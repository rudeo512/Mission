(function(a,b){if(typeof define==="function"&&define.amd){define(["angular"],function(c){return(nf.ng.Bridge=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Bridge=b(require("angular")))}else{nf.ng.Bridge=b(a.angular)}}}(this,function(a){function b(){this.rootScope;this.injector}b.prototype={constructor:b,call:function(e,d){var h=e.split(".");var i=this.rootScope;a.forEach(h,function(j){i=i[j]});var f=d.split(".");d=this.rootScope;a.forEach(f,function(j){d=d[j]});var g=Array.prototype.slice.call(arguments,2);var c=d.apply(i,g);if(c){return c}},get:function(c){var d=c.split(".");var e=this.rootScope;a.forEach(d,function(f){e=e[f]});return e},digest:function(){this.rootScope.$digest()}};return new b()}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.ServiceProvider=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.ServiceProvider=b())}else{nf.ng.ServiceProvider=b()}}}(this,function(){return function(){function a(){}a.prototype={constructor:a,register:function(c,b){this[c]=b},remove:function(b){delete this[b]}};return new a()}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.ClusterSummary=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ClusterSummary=b(require("jquery")))}else{nf.ClusterSummary=b(a.$)}}}(this,function(e){var d=false;var c=false;var f=false;var b=false;var a={urls:{clusterSummary:"../nifi-api/flow/cluster/summary"}};return{loadClusterSummary:function(){return e.ajax({type:"GET",url:a.urls.clusterSummary,dataType:"json"}).done(function(g){var h=g;var i=h.clusterSummary;if(d===true){if(f!==i.connectedToCluster){b=true}}else{if(i.clustered&&!i.connectedToCluster){b=true}}c=i.clustered;f=i.connectedToCluster;d=true})},isClustered:function(){return c===true},isConnectedToCluster:function(){return f===true},didConnectedStateChange:function(){var g=b;b=false;return g}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.Storage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Storage=b())}else{nf.Storage=b()}}}(this,function(){var h=false;var g=86400000;var f=g*2;var b=function(i){return typeof i==="undefined"};var e=function(i){return i===null};var d=function(i){return !b(i)&&!e(i)};var c=function(k){if(d(k.expires)){var i=new Date(k.expires);var j=new Date();return i.valueOf()<j.valueOf()}else{return false}};var a=function(i){try{var j=JSON.parse(localStorage.getItem(i));if(d(j)){return j}else{return null}}catch(k){return null}};return{init:function(){for(var k=0;k<localStorage.length;k++){try{var j=localStorage.key(k);this.getItem(j)}catch(l){}}},acknowledgeDisconnection:function(){h=true},resetDisconnectionAcknowledgement:function(){h=false},isDisconnectionAcknowledged:function(){return h},setItem:function(j,l,i){i=d(i)?i:new Date().valueOf()+f;var k={expires:i,item:l};localStorage.setItem(j,JSON.stringify(k))},hasItem:function(i){return a(i)!==null},getItem:function(i){var j=a(i);if(j===null){return null}if(c(j)){this.removeItem(i);return null}if(d(j.item)){return j.item}else{return null}},getItemExpiration:function(i){var j=a(i);if(j===null){return null}if(d(j.expires)){return j.expires}else{return null}},removeItem:function(i){localStorage.removeItem(i)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Storage"],function(d,c){return(nf.AjaxSetup=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AjaxSetup=b(require("jquery"),require("nf.Storage")))}else{nf.AjaxSetup=b(a.$,a.nf.Storage)}}}(this,function(b,a){b(document).ready(function(c){c.ajaxSetup({beforeSend:function(f){var d=a.hasItem("jwt");var e=a.getItem("jwt");if(e!==null){f.setRequestHeader("Authorization","Bearer "+e)}else{if(d===true){return false}}}})})}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.UniversalCapture=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.UniversalCapture=b(require("jquery")))}else{nf.UniversalCapture=b(a.$)}}}(this,function(b){b(document).ready(function(c){c(window).on("keydown",function(d){var i=d.ctrlKey||d.metaKey;if(!i&&d.keyCode===27){var g=c("div.value-combo");if(g.is(":visible")&&g.parent().hasClass("combo-editor")){return}if(c("div.property-detail").is(":visible")){a.removeAllPropertyDetailDialogs();d.stopImmediatePropagation();d.preventDefault()}else{var h=c(d.target);if(h.length){var j=c(".cancellable");if(j.length){var e=null;var f=null;c.each(j,function(k,m){var l=c(m);var n=l.css("zIndex");if(l.is(":visible")&&(n!==null&&typeof n!=="undefined")){n=parseInt(n,10);if(e===null||n>e){e=n;f=l}}});if(f!==null){if(f.hasClass("modal")){f.modal("hide")}else{f.hide()}d.stopImmediatePropagation();d.preventDefault();return}}if(top!==window){if(typeof parent.nf!=="undefined"&&typeof parent.nf.Shell!=="undefined"){parent.$("#shell-close-button").click();d.stopImmediatePropagation();d.preventDefault();return}}}}}else{if(i){if(d.keyCode===82){d.preventDefault()}}else{if(!c("input, textarea").is(":focus")&&(d.keyCode==8||d.keyCode===46)){d.preventDefault()}}}})});var a={removeAllPropertyDetailDialogs:function(){var c=b("body").find("div.property-detail");c.find("div.nfel-editor").nfeditor("destroy");c.find("div.value-combo").combo("destroy");c.hide().remove()}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.Dialog=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Dialog=b(require("jquery")))}else{nf.Dialog=b(a.$)}}}(this,function(b){b(document).ready(function(){b("#nf-ok-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-ok-dialog-content").empty()}}});b("#nf-yes-no-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-yes-no-dialog-content").empty();b("#nf-yes-no-dialog").modal("setButtonModel",[])}}})});var a={showOkDialog:function(c){c=b.extend({headerText:"",dialogContent:""},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-ok-dialog-content").append(d).append("</br>");b("#nf-ok-dialog").modal("setButtonModel",[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-ok-dialog").modal("hide");if(typeof c.okHandler==="function"){c.okHandler.call(this)}}}}]);b("#nf-ok-dialog").modal("setHeaderText",c.headerText).modal("show")},showYesNoDialog:function(c){c=b.extend({headerText:"",dialogContent:"",yesText:"Yes",noText:"No"},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-yes-no-dialog-content").append(d);b("#nf-yes-no-dialog").modal("setButtonModel",[{buttonText:c.yesText,color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.yesHandler==="function"){c.yesHandler.call(this)}}}},{buttonText:c.noText,color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.noHandler==="function"){c.noHandler.call(this)}}}}]);b("#nf-yes-no-dialog").modal("setHeaderText",c.headerText).modal("show")},showDisconnectedFromClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node is currently not connected to the cluster. Any modifications to the data flow made here will not replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})},showConnectedToClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node just joined the cluster. Any modifications to the data flow made here will replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage"],function(e,d,c){return(nf.Common=b(e,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Common=b(require("jquery"),require("d3"),require("nf.Storage")))}else{nf.Common=b(a.$,a.d3,a.nf.Storage)}}}(this,function(e,d,b){e(document).ready(function(){var g="images/bg-error.png";e("<img/>").attr("src",g).on("load",function(){e("div.message-pane").css("background-image",g)});e(document).on("mouseenter","span.link",function(){e(this).addClass("link-over")}).on("mouseleave","span.link",function(){e(this).removeClass("link-over")});e(document).on("click","div.nf-checkbox",function(){var h=e(this);if(h.hasClass("checkbox-unchecked")){h.removeClass("checkbox-unchecked").addClass("checkbox-checked")}else{h.removeClass("checkbox-checked").addClass("checkbox-unchecked")}h.trigger("change")});e(document).on("click",".nf-checkbox-label",function(h){e(h.target).parent().find(".nf-checkbox").click()});e(document).ajaxStart(function(){e("div.loading-container").addClass("ajax-loading")}).ajaxStop(function(){e("div.loading-container").removeClass("ajax-loading")});if(b.getItem("jwt")!==null){e("#user-logout-container").css("display","block");f.scheduleTokenRefresh()}e("#user-logout").on("click",function(){b.removeItem("jwt");window.location="../nifi/logout"});e("#user-home").on("click",function(){if(top!==window){parent.window.location="../nifi"}else{window.location="../nifi"}})});var c=null;var a=[{text:"view the user interface",value:"flow",description:"Allows users to view the user interface"},{text:"access the controller",value:"controller",description:"Allows users to view/modify the controller including Reporting Tasks, Controller Services, and Nodes in the Cluster"},{text:"query provenance",value:"provenance",description:"Allows users to submit a Provenance Search and request Event Lineage"},{text:"access restricted components",value:"restricted-components",description:"Allows users to create/modify restricted components assuming other permissions are sufficient"},{text:"access all policies",value:"policies",description:"Allows users to view/modify the policies for all components"},{text:"access users/user groups",value:"tenants",description:"Allows users to view/modify the users and user groups"},{text:"retrieve site-to-site details",value:"site-to-site",description:"Allows other NiFi instances to retrieve Site-To-Site details of this NiFi"},{text:"view system diagnostics",value:"system",description:"Allows users to view System Diagnostics"},{text:"proxy user requests",value:"proxy",description:"Allows proxy machines to send requests on the behalf of others"},{text:"access counters",value:"counters",description:"Allows users to view/modify Counters"}];var f={ANONYMOUS_USER_TEXT:"Anonymous user",config:{sensitiveText:"Sensitive value set",tooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:function(g){e(this).slideDown(100)}},hide:{effect:function(g){e(this).slideUp(100)}},position:{at:"top center",my:"bottom center"}}},SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,currentUser:undefined,sortVersion:function(g,r){if(g===r){return 0}var n=g.split(/-/);var s=r.split(/-/);if(n.length>=1&&s.length>=1){var p=n[0].split(/\./);var m=s[0].split(/\./);if(p.length>=1&&m.length>=1){var k=Math.min(p.length,m.length);for(var l=0;l<k;l++){var q=parseInt(p[l],10);var j=parseInt(m[l],10);if(isNaN(q)&&isNaN(j)){continue}else{if(isNaN(q)){return -1}else{if(isNaN(j)){return 1}}}if(q!==j){return q-j}}if(p.length===m.length){if(n.length===s.length){var o=f.substringAfterFirst(g,n[0]);var h=f.substringAfterFirst(r,s[0]);return o===h?0:o>h?1:-1}else{return s.length-n.length}}else{return p.length-m.length}}else{if(p.length>=1){return 1}else{if(m.length>=1){return -1}else{return 0}}}}else{if(n.length>=1){return 1}else{if(s.length>=1){return -1}else{return 0}}}},sortType:function(g,j){var h=function(m,k){var n=f.formatBundle(m.bundle);var l=f.formatBundle(k.bundle);return n===l?0:n>l?1:-1};var i=function(r,q){if(g.columnId==="version"){var p=f.isDefinedAndNotNull(r.bundle[g.columnId])?r.bundle[g.columnId]:"";var n=f.isDefinedAndNotNull(q.bundle[g.columnId])?q.bundle[g.columnId]:"";var l=f.sortVersion(p,n);return l===0?h(r,q):l}else{if(g.columnId==="type"){var o=f.substringAfterLast(r[g.columnId],".");var m=f.substringAfterLast(q[g.columnId],".");return o===m?0:o>m?1:-1}else{var k=f.isDefinedAndNotNull(r[g.columnId])?r[g.columnId]:"";var s=f.isDefinedAndNotNull(q[g.columnId])?q[g.columnId]:"";return k===s?h(r,q):k>s?1:-1}}};j.sort(i,g.sortAsc)},typeFormatter:function(l,h,k,j,g){var i="";if(g.restricted===true){i+='<div class="view-usage-restriction fa fa-shield"></div><span class="hidden row-id">'+f.escapeHtml(g.id)+"</span>"}else{i+='<div class="fa"></div>'}i+=f.escapeHtml(k);return i},genericValueFormatter:function(k,h,j,i,g){return f.escapeHtml(j)},typeBundleFormatter:function(k,h,j,i,g){return f.escapeHtml(f.formatBundle(g.bundle))},typeVersionFormatter:function(l,h,k,j,g){var i="";if(f.isDefinedAndNotNull(g.bundle)){i+=('<div style="float: left;">'+f.escapeHtml(g.bundle.version)+"</div>")}else{i+='<div style="float: left;">unversioned</div>'}if(!f.isEmpty(g.controllerServiceApis)){i+='<div class="controller-service-apis fa fa-list" title="Compatible Controller Service" style="margin-left: 4px;"></div><span class="hidden row-id">'+f.escapeHtml(g.id)+"</span>"}i+='<div class="clear"></div>';return i},instanceTypeFormatter:function(k,h,j,i,g){if(!g.permissions.canRead){return""}return f.escapeHtml(f.formatType(g.component))},instanceBundleFormatter:function(k,h,j,i,g){if(!g.permissions.canRead){return""}return f.typeBundleFormatter(k,h,j,i,g.component)},getVersionControlTooltip:function(g){return g.stateExplanation},formatClassName:function(g){return f.substringAfterLast(g.type,".")},formatType:function(g){var h=f.formatClassName(g);if(g.bundle.version!=="unversioned"){h+=(" "+g.bundle.version)}return h},formatBundle:function(g){var h="";if(g.group!=="default"){h=g.group+" - "}return h+g.artifact},setCurrentUser:function(g){f.currentUser=g},scheduleTokenRefresh:function(){if(c!==null){clearInterval(c)}var g=f.MILLIS_PER_MINUTE;var h=function(){var j=b.getItemExpiration("jwt");if(j!==null){var l=new Date(j);var k=new Date();var i=l.valueOf()-k.valueOf()-(30*f.MILLIS_PER_SECOND);if(i<g){if(e("#current-user").text()!==f.ANONYMOUS_USER_TEXT&&!e("#anonymous-user-alert").is(":visible")){e("#anonymous-user-alert").show().qtip(e.extend({},f.config.tooltipConfig,{content:"Your session will expire soon. Please log in again to avoid being automatically logged out.",position:{my:"top right",at:"bottom left"}}))}}}};h();c=setInterval(h,g)},setAnonymousUserLabel:function(){var g=e("#anonymous-user-alert");if(g.data("qtip")){g.qtip("api").destroy(true)}g.show().qtip(e.extend({},f.config.tooltipConfig,{content:"You are accessing with limited authority. Log in or request an account to access with additional authority granted to you by an administrator.",position:{my:"top right",at:"bottom left"}}));e("#current-user").text(f.ANONYMOUS_USER_TEXT).show()},getJwtPayload:function(h){if(f.isDefinedAndNotNull(h)){var g=h.split(/\./);if(g.length!==3){return""}var j=e.base64.atob(g[1]);var i=JSON.parse(j);if(f.isDefinedAndNotNull(i)){return i}else{return null}}return null},canVersionFlows:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.canVersionFlows===true}else{return false}},canAccessProvenance:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.provenancePermissions.canRead===true}else{return false}},canAccessRestrictedComponents:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.restrictedComponentsPermissions.canWrite===true}else{return false}},canAccessComponentRestrictions:function(h){if(f.isDefinedAndNotNull(f.currentUser)){if(f.currentUser.restrictedComponentsPermissions.canWrite===true){return true}var g=function(k){if(f.isEmpty(f.currentUser.componentRestrictionPermissions)){return false}var j=false;e.each(f.currentUser.componentRestrictionPermissions,function(l,m){if(m.requiredPermission.id===k.id){if(m.permissions.canWrite===true){j=true;return false}}});return j};var i=true;if(f.isEmpty(h)){i=false}else{e.each(h,function(j,k){if(!g(k.requiredPermission)){i=false;return false}})}return i}else{return false}},canAccessCounters:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.countersPermissions.canRead===true}else{return false}},canModifyCounters:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.countersPermissions.canRead===true&&f.currentUser.countersPermissions.canWrite===true}else{return false}},canAccessTenants:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.tenantsPermissions.canRead===true}else{return false}},canModifyTenants:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.tenantsPermissions.canRead===true&&f.currentUser.tenantsPermissions.canWrite===true}else{return false}},canAccessPolicies:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.policiesPermissions.canRead===true}else{return false}},canModifyPolicies:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.policiesPermissions.canRead===true&&f.currentUser.policiesPermissions.canWrite===true}else{return false}},canAccessController:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.controllerPermissions.canRead===true}else{return false}},canModifyController:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.controllerPermissions.canRead===true&&f.currentUser.controllerPermissions.canWrite===true}else{return false}},canAccessSystem:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.systemPermissions.canRead===true}else{return false}},addHoverEffect:function(g,i,h){e(document).on("mouseenter",g,function(){e(this).removeClass(i).addClass(h)}).on("mouseleave",g,function(){e(this).removeClass(h).addClass(i)});return e(g).addClass(i)},toggleScrollable:function(g){if(e(g).is(":visible")){if(g.offsetHeight<g.scrollHeight||g.offsetWidth<g.scrollWidth){e(g).addClass("scrollable")}else{e(g).removeClass("scrollable")}}},determineContrastColor:function(g){if(parseInt(g,16)>16777215/1.5){return"#000000"}return"#ffffff"},showLogoutLink:function(){if(b.getItem("jwt")===null){e("#user-logout-container").css("display","none")}else{e("#user-logout-container").css("display","block")}},isContentViewConfigured:function(){var g=e("#nifi-content-viewer-url").text();return !f.isBlank(g)},populateField:function(h,g){if(f.isUndefined(g)||f.isNull(g)){return e("#"+h).addClass("unset").text("No value set")}else{if(g===""){return e("#"+h).addClass("blank").text("Empty string set")}else{return e("#"+h).text(g)}}},clearField:function(g){return e("#"+g).removeClass("unset blank").text("")},cleanUpTooltips:function(g,h){g.find(h).each(function(){var j=e(this);if(j.data("qtip")){var i=j.qtip("api");i.destroy(true)}})},formatPropertyTooltip:function(h,j){var k=[];if(f.isDefinedAndNotNull(h)){if(!f.isBlank(h.description)){k.push(f.escapeHtml(h.description))}if(!f.isBlank(h.defaultValue)){k.push("<b>Default value:</b> "+f.escapeHtml(h.defaultValue))}if(!f.isBlank(h.supportsEl)){k.push("<b>Expression language scope:</b> "+f.escapeHtml(h.expressionLanguageScope))}if(!f.isBlank(h.identifiesControllerService)){var g=f.formatType({type:h.identifiesControllerService,bundle:h.identifiesControllerServiceBundle});var i=f.formatBundle(h.identifiesControllerServiceBundle);k.push("<b>Requires Controller Service:</b> "+f.escapeHtml(g+" from "+i))}}if(f.isDefinedAndNotNull(j)){if(!f.isEmpty(j.previousValues)){var l=[];e.each(j.previousValues,function(n,m){l.push("<li>"+f.escapeHtml(m.previousValue)+" - "+f.escapeHtml(m.timestamp)+" ("+f.escapeHtml(m.userIdentity)+")</li>")});k.push('<b>History:</b><ul class="property-info">'+l.join("")+"</ul>")}}if(k.length>0){return k.join("<br/><br/>")}else{return null}},formatProperty:function(g,h){return'<div><span class="label">'+f.formatValue(g)+": </span>"+f.formatValue(h)+"</div>"},formatValue:function(g){if(f.isDefinedAndNotNull(g)){if(g===""){return'<span class="blank" style="font-size: 13px; padding-top: 2px;">Empty string set</span>'}else{return f.escapeHtml(g)}}else{return'<span class="unset" style="font-size: 13px; padding-top: 2px;">No value set</span>'}},escapeHtml:(function(){var g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2f;"};return function(h){if(f.isDefinedAndNotNull(h)){return String(h).replace(/[&<>"'\/]/g,function(i){return g[i]})}else{return""}}}()),isSensitiveProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.sensitive===true}else{return false}},isRequiredProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.required===true}else{return false}},isDynamicProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.dynamic===true}else{return false}},getAllowableValues:function(g){if(f.isDefinedAndNotNull(g)){return g.allowableValues}else{return null}},supportsEl:function(g){if(f.isDefinedAndNotNull(g)){return g.supportsEl===true}else{return false}},formatUnorderedList:function(h){if(e.isArray(h)){var g=e('<ul class="result"></ul>');e.each(h,function(j,k){var i=e("<li></li>").appendTo(g);if(k instanceof jQuery){i.append(k)}else{i.text(k)}});return g}else{return null}},substringAfterLast:function(k,j){var h="";var i=k.lastIndexOf(j);if(i>=0){var g=i+j.length;if(g<k.length){h=k.substr(g)}}return h},substringAfterFirst:function(k,j){var h="";var i=k.indexOf(j);if(i>=0){var g=i+j.length;if(g<k.length){h=k.substr(g)}}return h},substringBeforeLast:function(j,i){var g="";var h=j.lastIndexOf(i);if(h>=0){g=j.substr(0,h)}return g},substringBeforeFirst:function(j,i){var g="";var h=j.indexOf(i);if(h>=0){g=j.substr(0,h)}return g},setCursor:function(h,g){if(g){e("#"+h).addClass("pointer")}else{e("#"+h).removeClass("pointer")}},getAccessToken:function(g){return e.Deferred(function(h){if(b.hasItem("jwt")){e.ajax({type:"POST",url:g}).done(function(i){h.resolve(i)}).fail(function(){h.reject()})}else{h.resolve("")}}).promise()},MILLIS_PER_DAY:86400000,MILLIS_PER_HOUR:3600000,MILLIS_PER_MINUTE:60000,MILLIS_PER_SECOND:1000,loadBalanceStrategyOptions:[{text:"Do not load balance",value:"DO_NOT_LOAD_BALANCE",description:"Do not load balance FlowFiles between nodes in the cluster."},{text:"Partition by attribute",value:"PARTITION_BY_ATTRIBUTE",description:"Determine which node to send a given FlowFile to based on the value of a user-specified FlowFile Attribute. All FlowFiles that have the same value for said Attribute will be sent to the same node in the cluster."},{text:"Round robin",value:"ROUND_ROBIN",description:"FlowFiles will be distributed to nodes in the cluster in a Round-Robin fashion."},{text:"Single node",value:"SINGLE_NODE",description:"All FlowFiles will be sent to the same node. Which node they are sent to is not defined."}],loadBalanceCompressionOptions:[{text:"Do not compress",value:"DO_NOT_COMPRESS",description:"FlowFiles will not be compressed"},{text:"Compress attributes only",value:"COMPRESS_ATTRIBUTES_ONLY",description:"FlowFiles' attributes will be compressed, but the FlowFiles' contents will not be"},{text:"Compress attributes and content",value:"COMPRESS_ATTRIBUTES_AND_CONTENT",description:"FlowFiles' attributes and content will be compressed"}],formatDuration:function(j){j=j<1?0:j;var l=j/f.MILLIS_PER_DAY;l=l>=1?parseInt(l,10):0;j%=f.MILLIS_PER_DAY;var g=j/f.MILLIS_PER_HOUR;g=g>=1?parseInt(g,10):0;j%=f.MILLIS_PER_HOUR;var h=j/f.MILLIS_PER_MINUTE;h=h>=1?parseInt(h,10):0;j%=f.MILLIS_PER_MINUTE;var k=j/f.MILLIS_PER_SECOND;k=k>=1?parseInt(k,10):0;j=Math.floor(j%f.MILLIS_PER_SECOND);var i=f.pad(g,2,"0")+":"+f.pad(h,2,"0")+":"+f.pad(k,2,"0")+"."+f.pad(j,3,"0");if(l>0){return l+" days and "+i}else{return i}},BYTES_IN_KILOBYTE:1024,BYTES_IN_MEGABYTE:1048576,BYTES_IN_GIGABYTE:1073741824,BYTES_IN_TERABYTE:1099511627776,formatDataSize:function(h){var g=parseFloat(h/f.BYTES_IN_TERABYTE);if(g>1){return g.toFixed(2)+" TB"}g=parseFloat(h/f.BYTES_IN_GIGABYTE);if(g>1){return g.toFixed(2)+" GB"}g=parseFloat(h/f.BYTES_IN_MEGABYTE);if(g>1){return g.toFixed(2)+" MB"}g=parseFloat(h/f.BYTES_IN_KILOBYTE);if(g>1){return g.toFixed(2)+" KB"}return parseFloat(h).toFixed(2)+" bytes"},formatInteger:function(h){var g=h+"";var i=/(\d+)(\d{3})/;while(i.test(g)){g=g.replace(i,"$1,$2")}return f.escapeHtml(g)},formatFloat:function(g){if(f.isUndefinedOrNull(g)){return 0+""}return g.toFixed(2)+""},pad:function(j,h,i){var g=j+"";while(g.length<h){g=i+g}return g},formatDateTime:function(g){return f.pad(g.getMonth()+1,2,"0")+"/"+f.pad(g.getDate(),2,"0")+"/"+f.pad(g.getFullYear(),2,"0")+" "+f.pad(g.getHours(),2,"0")+":"+f.pad(g.getMinutes(),2,"0")+":"+f.pad(g.getSeconds(),2,"0")+"."+f.pad(g.getMilliseconds(),3,"0")},parseDateTime:function(k){if(!f.isDefinedAndNotNull(k)){return new Date()}if(k==="No value set"){return new Date()}if(k==="Empty string set"){return new Date()}var r=k.split(/ /);if(r.length!==3){return new Date()}var h=r[0].split(/\//);var g=r[1].split(/:/);if(h.length!==3||g.length!==3){return new Date()}var m=parseInt(h[2],10);var l=parseInt(h[0],10)-1;var n=parseInt(h[1],10);var o=parseInt(g[0],10);var j=parseInt(g[1],10);var q=g[2].split(/\./);var p=parseInt(q[0],10);var i=0;if(q.length===2){i=parseInt(q[1],10)}return new Date(m,l,n,o,j,p,i)},parseDuration:function(g){var h=g.split(/:/);if(h.length!==3){return 0}var i=h[2].split(/\./);if(i.length===2){return new Date(1970,0,1,parseInt(h[0],10),parseInt(h[1],10),parseInt(i[0],10),parseInt(i[1],10)).getTime()}else{return new Date(1970,0,1,parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10),0).getTime()}},parseSize:function(i){var j=i.split(/ /);var h=parseFloat(j[0].replace(/,/g,""));var g=j[1];if(g==="KB"){return h*1024}else{if(g==="MB"){return h*1024*1024}else{if(g==="GB"){return h*1024*1024*1024}else{if(g==="TB"){return h*1024*1024*1024*1024}else{return h}}}}},parseCount:function(i){var h=i.split(/ /,1);if(h.length!==1){return 0}var g=parseInt(h[0].replace(/,/g,""),10);if(isNaN(g)){return 0}return g},isDefinedAndNotNull:function(g){return !f.isUndefined(g)&&!f.isNull(g)},isUndefinedOrNull:function(g){return f.isUndefined(g)||f.isNull(g)},isUndefined:function(g){return typeof g==="undefined"},isBlank:function(g){return f.isUndefined(g)||f.isNull(g)||e.trim(g)===""},isNull:function(g){return g===null},isEmpty:function(g){return e.isArray(g)?g.length===0:true},doBulletinsDiffer:function(h,j){if(e.isArray(h)&&e.isArray(j)){if(h.length===j.length){for(var g=0;g<h.length;g++){if(h[g].id!==j[g].id||h[g].canRead!==j[g].canRead){return true}}}else{return true}}else{if(e.isArray(h)||e.isArray(j)){return true}}return false},getFormattedBulletins:function(h){var g=[];e.each(h,function(k,l){if(l.canRead===true){var i=l.bulletin;var o="";if(f.isDefinedAndNotNull(i.nodeAddress)){o="-&nbsp;"+f.escapeHtml(i.nodeAddress)+"&nbsp;-&nbsp;"}var n=e("<pre></pre>").css({"white-space":"pre-wrap"}).text(i.message);var m=e("<div>"+f.escapeHtml(i.timestamp)+"&nbsp;"+o+"&nbsp;<b>"+f.escapeHtml(i.level)+"</b>&nbsp;</div>").append(n);g.push(m)}});return g},getFormattedServiceApis:function(h){var g=[];e.each(h,function(l,m){var j=f.formatType({type:m.type,bundle:m.bundle});var k=f.formatBundle(m.bundle);g.push(e("<div></div>").text(j+" from "+k))});return g},getFormattedGarbageCollections:function(h){h.sort(function(j,i){return i.collectionCount-j.collectionCount});var g=[];e.each(h,function(k,i){var j=e('<span style="font-weight: bold;"></span>').text(i.name);var l=e("<span></span>").text(" - "+i.collectionCount+" times ("+i.collectionTime+")");var m=e("<div></div>").append(j).append(l);g.push(m)});return g},getPolicyTypeListing:function(h){var g=d.nest().key(function(i){return i.value}).map(a,d.map);return g.get(h)[0]},getComponentName:function(g){return g.permissions.canRead===true?g.component.name:g.id},getComboOptionText:function(g,i){var h=g.find(function(j){return j.value===i});return f.isDefinedAndNotNull(h)?h.text:undefined}};return f}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Dialog","nf.Common"],function(d,c,e){return(nf.ErrorHandler=b(d,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("jquery"),require("nf.Dialog"),require("nf.Common")))}else{nf.ErrorHandler=b(a.$,a.nf.Dialog,a.nf.Common)}}}(this,function(b,a,c){return{handleAjaxError:function(g,d,e){if(d==="canceled"){if(b("#splash").is(":visible")){b("#message-title").text("Session Expired");b("#message-content").text("Your session has expired. Please reload to log in again.");b("#message-pane").show()}else{a.showOkDialog({headerText:"Session Expired",dialogContent:"Your session has expired. Please press Ok to log in again.",okHandler:function(){window.location="/nifi"}})}return}if(b("#splash").is(":visible")){if(g.status===401){b("#message-title").text("Unauthorized")}else{if(g.status===403){b("#message-title").text("Insufficient Permissions")}else{if(g.status===409){b("#message-title").text("Invalid State")}else{b("#message-title").text("An unexpected error has occurred")}}}if(b.trim(g.responseText)===""){b("#message-content").text("Please check the logs.")}else{b("#message-content").text(g.responseText)}b("#message-pane").show();return}if(g.status===400||g.status===404||g.status===409||g.status===503){a.showOkDialog({headerText:"Error",dialogContent:c.escapeHtml(g.responseText)})}else{if(g.status===403){a.showOkDialog({headerText:"Insufficient Permissions",dialogContent:c.escapeHtml(g.responseText)})}else{if(g.status<99||g.status===12007||g.status===12029){var f="Please ensure the application is running and check the logs for any errors.";if(c.isDefinedAndNotNull(d)){if(d==="timeout"){f="Request has timed out. Please ensure the application is running and check the logs for any errors."}else{if(d==="abort"){f="Request has been aborted."}else{if(d==="No Transport"){f="Request transport mechanism failed. Please ensure the host where the application is running is accessible."}}}}b("#message-title").text("Unable to communicate with NiFi");b("#message-content").text(f)}else{if(g.status===401){b("#message-title").text("Unauthorized");if(b.trim(g.responseText)===""){b("#message-content").text("Authentication is required to use this NiFi.")}else{b("#message-content").text(g.responseText)}}else{if(g.status===500){b("#message-title").text("An unexpected error has occurred");if(b.trim(g.responseText)===""){b("#message-content").text("An error occurred communicating with the application core. Please check the logs and fix any configuration issues before restarting.")}else{b("#message-content").text(g.responseText)}}else{if(g.status===200||g.status===201){b("#message-title").text("Parse Error");if(b.trim(g.responseText)===""){b("#message-content").text("Unable to interpret response from NiFi.")}else{b("#message-content").text(g.responseText)}}else{b("#message-title").text(g.status+": Unexpected Response");b("#message-content").text("An unexpected error has occurred. Please check the logs.")}}}}b("#message-pane").show()}}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.ClusterSummary","nf.ErrorHandler","nf.Dialog","nf.Common"],function(e,h,c,g,d,f){return(nf.ComponentState=b(e,h,c,g,d,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ComponentState=b(require("jquery"),require("Slick"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ComponentState=b(a.$,a.Slick,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(f,b,k,j,d,c){var l=function(){var o=[{id:"key",field:"key",name:"Key",sortable:true,resizable:true,formatter:c.genericValueFormatter},{id:"value",field:"value",name:"Value",sortable:true,resizable:true,formatter:c.genericValueFormatter}];if(k.isConnectedToCluster()){o.push({id:"scope",field:"scope",name:"Scope",sortable:true,resizable:true,formatter:c.genericValueFormatter})}return o};var g=function(){var o=f("#component-state-table").data("gridInstance");if(c.isDefinedAndNotNull(o)){var p=o.getData();p.setFilterArgs({searchString:m()});p.refresh()}};var a=function(q,p){if(p.searchString===""){return true}try{var u=new RegExp(p.searchString,"i")}catch(r){return false}var t=q.key.search(u)>=0;var o=q.value.search(u)>=0;var s=false;if(c.isDefinedAndNotNull(q.scope)){s=q.scope.search(u)>=0}return t||o||s};var e=function(o,q){var p=function(t,r){var s=c.isDefinedAndNotNull(t[o.columnId])?t[o.columnId]:"";var u=c.isDefinedAndNotNull(r[o.columnId])?r[o.columnId]:"";return s===u?0:s>u?1:-1};q.sort(p,o.sortAsc)};var m=function(){return f("#component-state-filter").val()};var i=function(){var o=f("#component-state-table").data("gridInstance");var p=o.getData();p.setItems([]);f("#component-state-partial-results-container").hide();f("#displayed-component-state-entries").text("0");f("#total-component-state-entries").text("0")};var h=function(o,p){var q=0;var s=0;var t=false;var r=f("#component-state-table").data("gridInstance");r.setColumns(l());var u=r.getData();u.beginUpdate();if(c.isDefinedAndNotNull(o)){f.each(o.state,function(v,w){u.addItem(f.extend({id:q++,scope:w.clusterNodeAddress},w))});s+=o.totalEntryCount;if(c.isDefinedAndNotNull(o.state)&&o.totalEntryCount!==o.state.length){t=true}}if(c.isDefinedAndNotNull(p)){f.each(p.state,function(v,w){u.addItem(f.extend({id:q++,scope:"Cluster"},w))});s+=p.totalEntryCount;if(c.isDefinedAndNotNull(p.state)&&p.totalEntryCount!==p.state.length){t=true}}u.endUpdate();u.reSort();if(t){f("#component-state-partial-results-container").show()}f("#total-component-state-entries").text(c.formatInteger(s))};var n=function(){f("#component-state-name").text("");f("#component-state-description").text("");f("#component-state-filter").val("");f("#clear-link").removeClass("disabled").attr("title","");i();f("#component-state-table").removeData("component")};return{init:function(){f("#component-state-filter").on("keyup",function(){g()});f("#component-state-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Component State",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f(this).modal("hide")}}}],handler:{close:function(){n()},resize:function(){f("#component-state-description").width(f("#component-state-dialog").find(".dialog-content").innerWidth()-1).text(f("#component-state-description").attr("title")).ellipsis()}}});f("#clear-link").on("click",function(){if(f(this).hasClass("disabled")===false){var s=f("#component-state-table");var u=s.data("gridInstance");var t=u.getDataLength();if(t>0){var r=s.data("component");f.ajax({type:"POST",url:r.uri+"/state/clear-requests",dataType:"json"}).done(function(v){i();h()}).fail(j.handleAjaxError)}else{d.showOkDialog({headerText:"Component State",dialogContent:"This component has no state to clear."})}}});var o={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var q=new b.Data.DataView({inlineFilters:false});q.setItems([]);q.setFilterArgs({searchString:"",property:"key"});q.setFilter(a);e({columnId:"key",sortAsc:true},q);var p=new b.Grid("#component-state-table",q,l(),o);p.setSelectionModel(new b.RowSelectionModel());p.registerPlugin(new b.AutoTooltips());p.setSortColumn("key",true);p.onSort.subscribe(function(s,r){e({columnId:r.sortCol.field,sortAsc:r.sortAsc},q)});q.onRowCountChanged.subscribe(function(s,r){p.updateRowCount();p.render();f("#displayed-component-state-entries").text(r.current)});q.onRowsChanged.subscribe(function(s,r){p.invalidateRows(r.rows);p.render()});f("#component-state-table").data("gridInstance",p);f("#displayed-component-state-entries").text("0");f("#total-component-state-entries").text("0")},showState:function(o,p){return f.ajax({type:"GET",url:o.uri+"/state",dataType:"json"}).done(function(r){var s=r.componentState;var q=f("#component-state-table");h(s.localState,s.clusterState);f("#component-state-dialog").modal("show");f("#component-state-name").text(o.component.name);f("#component-state-description").width(f("#component-state-dialog").find(".dialog-content").innerWidth()-1).text(s.stateDescription).ellipsis();q.data("component",o);if(p===false){f("#clear-link").addClass("disabled").attr("title","Component state can only be cleared when the component is not actively running")}var t=q.data("gridInstance");t.resizeCanvas()}).fail(j.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Shell=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Shell=b(require("jquery"),require("nf.Common")))}else{nf.Shell=b(a.$,a.nf.Common)}}}(this,function(b,e){b(document).ready(function(){b("#shell-dialog").modal({scrollableContentStyle:"scrollable",header:false,footer:false,responsive:{x:false,y:false}});b("#shell-close-button").click(function(){b("#shell-dialog").modal("hide")});b("#shell-undock-button").click(function(){var f=b("#shell-iframe").attr("src");if(!e.isBlank(f)){window.open(f);b("#shell-dialog").modal("hide")}})});var d=null;var c=null;var a=null;return{init:function(f){a=f},resizeContent:function(f){var g=f.find(".shell-content-container");g.css({width:f.width(),height:f.height()-28-40});f.trigger("shell:content:resize")},resizeIframe:function(f){var g=f.find("#shell-iframe");g.css({width:f.width(),height:f.height()-28-40});f.trigger("shell:iframe:resize")},showPage:function(f,g){if(e.isDefinedAndNotNull(a)){a.hide()}return b.Deferred(function(h){var i=b("#shell");if(e.isNull(g)||e.isUndefined(g)){g=true}b("#shell-dialog").modal("setCloseHandler",function(){i.empty();h.resolve()});b("#shell-dialog").modal("setOpenHandler",function(){e.toggleScrollable(b("#"+this.find(".tab-container").attr("id")+"-content").get(0))});b("#shell-dialog").modal("show");if(g){b("#shell-undock-button").show()}else{b("#shell-undock-button").hide()}var j=b("<iframe/>",{id:"shell-iframe",frameBorder:"0",src:f}).css({width:i.width(),height:i.height()-28}).appendTo(i)}).promise()},showContent:function(f){if(e.isDefinedAndNotNull(a)){a.hide()}return b.Deferred(function(g){var k=b(f);if(k.length){var h=b("#shell");var j=k.parent();k.detach();b("#shell-dialog").modal("setCloseHandler",function(){var m=b(".combo");for(var n=0,l=m.length;n<l;n++){if(b(m[n]).is(":visible")){b(m[n]).combo("close")}}g.resolve();k.hide().detach().appendTo(j);h.empty()});b("#shell-undock-button").hide();b("#shell-dialog").modal("show");var i=b("<div>").addClass("shell-content-container").css({width:h.width(),height:h.height()}).append(k).appendTo(h);k.show()}}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Client=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Client=b(require("jquery"),require("nf.Common")))}else{nf.Client=b(a.$,a.nf.Common)}}}(this,function(b,c){var a=null;return{init:function(){return b.ajax({type:"GET",url:"../nifi-api/flow/client-id",}).done(function(d){a=d})},getRevision:function(e){return{clientId:a,version:e.revision.version}},isNewerRevision:function(f,d){if(c.isDefinedAndNotNull(f)){var g=f.revision;var e=d.revision;return e.version>=g.version}else{return true}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Clipboard=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Clipboard=b(require("jquery"),require("nf.Common")))}else{nf.Clipboard=b(a.$,a.nf.Common)}}}(this,function(e,f){var a="copy";var d="paste";var c=null;var b={};return{addListener:function(h,g){b[h]=g},removeListener:function(g){if(f.isDefinedAndNotNull(b[g])){delete b[g]}},copy:function(h){c=h;for(var g in b){b[g].call(g,a,c)}},isCopied:function(){return f.isDefinedAndNotNull(c)},paste:function(){return e.Deferred(function(g){if(f.isDefinedAndNotNull(c)){var i=c;g.resolve(i);c=null;for(var h in b){b[h].call(h,d,i)}}else{g.reject()}}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Shell","nf.Dialog","nf.Storage","nf.Client"],function(g,h,c,f,e,d){return(nf.CustomUi=b(g,h,c,f,e,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.CustomUi=b(require("jquery"),require("nf.Common"),require("nf.Shell"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client")))}else{nf.CustomUi=b(a.$,a.nf.Common,a.nf.Shell,a.nf.Dialog,a.nf.Storage,a.nf.Client)}}}(this,function(e,f,a,d,c,b){return{showCustomUi:function(g,i,h){return e.Deferred(function(j){f.getAccessToken("../nifi-api/access/ui-extension-token").done(function(l){e("#shell-close-button");var k=b.getRevision(g);var m={id:g.id,revision:k.version,clientId:k.clientId,editable:h,disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged()};if(!f.isBlank(l)){m.access_token=l}a.showPage(".."+i+"?"+e.param(m),false).done(function(){j.resolve()})}).fail(function(){d.showOkDialog({headerText:"Advanced Configuration",dialogContent:"Unable to generate access token for accessing the advanced configuration dialog."});j.resolve()})}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","jquery","nf.Common","nf.ErrorHandler","nf.Dialog","nf.Clipboard","nf.Storage"],function(e,g,h,i,f,d,c){return(nf.CanvasUtils=b(e,g,h,i,f,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.CanvasUtils=b(require("d3"),require("jquery"),require("nf.Common"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Clipboard"),require("nf.Storage")))}else{nf.CanvasUtils=b(a.d3,a.$,a.nf.Common,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Clipboard,a.nf.Storage)}}}(this,function(q,a,g,d,j,e,c){var r;var n;var m;var h;var b;var f=q.map();var s=q.map();var p={storage:{namePrefix:"nifi-view-"},urls:{controller:"../nifi-api/controller"}};var i=2000;var o=2*Math.PI;var k=function(y,w){var v=0;var z=y-1;var x;var u=0;while(v<=z){x=~~((v+z)/2);u=w(x);if(u<0){z=x-1}else{if(u>0){v=x+1}else{break}}}return x};var t=function(v,u){return a.Deferred(function(x){var w=l.getGroupId();var y=m.marshal(v,w);m.create(y).done(function(z){m.move(z.snippet.id,u).done(function(){var B=q.map();var A=function(C,D){if(!B.has(C)){B.set(C,[])}B.get(C).push(D)};v.each(function(C){A(C.type,C.id)});B.each(function(D,C){l.getComponentByType(C).remove(D)});h.refresh();x.resolve()}).fail(d.handleAjaxError).fail(function(){x.reject()})}).fail(d.handleAjaxError).fail(function(){x.reject()})}).promise()};var l={init:function(y,w,v,x,u){r=y;n=w;m=v;h=x;b=u},config:{systemTooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:false},hide:{effect:false},position:{at:"bottom right",my:"top left"}}},getComponentByType:function(u){return b.getComponentByType(u)},getPerimeterPoint:function(u,D){var v=Math.atan2(D.height,D.width);var A=D.width/2;var z=D.height/2;var y=D.x+A;var w=D.y+z;var E=u.x-y;var C=u.y-w;var x=Math.atan2(C,E);x=x%o;if(x<0){x+=o}var B=(Math.PI/2)-x;if((x>=0&&x<v)||(x>=(o-v)&&x<o)){return{x:D.x+D.width,y:w+Math.tan(x)*A}}else{if(x>=v&&x<(Math.PI-v)){return{x:y+Math.tan(B)*z,y:D.y+D.height}}else{if(x>=(Math.PI-v)&&x<(Math.PI+v)){return{x:D.x,y:w-Math.tan(x)*A}}else{return{x:y-Math.tan(B)*z,y:D.y}}}}},queryBulletins:function(w){var u=[];var v=function(B){var z=new URL(window.location);var x=g.substringBeforeLast(z.href,"/nifi");var D=x+"/nifi-api/flow/bulletin-board?"+a.param({sourceId:B.join("|")});if(D.length>i){var y=Math.ceil(B.length/2);var C=B.slice(0,y);if(C.length>0){v(C)}var A=B.slice(y);if(A.length>0){v(A)}}else{u.push(a.ajax({type:"GET",url:D,dataType:"json"}))}};v(w);if(u.length===1){return a.Deferred(function(x){u[0].done(function(y){x.resolve(y)}).fail(function(){x.reject()}).fail(d.handleAjaxError)}).promise()}else{return a.Deferred(function(x){a.when.apply(window,u).done(function(){var z=a.makeArray(arguments);var y=null;var A=[];a.each(z,function(D,B){var C=B[0];var E=C.bulletinBoard;if(y===null){y=E.generated}Array.prototype.push.apply(A,E.bulletins)});A.sort(function(C,B){return B.id-C.id});x.resolve({bulletinBoard:{generated:y,bulletins:A}})}).fail(function(){x.reject()}).fail(d.handleAjaxError)}).promise()}},showComponent:function(v,u){if(g.isDefinedAndNotNull(v)){var w=a.Deferred(function(x){if(v!==r.getGroupId()){r.setGroupId(v);r.reload().done(function(){x.resolve()}).fail(function(A,y,z){j.showOkDialog({headerText:"Error",dialogContent:"Unable to load the group for the specified component."});x.reject(A,y,z)})}else{x.resolve()}}).promise();w.done(function(){var x=q.select("#id-"+u);if(!x.empty()){n.show(x)}else{j.showOkDialog({headerText:"Error",dialogContent:"Unable to find the specified component."})}});return w}else{return a.Deferred(function(x){x.reject()}).promise()}},showDeepLink:function(u){l.getSelection().classed("selected",false);if(a("#nf-ok-dialog").is(":visible")===true){a("#nf-ok-dialog").modal("hide")}if("URLSearchParams" in window){var x=new URL(window.location).searchParams;if(!nf.Common.isDefinedAndNotNull(x)){x=new URLSearchParams(new URL(window.location).search)}var v=l.getGroupId();if(nf.Common.isDefinedAndNotNull(x)){var w=[];if(x.get("processGroupId")){v=x.get("processGroupId")}if(x.get("componentIds")){w=x.get("componentIds").split(",")}if(w.length>=1){return l.showComponents(v,w,u)}else{return l.getComponentByType("ProcessGroup").enterGroup(v)}}else{return l.getComponentByType("ProcessGroup").enterGroup(v)}}},showComponents:function(v,x,u){if(g.isDefinedAndNotNull(v)){var w=a.Deferred(function(y){if(v!==r.getGroupId()||u){r.setGroupId(v);r.reload().done(function(){y.resolve()}).fail(function(B,z,A){j.showOkDialog({headerText:"Error",dialogContent:"Unable to enter the selected group."});y.reject(B,z,A)})}else{y.resolve()}}).promise();w.done(function(){var y=q.selectAll("g.component, g.connection").filter(function(A){if(x.indexOf(A.id)>=0){x.splice(x.indexOf(A.id),1);return A}});if(x.length>0){var z=a("<p></p>").text("Specified component(s) not found: "+x.join(", ")+".").append("<br/><br/>").append(a("<p>Unable to select component(s).</p>"));j.showOkDialog({headerText:"Error",dialogContent:z})}n.show(y)});return w}},setURLParameters:function(w,x){if("URLSearchParams" in window){if(!g.isDefinedAndNotNull(w)){w=l.getGroupId()}if(!g.isDefinedAndNotNull(x)){x=l.getSelection()}var u=[];x.each(function(A){u.push(A.id)});var v=new URL(window.location);var z=new URL(window.location).searchParams;if(!nf.Common.isDefinedAndNotNull(z)){z=new URLSearchParams(v.search)}if(nf.Common.isDefinedAndNotNull(z)){var z=new URLSearchParams(v.search);z.set("processGroupId",w);z.set("componentIds",u.sort());var y=v.origin+v.pathname;if(g.isDefinedAndNotNull(l.getParentGroupId())||u.length>0){if(!g.isDefinedAndNotNull(l.getParentGroupId())){z.set("processGroupId","root")}if((v.origin+v.pathname+"?"+z.toString()).length<=i){y=v.origin+v.pathname+"?"+z.toString()}else{if(g.isDefinedAndNotNull(l.getParentGroupId())){z.set("componentIds","");y=v.origin+v.pathname+"?"+z.toString()}}}window.history.replaceState({previous_url:v.href},window.document.title,y)}}},getSelection:function(){return q.selectAll("g.component.selected, g.connection.selected")},centerBoundingBox:function(v){var x=r.View.getScale();if(g.isDefinedAndNotNull(v.scale)){x=v.scale}var z=a("#canvas-container");var w=z.width()/x;var y=z.height()/x;var u=[(w/2)-(v.width/2),(y/2)-(v.height/2)];r.View.transform([(u[0]-v.x)*x,(u[1]-v.y)*x],x)},editable:function(u,v,w){if(l.canModify(u)){if(!u.classed("connectable")){u.call(v.activate)}if(!u.classed("moveable")){u.call(w.activate)}}else{if(u.classed("connectable")){u.call(v.deactivate)}if(u.classed("moveable")){u.call(w.deactivate)}}},transition:function(u,v){if(v&&!u.empty()){return u.transition().duration(400)}else{return u}},position:function(u,v){if(u.empty()){return}return l.transition(u,v).attr("transform",function(w){return"translate("+w.position.x+", "+w.position.y+")"})},ellipsis:function(w,y){y=y.trim();var v=parseInt(w.attr("width"),10);var x=w.node();w.text(y);if(y.length>0&&x.getSubStringLength(0,y.length-1)>v){v-=5;var u=k(y.length,function(z){var A=x.getSubStringLength(0,z);if(A>v){return -1}else{if(A<v){return 1}}return 0});w.text(y.substring(0,u)+String.fromCharCode(8230))}},multilineEllipsis:function(D,G,F){var w=1;var z=F.split(/\s+/).reverse();var C=parseInt(D.attr("x"),10);var B=parseInt(D.attr("y"),10);var v=parseInt(D.attr("width"),10);var H=[];var A=D.append("tspan").attrs({x:C,y:B,width:v});var u=z.pop();while(g.isDefinedAndNotNull(u)){H.push(u);A.text(H.join(" "));if(A.node().getComputedTextLength()>v){H.pop();A.text(H.join(" "));A=D.append("tspan").attrs({x:C,dy:"1.2em",width:v});if(++w>=G){var E=[u].concat(z.reverse());l.ellipsis(A,E.join(" "));break}else{A.text(u);H=[u]}}u=z.pop()}},activeThreadCount:function(w,z,A){var y=z.status.aggregateSnapshot.activeThreadCount;var u=z.status.aggregateSnapshot.terminatedThreadCount;if(y>0||u>0){var v=function(){var B=y+" active threads";if(u>0){B+=" ("+u+" terminated)"}return B};var x=w.select("text.active-thread-count").text(function(){if(u>0){return y+" ("+u+")"}else{return y}}).style("display","block").each(function(){var C=q.select(this);var B=this.getBBox();C.attr("x",function(){return z.dimensions.width-B.width-15});C.selectAll("title").remove()});x.append("title").text(v);w.select("text.active-thread-count-icon").attr("x",function(){var B=x.node().getBBox();if(typeof A==="function"){A(B.width+6)}return z.dimensions.width-B.width-20}).style("fill",function(){if(u>0){return"#ba554a"}else{return"#728e9b"}}).style("display","block").each(function(){var B=q.select(this);B.selectAll("title").remove()}).append("title").text(v)}else{w.selectAll("text.active-thread-count, text.active-thread-count-icon").style("display","none").each(function(){q.select(this).selectAll("title").remove()})}},disableImageHref:function(u){u.on("click.disableImageHref",function(){if(q.event.ctrlKey||q.event.shiftKey){q.event.preventDefault()}})},bulletins:function(u,A,B,z){z=g.isDefinedAndNotNull(z)?z:0;var x=q.select("#bulletin-tip-"+A.id);var w=false;if(!g.isEmpty(A.bulletins)){var y=g.getFormattedBulletins(A.bulletins);w=y.length>0;if(w){var v=g.formatUnorderedList(y)}}if(w){u.select("text.bulletin-icon").each(function(){if(x.empty()){x=B().append("div").attr("id",function(){return"bulletin-tip-"+A.id}).attr("class","tooltip nifi-tooltip")}x.html(function(){return a("<div></div>").append(v).html()});l.canvasTooltip(x,q.select(this))});u.select("text.bulletin-icon").style("visibility","visible");u.select("rect.bulletin-background").style("visibility","visible")}else{if(!x.empty()){x.remove()}u.select("text.bulletin-icon").style("visibility","hidden");u.select("rect.bulletin-background").style("visibility","hidden")}},canvasTooltip:function(u,v){v.on("mouseenter",function(){u.style("top",(q.event.pageY+15)+"px").style("left",(q.event.pageX+15)+"px").style("display","block")}).on("mousemove",function(){u.style("top",(q.event.pageY+15)+"px").style("left",(q.event.pageX+15)+"px")}).on("mouseleave",function(){u.style("display","none")})},canAlign:function(w){var v=true;var u=w.filter(function(y){var x=q.select(this);return l.isConnection(x)});if(w.size()-u.size()<2){v=false}if(l.canModify(w)===false){v=false}return v},isColorable:function(w){if(w.empty()){return false}if(l.canRead(w)===false||l.canModify(w)===false){return false}var v=w.filter(function(A){var z=q.select(this);return l.isProcessor(z)&&l.canModify(z)});var y=w.filter(function(A){var z=q.select(this);return l.isLabel(z)&&l.canModify(z)});var u=v.size()===w.size();var x=y.size()===w.size();return u||x},isConnection:function(u){return u.classed("connection")},isRemoteProcessGroup:function(u){return u.classed("remote-process-group")},isProcessor:function(u){return u.classed("processor")},isLabel:function(u){return u.classed("label")},isInputPort:function(u){return u.classed("input-port")},isOutputPort:function(u){return u.classed("output-port")},isProcessGroup:function(u){return u.classed("process-group")},isFunnel:function(u){return u.classed("funnel")},areRunnable:function(u){if(u.empty()){return true}var v=true;u.each(function(){if(!l.isRunnable(q.select(this))){v=false;return false}});return v},isRunnable:function(u){if(u.size()!==1){return false}if(l.isProcessGroup(u)){return true}if(l.canOperate(u)===false){return false}var w=false;var v=u.datum();if(l.isProcessor(u)||l.isInputPort(u)||l.isOutputPort(u)){w=l.supportsModification(u)&&v.status.aggregateSnapshot.runStatus==="Stopped"}return w},areStoppable:function(u){if(u.empty()){return true}var v=true;u.each(function(){if(!l.isStoppable(q.select(this))){v=false;return false}});return v},isStoppable:function(u){if(u.size()!==1){return false}if(l.isProcessGroup(u)){return true}if(l.canOperate(u)===false){return false}var w=false;var v=u.datum();if(l.isProcessor(u)||l.isInputPort(u)||l.isOutputPort(u)){w=v.status.aggregateSnapshot.runStatus==="Running"}return w},filterEnable:function(u){return u.filter(function(x){var v=q.select(this);var w=v.datum();if(l.isProcessGroup(v)){return true}if(l.canOperate(v)===false){return false}return((l.isProcessor(v)||l.isInputPort(v)||l.isOutputPort(v))&&l.supportsModification(v)&&w.status.aggregateSnapshot.runStatus==="Disabled")})},canEnable:function(u){if(u.empty()){return true}return l.filterEnable(u).size()===u.size()},filterDisable:function(u){return u.filter(function(x){var v=q.select(this);var w=v.datum();if(l.isProcessGroup(v)){return true}if(l.canOperate(v)===false){return false}return((l.isProcessor(v)||l.isInputPort(v)||l.isOutputPort(v))&&l.supportsModification(v)&&(w.status.aggregateSnapshot.runStatus==="Stopped"||w.status.aggregateSnapshot.runStatus==="Invalid"))})},canDisable:function(u){if(u.empty()){return true}return l.filterDisable(u).size()===u.size()},canAllStartTransmitting:function(u){if(u.empty()){return false}var v=true;u.each(function(){if(!l.canStartTransmitting(q.select(this))){v=false}});return v},canStartTransmitting:function(u){if(u.size()!==1){return false}if((l.canModify(u)===false||l.canRead(u)===false)&&l.canOperate(u)===false){return false}return l.isRemoteProcessGroup(u)},canAllStopTransmitting:function(u){if(u.empty()){return false}var v=true;u.each(function(){if(!l.canStopTransmitting(q.select(this))){v=false}});return v},canStopTransmitting:function(u){if(u.size()!==1){return false}if((l.canModify(u)===false||l.canRead(u)===false)&&l.canOperate(u)===false){return false}return l.isRemoteProcessGroup(u)},areDeletable:function(u){if(u.empty()){return false}var v=true;u.each(function(){if(!l.isDeletable(q.select(this))){v=false}});return v},isDeletable:function(u){if(u.size()!==1){return false}if(r.canWrite()===false){return false}if(l.canModify(u)===false){return false}return l.supportsModification(u)},isConfigurable:function(u){if(u.size()!==1){if(u.empty()){return true}else{return false}}if(l.isProcessGroup(u)){return true}if(l.canRead(u)===false||l.canModify(u)===false){return false}if(l.isFunnel(u)){return false}return l.supportsModification(u)},hasDetails:function(u){if(u.size()!==1){return false}if(l.canRead(u)===false){return false}if(l.canModify(u)){if(l.isProcessor(u)||l.isInputPort(u)||l.isOutputPort(u)||l.isRemoteProcessGroup(u)||l.isConnection(u)){return !l.isConfigurable(u)}}else{return l.isProcessor(u)||l.isConnection(u)||l.isInputPort(u)||l.isOutputPort(u)||l.isRemoteProcessGroup(u)}return false},canManagePolicies:function(){var u=l.getSelection();if(u.size()<=1){if(!u.empty()&&l.isConnection(u)){return false}return g.canAccessTenants()}return false},canModify:function(w){var v=w.size();var u=w.filter(function(x){return x.permissions.canWrite}).size();return v===u},canRead:function(v){var u=v.size();var w=v.filter(function(x){return x.permissions.canRead}).size();return u===w},canOperate:function(w){var v=w.size();var u=w.filter(function(x){return x.permissions.canWrite||(x.operatePermissions&&x.operatePermissions.canWrite)}).size();return v===u},supportsModification:function(B){if(B.size()!==1){return false}var z=B.datum();var x=false;if(l.isProcessor(B)||l.isInputPort(B)||l.isOutputPort(B)){x=!(z.status.aggregateSnapshot.runStatus==="Running"||z.status.aggregateSnapshot.activeThreadCount>0)}else{if(l.isRemoteProcessGroup(B)){x=!(z.status.transmissionStatus==="Transmitting"||z.status.aggregateSnapshot.activeThreadCount>0)}else{if(l.isProcessGroup(B)){x=true}else{if(l.isFunnel(B)){x=true}else{if(l.isLabel(B)){x=true}else{if(l.isConnection(B)){var A=false;var v=false;var C=l.getConnectionSourceComponentId(z);var u=q.select("#id-"+C);if(!u.empty()){if(l.isRemoteProcessGroup(u)||l.isProcessGroup(u)){A=true}else{A=l.supportsModification(u)}}var w=l.getConnectionDestinationComponentId(z);var y=q.select("#id-"+w);if(!y.empty()){if(l.isRemoteProcessGroup(y)||l.isProcessGroup(y)){v=true}else{v=l.supportsModification(y)}}x=A&&v}}}}}}return x},getConnectableTypeForSource:function(v){var u;if(l.isProcessor(v)){u="PROCESSOR"}else{if(l.isRemoteProcessGroup(v)){u="REMOTE_OUTPUT_PORT"}else{if(l.isProcessGroup(v)){u="OUTPUT_PORT"}else{if(l.isInputPort(v)){u="INPUT_PORT"}else{if(l.isFunnel(v)){u="FUNNEL"}}}}}return u},getConnectableTypeForDestination:function(v){var u;if(l.isProcessor(v)){u="PROCESSOR"}else{if(l.isRemoteProcessGroup(v)){u="REMOTE_INPUT_PORT"}else{if(l.isProcessGroup(v)){u="INPUT_PORT"}else{if(l.isOutputPort(v)){u="OUTPUT_PORT"}else{if(l.isFunnel(v)){u="FUNNEL"}}}}}return u},isCopyable:function(v){if(v.empty()){return false}if(l.canRead(v)===false){return false}var u=v.filter(function(z){var x=q.select(this);if(l.isConnection(x)){var w=!v.filter(function(A){var B=l.getConnectionSourceComponentId(z);return B===A.id}).empty();var y=!v.filter(function(A){var B=l.getConnectionDestinationComponentId(z);return B===A.id}).empty();return w&&y}else{return l.isProcessor(x)||l.isFunnel(x)||l.isLabel(x)||l.isProcessGroup(x)||l.isRemoteProcessGroup(x)||l.isInputPort(x)||l.isOutputPort(x)}});return v.size()===u.size()},isPastable:function(){return r.canWrite()&&e.isCopied()},persistUserView:function(){var u=p.storage.namePrefix+r.getGroupId();var w=r.View.getTranslate();var v={scale:r.View.getScale(),translateX:w[0],translateY:w[1]};c.setItem(u,v)},formatConnectionName:function(u){if(!g.isBlank(u.name)){return u.name}else{if(g.isDefinedAndNotNull(u.selectedRelationships)){return u.selectedRelationships.join(", ")}}return""},reloadConnectionSourceAndDestination:function(x,w){if(g.isBlank(x)===false){var v=q.select("#id-"+x);if(v.empty()===false){b.reload(v)}}if(g.isBlank(w)===false){var u=q.select("#id-"+w);if(u.empty()===false){b.reload(u)}}},getConnectionSourceComponentId:function(u){var v=u.sourceId;if(u.sourceGroupId!==r.getGroupId()){v=u.sourceGroupId}return v},getConnectionDestinationComponentId:function(u){var v=u.destinationId;if(u.destinationGroupId!==r.getGroupId()){v=u.destinationGroupId}return v},restoreUserView:function(){var w=false;try{var u=p.storage.namePrefix+r.getGroupId();var v=c.getItem(u);if(g.isDefinedAndNotNull(v)){if(isFinite(v.scale)&&isFinite(v.translateX)&&isFinite(v.translateY)){r.View.transform([v.translateX,v.translateY],v.scale);w=true}}}catch(x){}return w},getOrigin:function(v){var u={};v.each(function(x){var w=q.select(this);if(!l.isConnection(w)){if(g.isUndefined(u.x)||x.position.x<u.x){u.x=x.position.x}if(g.isUndefined(u.y)||x.position.y<u.y){u.y=x.position.y}}});return u},moveComponentsToParent:function(v){var u=r.getParentGroupId();if(u===null){j.showOkDialog({headerText:"Process Group",dialogContent:"Components are already in the topmost group."})}else{t(v,u)}},moveComponents:function(v,w){var u=w.datum();t(v,u.id).done(function(){l.getComponentByType("ProcessGroup").reload(u.id)})},trimDanglingEdges:function(u){var v=function(w){var A=l.getConnectionSourceComponentId(w);var z=l.getConnectionDestinationComponentId(w);var y=false;var x=false;u.each(function(B){if(B.id===A){y=true}if(B.id===z){x=true}});return y&&x};return u.filter(function(w){if(w.type==="Connection"){return v(w)}else{return true}})},isValidConnectionSource:function(u){if(u.size()!==1){return false}if(l.isProcessGroup(u)){return true}if(l.canRead(u)===false||l.canModify(u)===false){return false}return l.isProcessor(u)||l.isRemoteProcessGroup(u)||l.isInputPort(u)||l.isFunnel(u)},isValidConnectionDestination:function(v){if(v.size()!==1){return false}if(l.isProcessGroup(v)){return true}if(l.canModify(v)===false){return false}if(l.isRemoteProcessGroup(v)||l.isOutputPort(v)||l.isFunnel(v)){return true}if(l.isProcessor(v)){var u=v.datum();return u.inputRequirement!=="INPUT_FORBIDDEN"}},isManagedAuthorizer:function(){return r.isManagedAuthorizer()},isConfigurableAuthorizer:function(){return r.isConfigurableAuthorizer()},isConfigurableUsersAndGroups:function(){return r.isConfigurableUsersAndGroups()},addComponentRestrictions:function(u,v){u.each(function(w,x){if(!f.has(x)){f.set(x,[])}w.forEach(function(y){f.get(x).push(y)})});v.each(function(w,x){if(!s.has(x)){s.set(x,w)}})},getComponentRestrictions:function(){return{restrictedUsage:f,requiredPermissions:s}},setGroupId:function(u){return r.setGroupId(u)},getGroupId:function(){return r.getGroupId()},getGroupName:function(){return r.getGroupName()},getParentGroupId:function(){return r.getParentGroupId()},reload:function(){return r.reload({transition:true})},canReadCurrentGroup:function(){return r.canRead()},canWriteCurrentGroup:function(){return r.canWrite()},getCanvasScale:function(){return r.View.getScale()},getCanvasTranslate:function(){return r.View.getTranslate()},translateCanvas:function(u){r.View.translate(u)},fitCanvas:function(){return r.View.fit()},zoomInCanvas:function(){return r.View.zoomIn()},zoomOutCanvas:function(){return r.View.zoomOut()},actualSizeCanvas:function(){return r.View.actualSize()},shouldRenderPerScale:function(){return r.View.shouldRenderPerScale()},getCanvasOffset:function(){return r.CANVAS_OFFSET}};return l}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.CanvasUtils"],function(d,e,c){return(nf.GoTo=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.GoTo=b(require("jquery"),require("nf.ErrorHandler"),require("nf.CanvasUtils")))}else{nf.GoTo=b(a.$,a.nf.ErrorHandler,a.nf.CanvasUtils)}}}(this,function(h,j,e){var b={urls:{api:"../nifi-api",processGroups:"../nifi-api/flow/process-groups/"}};var a;var f;var c=function(u,q,r,p){var o=h('<div class="source-destination-connection"></div>').appendTo("#connections-container");if(q.sourceType==="OUTPUT_PORT"){d(u,o,q,r)}else{if(q.sourceType==="REMOTE_OUTPUT_PORT"){i(u,o,q,p)}else{g(o,q)}}var t=h('<div class="connection-entry"></div>').appendTo(o);var w="unset";var s="Connection";if(q.permissions.canRead===true){var v=e.formatConnectionName(q.component);if(v!==""){w="";s=v}}h('<div class="search-result-icon icon-connect"></div>').appendTo(t);h('<div class="connection-entry-name go-to-link"></div>').attr("title",s).addClass(w).text(s).on("click",function(){e.showComponent(u,q.id);h("#connections-dialog").modal("hide")}).appendTo(t);h('<div class="clear"></div>').appendTo(t);if(q.destinationType==="INPUT_PORT"){l(u,o,q,r)}else{if(q.destinationType==="REMOTE_INPUT_PORT"){k(u,o,q,p)}else{m(o,q)}}h('<div class="clear"></div>').appendTo(o)};var m=function(o,p){var q="icon-funnel";if(p.destinationType==="PROCESSOR"){q="icon-processor"}else{if(p.destinationType==="OUTPUT_PORT"){q="icon-port-out"}}var r=p.destinationId;if(p.permissions.canRead===true){r=p.component.destination.name}else{if(a===p.destinationId){r=f}}var s=h('<div class="destination-component"></div>').appendTo(o);h('<div class="search-result-icon"></div>').addClass(q).appendTo(s);h('<div class="destination-component-name go-to-link"></div>').attr("title",r).text(r).on("click",function(){e.showComponent(p.destinationGroupId,p.destinationId);h("#connections-dialog").modal("hide")}).appendTo(s);h('<div class="clear"></div>').appendTo(s)};var l=function(w,p,s,t){var v;h.each(t,function(x,y){if(s.destinationGroupId===y.id){v=y;return false}});var o=n(v);var r=h('<div class="destination-component"></div>').appendTo(p);h('<div class="search-result-icon icon-group"></div>').appendTo(r);h('<div class="destination-component-name go-to-link"></div>').attr("title",o).text(o).on("click",function(){e.showComponent(w,v.id);h("#connections-dialog").modal("hide")}).appendTo(r);h('<div class="clear"></div>').appendTo(r);var u=s.destinationId;if(s.permissions.canRead===true){u=s.component.destination.name}else{if(a===s.destinationId){u=f}}var q=h('<div class="destination-input-port"></div>').appendTo(r);h('<div class="search-result-icon icon-port-in"></div>').appendTo(q);h('<div class="destination-input-port-name go-to-link"></div>').attr("title",u).text(u).on("click",function(){e.showComponent(s.destinationGroupId,s.destinationId);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(r)};var k=function(t,o,s,r){var v;h.each(r,function(x,y){if(s.destinationGroupId===y.id){v=y;return false}});var u=n(v);var q=h('<div class="destination-component"></div>').appendTo(o);h('<div class="search-result-icon icon-group-remote"></div>').appendTo(q);h('<div class="destination-component-name go-to-link"></div>').attr("title",u).text(u).on("click",function(){e.showComponent(t,v.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var w=s.destinationId;if(s.permissions.canRead===true){w=s.component.destination.name}else{if(a===s.destinationId){w=f}}var p=h('<div class="destination-input-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-in"></div>').appendTo(p);h('<div class="destination-input-port-name"></div>').attr("title",w).text(w).appendTo(p);h('<div class="clear"></div>').appendTo(q)};var g=function(o,q){var s="icon-funnel";if(q.sourceType==="PROCESSOR"){s="icon-processor"}else{if(q.sourceType==="INPUT_PORT"){s="icon-port-in"}}var p=q.sourceId;if(q.permissions.canRead===true){p=q.component.source.name}else{if(a===q.sourceId){p=f}}var r=h('<div class="source-component"></div>').appendTo(o);h('<div class="search-result-icon"></div>').addClass(s).appendTo(r);h('<div class="source-component-name go-to-link"></div>').attr("title",p).text(p).on("click",function(){e.showComponent(q.sourceGroupId,q.sourceId);h("#connections-dialog").modal("hide")}).appendTo(r);h('<div class="clear"></div>').appendTo(r)};var d=function(v,p,r,s){var u;h.each(s,function(x,y){if(r.sourceGroupId===y.id){u=y;return false}});var o=n(u);var q=h('<div class="source-component"></div>').appendTo(p);h('<div class="search-result-icon icon-group"></div>').appendTo(q);h('<div class="source-component-name go-to-link"></div>').attr("title",o).text(o).on("click",function(){e.showComponent(v,u.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var t=r.sourceId;if(r.permissions.canRead===true){t=r.component.source.name}else{if(a===r.sourceId){t=f}}var w=h('<div class="source-output-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-out"></div>').appendTo(w);h('<div class="source-output-port-name go-to-link"></div>').attr("title",t).text(t).on("click",function(){e.showComponent(r.sourceGroupId,r.sourceId);h("#connections-dialog").modal("hide")}).appendTo(w);h('<div class="clear"></div>').appendTo(q)};var i=function(s,o,r,p){var u;h.each(p,function(x,y){if(r.sourceGroupId===y.id){u=y;return false}});var t=n(u);var q=h('<div class="source-component"></div>').appendTo(o);h('<div class="search-result-icon icon-group-remote"></div>').appendTo(q);h('<div class="source-component-name go-to-link"></div>').attr("title",t).text(t).on("click",function(){e.showComponent(s,u.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var v=r.sourceId;if(r.permissions.canRead===true){v=r.component.source.name}else{if(r.sourceId===a){v=f}}var w=h('<div class="source-output-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-out"></div>').appendTo(w);h('<div class="source-output-port-name"></div>').attr("title",v).text(v).appendTo(w);h('<div class="clear"></div>').appendTo(q)};var n=function(o){if(o.permissions.canRead===true){return o.component.name}else{if(a===o.id){return f}else{return o.id}}};return{init:function(){h("#connections-dialog").modal({scrollableContentStyle:"scrollable",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){h("#connections-dialog").modal("hide")}}}],handler:{close:function(){h("#connections-context").empty();h("#connections-container").empty()}}})},showDownstreamFromProcessor:function(s){var t=s.datum();var q=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();var o=n(t);a=t.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-processor"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(q,function(u,v){if(v.sourceId===t.id){c(e.getGroupId(),v,p,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromProcessor:function(s){var t=s.datum();var q=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();var o=n(t);a=t.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-processor"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(q,function(u,v){if(v.destinationId===t.id){c(e.getGroupId(),v,p,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromGroup:function(r){var s=r.datum();var p=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var q=e.getComponentByType("RemoteProcessGroup").get();var u="icon-group";if(e.isRemoteProcessGroup(r)){u="icon-group-remote"}var t=n(s);a=s.id;f=t;h("#connections-context").append(h('<div class="search-result-icon"></div>').addClass(u)).append(h('<div class="connections-component-name"></div>').text(t)).append('<div class="clear"></div>');h.each(p,function(v,w){if(w.sourceGroupId===s.id){c(e.getGroupId(),w,o,q)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromGroup:function(r){var s=r.datum();var p=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var q=e.getComponentByType("RemoteProcessGroup").get();var u="icon-group";if(e.isRemoteProcessGroup(r)){u="icon-group-remote"}var t=n(s);a=s.id;f=t;h("#connections-context").append(h('<div class="search-result-icon"></div>').addClass(u)).append(h('<div class="connections-component-name"></div>').text(t)).append('<div class="clear"></div>');h.each(p,function(v,w){if(w.destinationGroupId===s.id){c(e.getGroupId(),w,o,q)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromInputPort:function(t){var q=t.datum();var r=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var s=e.getComponentByType("RemoteProcessGroup").get();var o=n(q);a=q.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-port-in"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(r,function(u,v){if(v.sourceId===q.id){c(e.getGroupId(),v,p,s)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromInputPort:function(p){var o=p.datum();h.ajax({type:"GET",url:b.urls.processGroups+encodeURIComponent(e.getParentGroupId()),dataType:"json"}).done(function(s){var r=s.processGroupFlow.flow;var u=r.connections;var t=r.processGroups;var v=r.remoteProcessGroups;var q=n(o);a=o.id;f=q;h("#connections-context").append('<div class="search-result-icon icon-group"></div>').append(h('<div class="connections-component-name"></div>').text(e.getGroupName())).append('<div class="clear"></div>').append('<div class="search-result-icon icon-port-in" style="margin-left: 20px;"></div>').append(h('<div class="connections-component-name"></div>').text(q)).append('<div class="clear"></div>');h.each(u,function(w,x){if(x.destinationId===o.id){c(e.getParentGroupId(),x,t,v)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")}).fail(j.handleAjaxError)},showDownstreamFromOutputPort:function(p){var o=p.datum();h.ajax({type:"GET",url:b.urls.processGroups+encodeURIComponent(e.getParentGroupId()),dataType:"json"}).done(function(s){var r=s.processGroupFlow.flow;var u=r.connections;var t=r.processGroups;var v=r.remoteProcessGroups;var q=n(o);a=o.id;f=q;h("#connections-context").append('<div class="search-result-icon icon-group"></div>').append(h('<div class="connections-component-name"></div>').text(e.getGroupName())).append('<div class="clear"></div>').append('<div class="search-result-icon icon-port-out" style="margin-left: 20px;"></div>').append(h('<div class="connections-component-name"></div>').text(q)).append('<div class="clear"></div>');h.each(u,function(w,x){if(x.sourceId===o.id){c(e.getParentGroupId(),x,t,v)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")}).fail(j.handleAjaxError)},showUpstreamFromOutputPort:function(t){var q=t.datum();var r=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var s=e.getComponentByType("RemoteProcessGroup").get();var o=n(q);a=q.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-port-out"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(r,function(u,v){if(v.destinationId===q.id){c(e.getGroupId(),v,p,s)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromFunnel:function(s){var p=s.datum();var q=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();a=p.id;f="Funnel";h("#connections-context").append('<div class="search-result-icon icon-funnel"></div>').append(h('<div class="connections-component-name"></div>').text("Funnel")).append('<div class="clear"></div>');h.each(q,function(t,u){if(u.sourceId===p.id){c(e.getGroupId(),u,o,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromFunnel:function(s){var p=s.datum();var q=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();a=p.id;f="Funnel";h("#connections-context").append('<div class="search-result-icon icon-funnel"></div>').append(h('<div class="upstream-destination-name"></div>').text("Funnel")).append('<div class="clear"></div>');h.each(q,function(t,u){if(u.destinationId===p.id){c(e.getGroupId(),u,o,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage","nf.CanvasUtils","nf.Client"],function(g,f,d,e,c){return(nf.Snippet=b(g,f,d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Snippet=b(require("jquery"),require("d3"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.Client")))}else{nf.Snippet=b(a.$,a.d3,a.nf.Storage,a.nf.CanvasUtils,a.nf.Client)}}}(this,function(f,e,c,d,b){var a={urls:{snippets:"../nifi-api/snippets",processGroups:"../nifi-api/process-groups"}};return{marshal:function(h,g){var i={parentGroupId:g,processors:{},funnels:{},inputPorts:{},outputPorts:{},remoteProcessGroups:{},processGroups:{},connections:{},labels:{}};h.each(function(k){var j=e.select(this);if(d.isProcessor(j)){i.processors[k.id]=b.getRevision(j.datum())}else{if(d.isFunnel(j)){i.funnels[k.id]=b.getRevision(j.datum())}else{if(d.isLabel(j)){i.labels[k.id]=b.getRevision(j.datum())}else{if(d.isInputPort(j)){i.inputPorts[k.id]=b.getRevision(j.datum())}else{if(d.isOutputPort(j)){i.outputPorts[k.id]=b.getRevision(j.datum())}else{if(d.isProcessGroup(j)){i.processGroups[k.id]=b.getRevision(j.datum())}else{if(d.isRemoteProcessGroup(j)){i.remoteProcessGroups[k.id]=b.getRevision(j.datum())}else{if(d.isConnection(j)){i.connections[k.id]=b.getRevision(j.datum())}}}}}}}}});return i},create:function(h){var g={disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged(),snippet:h};return f.ajax({type:"POST",url:a.urls.snippets,data:JSON.stringify(g),dataType:"json",contentType:"application/json"})},copy:function(i,g,j){var h={snippetId:i,originX:g.x,originY:g.y,disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged()};return f.ajax({type:"POST",url:a.urls.processGroups+"/"+encodeURIComponent(j)+"/snippet-instance",data:JSON.stringify(h),dataType:"json",contentType:"application/json"})},remove:function(g){return f.ajax({type:"DELETE",url:a.urls.snippets+"/"+encodeURIComponent(g)+"?"+f.param({disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged()})})},move:function(h,i){var g={disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged(),snippet:{id:h,parentGroupId:i}};return f.ajax({type:"PUT",url:a.urls.snippets+"/"+encodeURIComponent(h),data:JSON.stringify(g),dataType:"json",contentType:"application/json"})}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.Storage","nf.ErrorHandler","nf.Client","nf.CanvasUtils"],function(h,f,i,g,d,j,c,e){return(nf.Connection=b(h,f,i,g,d,j,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Connection=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.ErrorHandler"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Connection=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.ErrorHandler,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(D,O,M,i,w,d,f,S){var m;var r;var L;var z;var J={width:216};var g=(J.width/2)-15-2;var R=function(Y){var aa=Y.datum();var X,ab;if(aa.bends.length>0){var Z=Math.min(Math.max(0,aa.labelIndex),aa.bends.length-1);X=aa.bends[Z].x;ab=aa.bends[Z].y}else{X=(aa.start.x+aa.end.x)/2;ab=(aa.start.y+aa.end.y)/2}X-=(J.width/2);ab-=(Y.attr("height")/2);return{x:X,y:ab}};var o;var A;var x;var q;var U;var P;var s;var B;var j=function(Y,X){return Math.pow(Y.x-X.x,2)+Math.pow(Y.y-X.y,2)};var t=function(Y,X){return Math.sqrt(j(Y,X))};var G=function(ab,aa,Y){var X=j(aa,Y);if(X===0){return Math.sqrt(j(ab,aa))}var Z=((ab.x-aa.x)*(Y.x-aa.x)+(ab.y-aa.y)*(Y.y-aa.y))/X;if(Z<0){return Math.sqrt(j(ab,aa))}if(Z>1){return Math.sqrt(j(ab,Y))}return Math.sqrt(j(ab,{x:aa.x+Z*(Y.x-aa.x),y:aa.y+Z*(Y.y-aa.y)}))};var b=function(ab,ad){if(ad.bends.length===0){return 0}var Z;var Y;var X=[ad.start].concat(ad.bends,[ad.end]);for(var aa=0;aa<X.length;aa++){if(aa+1<X.length){var ac=G(ab,X[aa],X[aa+1]);if(M.isUndefined(Z)||ac<Z){Z=ac;Y=aa}}}return Y};var F=function(X){return X.indexOf("INPUT_PORT")>=0};var y=function(X){return X.indexOf("OUTPUT_PORT")>=0};var K=function(X){return X.groupId!==S.getGroupId()&&(F(X.type)||y(X.type))};var n=function(X){if(M.isDefinedAndNotNull(X.flowFileExpiration)){var Y=X.flowFileExpiration.match(/^(\d+).*/);if(Y!==null&&Y.length>0){if(parseInt(Y[0],10)>0){return true}}}return false};var W=function(X){return M.isDefinedAndNotNull(X.loadBalanceStrategy)&&"DO_NOT_LOAD_BALANCE"!==X.loadBalanceStrategy};var T=function(X){X.sort(function(Z,Y){return Z.zIndex===Y.zIndex?0:Z.zIndex>Y.zIndex?1:-1})};var N=function(){return q.selectAll("g.connection").data(o.values(),function(X){return X.id})};var Q=function(Z,Y){if(Z.empty()){return Z}var X=Z.append("g").attrs({id:function(aa){return"id-"+aa.id},"class":"connection"}).classed("selected",Y);X.append("path").attrs({"class":"connection-path","pointer-events":"none"});X.append("path").attrs({"class":"connection-selection-path","pointer-events":"none"});X.append("path").attrs({"class":"connection-path-selectable","pointer-events":"stroke"}).on("mousedown.selection",function(){m.select(O.select(this.parentNode));S.setURLParameters()}).call(z.activate);return X};var v=function(Y){var X=false;if(M.isDefinedAndNotNull(Y.component.selectedRelationships)&&M.isDefinedAndNotNull(Y.component.availableRelationships)){D.each(Y.component.selectedRelationships,function(Z,aa){if(D.inArray(aa,Y.component.availableRelationships)===-1){X=true;return false}})}return X};var p=function(Y){var X="normal";if(Y.permissions.canRead){if(I(Y)||l(Y)){X="full"}else{if(v(Y)){X="ghost"}}}else{X="unauthorized"}return"url(#"+X+")"};var c=function(X){if(l(X)||I(X)){return"url(#connection-full-drop-shadow)"}else{return"url(#component-drop-shadow)"}};var l=function(X){return X.status.aggregateSnapshot.percentUseCount===100};var e=function(Y){var X=Y.status.aggregateSnapshot.percentUseCount;if(M.isDefinedAndNotNull(X)){return X>=61&&X<=85}return false};var k=function(Y){var X=Y.status.aggregateSnapshot.percentUseCount;if(M.isDefinedAndNotNull(X)){return X>85}return false};var I=function(X){return X.status.aggregateSnapshot.percentUseBytes===100};var C=function(Y){var X=Y.status.aggregateSnapshot.percentUseBytes;if(M.isDefinedAndNotNull(X)){return X>=61&&X<=85}return false};var H=function(Y){var X=Y.status.aggregateSnapshot.percentUseBytes;if(M.isDefinedAndNotNull(X)){return X>85}return false};var a=function(X,Y){if(X.empty()){return}var Z=true;var aa=true;var ab=false;if(M.isDefinedAndNotNull(Y)){Z=M.isDefinedAndNotNull(Y.updatePath)?Y.updatePath:Z;aa=M.isDefinedAndNotNull(Y.updateLabel)?Y.updateLabel:aa;ab=M.isDefinedAndNotNull(Y.transition)?Y.transition:ab}if(Z===true){X.classed("grouped",function(ad){var ac=false;if(ad.permissions.canRead){if(M.isDefinedAndNotNull(ad.component.selectedRelationships)&&ad.component.selectedRelationships.length>1){ac=true}}return ac}).classed("ghost",function(ad){var ac=false;if(ad.permissions.canRead){if(v(ad)){ac=true}}return ac});X.select("path.connection-path").classed("unauthorized",function(ac){return ac.permissions.canRead===false});X.select("path.connection-path-selectable").on("dblclick",function(ah){if(ah.permissions.canWrite&&ah.permissions.canRead){var ac=O.mouse(this.parentNode);var af=b({x:ac[0],y:ac[1]},ah);var ae=ah.component.bends.slice();ae.splice(af,0,{x:ac[0],y:ac[1]});var ad={id:ah.id,bends:ae};var ag=ah.component.labelIndex;if(ae.length===1){ad.labelIndex=0}else{if(af<=ag){ad.labelIndex=ag+1}}u(ah,ad);O.event.stopPropagation()}else{return null}})}X.each(function(aH){var ax=O.select(this);if(Z===true){var aG=S.getConnectionSourceComponentId(aH);var ai=O.select("#id-"+aG).datum();var aj;var ar;if(aH.bends.length>0){ar=aH.bends[aH.bends.length-1]}else{ar={x:ai.position.x+(ai.dimensions.width/2),y:ai.position.y+(ai.dimensions.height/2)}}if(M.isDefinedAndNotNull(aH.end)&&aH.end.dragging===true){aj=aH.end;var aI=O.select("g.hover.connectable-destination");if(!aI.empty()){var aB=aI.datum();var ac=S.getPerimeterPoint(ar,{x:aB.position.x,y:aB.position.y,width:aB.dimensions.width,height:aB.dimensions.height});aj.x=ac.x;aj.y=ac.y}}else{var ae=S.getConnectionDestinationComponentId(aH);var aK=O.select("#id-"+ae).datum();aj=S.getPerimeterPoint(ar,{x:aK.position.x,y:aK.position.y,width:aK.dimensions.width,height:aK.dimensions.height})}var au;if(aH.bends.length>0){au=aH.bends[0]}else{au=aj}var am=S.getPerimeterPoint(au,{x:ai.position.x,y:ai.position.y,width:ai.dimensions.width,height:ai.dimensions.height});aH.start=am;aH.end=aj;S.transition(ax.select("path.connection-path"),ab).attrs({d:function(){var aL=[aH.start].concat(aH.bends,[aH.end]);return B(aL)}});S.transition(ax.select("path.connection-selection-path"),ab).attrs({d:function(){var aL=[aH.start].concat(aH.bends,[aH.end]);return B(aL)}});S.transition(ax.select("path.connection-path-selectable"),ab).attrs({d:function(){var aL=[aH.start].concat(aH.bends,[aH.end]);return B(aL)}});var aq=ax.selectAll("rect.startpoint");var ao=ax.selectAll("rect.endpoint");var az=ax.selectAll("rect.midpoint");if(aH.permissions.canWrite&&aH.permissions.canRead){aq=aq.data([aH.start]);var aD=aq.enter().append("rect").attrs({"class":"startpoint linepoint","pointer-events":"all",width:8,height:8}).on("mousedown.selection",function(){m.select(O.select(this.parentNode));S.setURLParameters()}).call(z.activate);S.transition(aq.merge(aD),ab).attr("transform",function(aL){return"translate("+(aL.x-4)+", "+(aL.y-4)+")"});aq.exit().remove();var ao=ao.data([aH.end]);var an=ao.enter().append("rect").attrs({"class":"endpoint linepoint","pointer-events":"all",width:8,height:8}).on("mousedown.selection",function(){m.select(O.select(this.parentNode));S.setURLParameters()}).call(P).call(z.activate);S.transition(ao.merge(an),ab).attr("transform",function(aL){return"translate("+(aL.x-4)+", "+(aL.y-4)+")"});ao.exit().remove();var az=az.data(aH.bends);var aw=az.enter().append("rect").attrs({"class":"midpoint linepoint","pointer-events":"all",width:8,height:8}).on("dblclick",function(aO){O.event.stopPropagation();var aL=O.select(this.parentNode);var aS=aL.datum();var aR=S.getConnectionSourceComponentId(aS);var aQ=S.getConnectionDestinationComponentId(aS);if(aR===aQ&&aH.component.bends.length<=2){i.showOkDialog({headerText:"Connection",dialogContent:"Looping connections must have at least two bend points."});return}var aN=[];var aM=-1;D.each(aS.component.bends,function(aU,aT){if(aO.x!==aT.x&&aO.y!==aT.y){aN.push(aT)}else{aM=aU}});if(aM<0){return}var aL={id:aS.id,bends:aN};var aP=aS.component.labelIndex;if(aN.length<=1){aL.labelIndex=0}else{if(aM<=aP){aL.labelIndex=Math.max(0,aP-1)}}u(aS,aL)}).on("mousedown.selection",function(){m.select(O.select(this.parentNode));S.setURLParameters()}).call(U).call(z.activate);S.transition(az.merge(aw),ab).attr("transform",function(aL){return"translate("+(aL.x-4)+", "+(aL.y-4)+")"});az.exit().remove()}else{aq.remove();ao.remove();az.remove()}}if(aa===true){var ak=ax.select("g.connection-label-container");if(ax.classed("visible")){if(ak.empty()){ak=ax.insert("g","rect.startpoint").attrs({"class":"connection-label-container","pointer-events":"all"}).on("mousedown.selection",function(){m.select(O.select(this.parentNode));S.setURLParameters()}).call(z.activate).call(L.activate);ak.append("rect").attrs({"class":"body",width:J.width,x:0,y:0});ak.append("rect").attrs({"class":"border",width:J.width,fill:"transparent",stroke:"transparent"})}var ay=0;var ag=19;var aF=[];var al=[];var av=ak.select("g.connection-from-container");var aJ=ak.select("g.connection-to-container");var aA=ak.select("g.connection-name-container");if(aH.permissions.canRead){if(K(aH.component.source)){if(av.empty()){av=ak.append("g").attrs({"class":"connection-from-container"});aF.push(av.append("rect").attrs({"class":"connection-label-background",width:J.width,height:ag}));al.push(av.append("rect").attrs({"class":"connection-label-border",width:J.width,height:1}));av.append("text").attrs({"class":"stats-label",x:5,y:14}).text("From");av.append("text").attrs({"class":"stats-value connection-from",x:43,y:14,width:130});av.append("text").attrs({"class":"connection-from-run-status",x:200,y:14})}else{aF.push(av.select("rect.connection-label-background"));al.push(av.select("rect.connection-label-border"))}av.attr("transform",function(){var aL=(ag*ay++);return"translate(0, "+aL+")"});av.select("text.connection-from").each(function(){var aL=O.select(this);aL.text(null).selectAll("title").remove();S.ellipsis(aL,aH.component.source.name)}).append("title").text(function(){return aH.component.source.name});av.select("text.connection-from-run-status").text(function(){if(aH.component.source.exists===false){return"\uf071"}else{if(aH.component.source.running===true){return"\uf04b"}else{return"\uf04d"}}}).classed("running",function(){if(aH.component.source.exists===false){return false}else{return aH.component.source.running}}).classed("stopped",function(){if(aH.component.source.exists===false){return false}else{return !aH.component.source.running}}).classed("is-missing-port",function(){return aH.component.source.exists===false})}else{av.remove()}if(K(aH.component.destination)){if(aJ.empty()){aJ=ak.append("g").attrs({"class":"connection-to-container"});aF.push(aJ.append("rect").attrs({"class":"connection-label-background",width:J.width,height:ag}));al.push(aJ.append("rect").attrs({"class":"connection-label-border",width:J.width,height:1}));aJ.append("text").attrs({"class":"stats-label",x:5,y:14}).text("To");aJ.append("text").attrs({"class":"stats-value connection-to",x:25,y:14,width:145});aJ.append("text").attrs({"class":"connection-to-run-status",x:200,y:14})}else{aF.push(aJ.select("rect.connection-label-background"));al.push(aJ.select("rect.connection-label-border"))}aJ.attr("transform",function(){var aL=(ag*ay++);return"translate(0, "+aL+")"});aJ.select("text.connection-to").each(function(aM){var aL=O.select(this);aL.text(null).selectAll("title").remove();S.ellipsis(aL,aM.component.destination.name)}).append("title").text(function(aL){return aL.component.destination.name});aJ.select("text.connection-to-run-status").text(function(){if(aH.component.destination.exists===false){return"\uf071"}else{if(aH.component.destination.running===true){return"\uf04b"}else{return"\uf04d"}}}).classed("running",function(){if(aH.component.destination.exists===false){return false}else{return aH.component.destination.running}}).classed("stopped",function(){if(aH.component.destination.exists===false){return false}else{return !aH.component.destination.running}}).classed("is-missing-port",function(){return aH.component.destination.exists===false})}else{aJ.remove()}var ah=S.formatConnectionName(aH.component);if(!M.isBlank(ah)){if(aA.empty()){aA=ak.append("g").attrs({"class":"connection-name-container"});aF.push(aA.append("rect").attrs({"class":"connection-label-background",width:J.width,height:ag}));al.push(aA.append("rect").attrs({"class":"connection-label-border",width:J.width,height:1}));aA.append("text").attrs({"class":"stats-label",x:5,y:14}).text("Name");aA.append("text").attrs({"class":"stats-value connection-name",x:45,y:14,width:142})}else{aF.push(aA.select("rect.connection-label-background"));al.push(aA.select("rect.connection-label-border"))}aA.attr("transform",function(){var aL=(ag*ay++);return"translate(0, "+aL+")"});aA.select("text.connection-name").each(function(){var aL=O.select(this);aL.text(null).selectAll("title").remove();S.ellipsis(aL,ah)}).append("title").text(function(){return ah})}else{aA.remove()}}else{av.remove();aJ.remove();aA.remove()}var aE=3;var ad=ak.select("g.queued-container");if(ad.empty()){ad=ak.append("g").attrs({"class":"queued-container"});aF.push(ad.append("rect").attrs({"class":"connection-label-background",width:J.width,height:ag+aE}));al.push(ad.append("rect").attrs({"class":"connection-label-border",width:J.width,height:1}));ad.append("text").attrs({"class":"stats-label",x:5,y:14}).text("Queued");var aC=ad.append("text").attrs({"class":"stats-value queued",x:55,y:14});aC.append("tspan").attrs({"class":"count"});aC.append("tspan").attrs({"class":"size"});ad.append("text").attrs({"class":"load-balance-icon",y:14}).text(function(){return"\uf042"}).append("title");ad.append("text").attrs({"class":"expiration-icon",x:200,y:14}).text(function(){return"\uf017"}).append("title");var af=ag+aE-4;ad.append("rect").attrs({"class":"backpressure-tick object",width:1,height:3,x:5,y:af});var at=6;ad.append("rect").attrs({"class":"backpressure-object",width:g,height:3,x:at,y:af}).append("title");ad.append("rect").attrs({"class":"backpressure-tick object",width:1,height:3,x:at+g,y:af});ad.append("rect").attrs({"class":"backpressure-percent object",width:0,height:3,x:at,y:af});ad.append("rect").attrs({"class":"backpressure-tick data-size",width:1,height:3,x:(J.width/2)+10,y:af});var ap=(J.width/2)+10+1;ad.append("rect").attrs({"class":"backpressure-data-size",width:g,height:3,x:ap,y:af}).append("title");ad.append("rect").attrs({"class":"backpressure-tick data-size",width:1,height:3,x:ap+g,y:af});ad.append("rect").attrs({"class":"backpressure-percent data-size",width:0,height:3,x:ap,y:af})}else{aF.push(ad.select("rect.connection-label-background"));al.push(ad.select("rect.connection-label-border"))}ad.attr("transform",function(){var aL=(ag*ay++);return"translate(0, "+aL+")"});ak.select("rect.body").attr("height",function(){return(ag*ay)+aE}).classed("unauthorized",function(){return aH.permissions.canRead===false});ak.select("rect.border").attr("height",function(){return(ag*ay)+aE}).classed("unauthorized",function(){return aH.permissions.canRead===false});D.each(aF,function(aM,aL){if(aM%2===0){aL.attr("fill","#f4f6f7")}else{aL.attr("fill","#ffffff")}});D.each(al,function(aM,aL){if(aM>0){aL.attr("fill","#c7d2d7")}else{aL.attr("fill","transparent")}});ak.select("text.load-balance-icon").classed("hidden",function(){if(aH.permissions.canRead){return !W(aH.component)}else{return true}}).classed("load-balance-icon-active fa-rotate-90",function(aL){return aL.permissions.canRead&&aL.component.loadBalanceStatus==="LOAD_BALANCE_ACTIVE"}).classed("load-balance-icon-184",function(){return aH.permissions.canRead&&n(aH.component)}).classed("load-balance-icon-200",function(){return aH.permissions.canRead&&!n(aH.component)}).attr("x",function(){return aH.permissions.canRead&&n(aH.component)?184:200}).select("title").text(function(){if(aH.permissions.canRead){var aL=M.getComboOptionText(M.loadBalanceStrategyOptions,aH.component.loadBalanceStrategy);if("PARTITION_BY_ATTRIBUTE"===aH.component.loadBalanceStrategy){aL+=" ("+aH.component.loadBalancePartitionAttribute+")"}var aN="no compression";switch(aH.component.loadBalanceCompression){case"COMPRESS_ATTRIBUTES_ONLY":aN="'Attribute' compression";break;case"COMPRESS_ATTRIBUTES_AND_CONTENT":aN="'Attribute and content' compression";break}var aM="LOAD_BALANCE_ACTIVE"===aH.component.loadBalanceStatus?" Actively balancing...":"";return"Load Balance is configured with '"+aL+"' strategy and "+aN+"."+aM}else{return""}});ak.select("text.expiration-icon").classed("hidden",function(){if(aH.permissions.canRead){return !n(aH.component)}else{return true}}).select("title").text(function(){if(aH.permissions.canRead){return"Expires FlowFiles older than "+aH.component.flowFileExpiration}else{return""}});ak.select("rect.backpressure-object").classed("not-configured",function(){return M.isUndefinedOrNull(aH.status.aggregateSnapshot.percentUseCount)});ak.selectAll("rect.backpressure-tick.object").classed("not-configured",function(){return M.isUndefinedOrNull(aH.status.aggregateSnapshot.percentUseCount)});ak.select("rect.backpressure-data-size").classed("not-configured",function(){return M.isUndefinedOrNull(aH.status.aggregateSnapshot.percentUseBytes)});ak.selectAll("rect.backpressure-tick.data-size").classed("not-configured",function(){return M.isUndefinedOrNull(aH.status.aggregateSnapshot.percentUseBytes)});if(aH.permissions.canWrite){ak.call(s)}ax.call(E)}else{if(!ak.empty()){ak.remove()}}}S.transition(ax.select("g.connection-label-container"),ab).attr("transform",function(){var aM=O.select(this).select("rect.body");var aL=R(aM);return"translate("+aL.x+", "+aL.y+")"})})};var E=function(X){if(X.empty()){return}var Y=D.Deferred(function(aa){X.select("text.queued tspan.count").text(function(ac){return M.substringBeforeFirst(ac.status.aggregateSnapshot.queued," ")});var ab=X.select("rect.backpressure-percent.data-size");ab.transition().duration(400).attrs({width:function(ac){if(M.isDefinedAndNotNull(ac.status.aggregateSnapshot.percentUseBytes)){return(g*ac.status.aggregateSnapshot.percentUseBytes)/100}else{return 0}}}).on("end",function(){ab.classed("warning",function(ac){return C(ac)}).classed("error",function(ac){return H(ac)});aa.resolve()});X.select("rect.backpressure-data-size").select("title").text(function(ac){if(M.isDefinedAndNotNull(ac.status.aggregateSnapshot.percentUseBytes)){return"Queue is "+ac.status.aggregateSnapshot.percentUseBytes+"% full based on Back Pressure Data Size Threshold"}else{return"Back Pressure Data Size Threshold is not configured"}})}).promise();var Z=D.Deferred(function(aa){X.select("text.queued tspan.size").text(function(ac){return" "+M.substringAfterFirst(ac.status.aggregateSnapshot.queued," ")});var ab=X.select("rect.backpressure-percent.object");ab.transition().duration(400).attrs({width:function(ac){if(M.isDefinedAndNotNull(ac.status.aggregateSnapshot.percentUseCount)){return(g*ac.status.aggregateSnapshot.percentUseCount)/100}else{return 0}}}).on("end",function(){ab.classed("warning",function(ac){return e(ac)}).classed("error",function(ac){return k(ac)});aa.resolve()});X.select("rect.backpressure-object").select("title").text(function(ac){if(M.isDefinedAndNotNull(ac.status.aggregateSnapshot.percentUseCount)){return"Queue is "+ac.status.aggregateSnapshot.percentUseCount+"% full based on Back Pressure Object Threshold"}else{return"Back Pressure Object Threshold is not configured"}})}).promise();D.when(Y,Z).done(function(){X.select("path.connection-path").classed("full",function(aa){return l(aa)||I(aa)}).attrs({"marker-end":p});X.select("rect.border").classed("full",function(aa){return l(aa)||I(aa)});X.select("rect.body").attrs({filter:c})})};var u=function(Z,Y){var X={revision:f.getRevision(Z),disconnectedNodeAcknowledged:w.isDisconnectionAcknowledged(),component:Y};return D.ajax({type:"PUT",url:Z.uri,data:JSON.stringify(X),dataType:"json",contentType:"application/json"}).done(function(aa){V.set(aa)}).fail(function(ac,aa,ab){if(ac.status===400||ac.status===404||ac.status===409){i.showOkDialog({headerText:"Connection",dialogContent:M.escapeHtml(ac.responseText)})}else{d.handleAjaxError(ac,aa,ab)}})};var h=function(X){X.each(function(aa){var Z=S.getConnectionSourceComponentId(aa);var Y=S.getConnectionDestinationComponentId(aa);S.reloadConnectionSourceAndDestination(Z,Y)});X.remove()};var V={config:{selfLoopXOffset:(J.width/2)+5,selfLoopYOffset:25},init:function(X,Y,aa,Z){m=X;z=Y;L=aa;r=Z;o=O.map();A=O.map();x=O.map();q=O.select("#canvas").append("g").attrs({"pointer-events":"stroke","class":"connections"});B=O.line().x(function(ab){return ab.x}).y(function(ab){return ab.y}).curve(O.curveLinear);U=O.drag().on("start",function(){O.event.sourceEvent.stopPropagation()}).on("drag",function(ab){ab.x=O.event.x;ab.y=O.event.y;O.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}).on("end",function(){var ab=O.select(this.parentNode);var af=ab.datum();var ad=ab.selectAll("rect.midpoint").data();if(ad.length===af.component.bends.length){var ae=false;for(var ac=0;ac<ad.length&&!ae;ac++){if(ad[ac].x!==af.component.bends[ac].x||ad[ac].y!==af.component.bends[ac].y){ae=true}}if(ae){u(af,{id:af.id,bends:ad}).fail(function(){af.bends=D.map(af.component.bends,function(ag){return{x:ag.x,y:ag.y}});ab.call(a,{updatePath:true,updateLabel:false})})}}O.event.sourceEvent.stopPropagation()});P=O.drag().on("start",function(ab){ab.dragging=true;O.event.sourceEvent.stopPropagation()}).on("drag",function(ab){ab.x=O.event.x-8;ab.y=O.event.y-8;O.select("g.hover").classed("connectable-destination",function(){return S.isValidConnectionDestination(O.select(this))});O.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}).on("end",function(aj){aj.dragging=false;var ab=O.select(this.parentNode);var al=ab.datum();var ac=S.getConnectionDestinationComponentId(al);var ak=O.select("g.connectable-destination");if(ak.empty()){ab.call(a,{updatePath:true,updateLabel:false})}else{if(S.isProcessGroup(ak)||S.isRemoteProcessGroup(ak)){r.showConfiguration(ab,ak).done(function(){S.reloadConnectionSourceAndDestination(null,ac)}).fail(function(){ab.call(a,{updatePath:true,updateLabel:false})})}else{var af=ak.datum();var ah=S.getConnectableTypeForDestination(ak);var ag={revision:f.getRevision(al),disconnectedNodeAcknowledged:w.isDisconnectionAcknowledged(),component:{id:al.id,destination:{id:af.id,groupId:S.getGroupId(),type:ah}}};if(al.bends.length<2&&al.sourceId===af.id){var ad={x:af.position.x+(af.dimensions.width),y:af.position.y+(af.dimensions.height/2)};var ai=V.config.selfLoopXOffset;var ae=V.config.selfLoopYOffset;ag.component.bends=[];ag.component.bends.push({x:(ad.x+ai),y:(ad.y-ae)});ag.component.bends.push({x:(ad.x+ai),y:(ad.y+ae)})}D.ajax({type:"PUT",url:al.uri,data:JSON.stringify(ag),dataType:"json",contentType:"application/json"}).done(function(an){var am=an.component;V.set(an);S.reloadConnectionSourceAndDestination(null,ac);var ap=S.getConnectionSourceComponentId(an);var ao=S.getConnectionSourceComponentId(an);S.reloadConnectionSourceAndDestination(ap,ao)}).fail(function(ao,am,an){if(ao.status===400||ao.status===401||ao.status===403||ao.status===404||ao.status===409){i.showOkDialog({headerText:"Connection",dialogContent:M.escapeHtml(ao.responseText)});ab.call(a,{updatePath:true,updateLabel:false})}else{d.handleAjaxError(ao,am,an)}})}}O.event.sourceEvent.stopPropagation()});s=O.drag().on("start",function(ab){O.event.sourceEvent.stopPropagation()}).on("drag",function(ag){if(ag.bends.length>1){var ad=O.select("rect.label-drag");if(ad.empty()){var af=O.select(this).select("rect.body");var ae=R(af);var ab=J.width;var ak=af.attr("height");ad=O.select("#canvas").append("rect").attr("x",ae.x).attr("y",ae.y).attr("class","label-drag").attr("width",ab).attr("height",ak).attr("stroke-width",function(){return 1/S.getCanvasScale()}).attr("stroke-dasharray",function(){return 4/S.getCanvasScale()}).datum({x:ae.x,y:ae.y,width:ab,height:ak})}else{ad.attr("x",function(al){al.x+=O.event.dx;return al.x}).attr("y",function(al){al.y+=O.event.dy;return al.y})}var ah=ad.datum();var aj={x:ah.x+(ah.width/2),y:ah.y+(ah.height/2)};var ac=-1;var ai;D.each(ag.bends,function(an,am){var al={x:am.x,y:am.y};var ao=t(aj,al);if(ac===-1||ao<ai){ac=an;ai=ao}});ag.labelIndex=ac;O.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}}).on("end",function(ad){if(ad.bends.length>1){var ac=O.select("rect.label-drag");if(!ac.empty()){ac.remove()}if(ad.labelIndex!==ad.component.labelIndex){var ab=O.select(this.parentNode);u(ad,{id:ad.id,labelIndex:ad.labelIndex}).fail(function(){ad.labelIndex=ad.component.labelIndex;ab.call(a,{updatePath:true,updateLabel:false})})}}O.event.sourceEvent.stopPropagation()})},add:function(Y,aa){var ad=false;if(M.isDefinedAndNotNull(aa)){ad=M.isDefinedAndNotNull(aa.selectAll)?aa.selectAll:ad}var Z=new Date().getTime();var ae=function(af){x.set(af.id,Z);o.set(af.id,D.extend({type:"Connection"},af))};if(D.isArray(Y)){D.each(Y,function(af,ag){ae(ag)})}else{if(M.isDefinedAndNotNull(Y)){ae(Y)}}var ab=N();var ac=Q(ab.enter(),ad);var X=ab.merge(ac);X.call(a,{updatePath:true,updateLabel:false}).call(T)},isDisconnected:function(Z){if(Z.empty()){return false}var Y=O.map();var aa=O.map();var X=true;Z.filter(function(ab){return ab.type==="Connection"}).each(function(ab){Y.set(ab.id,ab)});Z.filter(function(ab){return ab.type!=="Connection"}).each(function(ab){aa.set(ab.id,ab.component);D.each(V.getComponentConnections(ab.id),function(ad,ac){if(!Y.has(ac.id)){X=false;return false}})});if(X){Y.each(function(ab,ac){if(X){X=aa.has(S.getConnectionSourceComponentId(ab))&&aa.has(S.getConnectionDestinationComponentId(ab))}})}return X},set:function(ac,af){var X=false;var ab=false;var Y=false;if(M.isDefinedAndNotNull(af)){X=M.isDefinedAndNotNull(af.selectAll)?af.selectAll:X;ab=M.isDefinedAndNotNull(af.transition)?af.transition:ab;Y=M.isDefinedAndNotNull(af.overrideRevisionCheck)?af.overrideRevisionCheck:Y}var ad=function(ag){var ah=o.get(ag.id);if((f.isNewerRevision(ah,ag)&&!A.has(ag.id))||Y===true){o.set(ag.id,D.extend({type:"Connection"},ag))}};if(D.isArray(ac)){D.each(o.keys(),function(ah,ai){var aj=o.get(ai);var ag=D.grep(ac,function(ak){return ak.id===aj.id});if(ag.length===0&&!x.has(ai)){o.remove(ai)}});D.each(ac,function(ag,ah){ad(ah)})}else{if(M.isDefinedAndNotNull(ac)){ad(ac)}}var ae=N();var aa=Q(ae.enter(),X);var Z=ae.merge(aa);Z.call(a,{updatePath:true,updateLabel:true,transition:ab}).call(T);ae.exit().call(h)},refresh:function(X){if(M.isDefinedAndNotNull(X)){O.select("#id-"+X).call(a,{updatePath:true,updateLabel:true})}else{O.selectAll("g.connection").call(a,{updatePath:true,updateLabel:true})}},pan:function(){O.selectAll("g.connection.entering, g.connection.leaving").call(a,{updatePath:false,updateLabel:true})},remove:function(Y){var X=new Date().getTime();if(D.isArray(Y)){D.each(Y,function(Z,aa){A.set(aa,X);o.remove(aa)})}else{A.set(Y,X);o.remove(Y)}N().exit().call(h)},removeAll:function(){V.remove(o.keys())},reload:function(Y){if(o.has(Y)){var X=o.get(Y);return D.ajax({type:"GET",url:X.uri,dataType:"json"}).done(function(Z){V.set(Z)})}},reloadStatus:function(X){if(o.has(X)){return D.ajax({type:"GET",url:"../nifi-api/flow/connections/"+encodeURIComponent(X)+"/status",dataType:"json"}).done(function(Y){var Z=o.get(X);Z.status=Y.connectionStatus;o.set(X,Z);N().call(E)})}},getComponentConnections:function(Y){var X=[];o.each(function(aa,Z){if(S.getConnectionSourceComponentId(aa)===Y||S.getConnectionDestinationComponentId(aa)===Y){X.push(aa)}});return X},get:function(X){if(M.isUndefined(X)){return o.values()}else{return o.get(X)}},expireCaches:function(Y){var X=function(Z){Z.each(function(aa,ab){if(Y>aa){Z.remove(ab)}})};X(x);X(A)}};return V}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,g,c,d){return(nf.Funnel=b(f,e,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Funnel=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Funnel=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(b,r,d,s,o){var i;var l;var e;var m;var c={width:48,height:48};var j;var q;var a;var p;var k=function(){return p.selectAll("g.funnel").data(j.values(),function(t){return t.id})};var g=function(v,u){if(v.empty()){return v}var t=v.append("g").attrs({id:function(w){return"id-"+w.id},"class":"funnel component"}).classed("selected",u).call(o.position);t.append("rect").attrs({rx:2,ry:2,"class":"border",width:function(w){return w.dimensions.width},height:function(w){return w.dimensions.height},fill:"transparent",stroke:"transparent"});t.append("rect").attrs({rx:2,ry:2,"class":"body",width:function(w){return w.dimensions.width},height:function(w){return w.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});t.append("text").attrs({"class":"funnel-icon",x:9,y:34}).text("\ue803");t.call(e.activate).call(m.activate);return t};var h=function(t){if(t.empty()){return}t.select("rect.border").classed("unauthorized",function(u){return u.permissions.canRead===false});t.select("rect.body").classed("unauthorized",function(u){return u.permissions.canRead===false});t.each(function(){var u=r.select(this);o.editable(u,i,l)})};var f=function(t){t.remove()};var n={init:function(v,w,t,u){i=v;l=w;e=t;m=u;j=r.map();q=r.map();a=r.map();p=r.select("#canvas").append("g").attrs({"pointer-events":"all","class":"funnels"})},add:function(v,u){var y=false;if(d.isDefinedAndNotNull(u)){y=d.isDefinedAndNotNull(u.selectAll)?u.selectAll:y}var t=new Date().getTime();var z=function(A){a.set(A.id,t);j.set(A.id,b.extend({type:"Funnel",dimensions:c},A))};if(b.isArray(v)){b.each(v,function(B,A){z(A)})}else{if(d.isDefinedAndNotNull(v)){z(v)}}var w=k();var x=g(w.enter(),y);h(w.merge(x))},set:function(u,B){var t=false;var y=false;var v=false;if(d.isDefinedAndNotNull(B)){t=d.isDefinedAndNotNull(B.selectAll)?B.selectAll:t;y=d.isDefinedAndNotNull(B.transition)?B.transition:y;v=d.isDefinedAndNotNull(B.overrideRevisionCheck)?B.overrideRevisionCheck:v}var z=function(D){var C=j.get(D.id);if((s.isNewerRevision(C,D)&&!q.has(D.id))||v===true){j.set(D.id,b.extend({type:"Funnel",dimensions:c},D))}};if(b.isArray(u)){b.each(j.keys(),function(D,F){var E=j.get(F);var C=b.grep(u,function(G){return G.id===E.id});if(C.length===0&&!a.has(F)){j.remove(F)}});b.each(u,function(D,C){z(C)})}else{if(d.isDefinedAndNotNull(u)){z(u)}}var A=k();var x=g(A.enter(),t);var w=A.merge(x);w.call(h).call(o.position,y);A.exit().call(f)},get:function(t){if(d.isUndefined(t)){return j.values()}else{return j.get(t)}},refresh:function(t){if(d.isDefinedAndNotNull(t)){r.select("#id-"+t).call(h)}else{r.selectAll("g.funnel").call(h)}},reload:function(u){if(j.has(u)){var t=j.get(u);return b.ajax({type:"GET",url:t.uri,dataType:"json"}).done(function(v){n.set(v)})}},position:function(t){r.select("#id-"+t).call(o.position)},remove:function(u){var t=new Date().getTime();if(b.isArray(u)){b.each(u,function(w,v){q.set(v,t);j.remove(v)})}else{q.set(u,t);j.remove(u)}k().exit().call(f)},removeAll:function(){n.remove(j.keys())},expireCaches:function(u){var t=function(v){v.each(function(w,x){if(u>w){v.remove(x)}})};t(a);t(q)}};return n}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage","nf.Common","nf.Client","nf.CanvasUtils"],function(g,f,d,h,c,e){return(nf.Label=b(g,f,d,h,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Label=b(require("jquery"),require("d3"),require("nf.Storage"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Label=b(a.$,a.d3,a.nf.Storage,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(e,v,g,k,x,t){var n;var q;var m;var l;var r;var j={width:150,height:150};var a=20;var i=64;var f;var u;var d;var b;var c;var p=function(){return b.selectAll("g.label").data(f.values(),function(y){return y.id})};var w=function(A,z){if(A.empty()){return A}var y=A.append("g").attrs({id:function(B){return"id-"+B.id},"class":"label component"}).classed("selected",z).call(t.position);y.append("rect").attrs({"class":"border",fill:"transparent",stroke:"transparent"});y.append("rect").attrs({"class":"body",filter:"url(#component-drop-shadow)","stroke-width":0});y.append("text").attrs({"xml:space":"preserve","font-weight":"bold",fill:"black","class":"label-value"});y.call(m.activate).call(r.activate).call(l.activate);return y};var h=function(y){if(y.empty()){return}y.select("rect.border").attrs({width:function(z){return z.dimensions.width},height:function(z){return z.dimensions.height}}).classed("unauthorized",function(z){return z.permissions.canRead===false});y.select("rect.body").attrs({width:function(z){return z.dimensions.width},height:function(z){return z.dimensions.height}}).style("fill",function(A){if(!A.permissions.canRead){return null}var z=o.defaultColor();if(k.isDefinedAndNotNull(A.component.style["background-color"])){z=A.component.style["background-color"]}return z}).classed("unauthorized",function(z){return z.permissions.canRead===false});y.each(function(D){var E=v.select(this);t.editable(E,n,q);var A=E.select("text.label-value");var B=E.selectAll("rect.labelpoint");if(D.permissions.canRead){A.attr("font-size",function(){var I="12px";if(k.isDefinedAndNotNull(D.component.style["font-size"])){I=D.component.style["font-size"]}return I});A.selectAll("tspan").remove();var H=[];if(k.isDefinedAndNotNull(D.component.label)){H=D.component.label.split("\n")}else{H.push("")}var C=o.defaultColor();if(k.isDefinedAndNotNull(D.component.style["background-color"])){C=D.component.style["background-color"]}e.each(H,function(J,I){A.append("tspan").attr("x","0.4em").attr("dy","1.2em").text(function(){return I}).style("fill",function(K){return k.determineContrastColor(k.substringAfterLast(C,"#"))})});if(D.permissions.canWrite){var G=[{x:D.dimensions.width,y:D.dimensions.height}];var F=B.data(G);var z=F.enter().append("rect").attrs({"class":"labelpoint",width:10,height:10}).call(c);F.merge(z).attr("transform",function(I){return"translate("+(I.x-10)+", "+(I.y-10)+")"});F.exit().remove()}}else{A.selectAll("tspan").remove();B.remove()}})};var s=function(y){y.remove()};var o={config:{width:j.width,height:j.height},init:function(A,B,y,z,C){n=A;q=B;m=y;r=z;l=C;f=v.map();u=v.map();d=v.map();b=v.select("#canvas").append("g").attrs({"pointer-events":"all","class":"labels"});c=v.drag().on("start",function(){v.event.sourceEvent.stopPropagation()}).on("drag",function(){var D=v.select(this.parentNode);var E=D.datum();E.dimensions.width=Math.max(i,v.event.x);E.dimensions.height=Math.max(a,v.event.y);h(D)}).on("end",function(){var E=v.select(this.parentNode);var F=E.datum();var G=false;if(k.isDefinedAndNotNull(F.component.width)||F.dimensions.width!==F.component.width){G=true}if(!G&&k.isDefinedAndNotNull(F.component.height)||F.dimensions.height!==F.component.height){G=true}if(G){var D={revision:x.getRevision(F),disconnectedNodeAcknowledged:g.isDisconnectionAcknowledged(),component:{id:F.id,width:F.dimensions.width,height:F.dimensions.height}};e.ajax({type:"PUT",url:F.uri,data:JSON.stringify(D),dataType:"json",contentType:"application/json"}).done(function(H){o.set(H)}).fail(function(){var I=j.width;if(k.isDefinedAndNotNull(F.component.width)){I=F.component.width}var H=j.height;if(k.isDefinedAndNotNull(F.component.height)){H=F.component.height}F.dimensions={width:I,height:H};E.call(h)})}v.event.sourceEvent.stopPropagation()})},add:function(B,z){var D=false;if(k.isDefinedAndNotNull(z)){D=k.isDefinedAndNotNull(z.selectAll)?z.selectAll:D}var y=new Date().getTime();var E=function(F){d.set(F.id,y);f.set(F.id,e.extend({type:"Label"},F))};if(e.isArray(B)){e.each(B,function(G,F){E(F)})}else{if(k.isDefinedAndNotNull(B)){E(B)}}var A=p();var C=w(A.enter(),D);h(A.merge(C))},set:function(z,G){var y=false;var D=false;var A=false;if(k.isDefinedAndNotNull(G)){y=k.isDefinedAndNotNull(G.selectAll)?G.selectAll:y;D=k.isDefinedAndNotNull(G.transition)?G.transition:D;A=k.isDefinedAndNotNull(G.overrideRevisionCheck)?G.overrideRevisionCheck:A}var E=function(H){var I=f.get(H.id);if((x.isNewerRevision(I,H)&&!u.has(H.id))||A===true){f.set(H.id,e.extend({type:"Label"},H))}};if(e.isArray(z)){e.each(f.keys(),function(I,K){var J=f.get(K);var H=e.grep(z,function(L){return L.id===J.id});if(H.length===0&&!d.has(K)){f.remove(K)}});e.each(z,function(I,H){E(H)})}else{if(k.isDefinedAndNotNull(z)){E(z)}}var F=p();var C=w(F.enter(),y);var B=F.merge(C);B.call(h).call(t.position,D);F.exit().call(s)},get:function(y){if(k.isUndefined(y)){return f.values()}else{return f.get(y)}},refresh:function(y){if(k.isDefinedAndNotNull(y)){v.select("#id-"+y).call(h)}else{v.selectAll("g.label").call(h)}},reload:function(z){if(f.has(z)){var y=f.get(z);return e.ajax({type:"GET",url:y.uri,dataType:"json"}).done(function(A){o.set(A)})}},position:function(y){v.select("#id-"+y).call(t.position)},remove:function(z){var y=new Date().getTime();if(e.isArray(z)){e.each(z,function(A,B){u.set(B,y);f.remove(B)})}else{u.set(z,y);f.remove(z)}p().exit().call(s)},removeAll:function(){o.remove(f.keys())},expireCaches:function(z){var y=function(A){A.each(function(B,C){if(z>B){A.remove(C)}})};y(d);y(u)},defaultColor:function(){return"#fff7d7"}};return o}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,g,c,d){return(nf.Port=b(f,e,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Port=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Port=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(d,x,h,y,u){var m;var r;var j;var i;var s;var n=15;var k=25;var v={width:240,height:50};var o={width:240,height:75};var e;var w;var c;var g;var q=function(){return g.selectAll("g.input-port, g.output-port").data(e.values(),function(z){return z.id})};var l=function(B,A){if(B.empty()){return B}var z=B.append("g").attrs({id:function(D){return"id-"+D.id},"class":function(D){if(D.portType==="INPUT_PORT"){return"input-port component"}else{return"output-port component"}}}).classed("selected",A).call(u.position);z.append("rect").attrs({"class":"border",width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height},fill:"transparent",stroke:"transparent"});z.append("rect").attrs({"class":"body",width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});var C=0;if(u.getParentGroupId()===null){C=k;z.append("rect").attrs({"class":"remote-banner",width:function(D){return D.dimensions.width},height:C,fill:"#e3e8eb"})}z.append("text").attrs({"class":"port-icon",x:10,y:38+C}).text(function(D){if(D.portType==="INPUT_PORT"){return"\ue832"}else{return"\ue833"}});z.append("text").attrs({x:70,y:25+C,width:95,height:30,"class":"port-name"});z.call(j.activate).call(s.activate).call(i.activate);z.filter(function(D){return D.permissions.canWrite&&D.permissions.canRead}).call(r.activate).call(m.activate);return z};var p=function(z){if(z.empty()){return}z.select("rect.border").classed("unauthorized",function(A){return A.permissions.canRead===false});z.select("rect.body").classed("unauthorized",function(A){return A.permissions.canRead===false});z.each(function(B){var A=x.select(this);var C=A.select("g.port-details");u.editable(A,m,r);if(A.classed("visible")){if(C.empty()){C=A.append("g").attr("class","port-details");var D=0;if(u.getParentGroupId()===null){D=k;C.append("text").attrs({"class":"port-transmission-icon",x:10,y:18});C.append("rect").attrs({"class":"bulletin-background",x:function(E){return B.dimensions.width-D},width:D,height:D});C.append("text").attrs({"class":"bulletin-icon",x:function(E){return B.dimensions.width-18},y:18}).text("\uf24a")}C.append("text").attrs({"class":"run-status-icon",x:50,y:function(){return 25+D}});C.append("path").attrs({"class":"component-comments",transform:"translate("+(B.dimensions.width-2)+", "+(B.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});C.append("text").attrs({"class":"active-thread-count-icon",y:43+D}).text("\ue83f");C.append("text").attrs({"class":"active-thread-count",y:43+D})}if(B.permissions.canRead){A.select("text.port-name").each(function(H){var G=x.select(this);var E=H.component.name;var F=E.split(/\s+/);G.text(null).selectAll("tspan, title").remove();if(F.length===1){u.ellipsis(G,E)}else{u.multilineEllipsis(G,2,E)}}).append("title").text(function(E){return E.component.name});A.select("path.component-comments").style("visibility",h.isBlank(B.component.comments)?"hidden":"visible").each(function(){var E=x.select("#comments-tip-"+B.id);if(h.isBlank(B.component.comments)){if(!E.empty()){E.remove()}}else{if(E.empty()){E=x.select("#port-tooltips").append("div").attr("id",function(){return"comments-tip-"+B.id}).attr("class","tooltip nifi-tooltip")}E.text(B.component.comments);u.canvasTooltip(E,x.select(this))}})}else{A.select("text.port-name").text(null);A.select("path.component-comments").style("visibility","hidden");A.call(b)}A.call(f)}else{if(B.permissions.canRead){A.select("text.port-name").text(function(F){var E=F.component.name;if(E.length>n){return E.substring(0,n)+String.fromCharCode(8230)}else{return E}})}else{A.select("text.port-name").text(null)}A.call(b);if(!C.empty()){C.remove()}}})};var f=function(z){if(z.empty()){return}z.select("text.run-status-icon").attrs({fill:function(B){var A="#728e9b";if(B.status.aggregateSnapshot.runStatus==="Invalid"){A="#cf9f5d"}else{if(B.status.aggregateSnapshot.runStatus==="Running"){A="#7dc7a0"}else{if(B.status.aggregateSnapshot.runStatus==="Stopped"){A="#d18686"}}}return A},"font-family":function(B){var A="FontAwesome";if(B.status.aggregateSnapshot.runStatus==="Disabled"){A="flowfont"}return A}}).text(function(B){var A="";if(B.status.aggregateSnapshot.runStatus==="Disabled"){A="\ue802"}else{if(B.status.aggregateSnapshot.runStatus==="Invalid"){A="\uf071"}else{if(B.status.aggregateSnapshot.runStatus==="Running"){A="\uf04b"}else{if(B.status.aggregateSnapshot.runStatus==="Stopped"){A="\uf04d"}}}}return A}).each(function(B){var A=x.select("#run-status-tip-"+B.id);if(B.permissions.canRead&&!h.isEmpty(B.component.validationErrors)){if(A.empty()){A=x.select("#port-tooltips").append("div").attr("id",function(){return"run-status-tip-"+B.id}).attr("class","tooltip nifi-tooltip")}A.html(function(){var C=h.formatUnorderedList(B.component.validationErrors);if(C===null||C.length===0){return""}else{return d("<div></div>").append(C).html()}});u.canvasTooltip(A,x.select(this))}else{if(!A.empty()){A.remove()}}});z.select("text.port-transmission-icon").attrs({"font-family":function(A){if(A.status.transmitting===true){return"FontAwesome"}else{return"flowfont"}}}).text(function(A){if(A.status.transmitting===true){return"\uf140"}else{return"\ue80a"}}).classed("transmitting",function(A){if(A.status.transmitting===true){return true}else{return false}}).classed("not-transmitting",function(A){if(A.status.transmitting!==true){return true}else{return false}});z.each(function(C){var A=x.select(this);var B=0;u.activeThreadCount(A,C,function(D){B=D});A.select("rect.bulletin-background").classed("has-bulletins",function(){return !h.isEmpty(C.status.aggregateSnapshot.bulletins)});u.bulletins(A,C,function(){return x.select("#port-tooltips")},B)})};var t=function(z){if(z.empty()){return}z.call(b).remove()};var b=function(z){z.each(function(A){d("#run-status-tip-"+A.id).remove();d("#bulletin-tip-"+A.id).remove();d("#comments-tip-"+A.id).remove()})};var a={init:function(B,C,z,A,D){m=B;r=C;j=z;s=A;i=D;e=x.map();w=x.map();c=x.map();g=x.select("#canvas").append("g").attrs({"pointer-events":"all","class":"ports"})},add:function(D,A){var F=false;if(h.isDefinedAndNotNull(A)){F=h.isDefinedAndNotNull(A.selectAll)?A.selectAll:F}var C=v;if(u.getParentGroupId()===null){C=o}var z=new Date().getTime();var G=function(H){c.set(H.id,z);e.set(H.id,d.extend({type:"Port",dimensions:C,status:{activeThreadCount:0}},H))};if(d.isArray(D)){d.each(D,function(I,H){G(H)})}else{if(h.isDefinedAndNotNull(D)){G(D)}}var B=q();var E=l(B.enter(),F);p(B.merge(E))},set:function(A,I){var B=false;var F=false;var C=false;if(h.isDefinedAndNotNull(I)){B=h.isDefinedAndNotNull(I.selectAll)?I.selectAll:B;F=h.isDefinedAndNotNull(I.transition)?I.transition:F;C=h.isDefinedAndNotNull(I.overrideRevisionCheck)?I.overrideRevisionCheck:C}var z=v;if(u.getParentGroupId()===null){z=o}var G=function(J){var K=e.get(J.id);if((y.isNewerRevision(K,J)&&!w.has(J.id))||C===true){e.set(J.id,d.extend({type:"Port",dimensions:z,status:{activeThreadCount:0}},J))}};if(d.isArray(A)){d.each(e.keys(),function(K,L){var M=e.get(L);var J=d.grep(A,function(N){return N.id===M.id});if(J.length===0&&!c.has(L)){e.remove(L)}});d.each(A,function(K,J){G(J)})}else{if(h.isDefinedAndNotNull(A)){G(A)}}var H=q();var E=l(H.enter(),B);var D=H.merge(E);D.call(p).call(u.position,F);H.exit().call(t)},get:function(z){if(h.isUndefined(z)){return e.values()}else{return e.get(z)}},refresh:function(z){if(h.isDefinedAndNotNull(z)){x.select("#id-"+z).call(p)}else{x.selectAll("g.input-port, g.output-port").call(p)}},pan:function(){x.selectAll("g.input-port.entering, g.output-port.entering, g.input-port.leaving, g.output-port.leaving").call(p)},reload:function(A){if(e.has(A)){var z=e.get(A);return d.ajax({type:"GET",url:z.uri,dataType:"json"}).done(function(B){a.set(B)})}},position:function(z){x.select("#id-"+z).call(u.position)},remove:function(A){var z=new Date().getTime();if(d.isArray(A)){d.each(A,function(B,C){w.set(C,z);e.remove(C)})}else{w.set(A,z);e.remove(A)}q().exit().call(t)},removeAll:function(){a.remove(e.keys())},expireCaches:function(A){var z=function(B){B.each(function(C,D){if(A>C){B.remove(D)}})};z(c);z(w)}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Connection","nf.Common","nf.Client","nf.CanvasUtils","nf.Dialog"],function(g,e,i,h,c,d,f){return(nf.ProcessGroup=b(g,e,i,h,c,d,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessGroup=b(require("jquery"),require("d3"),require("nf.Connection"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.Dialog")))}else{nf.ProcessGroup=b(a.$,a.d3,a.nf.Connection,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.Dialog)}}}(this,function(g,z,k,j,A,v,p){var n;var t;var l;var u;var o=30;var i={width:380,height:172};var d;var y;var e;var q;var m=function(B){return j.isDefinedAndNotNull(B.versionedFlowState)};var s=function(){return q.selectAll("g.process-group").data(d.values(),function(B){return B.id})};var w=function(D,B){if(D.empty()){return D}var C=D.append("g").attrs({id:function(E){return"id-"+E.id},"class":"process-group component"}).classed("selected",B).call(v.position);C.append("rect").attrs({"class":"border",width:function(E){return E.dimensions.width},height:function(E){return E.dimensions.height},fill:"transparent",stroke:"transparent"});C.append("rect").attrs({"class":"body",width:function(E){return E.dimensions.width},height:function(E){return E.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});C.append("rect").attrs({width:function(E){return E.dimensions.width},height:32,fill:"#b8c6cd"});C.append("text").attrs({x:10,y:20,width:300,height:16,"class":"process-group-name"});C.append("text").attrs({x:10,y:21,"class":"version-control"});C.on("dblclick",function(E){h.enterGroup(E.id)}).call(l.activate).call(u.activate);C.filter(function(E){return E.permissions.canWrite&&E.permissions.canRead}).on("mouseover.drop",function(I){var G=z.select(this);if(!G.classed("drop")){var H=G.datum();var F=z.select("rect.drag-selection");if(!F.empty()){var E=v.getSelection().filter(function(J){return H.id===J.id});if(E.empty()){G.classed("drop",function(){return k.isDisconnected(v.getSelection())})}}}}).on("mouseout.drop",function(E){z.select(this).classed("drop",false)}).call(t.activate).call(n.activate);return C};var b=10;var a=5;var x=function(B){if(B.empty()){return}B.select("rect.border").classed("unauthorized",function(C){return C.permissions.canRead===false});B.select("rect.body").classed("unauthorized",function(C){return C.permissions.canRead===false});B.each(function(K){var ab=z.select(this);var X=ab.select("g.process-group-details");v.editable(ab,n,t);if(ab.classed("visible")){if(X.empty()){X=ab.append("g").attr("class","process-group-details");X.append("rect").attrs({x:0,y:32,width:function(){return K.dimensions.width},height:24,fill:"#e3e8eb"});X.append("rect").attrs({x:0,y:function(){return K.dimensions.height-24},width:function(){return K.dimensions.width},height:24,fill:"#e3e8eb"});X.append("text").attrs({x:10,y:49,"class":"process-group-transmitting process-group-contents-icon","font-family":"FontAwesome"}).text("\uf140").append("title").text("Transmitting Remote Process Groups");X.append("text").attrs({y:49,"class":"process-group-transmitting-count process-group-contents-count"});X.append("text").attrs({y:49,"class":"process-group-not-transmitting process-group-contents-icon","font-family":"flowfont"}).text("\ue80a").append("title").text("Not Transmitting Remote Process Groups");X.append("text").attrs({y:49,"class":"process-group-not-transmitting-count process-group-contents-count"});X.append("text").attrs({y:49,"class":"process-group-running process-group-contents-icon","font-family":"FontAwesome"}).text("\uf04b").append("title").text("Running Components");X.append("text").attrs({y:49,"class":"process-group-running-count process-group-contents-count"});X.append("text").attrs({y:49,"class":"process-group-stopped process-group-contents-icon","font-family":"FontAwesome"}).text("\uf04d").append("title").text("Stopped Components");X.append("text").attrs({y:49,"class":"process-group-stopped-count process-group-contents-count"});X.append("text").attrs({y:49,"class":"process-group-invalid process-group-contents-icon","font-family":"FontAwesome"}).text("\uf071").append("title").text("Invalid Components");X.append("text").attrs({y:49,"class":"process-group-invalid-count process-group-contents-count"});X.append("text").attrs({y:49,"class":"process-group-disabled process-group-contents-icon","font-family":"flowfont"}).text("\ue802").append("title").text("Disabled Components");X.append("text").attrs({y:49,"class":"process-group-disabled-count process-group-contents-count"});X.append("text").attrs({x:10,y:function(){return K.dimensions.height-7},"class":"process-group-up-to-date process-group-contents-icon","font-family":"FontAwesome"}).text("\uf00c").append("title").text("Up to date Versioned Process Groups");X.append("text").attrs({y:function(){return K.dimensions.height-7},"class":"process-group-up-to-date-count process-group-contents-count"});X.append("text").attrs({y:function(){return K.dimensions.height-7},"class":"process-group-locally-modified process-group-contents-icon","font-family":"FontAwesome"}).text("\uf069").append("title").text("Locally modified Versioned Process Groups");X.append("text").attrs({y:function(){return K.dimensions.height-7},"class":"process-group-locally-modified-count process-group-contents-count"});X.append("text").attrs({y:function(){return K.dimensions.height-7},"class":"process-group-stale process-group-contents-icon","font-family":"FontAwesome"}).text("\uf0aa").append("title").text("Stale Versioned Process Groups");X.append("text").attrs({y:function(){return K.dimensions.height-7},"class":"process-group-stale-count process-group-contents-count"});X.append("text").attrs({y:function(){return K.dimensions.height-7},"class":"process-group-locally-modified-and-stale process-group-contents-icon","font-family":"FontAwesome"}).text("\uf06a").append("title").text("Locally modified and stale Versioned Process Groups");X.append("text").attrs({y:function(){return K.dimensions.height-7},"class":"process-group-locally-modified-and-stale-count process-group-contents-count"});X.append("text").attrs({y:function(){return K.dimensions.height-7},"class":"process-group-sync-failure process-group-contents-icon","font-family":"FontAwesome"}).text("\uf128").append("title").text("Sync failure Versioned Process Groups");X.append("text").attrs({y:function(){return K.dimensions.height-7},"class":"process-group-sync-failure-count process-group-contents-count"});X.append("rect").attrs({width:function(){return K.dimensions.width},height:19,x:0,y:66,fill:"#f4f6f7"});X.append("rect").attrs({width:function(){return K.dimensions.width},height:1,x:0,y:84,fill:"#c7d2d7"});X.append("rect").attrs({width:function(){return K.dimensions.width},height:19,x:0,y:85,fill:"#ffffff"});X.append("rect").attrs({width:function(){return K.dimensions.width},height:1,x:0,y:103,fill:"#c7d2d7"});X.append("rect").attrs({width:function(){return K.dimensions.width},height:19,x:0,y:104,fill:"#f4f6f7"});X.append("rect").attrs({width:function(){return K.dimensions.width},height:1,x:0,y:122,fill:"#c7d2d7"});X.append("rect").attrs({width:function(){return K.dimensions.width},height:19,x:0,y:123,fill:"#ffffff"});var W=X.append("g").attrs({transform:"translate(6, 75)"});W.append("text").attrs({width:73,height:10,x:4,y:5,"class":"stats-label"}).text("Queued");W.append("text").attrs({width:73,height:10,x:4,y:24,"class":"stats-label"}).text("In");W.append("text").attrs({width:73,height:10,x:4,y:42,"class":"stats-label"}).text("Read/Write");W.append("text").attrs({width:73,height:10,x:4,y:60,"class":"stats-label"}).text("Out");var F=X.append("g").attrs({transform:"translate(95, 75)"});var T=F.append("text").attrs({width:180,height:10,x:4,y:5,"class":"process-group-queued stats-value"});T.append("tspan").attrs({"class":"count"});T.append("tspan").attrs({"class":"size"});var O=F.append("text").attrs({width:180,height:10,x:4,y:24,"class":"process-group-in stats-value"});O.append("tspan").attrs({"class":"count"});O.append("tspan").attrs({"class":"size"});O.append("tspan").attrs({"class":"ports"});F.append("text").attrs({width:180,height:10,x:4,y:42,"class":"process-group-read-write stats-value"});var R=F.append("text").attrs({width:180,height:10,x:4,y:60,"class":"process-group-out stats-value"});R.append("tspan").attrs({"class":"ports"});R.append("tspan").attrs({"class":"count"});R.append("tspan").attrs({"class":"size"});var N=X.append("g").attrs({transform:"translate(335, 75)"});N.append("text").attrs({width:25,height:10,x:4,y:24,"class":"stats-info"}).text("5 min");N.append("text").attrs({width:25,height:10,x:4,y:42,"class":"stats-info"}).text("5 min");N.append("text").attrs({width:25,height:10,x:4,y:60,"class":"stats-info"}).text("5 min");X.append("path").attrs({"class":"component-comments",transform:"translate("+(K.dimensions.width-2)+", "+(K.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});X.append("text").attrs({"class":"active-thread-count-icon",y:20}).text("\ue83f");X.append("text").attrs({"class":"active-thread-count",y:20});X.append("rect").attrs({"class":"bulletin-background",x:function(){return K.dimensions.width-24},y:32,width:24,height:24});X.append("text").attrs({"class":"bulletin-icon",x:function(){return K.dimensions.width-17},y:49}).text("\uf24a")}var V=X.select("text.process-group-transmitting").classed("transmitting",function(ai){return ai.permissions.canRead&&ai.activeRemotePortCount>0}).classed("zero",function(ai){return ai.permissions.canRead&&ai.activeRemotePortCount===0});var ae=X.select("text.process-group-transmitting-count").attr("x",function(){var ai=parseInt(V.attr("x"),10);return ai+Math.round(V.node().getComputedTextLength())+a}).text(function(ai){return ai.activeRemotePortCount});ae.append("title").text("Transmitting Remote Process Groups");var E=X.select("text.process-group-not-transmitting").classed("not-transmitting",function(ai){return ai.permissions.canRead&&ai.inactiveRemotePortCount>0}).classed("zero",function(ai){return ai.permissions.canRead&&ai.inactiveRemotePortCount===0}).attr("x",function(){var ai=parseInt(ae.attr("x"),10);return ai+Math.round(ae.node().getComputedTextLength())+b});var ac=X.select("text.process-group-not-transmitting-count").attr("x",function(){var ai=parseInt(E.attr("x"),10);return ai+Math.round(E.node().getComputedTextLength())+a}).text(function(ai){return ai.inactiveRemotePortCount});ac.append("title").text("Not transmitting Remote Process Groups");var G=X.select("text.process-group-running").classed("running",function(ai){return ai.permissions.canRead&&ai.component.runningCount>0}).classed("zero",function(ai){return ai.permissions.canRead&&ai.component.runningCount===0}).attr("x",function(){var ai=parseInt(ac.attr("x"),10);return ai+Math.round(ac.node().getComputedTextLength())+b});var M=X.select("text.process-group-running-count").attr("x",function(){var ai=parseInt(G.attr("x"),10);return ai+Math.round(G.node().getComputedTextLength())+a}).text(function(ai){return ai.runningCount});M.append("title").text("Running Components");var H=X.select("text.process-group-stopped").classed("stopped",function(ai){return ai.permissions.canRead&&ai.component.stoppedCount>0}).classed("zero",function(ai){return ai.permissions.canRead&&ai.component.stoppedCount===0}).attr("x",function(){var ai=parseInt(M.attr("x"),10);return ai+Math.round(M.node().getComputedTextLength())+b});var ad=X.select("text.process-group-stopped-count").attr("x",function(){var ai=parseInt(H.attr("x"),10);return ai+Math.round(H.node().getComputedTextLength())+a}).text(function(ai){return ai.stoppedCount});ad.append("title").text("Stopped Components");var aa=X.select("text.process-group-invalid").classed("invalid",function(ai){return ai.permissions.canRead&&ai.component.invalidCount>0}).classed("zero",function(ai){return ai.permissions.canRead&&ai.component.invalidCount===0}).attr("x",function(){var ai=parseInt(ad.attr("x"),10);return ai+Math.round(ad.node().getComputedTextLength())+b});var Q=X.select("text.process-group-invalid-count").attr("x",function(){var ai=parseInt(aa.attr("x"),10);return ai+Math.round(aa.node().getComputedTextLength())+a}).text(function(ai){return ai.invalidCount});Q.append("title").text("Invalid Components");var I=X.select("text.process-group-disabled").classed("disabled",function(ai){return ai.permissions.canRead&&ai.component.disabledCount>0}).classed("zero",function(ai){return ai.permissions.canRead&&ai.component.disabledCount===0}).attr("x",function(){var ai=parseInt(Q.attr("x"),10);return ai+Math.round(Q.node().getComputedTextLength())+b});var Z=X.select("text.process-group-disabled-count").attr("x",function(){var ai=parseInt(I.attr("x"),10);return ai+Math.round(I.node().getComputedTextLength())+a}).text(function(ai){return ai.disabledCount});Z.append("title").text("Disabled Components");var ah=X.select("text.process-group-up-to-date").classed("up-to-date",function(ai){return ai.permissions.canRead&&ai.component.upToDateCount>0}).classed("zero",function(ai){return ai.permissions.canRead&&ai.component.upToDateCount===0});var L=X.select("text.process-group-up-to-date-count").attr("x",function(){var ai=parseInt(ah.attr("x"),10);return ai+Math.round(ah.node().getComputedTextLength())+a}).text(function(ai){return ai.upToDateCount});L.append("title").text("Up to date Versioned Process Groups");var U=X.select("text.process-group-locally-modified").classed("locally-modified",function(ai){return ai.permissions.canRead&&ai.component.locallyModifiedCount>0}).classed("zero",function(ai){return ai.permissions.canRead&&ai.component.locallyModifiedCount===0}).attr("x",function(){var ai=parseInt(L.attr("x"),10);return ai+Math.round(L.node().getComputedTextLength())+b});var D=X.select("text.process-group-locally-modified-count").attr("x",function(){var ai=parseInt(U.attr("x"),10);return ai+Math.round(U.node().getComputedTextLength())+a}).text(function(ai){return ai.locallyModifiedCount});D.append("title").text("Locally modified Versioned Process Groups");var P=X.select("text.process-group-stale").classed("stale",function(ai){return ai.permissions.canRead&&ai.component.staleCount>0}).classed("zero",function(ai){return ai.permissions.canRead&&ai.component.staleCount===0}).attr("x",function(){var ai=parseInt(D.attr("x"),10);return ai+Math.round(D.node().getComputedTextLength())+b});var J=X.select("text.process-group-stale-count").attr("x",function(){var ai=parseInt(P.attr("x"),10);return ai+Math.round(P.node().getComputedTextLength())+a}).text(function(ai){return ai.staleCount});J.append("title").text("Stale Versioned Process Groups");var C=X.select("text.process-group-locally-modified-and-stale").classed("locally-modified-and-stale",function(ai){return ai.permissions.canRead&&ai.component.locallyModifiedAndStaleCount>0}).classed("zero",function(ai){return ai.permissions.canRead&&ai.component.locallyModifiedAndStaleCount===0}).attr("x",function(){var ai=parseInt(J.attr("x"),10);return ai+Math.round(J.node().getComputedTextLength())+b});var S=X.select("text.process-group-locally-modified-and-stale-count").attr("x",function(){var ai=parseInt(C.attr("x"),10);return ai+Math.round(C.node().getComputedTextLength())+a}).text(function(ai){return ai.locallyModifiedAndStaleCount});S.append("title").text("Locally modified and stale Versioned Process Groups");var af=X.select("text.process-group-sync-failure").classed("sync-failure",function(ai){return ai.permissions.canRead&&ai.component.syncFailureCount>0}).classed("zero",function(ai){return ai.permissions.canRead&&ai.component.syncFailureCount===0}).attr("x",function(){var ai=parseInt(S.attr("x"),10);return ai+Math.round(S.node().getComputedTextLength())+b-2});var Y=X.select("text.process-group-sync-failure-count").attr("x",function(){var ai=parseInt(af.attr("x"),10);return ai+Math.round(af.node().getComputedTextLength())+a}).text(function(ai){return ai.syncFailureCount});Y.append("title").text("Sync failure Versioned Process Groups");var ag=ab.select("text.version-control").styles({visibility:m(K)?"visible":"hidden",fill:function(){if(m(K)){var ai=K.versionedFlowState;if(ai==="SYNC_FAILURE"){return"#666666"}else{if(ai==="LOCALLY_MODIFIED_AND_STALE"){return"#BA554A"}else{if(ai==="STALE"){return"#BA554A"}else{if(ai==="LOCALLY_MODIFIED"){return"#666666"}else{return"#1A9964"}}}}}else{return"#000"}}}).text(function(){if(m(K)){var ai=K.versionedFlowState;if(ai==="SYNC_FAILURE"){return"\uf128"}else{if(ai==="LOCALLY_MODIFIED_AND_STALE"){return"\uf06a"}else{if(ai==="STALE"){return"\uf0aa"}else{if(ai==="LOCALLY_MODIFIED"){return"\uf069"}else{return"\uf00c"}}}}}else{return""}});if(K.permissions.canRead){ag.each(function(){var ai=z.select("#version-control-tip-"+K.id);if(m(K)){if(ai.empty()){ai=z.select("#process-group-tooltips").append("div").attr("id",function(){return"version-control-tip-"+K.id}).attr("class","tooltip nifi-tooltip")}ai.html(function(){var aj=K.component.versionControlInformation;var al=g("<div></div>").text('Tracking to "'+aj.flowName+'" version '+aj.version+' in "'+aj.registryName+" - "+aj.bucketName+'"');var ak=g("<div></div>").text(j.getVersionControlTooltip(aj));return g("<div></div>").append(al).append("<br/>").append(ak).html()});v.canvasTooltip(ai,z.select(this))}else{if(!ai.empty()){ai.remove()}}});ab.select("path.component-comments").style("visibility",j.isBlank(K.component.comments)?"hidden":"visible").each(function(){var ai=z.select("#comments-tip-"+K.id);if(j.isBlank(K.component.comments)){if(!ai.empty()){ai.remove()}}else{if(ai.empty()){ai=z.select("#process-group-tooltips").append("div").attr("id",function(){return"comments-tip-"+K.id}).attr("class","tooltip nifi-tooltip")}ai.text(K.component.comments);v.canvasTooltip(ai,z.select(this))}});ab.select("text.process-group-name").attrs({x:function(){if(m(K)){var ai=parseInt(ag.attr("x"),10);return ai+Math.round(ag.node().getComputedTextLength())+a}else{return 10}},width:function(){if(m(K)){var aj=parseInt(ag.attr("x"),10);var ai=parseInt(z.select(this).attr("x"),10);return 300-(ai-aj)}else{return 300}}}).each(function(aj){var ai=z.select(this);ai.text(null).selectAll("title").remove();v.ellipsis(ai,aj.component.name)}).append("title").text(function(ai){return ai.component.name})}else{ab.select("path.component-comments").style("visibility","hidden");ab.select("text.process-group-name").attrs({x:10,width:316}).text(null);ab.call(c)}ab.call(f)}else{if(K.permissions.canRead){ab.select("text.process-group-name").text(function(aj){var ai=aj.component.name;if(ai.length>o){return ai.substring(0,o)+String.fromCharCode(8230)}else{return ai}})}else{ab.select("text.process-group-name").text(null)}ab.call(c);if(!X.empty()){X.remove()}}})};var f=function(B){if(B.empty()){return}B.select("text.process-group-queued tspan.count").text(function(C){return j.substringBeforeFirst(C.status.aggregateSnapshot.queued," ")});B.select("text.process-group-queued tspan.size").text(function(C){return" "+j.substringAfterFirst(C.status.aggregateSnapshot.queued," ")});B.select("text.process-group-in tspan.count").text(function(C){return j.substringBeforeFirst(C.status.aggregateSnapshot.input," ")});B.select("text.process-group-in tspan.size").text(function(C){return" "+j.substringAfterFirst(C.status.aggregateSnapshot.input," ")});B.select("text.process-group-in tspan.ports").text(function(C){return" "+String.fromCharCode(8594)+" "+C.inputPortCount});B.select("text.process-group-read-write").text(function(C){return C.status.aggregateSnapshot.read+" / "+C.status.aggregateSnapshot.written});B.select("text.process-group-out tspan.ports").text(function(C){return C.outputPortCount+" "+String.fromCharCode(8594)+" "});B.select("text.process-group-out tspan.count").text(function(C){return j.substringBeforeFirst(C.status.aggregateSnapshot.output," ")});B.select("text.process-group-out tspan.size").text(function(C){return" "+j.substringAfterFirst(C.status.aggregateSnapshot.output," ")});B.each(function(E){var C=z.select(this);var D=0;v.activeThreadCount(C,E,function(F){D=F});C.select("rect.bulletin-background").classed("has-bulletins",function(){return !j.isEmpty(E.status.aggregateSnapshot.bulletins)});v.bulletins(C,E,function(){return z.select("#process-group-tooltips")},D)})};var r=function(B){if(B.empty()){return}B.call(c).remove()};var c=function(B){B.each(function(C){g("#bulletin-tip-"+C.id).remove();g("#version-control-tip-"+C.id).remove();g("#comments-tip-"+C.id).remove()})};var h={init:function(D,E,B,C){n=D;t=E;l=B;u=C;d=z.map();y=z.map();e=z.map();q=z.select("#canvas").append("g").attrs({"pointer-events":"all","class":"process-groups"})},add:function(H,C){var F=false;if(j.isDefinedAndNotNull(C)){F=j.isDefinedAndNotNull(C.selectAll)?C.selectAll:F}var B=new Date().getTime();var G=function(I){e.set(I.id,B);d.set(I.id,g.extend({type:"ProcessGroup",dimensions:i},I))};if(g.isArray(H)){g.each(H,function(I,J){G(J)})}else{if(j.isDefinedAndNotNull(H)){G(H)}}var D=s();var E=w(D.enter(),F);x(D.merge(E))},set:function(D,J){var B=false;var G=false;var C=false;if(j.isDefinedAndNotNull(J)){B=j.isDefinedAndNotNull(J.selectAll)?J.selectAll:B;G=j.isDefinedAndNotNull(J.transition)?J.transition:G;C=j.isDefinedAndNotNull(J.overrideRevisionCheck)?J.overrideRevisionCheck:C}var H=function(K){var L=d.get(K.id);if((A.isNewerRevision(L,K)&&!y.has(K.id))||C===true){d.set(K.id,g.extend({type:"ProcessGroup",dimensions:i},K))}};if(g.isArray(D)){g.each(d.keys(),function(L,M){var N=d.get(M);var K=g.grep(D,function(O){return O.id===N.id});if(K.length===0&&!e.has(M)){d.remove(M)}});g.each(D,function(K,L){H(L)})}else{if(j.isDefinedAndNotNull(D)){H(D)}}var I=s();var F=w(I.enter(),B);var E=I.merge(F);E.call(x).call(v.position,G);I.exit().call(r)},get:function(B){if(j.isUndefined(B)){return d.values()}else{return d.get(B)}},refresh:function(B){if(j.isDefinedAndNotNull(B)){z.select("#id-"+B).call(x)}else{z.selectAll("g.process-group").call(x)}},pan:function(){z.selectAll("g.process-group.entering, g.process-group.leaving").call(x)},reload:function(C){if(d.has(C)){var B=d.get(C);return g.ajax({type:"GET",url:B.uri,dataType:"json"}).done(function(D){h.set(D)})}},position:function(B){z.select("#id-"+B).call(v.position)},remove:function(C){var B=new Date().getTime();if(g.isArray(C)){g.each(C,function(E,D){y.set(D,B);d.remove(D)})}else{y.set(C,B);d.remove(C)}s().exit().call(r)},removeAll:function(){h.remove(d.keys())},expireCaches:function(C){var B=function(D){D.each(function(E,F){if(C>E){D.remove(F)}})};B(e);B(y)},enterGroup:function(B){u.hide();v.setGroupId(B);return v.reload().done(function(){var C=v.restoreUserView();if(C===false){v.fitCanvas()}v.setURLParameters(B,z.select())}).fail(function(){p.showOkDialog({headerText:"Process Group",dialogContent:"Unable to enter the selected group."})})}};return h}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Connection","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,h,g,c,d){return(nf.RemoteProcessGroup=b(f,e,h,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroup=b(require("jquery"),require("d3"),require("nf.Connection"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.RemoteProcessGroup=b(a.$,a.d3,a.nf.Connection,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(g,y,l,j,z,v){var n;var t;var m;var k;var u;var o=30;var h={width:380,height:158};var c;var w;var d;var x;var s=function(){return x.selectAll("g.remote-process-group").data(c.values(),function(A){return A.id})};var f=function(C,A){if(C.empty()){return C}var B=C.append("g").attrs({id:function(D){return"id-"+D.id},"class":"remote-process-group component"}).classed("selected",A).call(v.position);B.append("rect").attrs({"class":"border",width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height},fill:"transparent",stroke:"transparent"});B.append("rect").attrs({"class":"body",width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});B.append("rect").attrs({width:function(D){return D.dimensions.width},height:32,fill:"#b8c6cd"});B.append("text").attrs({x:30,y:20,width:305,height:16,"class":"remote-process-group-name"});B.call(m.activate).call(u.activate).call(k.activate);return B};var r=function(A){if(A.empty()){return}A.select("rect.border").classed("unauthorized",function(B){return B.permissions.canRead===false});A.select("rect.body").classed("unauthorized",function(B){return B.permissions.canRead===false});A.each(function(G){var H=y.select(this);var E=H.select("g.remote-process-group-details");v.editable(H,n,t);if(H.classed("visible")){if(E.empty()){E=H.append("g").attr("class","remote-process-group-details");E.append("text").attrs({"class":"remote-process-group-transmission-status",x:10,y:20});E.append("rect").attrs({x:0,y:32,width:function(){return G.dimensions.width},height:24,fill:"#e3e8eb"});E.append("text").attrs({"class":"remote-process-group-transmission-secure",x:10,y:48});E.append("text").attrs({x:30,y:48,width:305,height:12,"class":"remote-process-group-uri"});E.append("rect").attrs({width:function(){return G.dimensions.width},height:19,x:0,y:66,fill:"#f4f6f7"});E.append("rect").attrs({width:function(){return G.dimensions.width},height:1,x:0,y:84,fill:"#c7d2d7"});E.append("rect").attrs({width:function(){return G.dimensions.width},height:19,x:0,y:85,fill:"#ffffff"});var F=E.append("g").attrs({transform:"translate(6, 75)"});F.append("text").attrs({width:73,height:10,x:4,y:5,"class":"stats-label"}).text("Sent");F.append("text").attrs({width:73,height:10,x:4,y:23,"class":"stats-label"}).text("Received");var I=E.append("g").attrs({transform:"translate(95, 75)"});var B=I.append("text").attrs({width:180,height:10,x:4,y:5,"class":"remote-process-group-sent stats-value"});B.append("tspan").attrs({"class":"count"});B.append("tspan").attrs({"class":"size"});B.append("tspan").attrs({"class":"ports"});var C=I.append("text").attrs({width:180,height:10,x:4,y:23,"class":"remote-process-group-received stats-value"});C.append("tspan").attrs({"class":"ports"});C.append("tspan").attrs({"class":"count"});C.append("tspan").attrs({"class":"size"});var D=E.append("g").attrs({transform:"translate(335, 75)"});D.append("text").attrs({width:25,height:10,x:4,y:5,"class":"stats-info"}).text("5 min");D.append("text").attrs({width:25,height:10,x:4,y:23,"class":"stats-info"}).text("5 min");E.append("rect").attrs({x:0,y:function(){return G.dimensions.height-24},width:function(){return G.dimensions.width},height:24,fill:"#e3e8eb"});E.append("text").attrs({x:10,y:150,"class":"remote-process-group-last-refresh"});E.append("path").attrs({"class":"component-comments",transform:"translate("+(G.dimensions.width-2)+", "+(G.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});E.append("text").attrs({"class":"active-thread-count-icon",y:20}).text("\ue83f");E.append("text").attrs({"class":"active-thread-count",y:20});E.append("rect").attrs({"class":"bulletin-background",x:function(){return G.dimensions.width-24},y:32,width:24,height:24});E.append("text").attrs({"class":"bulletin-icon",x:function(){return G.dimensions.width-17},y:49}).text("\uf24a")}if(G.permissions.canRead){E.select("text.remote-process-group-uri").each(function(K){var J=y.select(this);J.text(null).selectAll("title").remove();v.ellipsis(J,K.component.targetUris)}).append("title").text(function(J){return J.component.name});E.select("text.remote-process-group-transmission-secure").text(function(K){var J="";if(K.component.targetSecure===true){J="\uf023"}else{J="\uf09c"}return J}).each(function(K){var J=y.select("#transmission-secure-"+K.id);if(J.empty()){J=y.select("#remote-process-group-tooltips").append("div").attr("id",function(){return"transmission-secure-"+K.id}).attr("class","tooltip nifi-tooltip")}J.text(function(){if(K.component.targetSecure===true){return"Site-to-Site is secure."}else{return"Site-to-Site is NOT secure."}});v.canvasTooltip(J,y.select(this))});E.select("path.component-comments").style("visibility",j.isBlank(G.component.comments)?"hidden":"visible").each(function(){var J=y.select("#comments-tip-"+G.id);if(j.isBlank(G.component.comments)){if(!J.empty()){J.remove()}}else{if(J.empty()){J=y.select("#remote-process-group-tooltips").append("div").attr("id",function(){return"comments-tip-"+G.id}).attr("class","tooltip nifi-tooltip")}J.text(G.component.comments);v.canvasTooltip(J,y.select(this))}});E.select("text.remote-process-group-last-refresh").text(function(J){if(j.isDefinedAndNotNull(J.component.flowRefreshed)){return J.component.flowRefreshed}else{return"Remote flow not current"}});H.select("text.remote-process-group-name").each(function(K){var J=y.select(this);J.text(null).selectAll("title").remove();v.ellipsis(J,K.component.name)}).append("title").text(function(J){return J.component.name})}else{E.select("text.remote-process-group-uri").text(null);E.select("text.remote-process-group-transmission-secure").text(null);E.select("path.component-comments").style("visibility","hidden");E.select("text.remote-process-group-last-refresh").text(null);H.select("text.remote-process-group-name").text(null);H.call(a)}H.call(e)}else{if(G.permissions.canRead){H.select("text.remote-process-group-name").text(function(K){var J=K.component.name;if(J.length>o){return J.substring(0,o)+String.fromCharCode(8230)}else{return J}})}else{H.select("text.remote-process-group-name").text(null)}H.call(a);if(!E.empty()){E.remove()}}})};var b=function(A){return A.status.validationStatus==="INVALID"};var p=function(B){var A=[];if(!j.isEmpty(B.component.authorizationIssues)){A=A.concat(B.component.authorizationIssues)}if(!j.isEmpty(B.component.validationErrors)){A=A.concat(B.component.validationErrors)}return A};var e=function(A){if(A.empty()){return}A.select("text.remote-process-group-sent tspan.count").text(function(B){return j.substringBeforeFirst(B.status.aggregateSnapshot.sent," ")});A.select("text.remote-process-group-sent tspan.size").text(function(B){return" "+j.substringAfterFirst(B.status.aggregateSnapshot.sent," ")});A.select("text.remote-process-group-sent tspan.ports").text(function(B){return" "+String.fromCharCode(8594)+" "+B.inputPortCount});A.select("text.remote-process-group-received tspan.ports").text(function(B){return B.outputPortCount+" "+String.fromCharCode(8594)+" "});A.select("text.remote-process-group-received tspan.count").text(function(B){return j.substringBeforeFirst(B.status.aggregateSnapshot.received," ")});A.select("text.remote-process-group-received tspan.size").text(function(B){return" "+j.substringAfterFirst(B.status.aggregateSnapshot.received," ")});A.select("text.remote-process-group-transmission-status").text(function(C){var B="";if(b(C)){B="\uf071"}else{if(C.status.transmissionStatus==="Transmitting"){B="\uf140"}else{B="\ue80a"}}return B}).attr("font-family",function(C){var B="";if(b(C)||C.status.transmissionStatus==="Transmitting"){B="FontAwesome"}else{B="flowfont"}return B}).classed("invalid",function(B){return b(B)}).classed("transmitting",function(B){return !b(B)&&B.status.transmissionStatus==="Transmitting"}).classed("not-transmitting",function(B){return !b(B)&&B.status.transmissionStatus!=="Transmitting"}).each(function(C){var B=y.select("#authorization-issues-"+C.id);if(C.permissions.canRead&&b(C)){if(B.empty()){B=y.select("#remote-process-group-tooltips").append("div").attr("id",function(){return"authorization-issues-"+C.id}).attr("class","tooltip nifi-tooltip")}B.html(function(){var D=j.formatUnorderedList(p(C));if(D===null||D.length===0){return""}else{return g("<div></div>").append(D).html()}});v.canvasTooltip(B,y.select(this))}else{if(!B.empty()){B.remove()}}});A.each(function(D){var B=y.select(this);var C=0;v.activeThreadCount(B,D,function(E){C=E});B.select("rect.bulletin-background").classed("has-bulletins",function(){return !j.isEmpty(D.status.aggregateSnapshot.bulletins)});v.bulletins(B,D,function(){return y.select("#remote-process-group-tooltips")},C)})};var i=function(A){if(A.empty()){return}A.call(a).remove()};var a=function(A){A.each(function(B){g("#bulletin-tip-"+B.id).remove();g("#authorization-issues-"+B.id).remove();g("#transmission-secure-"+B.id).remove();g("#comments-tip-"+B.id).remove()})};var q={init:function(C,D,A,B,E){n=C;t=D;m=A;u=B;k=E;c=y.map();w=y.map();d=y.map();x=y.select("#canvas").append("g").attrs({"pointer-events":"all","class":"remote-process-groups"})},add:function(G,B){var E=false;if(j.isDefinedAndNotNull(B)){E=j.isDefinedAndNotNull(B.selectAll)?B.selectAll:E}var A=new Date().getTime();var F=function(H){d.set(H.id,A);c.set(H.id,g.extend({type:"RemoteProcessGroup",dimensions:h},H))};if(g.isArray(G)){g.each(G,function(H,I){F(I)})}else{if(j.isDefinedAndNotNull(G)){F(G)}}var C=s();var D=f(C.enter(),E);r(C.merge(D))},set:function(A,I){var B=false;var F=false;var C=false;if(j.isDefinedAndNotNull(I)){B=j.isDefinedAndNotNull(I.selectAll)?I.selectAll:B;F=j.isDefinedAndNotNull(I.transition)?I.transition:F;C=j.isDefinedAndNotNull(I.overrideRevisionCheck)?I.overrideRevisionCheck:C}var G=function(J){var K=c.get(J.id);if((z.isNewerRevision(K,J)&&!w.has(J.id))||C===true){c.set(J.id,g.extend({type:"RemoteProcessGroup",dimensions:h},J))}};if(g.isArray(A)){g.each(c.keys(),function(K,L){var M=c.get(L);var J=g.grep(A,function(N){return N.id===M.id});if(J.length===0&&!d.has(L)){c.remove(L)}});g.each(A,function(J,K){G(K)})}else{if(j.isDefinedAndNotNull(A)){G(A)}}var H=s();var E=f(H.enter(),B);var D=H.merge(E);D.call(r).call(v.position,F);H.exit().call(i)},get:function(A){if(j.isUndefined(A)){return c.values()}else{return c.get(A)}},refresh:function(A){if(j.isDefinedAndNotNull(A)){y.select("#id-"+A).call(r)}else{y.selectAll("g.remote-process-group").call(r)}},pan:function(){y.selectAll("g.remote-process-group.entering, g.remote-process-group.leaving").call(r)},reload:function(B){if(c.has(B)){var A=c.get(B);return g.ajax({type:"GET",url:A.uri,dataType:"json"}).done(function(C){q.set(C);var D=l.getComponentConnections(B);g.each(D,function(F,E){if(E.permissions.canRead){l.reload(E.id)}})})}},position:function(A){y.select("#id-"+A).call(v.position)},remove:function(B){var A=new Date().getTime();if(g.isArray(B)){g.each(B,function(D,C){w.set(C,A);c.remove(C)})}else{w.set(B,A);c.remove(B)}s().exit().call(i)},removeAll:function(){q.remove(c.keys())},expireCaches:function(B){var A=function(C){C.each(function(D,E){if(B>D){C.remove(E)}})};A(d);A(w)}};return q}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.ClusterSummary","nf.CanvasUtils"],function(g,f,h,d,c,e){return(nf.Processor=b(g,f,h,d,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Processor=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.ClusterSummary"),require("nf.CanvasUtils")))}else{nf.Processor=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.ClusterSummary,a.nf.CanvasUtils)}}}(this,function(e,A,i,B,h,v){var m;var r;var k;var j;var u;var n=25;var g={width:350,height:130};var y;var z;var c;var s;var q=function(){return s.selectAll("g.processor").data(y.values(),function(C){return C.id})};var d=function(E,D){if(E.empty()){return E}var C=E.append("g").attrs({id:function(F){return"id-"+F.id},"class":"processor component"}).classed("selected",D).call(v.position);C.append("rect").attrs({"class":"border",width:function(F){return F.dimensions.width},height:function(F){return F.dimensions.height},fill:"transparent",stroke:"transparent"});C.append("rect").attrs({"class":"body",width:function(F){return F.dimensions.width},height:function(F){return F.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});C.append("text").attrs({x:75,y:18,width:230,height:14,"class":"processor-name"});C.append("rect").attrs({x:0,y:0,width:50,height:50,"class":"processor-icon-container"});C.append("text").attrs({x:9,y:35,"class":"processor-icon"}).text("\ue807");C.append("circle").attrs({r:9,cx:12,cy:12,"class":"restricted-background"});C.append("text").attrs({x:7.75,y:17,"class":"restricted"}).text("\uf132");C.append("circle").attrs({r:9,cx:38,cy:36,"class":"is-primary-background"});C.append("text").attrs({x:34.75,y:40,"class":"is-primary"}).text("P").append("title").text(function(F){return"This component is only scheduled to execute on the Primary Node"});C.call(k.activate).call(u.activate).call(j.activate);return C};var x=function(C){if(C.empty()){return}C.select("rect.border").classed("unauthorized",function(D){return D.permissions.canRead===false}).classed("ghost",function(D){return D.permissions.canRead===true&&D.component.extensionMissing===true});C.select("rect.body").classed("unauthorized",function(D){return D.permissions.canRead===false});C.each(function(I){var F=A.select(this);var D=F.select("g.processor-canvas-details");v.editable(F,m,r);if(F.classed("visible")){if(D.empty()){D=F.append("g").attr("class","processor-canvas-details");D.append("text").attrs({"class":"run-status-icon",x:55,y:23,width:14,height:14});D.append("text").attrs({"class":"processor-type",x:75,y:32,width:230,height:12});D.append("text").attrs({"class":"processor-bundle",x:75,y:45,width:200,height:12});D.append("rect").attrs({width:function(){return I.dimensions.width},height:19,x:0,y:50,fill:"#f4f6f7"});D.append("rect").attrs({width:function(){return I.dimensions.width},height:1,x:0,y:68,fill:"#c7d2d7"});D.append("rect").attrs({width:function(){return I.dimensions.width},height:19,x:0,y:69,fill:"#ffffff"});D.append("rect").attrs({width:function(){return I.dimensions.width},height:1,x:0,y:87,fill:"#c7d2d7"});D.append("rect").attrs({width:function(){return I.dimensions.width},height:20,x:0,y:88,fill:"#f4f6f7"});D.append("rect").attrs({width:function(){return I.dimensions.width},height:1,x:0,y:106,fill:"#c7d2d7"});D.append("rect").attrs({width:function(){return I.dimensions.width},height:19,x:0,y:107,fill:"#ffffff"});var L=D.append("g").attrs({transform:"translate(10, 55)"});L.append("text").attrs({width:73,height:10,y:9,"class":"stats-label"}).text("In");L.append("text").attrs({width:73,height:10,y:27,"class":"stats-label"}).text("Read/Write");L.append("text").attrs({width:73,height:10,y:46,"class":"stats-label"}).text("Out");L.append("text").attrs({width:73,height:10,y:65,"class":"stats-label"}).text("Tasks/Time");var E=D.append("g").attrs({transform:"translate(85, 55)"});var K=E.append("text").attrs({width:180,height:9,y:9,"class":"processor-in stats-value"});K.append("tspan").attrs({"class":"count"});K.append("tspan").attrs({"class":"size"});E.append("text").attrs({width:180,height:10,y:27,"class":"processor-read-write stats-value"});var G=E.append("text").attrs({width:180,height:10,y:46,"class":"processor-out stats-value"});G.append("tspan").attrs({"class":"count"});G.append("tspan").attrs({"class":"size"});E.append("text").attrs({width:180,height:10,y:65,"class":"processor-tasks-time stats-value"});var J=D.append("g").attr("transform","translate(305, 55)");J.append("text").attrs({width:25,height:10,y:9,"class":"stats-info"}).text("5 min");J.append("text").attrs({width:25,height:10,y:27,"class":"stats-info"}).text("5 min");J.append("text").attrs({width:25,height:10,y:46,"class":"stats-info"}).text("5 min");J.append("text").attrs({width:25,height:10,y:65,"class":"stats-info"}).text("5 min");D.append("path").attrs({"class":"component-comments",transform:"translate("+(I.dimensions.width-2)+", "+(I.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});D.append("text").attrs({"class":"active-thread-count-icon",y:46}).text("\ue83f");D.append("text").attrs({"class":"active-thread-count",y:46});D.append("rect").attrs({"class":"bulletin-background",x:function(M){return I.dimensions.width-24},width:24,height:24});D.append("text").attrs({"class":"bulletin-icon",x:function(M){return I.dimensions.width-17},y:17}).text("\uf24a")}if(I.permissions.canRead){F.select("text.processor-name").each(function(N){var M=A.select(this);M.text(null).selectAll("title").remove();v.ellipsis(M,N.component.name)}).append("title").text(function(M){return M.component.name});F.select("text.processor-type").each(function(N){var M=A.select(this);M.text(null).selectAll("title").remove();v.ellipsis(M,i.formatType(N.component))}).append("title").text(function(M){return i.formatType(M.component)});F.select("text.processor-bundle").each(function(N){var M=A.select(this);M.text(null).selectAll("title").remove();v.ellipsis(M,i.formatBundle(N.component.bundle))}).append("title").text(function(M){return i.formatBundle(M.component.bundle)});F.select("path.component-comments").style("visibility",i.isBlank(I.component.config.comments)?"hidden":"visible").each(function(){var M=A.select("#comments-tip-"+I.id);if(i.isBlank(I.component.config.comments)){if(!M.empty()){M.remove()}}else{if(M.empty()){M=A.select("#processor-tooltips").append("div").attr("id",function(){return"comments-tip-"+I.id}).attr("class","tooltip nifi-tooltip")}M.text(I.component.config.comments);v.canvasTooltip(M,A.select(this))}})}else{F.select("text.processor-name").text(null);F.select("text.processor-type").text(null);F.select("text.processor-bundle").text(null);F.select("path.component-comments").style("visibility","hidden");F.call(b)}F.call(f)}else{if(I.permissions.canRead){F.select("text.processor-name").text(function(N){var M=N.component.name;if(M.length>n){return M.substring(0,n)+String.fromCharCode(8230)}else{return M}})}else{F.select("text.processor-name").text(null)}F.call(b);if(!D.empty()){D.remove()}}F.select("rect.processor-icon-container").classed("unauthorized",!I.permissions.canRead);F.select("text.processor-icon").classed("unauthorized",!I.permissions.canRead);F.select("rect.border").classed("unauthorized",!I.permissions.canRead);if(I.permissions.canRead){if(i.isDefinedAndNotNull(I.component.style["background-color"])){var H=I.component.style["background-color"];F.select("rect.processor-icon-container").style("fill",function(M){return H});F.select("rect.border").style("stroke",function(M){return H})}}F.select("text.processor-icon").style("fill",function(N){var M=p.defaultIconColor();if(!N.permissions.canRead){return M}if(i.isDefinedAndNotNull(N.component.style["background-color"])){M=N.component.style["background-color"];if(M.toLowerCase()==="#ffffff"){M=p.defaultIconColor()}else{M=i.determineContrastColor(i.substringAfterLast(M,"#"))}}return M});F.select("circle.restricted-background").style("visibility",l);F.select("text.restricted").style("visibility",l);F.select("circle.is-primary-background").style("visibility",o);F.select("text.is-primary").style("visibility",o)})};var l=function(C){if(!C.permissions.canRead){return"hidden"}return C.component.restricted?"visible":"hidden"};var o=function(C){return h.isClustered()&&C.status.aggregateSnapshot.executionNode==="PRIMARY"?"visible":"hidden"};var w=function(C){return(C.permissions.canRead&&!i.isEmpty(C.component.validationErrors))||C.status.aggregateSnapshot.runStatus==="Validating"};var a=function(D){if(D.permissions.canRead&&!i.isEmpty(D.component.validationErrors)){var C=i.formatUnorderedList(D.component.validationErrors);if(C===null||C.length===0){return""}else{return C}}else{return"Validating..."}};var f=function(C){if(C.empty()){return}C.select("text.run-status-icon").attrs({fill:function(E){var D="#728e9b";if(E.status.aggregateSnapshot.runStatus==="Validating"){D="#a8a8a8"}else{if(E.status.aggregateSnapshot.runStatus==="Invalid"){D="#cf9f5d"}else{if(E.status.aggregateSnapshot.runStatus==="Running"){D="#7dc7a0"}else{if(E.status.aggregateSnapshot.runStatus==="Stopped"){D="#d18686"}}}}return D},"font-family":function(E){var D="FontAwesome";if(E.status.aggregateSnapshot.runStatus==="Disabled"){D="flowfont"}return D}}).classed("fa-spin",function(D){return D.status.aggregateSnapshot.runStatus==="Validating"}).text(function(E){var D="";if(E.status.aggregateSnapshot.runStatus==="Disabled"){D="\ue802"}else{if(E.status.aggregateSnapshot.runStatus==="Validating"){D="\uf1ce"}else{if(E.status.aggregateSnapshot.runStatus==="Invalid"){D="\uf071"}else{if(E.status.aggregateSnapshot.runStatus==="Running"){D="\uf04b"}else{if(E.status.aggregateSnapshot.runStatus==="Stopped"){D="\uf04d"}}}}}return D}).each(function(E){var D=A.select("#run-status-tip-"+E.id);if(w(E)){if(D.empty()){D=A.select("#processor-tooltips").append("div").attr("id",function(){return"run-status-tip-"+E.id}).attr("class","tooltip nifi-tooltip")}D.html(function(){return e("<div></div>").append(a(E)).html()});v.canvasTooltip(D,A.select(this))}else{if(!D.empty()){D.remove()}}});C.select("text.processor-in tspan.count").text(function(D){return i.substringBeforeFirst(D.status.aggregateSnapshot.input," ")});C.select("text.processor-in tspan.size").text(function(D){return" "+i.substringAfterFirst(D.status.aggregateSnapshot.input," ")});C.select("text.processor-read-write").text(function(D){return D.status.aggregateSnapshot.read+" / "+D.status.aggregateSnapshot.written});C.select("text.processor-out tspan.count").text(function(D){return i.substringBeforeFirst(D.status.aggregateSnapshot.output," ")});C.select("text.processor-out tspan.size").text(function(D){return" "+i.substringAfterFirst(D.status.aggregateSnapshot.output," ")});C.select("text.processor-tasks-time").text(function(D){return D.status.aggregateSnapshot.tasks+" / "+D.status.aggregateSnapshot.tasksDuration});C.each(function(E){var D=A.select(this);v.activeThreadCount(D,E);D.select("rect.bulletin-background").classed("has-bulletins",function(){return !i.isEmpty(E.status.aggregateSnapshot.bulletins)});v.bulletins(D,E,function(){return A.select("#processor-tooltips")},286)})};var t=function(C){if(C.empty()){return}C.call(b).remove()};var b=function(C){C.each(function(D){e("#run-status-tip-"+D.id).remove();e("#bulletin-tip-"+D.id).remove();e("#comments-tip-"+D.id).remove()})};var p={init:function(E,F,C,D,G){m=E;r=F;k=C;u=D;j=G;y=A.map();z=A.map();c=A.map();s=A.select("#canvas").append("g").attrs({"pointer-events":"all","class":"processors"})},add:function(C,E){var H=false;if(i.isDefinedAndNotNull(E)){H=i.isDefinedAndNotNull(E.selectAll)?E.selectAll:H}var D=new Date().getTime();var I=function(J){c.set(J.id,D);y.set(J.id,e.extend({type:"Processor",dimensions:g},J))};if(e.isArray(C)){e.each(C,function(J,K){I(K)})}else{if(i.isDefinedAndNotNull(C)){I(C)}}var F=q();var G=d(F.enter(),H);x(F.merge(G))},set:function(H,K){var C=false;var G=false;var D=false;if(i.isDefinedAndNotNull(K)){C=i.isDefinedAndNotNull(K.selectAll)?K.selectAll:C;G=i.isDefinedAndNotNull(K.transition)?K.transition:G;D=i.isDefinedAndNotNull(K.overrideRevisionCheck)?K.overrideRevisionCheck:D}var I=function(M){var L=y.get(M.id);if((B.isNewerRevision(L,M)&&!z.has(M.id))||D===true){y.set(M.id,e.extend({type:"Processor",dimensions:g},M))}};if(e.isArray(H)){e.each(y.keys(),function(M,N){var O=y.get(N);var L=e.grep(H,function(P){return P.id===O.id});if(L.length===0&&!c.has(N)){y.remove(N)}});e.each(H,function(L,M){I(M)})}else{if(i.isDefinedAndNotNull(H)){I(H)}}var J=q();var F=d(J.enter(),C);var E=J.merge(F);E.call(x);E.call(v.position,G);J.exit().call(t)},get:function(C){if(i.isUndefined(C)){return y.values()}else{return y.get(C)}},refresh:function(C){if(i.isDefinedAndNotNull(C)){A.select("#id-"+C).call(x)}else{A.selectAll("g.processor").call(x)}},position:function(C){A.select("#id-"+C).call(v.position)},pan:function(){A.selectAll("g.processor.entering, g.processor.leaving").call(x)},reload:function(D){if(y.has(D)){var C=y.get(D);return e.ajax({type:"GET",url:C.uri,dataType:"json"}).done(function(E){p.set(E)})}},remove:function(D){var C=new Date().getTime();if(e.isArray(D)){e.each(D,function(E,F){z.set(F,C);y.remove(F)})}else{z.set(D,C);y.remove(D)}q().exit().call(t)},removeAll:function(){p.remove(y.keys())},expireCaches:function(D){var C=function(E){E.each(function(F,G){if(D>F){E.remove(G)}})};C(c);C(z)},defaultFillColor:function(){return"#FFFFFF"},defaultIconColor:function(){return"#ad9897"}};return p}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Processor","nf.ClusterSummary","nf.CustomUi","nf.UniversalCapture","nf.Connection"],function(f,n,c,e,g,o,d,h,m,l,k,i,j){return(nf.ProcessorConfiguration=b(f,n,c,e,g,o,d,h,m,l,k,i,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessorConfiguration=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Processor"),require("nf.ClusterSummary"),require("nf.CustomUi"),require("nf.UniversalCapture"),require("nf.Connection")))}else{nf.ProcessorConfiguration=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Processor,a.nf.ClusterSummary,a.nf.CustomUi,a.nf.UniversalCapture,a.nf.Connection)}}}(this,function(d,g,i,n,f,x,u,y,m,h,b,t,j){var k=[0,25,50,100,250,500,1000,2000];var p=function(z){var A=[{text:"Timer driven",value:"TIMER_DRIVEN",description:"Processor will be scheduled to run on an interval defined by the run schedule."}];if(z.supportsEventDriven===true){A.push({text:"Event driven",value:"EVENT_DRIVEN",description:"Processor will be scheduled to run when triggered by an event (e.g. a FlowFile enters an incoming queue). This scheduling strategy is experimental."})}else{if(z.config.schedulingStrategy==="EVENT_DRIVEN"){A.push({text:"Event driven",value:"EVENT_DRIVEN",description:"Processor will be scheduled to run when triggered by an event (e.g. a FlowFile enters an incoming queue). This scheduling strategy is experimental.",disabled:true})}}if(z.config.schedulingStrategy==="PRIMARY_NODE_ONLY"){A.push({text:"On primary node",value:"PRIMARY_NODE_ONLY",description:"Processor will be scheduled on the primary node on an interval defined by the run schedule. This option has been deprecated, please use the Execution setting below.",disabled:true})}A.push({text:"CRON driven",value:"CRON_DRIVEN",description:"Processor will be scheduled to run on at specific times based on the specified CRON string."});return A};var e=function(z){return[{text:"All nodes",value:"ALL",description:"Processor will be scheduled to run on all nodes",disabled:z.executionNodeRestricted===true},{text:"Primary node",value:"PRIMARY",description:"Processor will be scheduled to run only on the primary node"}]};var a=function(C,z,A){if(C.status===400){var D=C.responseText.split("\n");var B;if(D.length===1){B=d("<span></span>").text(D[0])}else{B=i.formatUnorderedList(D)}n.showOkDialog({dialogContent:B,headerText:"Processor Configuration"})}else{g.handleAjaxError(C,z,A)}};var o=function(E){var z=d('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text(E.name);var B=d('<span class="relationship-name-value hidden"></span>').text(E.name);var C=d('<div class="processor-relationship nf-checkbox"></div>');if(E.autoTerminate===true){C.addClass("checkbox-checked")}else{C.addClass("checkbox-unchecked")}var D=d('<div class="processor-relationship-container"></div>').append(C).append(z).append(B).appendTo("#auto-terminate-relationship-names");if(!i.isBlank(E.description)){var A=d('<div class="relationship-description"></div>').text(E.description);D.append(A)}return D};var w=function(){var B=d("#processor-configuration").data("processorDetails");var C=false;var D=r();d.each(B.relationships,function(F,G){if(G.autoTerminate===true){if(d.inArray(G.name,D)===-1){C=true;return false}}else{if(G.autoTerminate===false){if(d.inArray(G.name,D)>=0){C=true;return false}}}});if(C){return true}var E=d("#scheduling-strategy-combo").combo("getSelectedOption").value;if(E!==(B.config.schedulingStrategy+"")){return true}if(B.supportsParallelProcessing===true){var z;if(E==="EVENT_DRIVEN"){z=d("#event-driven-concurrently-schedulable-tasks")}else{if(E==="CRON_DRIVEN"){z=d("#cron-driven-concurrently-schedulable-tasks")}else{z=d("#timer-driven-concurrently-schedulable-tasks")}}if(z.val()!==(B.config.concurrentlySchedulableTaskCount+"")){return true}}var A;if(E==="CRON_DRIVEN"){A=d("#cron-driven-scheduling-period")}else{if(E!=="EVENT_DRIVEN"){A=d("#timer-driven-scheduling-period")}}if(i.isDefinedAndNotNull(A)&&A.val()!==(B.config.schedulingPeriod+"")){return true}if(d("#execution-node-combo").combo("getSelectedOption").value!==(B.config.executionNode+"")){return true}if(d("#processor-name").val()!==B.name){return true}if(d("#processor-enabled").hasClass("checkbox-checked")&&B.state==="DISABLED"){return true}else{if(d("#processor-enabled").hasClass("checkbox-unchecked")&&(B.state==="RUNNING"||B.state==="STOPPED")){return true}}if(d("#penalty-duration").val()!==(B.config.penaltyDuration+"")){return true}if(d("#yield-duration").val()!==(B.config.yieldDuration+"")){return true}if(d("#bulletin-level-combo").combo("getSelectedOption").value!==(B.config.bulletinLevel+"")){return true}if(d("#processor-comments").val()!==B.config.comments){return true}return d("#processor-properties").propertytable("isSaveRequired")};var l=function(B){var D={};var z=d("#scheduling-strategy-combo").combo("getSelectedOption").value;var G;if(z==="EVENT_DRIVEN"){G=d("#event-driven-concurrently-schedulable-tasks")}else{if(z==="CRON_DRIVEN"){G=d("#cron-driven-concurrently-schedulable-tasks")}else{G=d("#timer-driven-concurrently-schedulable-tasks")}}if(!G.is(":disabled")){D.concurrentlySchedulableTaskCount=G.val()}var E;if(z==="CRON_DRIVEN"){E=d("#cron-driven-scheduling-period")}else{if(z!=="EVENT_DRIVEN"){E=d("#timer-driven-scheduling-period")}}if(i.isDefinedAndNotNull(E)){D.schedulingPeriod=E.val()}D.executionNode=d("#execution-node-combo").combo("getSelectedOption").value;D.penaltyDuration=d("#penalty-duration").val();D.yieldDuration=d("#yield-duration").val();D.bulletinLevel=d("#bulletin-level-combo").combo("getSelectedOption").value;D.schedulingStrategy=z;D.comments=d("#processor-comments").val();if(B.supportsBatching===true){var A=d("#run-duration-slider").slider("value");D.runDurationMillis=k[A]}D.autoTerminatedRelationships=r();var F=d("#processor-properties").propertytable("marshalProperties");if(d.isEmptyObject(F)===false){D.properties=F}var C={};C.id=d("#processor-id").text();C.name=d("#processor-name").val();C.config=D;if(d("#processor-enabled").hasClass("checkbox-unchecked")){C.state="DISABLED"}else{if(d("#processor-enabled").hasClass("checkbox-checked")){C.state="STOPPED"}}var H={};H.component=C;return H};var r=function(){var A=d("#auto-terminate-relationship-names");var z=[];d.each(A.children(),function(B,E){var D=d(E);var C=D.children("div.processor-relationship");if(C.hasClass("checkbox-checked")){z.push(D.children("span.relationship-name-value").text())}});return z};var v=function(A){var C=[];var B=A.component;var z=B.config;if(i.isDefinedAndNotNull(z.concurrentlySchedulableTaskCount)&&!d.isNumeric(z.concurrentlySchedulableTaskCount)){C.push("Concurrent tasks must be an integer value")}if(i.isDefinedAndNotNull(z.schedulingPeriod)&&i.isBlank(z.schedulingPeriod)){C.push("Run schedule must be specified")}if(i.isBlank(z.penaltyDuration)){C.push("Penalty duration must be specified")}if(i.isBlank(z.yieldDuration)){C.push("Yield duration must be specified")}if(C.length>0){n.showOkDialog({dialogContent:i.formatUnorderedList(C),headerText:"Processor Configuration"});return false}else{return true}};var c=function(A){var z=j.getComponentConnections(A.id);d.each(z,function(C,B){if(B.permissions.canRead){if(B.sourceId===A.id){j.reload(B.id)}}})};var q=function(){return d.Deferred(function(z){d("#processor-properties").propertytable("saveRow");if(w()){n.showYesNoDialog({headerText:"Processor Configuration",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){z.resolve()},yesHandler:function(){var A=d("#processor-configuration").data("processorDetails");s(A).done(function(){z.resolve()}).fail(function(){z.reject()})}})}else{z.resolve()}}).promise()};var s=function(z){var A=l(z);if(v(A)){var B=m.get(z.id);A.revision=x.getRevision(B);A.disconnectedNodeAcknowledged=f.isDisconnectionAcknowledged();return d.ajax({type:"PUT",data:JSON.stringify(A),url:B.uri,dataType:"json",contentType:"application/json"}).done(function(C){m.set(C)}).fail(a)}else{return d.Deferred(function(C){C.reject()}).promise()}};return{init:function(){d("#processor-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"processor-standard-settings-tab-content"},{name:"Scheduling",tabContentId:"processor-scheduling-tab-content"},{name:"Properties",tabContentId:"processor-properties-tab-content"},{name:"Comments",tabContentId:"processor-comments-tab-content"}],select:function(){t.removeAllPropertyDetailDialogs();if(d(this).text()==="Properties"){d("#processor-properties").propertytable("resetTableSize")}d("#processor-properties").propertytable("saveRow");var z=d("#auto-terminate-relationship-names");if(z.is(":visible")&&z.get(0).scrollHeight>Math.round(z.innerHeight())){z.css("border-width","1px")}}});d("#processor-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Processor",handler:{close:function(){d("#auto-terminate-relationship-names").css("border-width","0").empty();d("#processor-properties").propertytable("cancelEdit").propertytable("clear");d("#processor-configuration").removeData("processorDetails")},open:function(){i.toggleScrollable(d("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});d("#bulletin-level-combo").combo({options:[{text:"DEBUG",value:"DEBUG"},{text:"INFO",value:"INFO"},{text:"WARN",value:"WARN"},{text:"ERROR",value:"ERROR"},{text:"NONE",value:"NONE"}]});d("#run-duration-slider").slider({min:0,max:k.length-1,change:function(A,B){var z=d("#processor-configuration").data("processorDetails");if(B.value>0&&(z.inputRequirement==="INPUT_FORBIDDEN"||z.inputRequirement==="INPUT_ALLOWED")){d("#run-duration-data-loss").show()}else{d("#run-duration-data-loss").hide()}}});d("#processor-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-processor-property-container",descriptorDeferred:function(z){var A=d("#processor-configuration").data("processorDetails");var B=m.get(A.id);return d.ajax({type:"GET",url:B.uri+"/descriptors",data:{propertyName:z},dataType:"json"}).fail(g.handleAjaxError)},goToServiceDeferred:q})},showConfiguration:function(A){if(u.isProcessor(A)){var B=A.datum();var z=B.component;var C=[];C.push(m.reload(z.id));C.push(d.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(z.id),dataType:"json"}));d.when.apply(window,C).done(function(L,O){var M=L[0];z=M.component;var I=O[0].componentHistory;d("#processor-configuration").data("processorDetails",z);var H="checkbox-checked";if(z.state==="DISABLED"){H="checkbox-unchecked"}d("#processor-id").text(z.id);d("#processor-type").text(i.formatType(z));d("#processor-bundle").text(i.formatBundle(z.bundle));d("#processor-name").val(z.name);d("#processor-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(H);d("#penalty-duration").val(z.config.penaltyDuration);d("#yield-duration").val(z.config.yieldDuration);d("#processor-comments").val(z.config.comments);if(z.supportsBatching===true){d("#run-duration-setting-container").show();var N=k.indexOf(z.config.runDurationMillis);d("#run-duration-slider").slider("value",N)}else{d("#run-duration-setting-container").hide()}d("#bulletin-level-combo").combo("setSelectedOption",{value:z.config.bulletinLevel});var F=z.config.schedulingStrategy;d("#scheduling-strategy-combo").combo({options:p(z),selectedOption:{value:F},select:function(Q){if(Q.value==="EVENT_DRIVEN"){d("#event-driven-warning").show();d("#timer-driven-options").hide();d("#event-driven-options").show();d("#cron-driven-options").hide()}else{d("#event-driven-warning").hide();if(Q.value==="CRON_DRIVEN"){d("#timer-driven-options").hide();d("#event-driven-options").hide();d("#cron-driven-options").show()}else{d("#timer-driven-options").show();d("#event-driven-options").hide();d("#cron-driven-options").hide()}}}});var E=z.config.executionNode;d("#execution-node-combo").combo({options:e(z),selectedOption:{value:E}});d("#execution-node-options").show();var P=z.config.defaultConcurrentTasks;d("#timer-driven-concurrently-schedulable-tasks").val(P.TIMER_DRIVEN);d("#event-driven-concurrently-schedulable-tasks").val(P.EVENT_DRIVEN);d("#cron-driven-concurrently-schedulable-tasks").val(P.CRON_DRIVEN);var K;if(F==="EVENT_DRIVEN"){K=d("#event-driven-concurrently-schedulable-tasks").val(z.config.concurrentlySchedulableTaskCount)}else{if(F==="CRON_DRIVEN"){K=d("#cron-driven-concurrently-schedulable-tasks").val(z.config.concurrentlySchedulableTaskCount)}else{K=d("#timer-driven-concurrently-schedulable-tasks").val(z.config.concurrentlySchedulableTaskCount)}}if(i.isDefinedAndNotNull(K)){if(z.supportsParallelProcessing===true){K.prop("disabled",false)}else{K.prop("disabled",true)}}var G=z.config.defaultSchedulingPeriod;d("#cron-driven-scheduling-period").val(G.CRON_DRIVEN);d("#timer-driven-scheduling-period").val(G.TIMER_DRIVEN);if(z.config.schedulingStrategy==="CRON_DRIVEN"){d("#cron-driven-scheduling-period").val(z.config.schedulingPeriod)}else{if(z.config.schedulingStrategy!=="EVENT_DRIVEN"){d("#timer-driven-scheduling-period").val(z.config.schedulingPeriod)}}if(!i.isEmpty(z.relationships)){d.each(z.relationships,function(Q,R){o(R)})}else{d("#auto-terminate-relationship-names").append('<div class="unset">This processor has no relationships.</div>')}var J=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){d("#processor-properties").propertytable("saveRow");s(z).done(function(Q){c(z);d("#processor-configuration").modal("hide");y.digest()})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){d("#processor-configuration").modal("hide")}}}];if(i.isDefinedAndNotNull(z.config.customUiUrl)&&z.config.customUiUrl!==""){J.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var Q=function(){d("#processor-configuration").modal("hide");b.showCustomUi(M,z.config.customUiUrl,true).done(function(){m.reload(z.id);c(z)})};d("#processor-properties").propertytable("saveRow");if(w()){n.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:Q,yesHandler:function(){s(z).done(function(R){Q()})}})}else{Q()}}}})}d("#processor-configuration").modal("setButtonModel",J);d("#processor-properties").propertytable("setGroupId",z.parentGroupId).propertytable("loadProperties",z.config.properties,z.config.descriptors,I.propertyHistory);d("#processor-configuration").modal("show");d("#processor-configuration div.relationship-name").ellipsis();var D=d("#auto-terminate-relationship-names");if(D.is(":visible")&&D.get(0).scrollHeight>Math.round(D.innerHeight())){D.css("border-width","1px")}}).fail(g.handleAjaxError)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.UniversalCapture","nf.Dialog","nf.ErrorHandler","nf.CustomUi","nf.ClusterSummary"],function(f,g,i,e,h,d,c){return(nf.ProcessorDetails=b(f,g,i,e,h,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessorDetails=b(require("jquery"),require("nf.Common"),require("nf.UniversalCapture"),require("nf.Dialog"),require("nf.ErrorHandler"),require("nf.CustomUi"),require("nf.ClusterSummary")))}else{nf.ProcessorDetails=b(a.$,a.nf.Common,a.nf.UniversalCapture,a.nf.Dialog,a.nf.ErrorHandler,a.nf.CustomUi,a.nf.ClusterSummary)}}}(this,function(e,f,h,d,g,c,a){var b=function(l){var i=e('<div class="relationship-name ellipsis"></div>').text(l.name);if(l.autoTerminate===true){i.css("font-weight","bold")}var k=e('<div class="processor-relationship-container"></div>').append(i).appendTo("#read-only-auto-terminate-relationship-names");if(!f.isBlank(l.description)){var j=e('<div class="relationship-description"></div>').text(l.description);k.append(j)}return k};return{init:function(i){e("#processor-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"details-standard-settings-tab-content"},{name:"Scheduling",tabContentId:"details-scheduling-tab-content"},{name:"Properties",tabContentId:"details-processor-properties-tab-content"},{name:"Comments",tabContentId:"details-processor-comments-tab-content"}],select:function(){h.removeAllPropertyDetailDialogs();if(e(this).text()==="Properties"){e("#read-only-processor-properties").propertytable("resetTableSize")}var j=e("#read-only-auto-terminate-relationship-names");if(j.is(":visible")&&j.get(0).scrollHeight>Math.round(j.innerHeight())){j.css("border-width","1px")}}});e("#processor-details").modal({headerText:"Processor Details",scrollableContentStyle:"scrollable",handler:{close:function(){e("#read-only-auto-terminate-relationship-names").css("border-width","0").empty();e("#read-only-processor-properties").propertytable("clear");f.clearField("read-only-processor-id");f.clearField("read-only-processor-type");f.clearField("read-only-processor-name");f.clearField("read-only-concurrently-schedulable-tasks");f.clearField("read-only-scheduling-period");f.clearField("read-only-penalty-duration");f.clearField("read-only-yield-duration");f.clearField("read-only-run-duration");f.clearField("read-only-bulletin-level");f.clearField("read-only-execution-node");f.clearField("read-only-execution-status");f.clearField("read-only-processor-comments");e("#processor-details").removeData("processorDetails");e("#processor-details").removeData("processorHistory")},open:function(){f.toggleScrollable(e("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});e("#read-only-processor-properties").propertytable({supportsGoTo:i,readOnly:true})},showDetails:function(k,l){var j=e.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(l),dataType:"json"}).done(function(n){if(f.isDefinedAndNotNull(n.component)){var o=n.component;e("#processor-details").data("processorDetails",o);f.populateField("read-only-processor-id",o.id);f.populateField("read-only-processor-type",f.formatType(o));f.populateField("read-only-processor-bundle",f.formatBundle(o.bundle));f.populateField("read-only-processor-name",o.name);f.populateField("read-only-concurrently-schedulable-tasks",o.config.concurrentlySchedulableTaskCount);f.populateField("read-only-scheduling-period",o.config.schedulingPeriod);f.populateField("read-only-penalty-duration",o.config.penaltyDuration);f.populateField("read-only-yield-duration",o.config.yieldDuration);f.populateField("read-only-run-duration",f.formatDuration(o.config.runDurationMillis));f.populateField("read-only-bulletin-level",o.config.bulletinLevel);f.populateField("read-only-processor-comments",o.config.comments);var m=true;var q=o.config.schedulingStrategy;if(q==="EVENT_DRIVEN"){m=false;q="Event driven"}else{if(q==="CRON_DRIVEN"){q="CRON driven"}else{if(q==="TIMER_DRIVEN"){q="Timer driven"}else{q="On primary node"}}}f.populateField("read-only-scheduling-strategy",q);if(m===true){e("#read-only-run-schedule").show()}else{e("#read-only-run-schedule").hide()}var p=o.config.executionNode;if(p==="ALL"){p="All nodes"}else{if(p==="PRIMARY"){p="Primary node only"}}f.populateField("read-only-execution-node",p);e("#read-only-execution-node-options").show();if(!f.isEmpty(o.relationships)){e.each(o.relationships,function(r,s){b(s)})}else{e("#read-only-auto-terminate-relationship-names").append('<div class="unset">This processor has no relationships.</div>')}}});var i=e.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(l),dataType:"json"}).done(function(m){var n=m.componentHistory;e("#processor-details").data("processorHistory",n)});e.when(j,i).done(function(t,o){var q=t[0];var n=q.component;var m=o[0];var s=m.componentHistory;e("#read-only-processor-properties").propertytable("loadProperties",n.config.properties,n.config.descriptors,s.propertyHistory);var p=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#processor-details").modal("hide")}}}];if(top===window&&f.isDefinedAndNotNull(c)&&f.isDefinedAndNotNull(n.config.customUiUrl)&&n.config.customUiUrl!==""){p.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#processor-details").modal("hide");c.showCustomUi(q,n.config.customUiUrl,false)}}})}e("#processor-details").modal("setButtonModel",p).modal("show");e("#processor-details div.relationship-name").ellipsis();var r=e("#read-only-auto-terminate-relationship-names");if(r.is(":visible")&&r.get(0).scrollHeight>Math.round(r.innerHeight())){r.css("border-width","1px")}}).fail(function(o,m,n){if(o.status===400||o.status===404||o.status===409){d.showOkDialog({headerText:"Error",dialogContent:f.escapeHtml(o.responseText)})}else{g.handleAjaxError(o,m,n)}})}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage","nf.ErrorHandler","nf.Common","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Label"],function(f,j,g,i,c,k,d,h,e){return(nf.LabelConfiguration=b(f,j,g,i,c,k,d,h,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.LabelConfiguration=b(require("jquery"),require("d3"),require("nf.Storage"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Label")))}else{nf.LabelConfiguration=b(a.$,a.d3,a.nf.Storage,a.nf.ErrorHandler,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Label)}}}(this,function(e,i,f,h,b,j,c,g,d){var a="";return{init:function(){e("#label-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Label",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var o=i.select("#id-"+a).datum();var n=e("#label-value").val();var p=e("#label-font-size").combo("getSelectedOption");var m={revision:j.getRevision(o),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{id:a,label:n,style:{"font-size":p.value}}};e.ajax({type:"PUT",url:o.uri,data:JSON.stringify(m),dataType:"json",contentType:"application/json"}).done(function(q){d.set(q);g.digest()}).fail(h.handleAjaxError);this.modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){a=""},open:function(){e("#label-value").focus()}}});var l=[];for(var k=12;k<=24;k+=2){l.push({text:k+"px",value:k+"px"})}e("#label-font-size").combo({options:l,selectedOption:{value:"12px"},select:function(n){var m=e("#label-value");m.css({"font-size":n.value,"line-height":n.value}).val(m.val())}})},showConfiguration:function(l){if(c.isLabel(l)){var n=l.datum();var k="";if(b.isDefinedAndNotNull(n.component.label)){k=n.component.label}var m="12px";if(b.isDefinedAndNotNull(n.component.style["font-size"])){m=n.component.style["font-size"]}a=n.id;e("#label-value").val(k);e("#label-font-size").combo("setSelectedOption",{value:m});e("#label-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Port"],function(g,k,j,c,e,h,l,d,i,f){return(nf.PortConfiguration=b(g,k,j,c,e,h,l,d,i,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PortConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Port")))}else{nf.PortConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Port)}}}(this,function(f,j,i,b,d,g,k,c,h,e){var a=function(){f("#port-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Port",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var o=f("#port-id").text();var m=j.select("#id-"+o).datum();var l={id:o,name:f("#port-name").val(),comments:f("#port-comments").val()};if(f("#port-concurrent-task-container").is(":visible")){l.concurrentlySchedulableTaskCount=f("#port-concurrent-tasks").val()}if(f("#port-enabled").hasClass("checkbox-unchecked")){l.state="DISABLED"}else{if(f("#port-enabled").hasClass("checkbox-checked")){l.state="STOPPED"}}var n={revision:k.getRevision(m),disconnectedNodeAcknowledged:g.isDisconnectionAcknowledged(),component:l};f.ajax({type:"PUT",data:JSON.stringify(n),url:m.uri,dataType:"json",contentType:"application/json"}).done(function(p){e.set(p);h.digest();f("#port-configuration").modal("hide")}).fail(function(s,p,q){if(s.status===400){var t=s.responseText.split("\n");var r;if(t.length===1){r=f("<span></span>").text(t[0])}else{r=b.formatUnorderedList(t)}d.showOkDialog({dialogContent:r,headerText:"Port Configuration"})}else{f("#port-configuration").modal("hide");i.handleAjaxError(s,p,q)}})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#port-configuration").modal("hide")}}}],handler:{close:function(){f("#port-id").text("");f("#port-name").val("");f("#port-enabled").removeClass("checkbox-unchecked checkbox-checked");f("#port-concurrent-tasks").val("");f("#port-comments").val("")}}})};return{init:function(){a()},showConfiguration:function(m){if(c.isInputPort(m)||c.isOutputPort(m)){var n=m.datum();var l="checkbox-checked";if(n.component.state==="DISABLED"){l="checkbox-unchecked"}if(c.getParentGroupId()===null){f("#port-concurrent-task-container").show()}else{f("#port-concurrent-task-container").hide()}f("#port-id").text(n.id);f("#port-name").val(n.component.name);f("#port-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(l);f("#port-concurrent-tasks").val(n.component.concurrentlySchedulableTaskCount);f("#port-comments").val(n.component.comments);f("#port-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.CanvasUtils"],function(d,e,c){return(nf.PortDetails=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PortDetails=b(require("jquery"),require("nf.Common"),require("nf.CanvasUtils")))}else{nf.PortDetails=b(a.$,a.nf.Common,a.nf.CanvasUtils)}}}(this,function(b,c,a){return{init:function(){b("#port-details").modal({scrollableContentStyle:"scrollable",headerText:"Port Details",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#port-details").modal("hide")}}}],handler:{close:function(){c.clearField("read-only-port-name");c.clearField("read-only-port-id");c.clearField("read-only-port-comments")}}})},showDetails:function(d){if(a.isInputPort(d)||a.isOutputPort(d)){var e=d.datum();c.populateField("read-only-port-name",e.component.name);c.populateField("read-only-port-id",e.id);c.populateField("read-only-port-comments",e.component.comments);b("#port-details").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.ProcessGroup","nf.Shell","nf.CanvasUtils"],function(h,k,j,f,g,i,l,c,d,e){return(nf.ProcessGroupConfiguration=b(h,k,j,f,g,i,l,c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessGroupConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ProcessGroup"),require("nf.Shell"),require("nf.CanvasUtils")))}else{nf.ProcessGroupConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ProcessGroup,a.nf.Shell,a.nf.CanvasUtils)}}}(this,function(d,r,f,h,j,e,s,g,p,m){var c;var q={urls:{api:"../nifi-api"}};var k=function(){};var b=function(){return d("#process-group-controller-services-table")};var a=function(t,v){var u={revision:s.getRevision({revision:{version:t}}),disconnectedNodeAcknowledged:e.isDisconnectionAcknowledged(),component:{id:v,name:d("#process-group-name").val(),comments:d("#process-group-comments").val()}};d.ajax({type:"PUT",data:JSON.stringify(u),url:q.urls.api+"/process-groups/"+encodeURIComponent(v),dataType:"json",contentType:"application/json"}).done(function(w){if(w.permissions.canRead&&w.component.parentGroupId===m.getGroupId()){g.set(w)}j.showOkDialog({headerText:"Process Group Configuration",dialogContent:"Process group configuration successfully saved."});d("#process-group-configuration-save").off("click").on("click",function(){a(w.revision.version,v)});m.reload()}).fail(f.handleAjaxError)};var l=function(v){var y=function(){d("#read-only-process-group-name").addClass("unset").text("Unauthorized");d("#read-only-process-group-comments").addClass("unset").text("Unauthorized")};var x=function(z){if(z){d("#process-group-configuration div.editable").show();d("#process-group-configuration div.read-only").hide();d("#process-group-configuration-save").show()}else{d("#process-group-configuration div.editable").hide();d("#process-group-configuration div.read-only").show();d("#process-group-configuration-save").hide()}};d("#process-group-id").text(v);d("#process-group-configuration-refresh-button").off("click").on("click",function(){l(v)});d("#add-process-group-configuration-controller-service").off("click").on("click",function(){var A=d("#process-group-configuration-tabs li.selected-tab").text();if(A==="Controller Services"){var z=q.urls.api+"/process-groups/"+encodeURIComponent(v)+"/controller-services";c.promptNewControllerService(z,b())}});var w=d.Deferred(function(z){d.ajax({type:"GET",url:q.urls.api+"/process-groups/"+encodeURIComponent(v),dataType:"json"}).done(function(A){d("#process-group-configuration").data("process-group",A);var B=A.component;if(A.permissions.canWrite){d("#process-group-name").removeClass("unset").val(B.name);d("#process-group-comments").removeClass("unset").val(B.comments);d("#process-group-configuration-header-text").text(B.name+" Configuration");x(true);d("#process-group-configuration-save").off("click").on("click",function(){a(A.revision.version,A.id)})}else{if(A.permissions.canRead){d("#read-only-process-group-name").removeClass("unset").text(B.name);d("#read-only-process-group-comments").removeClass("unset").text(B.comments);d("#process-group-configuration-header-text").text(B.name+" Configuration")}else{y()}x(false)}z.resolve()}).fail(function(C,A,B){if(C.status===403){if(v===m.getGroupId()){d("#process-group-configuration").data("process-group",{permissions:{canRead:false,canWrite:m.canWriteCurrentGroup()}})}else{d("#process-group-configuration").data("process-group",g.get(v))}y();x(false);z.resolve()}else{z.reject(C,A,B)}})}).promise();var t=q.urls.api+"/flow/process-groups/"+encodeURIComponent(v)+"/controller-services";var u=c.loadControllerServices(t,b());return d.when(w,u).done(function(B,A){var z=A[0];d("#process-group-configuration-last-refreshed").text(z.currentTime)}).fail(f.handleAjaxError)};var n=function(){p.showContent("#process-group-configuration").done(function(){o()});d("#process-group-configuration-tabs").find(".selected-tab").click();i.resetTableSize()};var o=function(){d("#process-group-configuration").removeData("process-group");d("#process-group-configuration-save").mouseout();d("#process-group-id").text("");d("#process-group-name").val("");d("#process-group-comments").val("");d("#process-group-configuration-header-text").text("Process Group Configuration")};var i={init:function(t){c=t;d("#process-group-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-process-group-configuration-tab-content"},{name:"Controller Services",tabContentId:"process-group-controller-services-tab-content"}],select:function(){var v=d("#process-group-configuration").data("process-group");var w=h.isDefinedAndNotNull(v)?v.permissions.canWrite:false;var u=d(this).text();if(u==="General"){d("#flow-cs-availability").hide();d("#add-process-group-configuration-controller-service").hide();if(w){d("#process-group-configuration-save").show()}else{d("#process-group-configuration-save").hide()}}else{d("#flow-cs-availability").show();d("#process-group-configuration-save").hide();if(w){d("#add-process-group-configuration-controller-service").show();d("#process-group-controller-services-tab-content").css("top","32px")}else{d("#add-process-group-configuration-controller-service").hide();d("#process-group-controller-services-tab-content").css("top","0")}i.resetTableSize()}}});k();c.init(b())},resetTableSize:function(){c.resetTableSize(b())},showConfiguration:function(t){return l(t).done(n)},loadConfiguration:function(t){return l(t)},selectControllerService:function(t){var u=b().data("gridInstance");var v=u.getData();var w=v.getRowById(t);u.setSelectedRows([w]);u.scrollRowIntoView(w);d("#process-group-configuration-tabs").find("li:eq(1)").click()}};return i}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","Slick","nf.Canvas","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Storage","nf.Client","nf.Common","nf.ng.Bridge","nf.Processor","nf.ProcessGroup","nf.ProcessGroupConfiguration"],function(i,p,f,n,g,m,h,j,o,e,k,l,c,d){return(nf.ComponentState=b(i,p,f,n,g,m,h,j,o,e,k,l,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ComponentState=b(require("jquery"),require("d3"),require("Slick"),require("nf.Canvas"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.Common"),require("nf.ng.Bridge"),require("nf.Processor"),require("nf.ProcessGroup"),require("nf.ProcessGroupConfiguration")))}else{nf.VariableRegistry=b(a.$,a.d3,a.Slick,a.nf.Canvas,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.Common,a.nf.ng.Bridge,a.nf.Processor,a.nf.ProcessGroup,a.nf.ProcessGroupConfiguration)}}}(this,function(A,I,b,v,K,e,h,t,g,H,o,s,y,B){var D=null;var i=function(Q){var R=this;var N="";var O;var T;var S;var P;this.init=function(){var V=A("body");O=Q.item[Q.column.field];T=A("<div></div>").addClass("slickgrid-editor").css({"z-index":100000,position:"absolute","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",overflow:"hidden",padding:"10px 20px",cursor:"move",transform:"translate3d(0px, 0px, 0px)"}).appendTo(V);P=A('<textarea hidefocus rows="5"/>').css({height:"80px",width:Q.position.width+"px","min-width":"212px","margin-bottom":"5px","margin-top":"10px","white-space":"pre"}).tab().on("keydown",R.handleKeyDown).appendTo(T);T.draggable({cancel:".button, textarea, .nf-checkbox",containment:"parent"});var U=A('<div class="string-check-container">');U.appendTo(T);S=A('<div class="nf-checkbox string-check"/>').appendTo(U);A('<span class="string-check-label nf-checkbox-label">&nbsp;Set empty string</span>').appendTo(U);var W=A('<div class="button">Ok</div>').css({color:"#fff",background:"#728E9B"}).hover(function(){A(this).css("background","#004849")},function(){A(this).css("background","#728E9B")}).on("click",R.save);var X=A('<div class="secondary-button">Cancel</div>').css({color:"#004849",background:"#E3E8EB"}).hover(function(){A(this).css("background","#C7D2D7")},function(){A(this).css("background","#E3E8EB")}).on("click",R.cancel);A("<div></div>").css({position:"relative",top:"10px",left:"20px",width:"212px",clear:"both","float":"right"}).append(W).append(X).append('<div class="clear"></div>').appendTo(T);R.position(Q.position);P.focus().select()};this.handleKeyDown=function(U){if(U.which===A.ui.keyCode.ENTER&&!U.shiftKey){R.save()}else{if(U.which===A.ui.keyCode.ESCAPE){R.cancel();U.stopImmediatePropagation();U.preventDefault()}}};this.save=function(){Q.commitChanges()};this.cancel=function(){P.val(N);Q.cancelChanges()};this.hide=function(){T.hide()};this.show=function(){T.show()};this.position=function(U){T.css({top:U.top-27,left:U.left-20})};this.destroy=function(){T.remove()};this.focus=function(){P.focus()};this.loadValue=function(V){var W=false;if(H.isDefinedAndNotNull(V[Q.column.field])){N=V[Q.column.field];W=N===""}var U=W?"checkbox-checked":"checkbox-unchecked";S.addClass(U);P.val(N);P.select()};this.serializeValue=function(){if(P.val()===""){if(S.hasClass("checkbox-checked")){return""}else{return null}}else{return P.val()}};this.applyValue=function(U,V){U[Q.column.field]=V};this.isValueChanged=function(){return R.serializeValue()!==O};this.validate=function(){return{valid:true,msg:null}};this.init()};var k=function(P,T,V,U){var Q=A(T.getCellNode(V,U));var R=Q.offset();var N=A('<div class="property-detail"></div>').css({"z-index":1999,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)",top:R.top-26,left:R.left-20}).draggable({containment:"parent"}).appendTo("body");A('<textarea hidefocus rows="5" readonly="readonly"/>').css({height:"80px",resize:"both",width:Q.width()+"px",margin:"10px 0px","white-space":"pre"}).text(P.value).on("keydown",function(W){if(W.which===A.ui.keyCode.ESCAPE){O();W.stopImmediatePropagation();W.preventDefault()}}).appendTo(N);var O=function(){N.hide().remove()};var S=A('<div class="button">Ok</div>').css({position:"relative",top:"10px",left:"20px"}).hover(function(){A(this).css("background","#004849")},function(){A(this).css("background","#728E9B")}).on("click",function(){O()});A("<div></div>").append(S).append('<div class="clear"></div>').appendTo(N)};var z={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,editable:true,enableAddRow:false,autoEdit:false,multiSelect:false,rowHeight:24};var m=function(N){var Q=K.getSelection();if(Q.empty()===false){var R=Q.datum();if(R.id===N){if(R.permissions.canRead){return H.escapeHtml(R.component.name)}else{return H.escapeHtml(R.id)}}}var O=o.injector.get("breadcrumbsCtrl").getBreadcrumbs();var P=N;A.each(O,function(S,T){if(T.id===N){P=T.label;return false}});return P};var a=function(){var P=A("#variable-registry-table");var R=function(Z,W,Y,X,V){return H.escapeHtml(Y)};var O=function(Z,W,Y,X,V){if(V.isOverridden){return'<div class="overridden" title="This value has been overridden by another variable in a descendant Process Group">'+H.escapeHtml(Y)+"</div>"}else{if(Y===""){return'<span class="table-cell blank">Empty string set</span>'}else{if(Y===null){return'<span class="unset">No value set</span>'}else{return H.escapeHtml(Y)}}}};var U=function(Z,W,Y,X,V){if(H.isDefinedAndNotNull(Y)){return H.escapeHtml(m(Y))}else{return"Controller"}};var Q=function(ab,W,aa,Z,V){var Y="";if(V.isEditable===true){Y+='<div title="Delete" class="delete-variable pointer fa fa-trash"></div>'}else{var X=A("#variable-registry-process-group-id").text();if(V.processGroupId!==X){Y+='<div title="Go To" class="go-to-variable pointer fa fa-long-arrow-right"></div>'}}return Y};var S=[{id:"scope",name:"Scope",field:"processGroupId",formatter:U,sortable:true,resizable:true},{id:"name",name:"Name",field:"name",formatter:R,sortable:true,resizable:true},{id:"value",name:"Value",field:"value",formatter:O,sortable:true,resizable:true,cssClass:"pointer"},{id:"actions",name:"&nbsp;",resizable:false,formatter:Q,sortable:false,width:45,maxWidth:45}];var N=new b.Data.DataView({inlineFilters:false});N.setFilterArgs({searchString:"",property:"hidden"});N.setFilter(function(W,V){return W.hidden===false});N.getItemMetadata=function(V){return{columns:{value:{editor:i}}}};M({columnId:"name",sortAsc:true},N);var T=new b.Grid(P,N,S,z);T.setSelectionModel(new b.RowSelectionModel());T.registerPlugin(new b.AutoTooltips());T.setSortColumn("name",true);T.onSort.subscribe(function(W,V){M({columnId:V.sortCol.id,sortAsc:V.sortAsc},N)});T.onClick.subscribe(function(Z,W){var V=N.getItem(W.row);if(T.getColumns()[W.cell].id==="value"){if(V.isEditable===true){T.gotoCell(W.row,W.cell,true)}else{T.setSelectedRows([W.row]);k(V,T,W.row,W.cell)}Z.stopImmediatePropagation()}else{if(T.getColumns()[W.cell].id==="actions"){var Y=A(Z.target);if(Y.hasClass("delete-variable")){N.updateItem(V.id,A.extend(V,{hidden:true}));var aa=N.getItems();A.each(aa,function(ab,ac){if(ac.isOverridden===true&&!f(aa,ac)){N.updateItem(ac.id,A.extend(ac,{isOverridden:false}))}});var X=T.getSelectedRows();if(X.length===0){T.setSelectedRows([0])}Z.stopImmediatePropagation()}else{if(Y.hasClass("go-to-variable")){w().done(function(){var ab=o.injector.get("breadcrumbsCtrl").getBreadcrumbs();A.each(ab,function(ac,ad){if(ad.id===V.processGroupId){if(H.isDefinedAndNotNull(ad.parentBreadcrumb)){K.showComponent(ad.parentBreadcrumb.id,ad.id).done(function(){setTimeout(function(){x(V.processGroupId,V.name)},500)})}else{K.getComponentByType("ProcessGroup").enterGroup(ad.id).done(function(){setTimeout(function(){x(V.processGroupId,V.name)},500)})}return false}})})}}}}});T.onSelectedRowsChanged.subscribe(function(X,W){if(A.isArray(W.rows)&&W.rows.length===1){if(T.getDataLength()>0){var Y=W.rows[0];var V=T.getDataItem(Y);if(D===null||D!==V.id){A("#affected-components-context").removeClass("unset").text(V.name);E(V.affectedComponents);D=V.id}}}});T.onBeforeCellEditorDestroy.subscribe(function(W,V){setTimeout(function(){T.resizeCanvas()},50)});N.onRowCountChanged.subscribe(function(W,V){T.updateRowCount();T.render()});N.onRowsChanged.subscribe(function(W,V){T.invalidateRows(V.rows);T.render()});N.syncGridSelection(T,true);P.data("gridInstance",T)};var w=function(){var O=A("#variable-registry-table").data("gridInstance");if(H.isDefinedAndNotNull(O)){var N=O.getEditController();N.commitCurrentEdit()}return A.Deferred(function(P){if(A("#variable-update-status").is(":visible")){F();P.resolve()}else{var Q=n();if(A.isEmptyObject(Q)){F();P.resolve()}else{h.showYesNoDialog({headerText:"Variables",dialogContent:"Save changes before leaving variable configuration?",noHandler:function(){F();P.resolve()},yesHandler:function(){L().done(function(){P.resolve()}).fail(function(){P.reject()})}})}}}).promise()};var M=function(N,P){var O=function(S,Q){if(N.columnId==="scope"){var V=H.isDefinedAndNotNull(S.processGroupId)?m(S.processGroupId):"";var U=H.isDefinedAndNotNull(Q.processGroupId)?m(Q.processGroupId):"";return V===U?0:V>U?1:-1}else{var R=H.isDefinedAndNotNull(S[N.columnId])?S[N.columnId]:"";var T=H.isDefinedAndNotNull(Q[N.columnId])?Q[N.columnId]:"";return R===T?0:R>T?1:-1}};P.sort(O,N.sortAsc)};var J=function(O,N){return O.component.name.localeCompare(N.component.name)};var p=function(O,N){var Q=A('<li class="affected-component-container"></li>').appendTo(N);var P=O.component;A('<div class="referencing-component-state"></div>').addClass(function(){if(H.isDefinedAndNotNull(P.state)){var R=A(this);var T=P.state.toLowerCase();if(T==="stopped"&&!H.isEmpty(P.validationErrors)){T="invalid";var S=H.formatUnorderedList(P.validationErrors);R.qtip(A.extend({},K.config.systemTooltipConfig,{content:S}))}return T}else{return""}}).appendTo(Q);A('<span class="referencing-component-name link"></span>').text(P.name).on("click",function(){w().done(function(){K.showComponent(P.processGroupId,P.id)})}).appendTo(Q);A('<div class="referencing-component-bulletins"></div>').addClass(P.id+"-affected-bulletins").appendTo(Q);A('<span class="referencing-component-active-thread-count"></span>').text(function(){if(H.isDefinedAndNotNull(P.activeThreadCount)&&P.activeThreadCount>0){return"("+P.activeThreadCount+")"}else{return""}}).appendTo(Q)};var d=function(P,O){var Q=A('<li class="affected-component-container"></li>').appendTo(O);var N=P.component;A('<div class="referencing-component-state"></div>').addClass(function(){if(H.isDefinedAndNotNull(N.state)){var R=A(this);var T=N.state==="ENABLED"?"enabled":"disabled";if(T==="disabled"&&!H.isEmpty(N.validationErrors)){T="invalid";var S=H.formatUnorderedList(N.validationErrors);R.qtip(A.extend({},K.config.systemTooltipConfig,{content:S}))}return T}else{return""}}).appendTo(Q);A('<div class="referencing-component-bulletins"></div>').addClass(N.id+"-affected-bulletins").appendTo(Q);A('<span class="referencing-component-name link"></span>').text(N.name).on("click",function(){w().done(function(){B.showConfiguration(N.processGroupId).done(function(){B.selectControllerService(N.id)})})}).appendTo(Q)};var E=function(R){var O=[];var P=[];var N=[];var U=A("#variable-registry-affected-processors");H.cleanUpTooltips(U,"div.referencing-component-state");H.cleanUpTooltips(U,"div.referencing-component-bulletins");U.empty();var T=A("#variable-registry-affected-controller-services");H.cleanUpTooltips(T,"div.referencing-component-state");H.cleanUpTooltips(T,"div.referencing-component-bulletins");T.empty();var Q=A("#variable-registry-affected-unauthorized-components").empty();if(H.isUndefined(R)){A('<li class="affected-component-container"><span class="unset">Pending Apply</span></li>').appendTo(U);A('<li class="affected-component-container"><span class="unset">Pending Apply</span></li>').appendTo(T);A('<li class="affected-component-container"><span class="unset">Pending Apply</span></li>').appendTo(Q)}else{var S=[];A.each(R,function(V,W){if(W.permissions.canRead===true&&W.permissions.canWrite===true){S.push(W.id);if(W.component.referenceType==="PROCESSOR"){O.push(W)}else{P.push(W)}}else{if(W.permissions.canRead===true){S.push(W.id)}N.push(W)}});if(O.length===0){A('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(U)}else{O.sort(J);A.each(O,function(V,W){p(W,U)})}if(P.length===0){A('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(T)}else{P.sort(J);A.each(P,function(V,W){d(W,T)})}if(N.length===0){A('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(Q)}else{N.sort(function(W,V){if(W.permissions.canRead===true&&V.permissions.canRead===true){var X=W.component.referenceType===V.component.referenceType?0:W.component.referenceType>V.component.referenceType?-1:1;if(X===0){X=W.component.name===V.component.name?0:W.component.name>V.component.name?1:-1}return X}else{if(W.permissions.canRead===false&&V.permissions.canRead===false){return W.id>V.id?1:-1}else{if(W.permissions.canRead===true){return -1}else{return 1}}}});A.each(N,function(X,V){if(V.permissions.canRead===true){if(V.component.referenceType==="PROCESSOR"){p(V,Q)}else{d(V,Q)}}else{var W=A('<li class="affected-component-container"></li>').appendTo(Q);A('<span class="unset"></span>').text(V.id).appendTo(W)}})}if(S.length>0){K.queryBulletins(S).done(function(W){var X=W.bulletinBoard.bulletins;var V=I.nest().key(function(Y){return Y.sourceId}).map(X,I.map);V.each(function(Y,Z){A("div."+Z+"-affected-bulletins").each(function(){var ab=A(this);if(Y.length>0){var aa=H.getFormattedBulletins(Y);var ac=H.formatUnorderedList(aa);ab.addClass("has-bulletins").show().qtip(A.extend({},K.config.systemTooltipConfig,{content:ac}))}})})})}}};var x=function(N,O){return A.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(N)+"/variable-registry",dataType:"json"}).done(function(P){A("#process-group-variable-registry").text(m(N));A("#variable-registry-process-group-id").text(N).data("revision",P.processGroupRevision);l(P.variableRegistry,O);A("#variable-registry-dialog").modal("show")}).fail(e.handleAjaxError)};var f=function(T,S){var R=[];A.each(T,function(V,U){if(S.name===U.name&&U.hidden===false){R.push(U)}});var Q=false;if(R.length>1){var P=[];var O=o.injector.get("breadcrumbsCtrl").getBreadcrumbs();A.each(O,function(U,V){P.push(V.id)});var N=A("#variable-registry-process-group-id").text();if(P.indexOf(N)===-1){P.push(N)}A.each(P,function(V,U){for(var W=0;W<R.length;W++){if(U===R[W].processGroupId){if(S===R[W]){Q=true}R.splice(W,1);if(R.length===1){return false}}}})}return Q};var c=function(P){if(P.canWrite===true){var O=A("#variable-registry-process-group-id").text();if(P.processGroupId===O){var Q=K.getSelection();if(Q.empty()===false&&nf.CanvasUtils.isProcessGroup(Q)){var S=Q.datum();if(S.id===O){return S.permissions.canWrite===true}}var R=false;var N=o.injector.get("breadcrumbsCtrl").getBreadcrumbs();A.each(N,function(T,U){if(U.id===O){R=U.permissions.canWrite===true;return false}});return R}}return false};var l=function(Q,T){if(H.isDefinedAndNotNull(Q)){var R=0;var S=0;var U=A("#variable-registry-table").data("gridInstance");var O=U.getData();O.beginUpdate();var V=[];A.each(Q.variables,function(Z,X){var Y=X.variable;V.push({id:R++,hidden:false,canWrite:X.canWrite,name:Y.name,value:Y.value,previousValue:Y.value,processGroupId:Y.processGroupId,affectedComponents:Y.affectedComponents})});A.each(V,function(Y,X){O.addItem(A.extend({isOverridden:f(V,X),isEditable:c(X)},X))});O.endUpdate();O.reSort();if(H.isDefinedAndNotNull(T)){A.each(V,function(Y,X){if(Q.processGroupId===X.processGroupId&&X.name===T){S=O.getRowById(X.id)}})}if(V.length===0){var N=A("#variable-registry-affected-processors");H.cleanUpTooltips(N,"div.referencing-component-state");H.cleanUpTooltips(N,"div.referencing-component-bulletins");N.empty();var W=A("#variable-registry-affected-controller-services");H.cleanUpTooltips(W,"div.referencing-component-state");H.cleanUpTooltips(W,"div.referencing-component-bulletins");W.empty();var P=A("#variable-registry-affected-unauthorized-components").empty();A('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(N);A('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(W);A('<li class="affected-component-container"><span class="unset">None</span></li>').appendTo(P);A("#affected-components-context").addClass("unset").text("None")}else{U.setSelectedRows([S])}}};var q=function(Q,P,O){var N=A("#variable-update-steps").empty();A.each(Q,function(T,S){var R=A("<li></li>").text(S.description).appendTo(N);A('<div class="variable-step"></div>').addClass(function(){if(H.isDefinedAndNotNull(S.failureReason)){return"ajax-error"}else{if(S.complete===true){return"ajax-complete"}else{return P===true||O===true?"ajax-error":"ajax-loading"}}}).appendTo(R);A('<div class="clear"></div>').appendTo(R)})};var L=function(){var P=n();if(P.length===0){F();return}var O=P.map(function(Q){return Q.variable.name});A("#affected-components-context").removeClass("unset").text(O.join(", "));var N=A("#variable-registry-process-group-id").text();return A.Deferred(function(Q){var T=function(){A("#variable-registry-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){Q.resolve();F()}}}])};var R=false;A("#variable-registry-dialog").modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){R=true;T()}}}]);var U;var S=function(X,V,W){if(H.isDefinedAndNotNull(U)){G(N,U)}A("#variable-update-steps").find("div.variable-step.ajax-loading").removeClass("ajax-loading").addClass("ajax-error");T()};u(N,P).done(function(V){var W=function(Z){var Y=Z.request;var X=H.isDefinedAndNotNull(Y.failureReason);U=Y.requestId;E(Y.affectedComponents);q(Y.updateSteps,R,X);if(R){G(Y.processGroupId,U)}else{if(Y.complete===true){if(X){h.showOkDialog({headerText:"Variable Update Error",dialogContent:"Unable to complete variable update request: "+H.escapeHtml(Y.failureReason)})}A.each(Y.affectedComponents,function(aa,ac){if(ac.permissions.canRead===true){var ab=ac.component;if(ab.referenceType==="PROCESSOR"&&K.getGroupId()===ab.processGroupId){s.reload(ab.id)}}});if(K.getGroupId()!==Y.processGroupId){y.reload(Y.processGroupId)}G(Y.processGroupId,U);T()}else{setTimeout(function(){r(Y.processGroupId,U).done(function(aa){W(aa)}).fail(S)},2000)}}};A("#variable-registry-table, #add-variable").hide();A("#variable-update-status").show();W(V)}).fail(S)}).promise()};var u=function(N,Q){var P=A("#variable-registry-process-group-id").data("revision");var O={processGroupRevision:g.getRevision({revision:{version:P.version}}),disconnectedNodeAcknowledged:t.isDisconnectionAcknowledged(),variableRegistry:{processGroupId:N,variables:Q}};return A.ajax({type:"POST",data:JSON.stringify(O),url:"../nifi-api/process-groups/"+encodeURIComponent(N)+"/variable-registry/update-requests",dataType:"json",contentType:"application/json"}).fail(e.handleAjaxError)};var r=function(N,O){return A.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(N)+"/variable-registry/update-requests/"+encodeURIComponent(O),dataType:"json"}).fail(e.handleAjaxError)};var G=function(N,O){return A.ajax({type:"DELETE",url:"../nifi-api/process-groups/"+encodeURIComponent(N)+"/variable-registry/update-requests/"+encodeURIComponent(O)+"?"+A.param({disconnectedNodeAcknowledged:t.isDisconnectionAcknowledged()}),dataType:"json"}).fail(e.handleAjaxError)};var n=function(){var P=[];var O=A("#variable-registry-table").data("gridInstance");var N=O.getData();A.each(N.getItems(),function(){var R={name:this.name};var Q=false;if(this.hidden===true&&this.previousValue!==null){R.value=null;Q=true}else{if(this.value!==this.previousValue){R.value=this.value;Q=true}}if(Q){P.push({variable:R})}});return P};var C=function(){var V=A("#variable-registry-process-group-id").text();var T=A.trim(A("#new-variable-name").val());if(T!==""){var S=A("#variable-registry-table").data("gridInstance");var P=S.getData();var Q=[];var W=null;A.each(P.getItems(),function(X,Y){if(T===Y.name){if(V===Y.processGroupId){W=Y}else{Q.push(Y)}}});if(W===null){var O=P.getLength();P.addItem({id:O,hidden:false,canWrite:true,name:T,value:null,previousValue:null,processGroupId:V,isEditable:true,isOverridden:false});A.each(Q,function(X,Y){P.updateItem(Y.id,A.extend(Y,{isOverridden:true}))});P.reSort();var U=P.getRowById(O);S.setActiveCell(U,S.getColumnIndex("value"));S.editActiveCell()}else{if(W.hidden===true){P.updateItem(W.id,A.extend(W,{hidden:false,value:null}));var R=P.getRowById(W.id);S.setActiveCell(R,S.getColumnIndex("value"));S.editActiveCell()}else{h.showOkDialog({headerText:"Variable Exists",dialogContent:"A variable with this name already exists."});var N=P.getRowById(W.id);S.setSelectedRows([N]);S.scrollRowIntoView(N)}}}else{h.showOkDialog({headerText:"Variable Name",dialogContent:"Variable name must be specified."})}A("#new-variable-dialog").modal("hide")};var F=function(){A("#variable-registry-dialog").modal("hide")};var j=function(){A("#variable-registry-table, #add-variable").show();A("#variable-update-status").hide();A("#process-group-variable-registry").text("");A("#variable-registry-process-group-id").text("").removeData("revision");A("#affected-components-context").removeClass("unset").text("");var Q=A("#variable-registry-table").data("gridInstance");var N=Q.getData();N.setItems([]);var P=A("#variable-registry-affected-processors");H.cleanUpTooltips(P,"div.referencing-component-state");H.cleanUpTooltips(P,"div.referencing-component-bulletins");P.empty();var O=A("#variable-registry-affected-controller-services");H.cleanUpTooltips(O,"div.referencing-component-state");H.cleanUpTooltips(O,"div.referencing-component-bulletins");O.empty();A("#variable-registry-affected-unauthorized-components").empty();D=null};return{init:function(){A("#variable-registry-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Variables",handler:{close:function(){j()},open:function(){var N=A("#variable-registry-table").data("gridInstance");if(H.isDefinedAndNotNull(N)){N.resizeCanvas()}}}});A("#new-variable-dialog").modal({headerText:"New Variable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){C()}}}],handler:{close:function(){A("#new-variable-name").val("")},open:function(){A("#new-variable-name").focus()}}});A("#new-variable-name").on("keydown",function(O){var N=O.keyCode?O.keyCode:O.which;if(N===A.ui.keyCode.ENTER){C();O.stopImmediatePropagation();O.preventDefault()}});A("#add-variable").on("click",function(){A("#new-variable-dialog").modal("show")});a()},showVariables:function(N){A("#variable-registry-dialog").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){L()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){F()}}}]);return x(N)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Storage","nf.Client","nf.CanvasUtils","nf.ProcessGroupConfiguration","nf.ng.Bridge"],function(g,d,j,e,h,k,f,c,i){return(nf.ComponentState=b(g,j,e,h,k,f,c,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ComponentState=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ProcessGroupConfiguration"),require("nf.ng.Bridge")))}else{nf.ComponentVersion=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.ProcessGroupConfiguration,a.nf.ng.Bridge)}}}(this,function(h,k,e,i,n,f,c,j){var a;var d;var b=function(o){if(o.type==="ReportingTask"){return"../nifi-api/flow/reporting-task-types"}else{if(o.type==="ControllerService"){return"../nifi-api/flow/controller-service-types"}else{return"../nifi-api/flow/processor-types"}}};var g=function(o){if(o.type==="ReportingTask"){return"reportingTaskTypes"}else{if(o.type==="ControllerService"){return"controllerServiceTypes"}else{return"processorTypes"}}};var m=function(){var o=a.keys();h.each(o,function(q,p){a.remove(p)});h("#component-version-controller-service-apis").empty();h("#component-version-controller-service-apis-container").hide();h("#component-version-name").text("");h("#component-version-bundle").text("");h("#component-version-tags").text("");h("#component-version-restriction").removeClass("unset").text("");h("#component-version-description").text("");h("#component-version-selector").combo("destroy");h("#component-version-dialog").removeData("component")};var l=function(q){var r=a.get(q.value);if(e.isDefinedAndNotNull(r.usageRestriction)){h("#component-version-restriction").text(r.usageRestriction)}else{h("#component-version-restriction").addClass("unset").text("No restriction")}if(!e.isEmpty(r.controllerServiceApis)){var o=e.getFormattedServiceApis(r.controllerServiceApis);var p=e.formatUnorderedList(o);h("#component-version-controller-service-apis").empty().append(p);h("#component-version-controller-service-apis-container").show()}h("#component-version-tags").text(r.tags.join(", "));h("#component-version-description").text(r.description)};return{init:function(o){a=d3.map();d=o;h("#component-version-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Component Version",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var r=h("#component-version-selector").combo("getSelectedOption");var s=a.get(r.value);var q=h("#component-version-dialog").data("component");var p={revision:n.getRevision(q),disconnectedNodeAcknowledged:i.isDisconnectionAcknowledged(),component:{id:q.id,bundle:{group:s.bundle.group,artifact:s.bundle.artifact,version:s.bundle.version}}};h.ajax({type:"PUT",url:q.uri,data:JSON.stringify(p),dataType:"json",contentType:"application/json"}).done(function(u){if(q.type==="Processor"){f.getComponentByType(q.type).set(u);j.digest()}else{if(q.type==="ControllerService"){var t=q.component.parentGroupId;h.Deferred(function(v){if(e.isDefinedAndNotNull(t)){if(h("#process-group-configuration").is(":visible")){c.loadConfiguration(t).done(function(){v.resolve()})}else{c.showConfiguration(t).done(function(){v.resolve()})}}else{if(h("#settings").is(":visible")){d.loadSettings().done(function(){v.resolve()})}else{d.showSettings().done(function(){v.resolve()})}}}).done(function(){if(e.isDefinedAndNotNull(t)){c.selectControllerService(q.id)}else{d.selectControllerService(q.id)}})}else{if(q.type==="ReportingTask"){h.Deferred(function(v){if(h("#settings").is(":visible")){d.loadSettings().done(function(){v.resolve()})}else{d.showSettings().done(function(){v.resolve()})}}).done(function(){d.selectReportingTask(q.id)})}}}}).fail(k.handleAjaxError);this.modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){m()}}})},promptForVersionChange:function(o){var p={bundleGroupFilter:o.component.bundle.group,bundleArtifactFilter:o.component.bundle.artifact};if(g(o)==="controllerServiceTypes"){p.typeFilter=o.component.type}else{p.type=o.component.type}return h.ajax({type:"GET",url:b(o)+"?"+h.param(p),dataType:"json"}).done(function(q){var r=[];var s;h.each(q[g(o)],function(t,w){var v=w.type;a.set(w.bundle.version,w);var u={text:w.bundle.version,value:w.bundle.version,description:e.escapeHtml(w.description)};if(w.bundle.version===o.component.bundle.version){s=u}r.push(u)});r.sort(function(u,t){return -e.sortVersion(u.text,t.text)});h("#component-version-name").text(o.component.name);h("#component-version-bundle").text(e.formatBundle(o.component.bundle));h("#component-version-selector").combo({options:r,selectedOption:s,select:l});h("#component-version-dialog").data("component",o).modal("show")}).fail(k.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.RemoteProcessGroup"],function(g,k,j,d,f,h,l,e,i,c){return(nf.RemoteProcessGroupConfiguration=b(g,k,j,d,f,h,l,e,i,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.RemoteProcessGroup")))}else{nf.RemoteProcessGroupConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.RemoteProcessGroup)}}}(this,function(e,i,h,b,d,f,j,c,g,a){return{init:function(){e("#remote-process-group-configuration").modal({headerText:"Configure Remote Process Group",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var k=e("#remote-process-group-id").text();var l=i.select("#id-"+k).datum();var m={revision:j.getRevision(l),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{id:k,targetUris:e("#remote-process-group-urls").val(),communicationsTimeout:e("#remote-process-group-timeout").val(),yieldDuration:e("#remote-process-group-yield-duration").val(),transportProtocol:e("#remote-process-group-transport-protocol-combo").combo("getSelectedOption").value,proxyHost:e("#remote-process-group-proxy-host").val(),proxyPort:e("#remote-process-group-proxy-port").val(),proxyUser:e("#remote-process-group-proxy-user").val(),proxyPassword:e("#remote-process-group-proxy-password").val(),localNetworkInterface:e("#remote-process-group-local-network-interface").val()}};e.ajax({type:"PUT",data:JSON.stringify(m),url:l.uri,dataType:"json",contentType:"application/json"}).done(function(n){a.set(n);g.digest();e("#remote-process-group-configuration").modal("hide")}).fail(function(q,n,o){if(q.status===400){var r=q.responseText.split("\n");var p;if(r.length===1){p=e("<span></span>").text(r[0])}else{p=b.formatUnorderedList(r)}d.showOkDialog({dialogContent:p,headerText:"Remote Process Group Configuration"})}else{h.handleAjaxError(q,n,o)}})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#remote-process-group-configuration").modal("hide")}}}],handler:{close:function(){e("#remote-process-group-id").text("");e("#remote-process-group-name").text("");e("#remote-process-group-urls").val("");e("#remote-process-group-timeout").val("");e("#remote-process-group-yield-duration").val("");e("#remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:"RAW"});e("#remote-process-group-local-network-interface").val("");e("#remote-process-group-proxy-host").val("");e("#remote-process-group-proxy-port").val("");e("#remote-process-group-proxy-user").val("");e("#remote-process-group-proxy-password").val("")}}});e("#remote-process-group-transport-protocol-combo").combo({options:[{text:"RAW",value:"RAW"},{text:"HTTP",value:"HTTP"}]})},showConfiguration:function(k){if(c.isRemoteProcessGroup(k)){var l=k.datum();e("#remote-process-group-id").text(l.id);e("#remote-process-group-name").text(l.component.name);e("#remote-process-group-urls").val(l.component.targetUris);e("#remote-process-group-timeout").val(l.component.communicationsTimeout);e("#remote-process-group-yield-duration").val(l.component.yieldDuration);e("#remote-process-group-proxy-host").val(l.component.proxyHost);e("#remote-process-group-proxy-port").val(l.component.proxyPort);e("#remote-process-group-proxy-user").val(l.component.proxyUser);e("#remote-process-group-proxy-password").val(l.component.proxyPassword);e("#remote-process-group-local-network-interface").val(l.component.localNetworkInterface);e("#remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:l.component.transportProtocol});e("#remote-process-group-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.CanvasUtils"],function(d,e,c){return(nf.RemoteProcessGroupDetails=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupDetails=b(require("jquery"),require("nf.Common"),require("nf.CanvasUtils")))}else{nf.RemoteProcessGroupDetails=b(a.$,a.nf.Common,a.nf.CanvasUtils)}}}(this,function(b,c,a){return{init:function(){b("#remote-process-group-details").modal({headerText:"Remote Process Group Details",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#remote-process-group-details").modal("hide")}}}],handler:{close:function(){c.clearField("read-only-remote-process-group-id");c.clearField("read-only-remote-process-group-name");c.clearField("read-only-remote-process-group-urls");c.clearField("read-only-remote-process-group-timeout");c.clearField("read-only-remote-process-group-yield-duration");c.clearField("read-only-remote-process-group-transport-protocol");c.clearField("read-only-remote-process-group-local-network-interface");c.clearField("read-only-remote-process-group-proxy-host");c.clearField("read-only-remote-process-group-proxy-port");c.clearField("read-only-remote-process-group-proxy-user");c.clearField("read-only-remote-process-group-proxy-password")}}})},showDetails:function(d){if(a.isRemoteProcessGroup(d)){var e=d.datum();c.populateField("read-only-remote-process-group-id",e.id);c.populateField("read-only-remote-process-group-name",e.component.name);c.populateField("read-only-remote-process-group-urls",e.component.targetUris);c.populateField("read-only-remote-process-group-timeout",e.component.communicationsTimeout);c.populateField("read-only-remote-process-group-yield-duration",e.component.yieldDuration);c.populateField("read-only-remote-process-group-transport-protocol",e.component.transportProtocol);c.populateField("read-only-remote-process-group-local-network-interface",e.component.localNetworkInterface);c.populateField("read-only-remote-process-group-proxy-host",e.component.proxyHost);c.populateField("read-only-remote-process-group-proxy-port",e.component.proxyPort);c.populateField("read-only-remote-process-group-proxy-user",e.component.proxyUser);c.populateField("read-only-remote-process-group-proxy-password",e.component.proxyPassword);b("#remote-process-group-details").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.RemoteProcessGroup"],function(g,k,j,d,f,h,l,e,i,c){return(nf.RemoteProcessGroupPorts=b(g,k,j,d,f,h,l,e,i,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupPorts=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.RemoteProcessGroup")))}else{nf.RemoteProcessGroupPorts=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.RemoteProcessGroup)}}}(this,function(g,n,l,c,e,i,o,d,j,b){var h=function(){g("#remote-port-configuration").modal({headerText:"Configure Remote Port",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var r=g("#remote-port-concurrent-tasks").val();var q=g("#remote-port-batch-count").val();var w=new Array();if(!g.isNumeric(r)){w.push("Concurrent tasks must be an integer value.")}if(q&&!g.isNumeric(q)){w.push("Batch Settings: count must be an integer value.")}if(w.length==0){var p=g("#remote-process-group-ports-id").text();var v=n.select("#id-"+p).datum();var u=g("#remote-port-id").text();var t={revision:o.getRevision(v),disconnectedNodeAcknowledged:i.isDisconnectionAcknowledged(),remoteProcessGroupPort:{id:u,groupId:p,useCompression:g("#remote-port-use-compression").hasClass("checkbox-checked"),concurrentlySchedulableTaskCount:r,batchSettings:{count:q,size:g("#remote-port-batch-size").val(),duration:g("#remote-port-batch-duration").val()}}};var s="/output-ports/";if(g("#remote-port-type").text()==="input"){s="/input-ports/"}g.ajax({type:"PUT",data:JSON.stringify(t),url:v.uri+s+encodeURIComponent(u),dataType:"json",contentType:"application/json"}).done(function(x){v.revision=x.revision;var y=x.remoteProcessGroupPort;var A="No";if(y.useCompression===true){A="Yes"}g("#"+u+"-concurrent-tasks").text(y.concurrentlySchedulableTaskCount);g("#"+u+"-compression").text(A);var z=a(y);g("#"+u+"-batch-count").text(z.count);g("#"+u+"-batch-size").text(z.size);g("#"+u+"-batch-duration").text(z.duration)}).fail(function(A,x,y){if(A.status===400){var B=A.responseText.split("\n");var z;if(B.length===1){z=g("<span></span>").text(B[0])}else{z=c.formatUnorderedList(B)}e.showOkDialog({dialogContent:z,headerText:"Remote Process Group Ports"})}else{l.handleAjaxError(A,x,y)}}).always(function(){g("#remote-port-configuration").modal("hide")})}else{e.showOkDialog({headerText:"Remote Process Group Ports",dialogContent:w.reduce(function(x,y){return typeof(x)==="string"?x+" "+y:y})});g("#remote-port-configuration").modal("hide")}}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){g("#remote-port-configuration").modal("hide")}}}],handler:{close:function(){g("#remote-port-id").text("");g("#remote-port-name").text("");g("#remote-port-concurrent-tasks").val("");g("#remote-port-use-compression").removeClass("checkbox-checked checkbox-unchecked");g("#remote-port-batch-count").val("");g("#remote-port-batch-size").val("");g("#remote-port-batch-duration").val("")}}})};var k=function(){g("#remote-process-group-ports").modal({scrollableContentStyle:"scrollable",headerText:"Remote Process Group Ports",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var p=g("#remote-process-group-ports-id").text();var r=n.select("#id-"+p);var q=r.datum();if(d.canModify(r)){b.reload(q.id)}g("#remote-process-group-ports").modal("hide")}}}],handler:{close:function(){g("#remote-process-group-ports-id").text("");g("#remote-process-group-ports-name").text("");g("#remote-process-group-ports-urls").text("");var p=g("#remote-process-group-ports");c.cleanUpTooltips(p,"div.remote-port-removed");c.cleanUpTooltips(p,"div.concurrent-tasks-info");g("#remote-process-group-input-ports-container").empty();g("#remote-process-group-output-ports-container").empty()}}})};var a=function(q){var p={};var r=q.batchSettings;if(r){p.count=typeof(r.count)==="number"?r.count:"No value set";p.size=r.size?r.size:"No value set";p.duration=r.duration?r.duration:"No value set"}else{p.count="No value set";p.size="No value set";p.duration="No value set"}return p};var f=function(D,B,w){var t=c.escapeHtml(B.id);var x=g('<div class="remote-port-container"></div>').appendTo(D);var I=g('<div class="remote-port-edit-container"></div>').appendTo(x);var u=g('<div class="remote-port-details-container"></div>').appendTo(x);var z=g("#remote-process-group-ports-id").text();var v=n.select("#id-"+z);if(d.canOperate(v)){var J=function(L){var M;if(L.connected===true){if(L.transmitting===true){M=(j.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary enabled-active-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope));M.click()}else{if(L.exists===true){M=(j.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary enabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope))}else{M=(j.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope))}}}else{if(L.transmitting===true){M=(j.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary disabled-active-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope))}else{M=(j.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope))}}return M};var C=J(B);C.appendTo(I);if(d.canModify(v)){if(B.exists===true&&B.connected===true){var H=g('<button class="button edit-remote-port fa fa-pencil"></button>').click(function(){var P=g("#"+t+"-name").text();var O=g("#"+t+"-concurrent-tasks").text();var L=g("#"+t+"-compression").text()==="Yes";var N=g("#"+t+"-batch-count").text();var M=g("#"+t+"-batch-size").text();var Q=g("#"+t+"-batch-duration").text();m(B.id,P,O,L,N,M,Q,w)}).appendTo(I);if(B.transmitting===true){H.hide()}else{H.show()}}else{if(B.exists===false){g('<div class="remote-port-removed"/>').appendTo(I).qtip(g.extend({},c.config.tooltipConfig,{content:"This port has been removed."}))}}}if(c.isDefinedAndNotNull(C)){var K=function(){var L=g("#remote-process-group-ports-id").text();var O=n.select("#id-"+L).datum();var P=false;if(C.hasClass("enabled-inactive-transmission")){P=true}var N={revision:o.getRevision(O),disconnectedNodeAcknowledged:i.isDisconnectionAcknowledged(),state:P?"TRANSMITTING":"STOPPED"};var M="/output-ports/";if(w==="input"){M="/input-ports/"}g.ajax({type:"PUT",data:JSON.stringify(N),url:O.uri+M+encodeURIComponent(B.id)+"/run-status",dataType:"json",contentType:"application/json"}).done(function(Q){O.revision=Q.revision;var R=Q.remoteProcessGroupPort;if(R.exists===false){C.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("disabled-inactive-transmission").off("click");if(c.isDefinedAndNotNull(H)){H.hide()}}else{if(R.transmitting===true){C.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("enabled-active-transmission");if(c.isDefinedAndNotNull(H)){H.hide()}}else{C.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("enabled-inactive-transmission");if(c.isDefinedAndNotNull(H)){H.show()}}}}).fail(function(U,Q,R){var T=J(B);T.click(K);C.replaceWith(T);C=T;if(U.status===400){var V=U.responseText.split("\n");var S;if(V.length===1){S=g("<span></span>").text(V[0])}else{S=c.formatUnorderedList(V)}e.showOkDialog({headerText:"Remote Process Group Ports",dialogContent:S})}else{l.handleAjaxError(U,Q,R)}})};C.click(K)}}else{if(B.transmitting===true){(j.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary enabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope)).appendTo(I)}else{(j.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope)).appendTo(I)}}g('<div id="'+t+'-id" class="remote-port-id hidden"></div>').text(B.id).appendTo(u);g('<div id="'+t+'-name" class="remote-port-name ellipsis"></div>').text(B.name).appendTo(u);g('<div class="clear"></div>').appendTo(u);if(c.isBlank(B.comments)){g('<div class="remote-port-description unset">No description specified.</div>').appendTo(u)}else{g('<div class="remote-port-description"></div>').text(B.comments).appendTo(u)}g('<div class="clear"></div>').appendTo(u);var E=g('<div class="concurrent-task-container"></div>').appendTo(u);var y=g('<div class="setting-field"></div>').append(g('<div id="'+t+'-concurrent-tasks"></div>').text(B.concurrentlySchedulableTaskCount));g('<div><div class="setting-name">Concurrent tasks<div class="processor-setting concurrent-tasks-info fa fa-question-circle"></div></div></div>').append(y).appendTo(E).find("div.concurrent-tasks-info").qtip(g.extend({},c.config.tooltipConfig,{content:"The number of tasks that should be concurrently scheduled for this port."}));var q=g('<div class="compression-container"></div>').appendTo(u);var p="No";if(B.useCompression===true){p="Yes"}g('<div><div class="setting-name">Compressed</div><div class="setting-field"><div id="'+t+'-compression">'+p+"</div></div></div>").appendTo(q);g('<div class="clear"></div>').appendTo(u);var s=g('<div class="batch-settings-container"></div>').append(g('<div class="setting-name">Batch Settings<div class="processor-setting batch-settings-info fa fa-question-circle"></div></div>')).appendTo(u);s.find("div.batch-settings-info").qtip(g.extend({},nf.Common.config.tooltipConfig,{content:(w==="input"?"The batch settings to control how this NiFi sends data to the remote input port in a transaction. This NiFi will transfer as much flow files as they are queued in incoming relationships, until any of these limits is met. If none of these setting is specified, this NiFi uses 500 milliseconds batch duration by default.":"The batch settings to tell the remote NiFi how this NiFi prefers to receive data from the remote output port in a transaction. The remote NiFi will use these settings as a hint to control batch data transferring. However, actual behavior depends on the version of remote NiFi instance. Recent version of NiFi uses 5 seconds for batch duration if none of these setting is specified.")}));var G=a(B);var r=g('<div class="setting-field"></div>').append(g('<div id="'+t+'-batch-count"></div>').text(G.count));var F=g('<div class="setting-field"></div>').append(g('<div id="'+t+'-batch-size"></div>').text(G.size));var A=g('<div class="setting-field"></div>').append(g('<div id="'+t+'-batch-duration"></div>').text(G.duration));g('<div class="batch-setting"><div class="setting-name">Count<div class="processor-setting"></div></div></div>').append(r).appendTo(s);g('<div class="batch-setting"><div class="setting-name">Size<div class="processor-setting"></div></div></div>').append(F).appendTo(s);g('<div class="batch-setting"><div class="setting-name">Duration<div class="processor-setting"></div></div></div>').append(A).appendTo(s);g('<div class="clear"></div>').appendTo(x);x.find(".ellipsis").ellipsis();j.digest()};var m=function(s,t,v,w,q,u,r,p){g("#remote-port-id").text(s);g("#remote-port-type").text(p);var x="checkbox-unchecked";if(w===true){x="checkbox-checked"}g("#remote-port-use-compression").addClass(x);g("#remote-port-concurrent-tasks").val(v);g("#remote-port-batch-count").val(q==="No value set"?null:q);g("#remote-port-batch-size").val(u==="No value set"?null:u);g("#remote-port-batch-duration").val(r==="No value set"?null:r);g("#remote-port-name").text(t).ellipsis();g("#remote-port-configuration").modal("show")};return{init:function(){h();k()},showPorts:function(p){if(d.isRemoteProcessGroup(p)){var q=p.datum();g.ajax({type:"GET",url:q.uri,dataType:"json"}).done(function(t){var w=t.component;b.set(t);g("#remote-process-group-ports-id").text(w.id);g("#remote-process-group-ports-name").text(w.name);g("#remote-process-group-ports-urls").text(w.targetUris);var r=w.contents;if(c.isDefinedAndNotNull(r)){var A=[];var u=[];var s=function(C,B){var E=C.name.toUpperCase();var D=B.name.toUpperCase();return E<D?-1:(E>D?1:0)};var y=g("#remote-process-group-input-ports-container");g.each(r.inputPorts,function(C,B){if(B.connected===true){A.push(B)}else{u.push(B)}});A.sort(s);u.sort(s);g.each(A,function(C,B){f(y,B,"input")});g.each(u,function(C,B){f(y,B,"input")});if(c.isEmpty(A)&&c.isEmpty(u)){g('<div class="unset"></div>').text("No ports to display").appendTo(y)}var v=[];var z=[];var x=g("#remote-process-group-output-ports-container");g.each(r.outputPorts,function(B,C){if(C.connected===true){v.push(C)}else{z.push(C)}});v.sort(s);z.sort(s);g.each(v,function(B,C){f(x,C,"output")});g.each(z,function(B,C){f(x,C,"output")});if(c.isEmpty(v)&&c.isEmpty(z)){g('<div class="unset"></div>').text("No ports to display").appendTo(x)}}g("#remote-process-group-ports").modal("show")}).fail(l.handleAjaxError)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.CanvasUtils","nf.Connection"],function(f,j,i,c,e,g,k,d,h){return(nf.ConnectionConfiguration=b(f,j,i,c,e,g,k,d,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ConnectionConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.Connection")))}else{nf.ConnectionConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.Connection)}}}(this,function(v,F,c,E,i,r,f,J,N){var d;var q;var n;var h;var m=75;var I=200;var A={urls:{api:"../nifi-api",prioritizers:"../nifi-api/flow/prioritizers"}};var g=function(){F.select("path.connector").remove()};var u=function(){v("div.available-relationship").bind("change",function(){v("#connection-configuration").modal("refreshButtons")})};var b=function(O){if(J.isProcessor(O)){return v.Deferred(function(P){D(O).done(function(R){if(!E.isEmpty(R.relationships)){v.each(R.relationships,function(S,T){w(T.name)});u();var Q=v("#relationship-names").children("div");if(Q.length===1){Q.children("div.available-relationship").removeClass("checkbox-unchecked").addClass("checkbox-checked")}v("#connection-configuration").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){return t().length===0},handler:{click:function(){B(t());v("#connection-configuration").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){v("#connection-configuration").modal("hide")}}}]);P.resolve()}else{i.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+E.escapeHtml(R.name)+"' does not support any relationships."});k();P.reject()}}).fail(function(){P.reject()})}).promise()}else{return v.Deferred(function(Q){var P;if(J.isInputPort(O)){P=C(O)}else{if(J.isRemoteProcessGroup(O)){P=e(O)}else{if(J.isProcessGroup(O)){P=G(O)}else{P=l(O)}}}P.done(function(){v("#connection-configuration").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){B();v("#connection-configuration").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){v("#connection-configuration").modal("hide")}}}]);Q.resolve()}).fail(function(){Q.reject()})}).promise()}};var C=function(O){return v.Deferred(function(Q){var P=O.datum();var R=P.permissions.canRead?P.component.name:P.id;v("#input-port-source").show();v("#input-port-source-name").text(R).attr("title",R);v("#connection-source-id").val(P.id);v("#connection-source-component-id").val(P.id);v("#connection-source-group-id").val(J.getGroupId());v("#connection-source-group-name").text(J.getGroupName());Q.resolve()}).promise()};var l=function(O){return v.Deferred(function(Q){var P=O.datum();v("#funnel-source").show();v("#connection-source-id").val(P.id);v("#connection-source-component-id").val(P.id);v("#connection-source-group-id").val(J.getGroupId());v("#connection-source-group-name").text(J.getGroupName());Q.resolve()}).promise()};var D=function(O){return v.Deferred(function(Q){var P=O.datum();var R=P.permissions.canRead?P.component.name:P.id;var S=P.permissions.canRead?E.substringAfterLast(P.component.type,"."):"Processor";v("#processor-source").show();v("#processor-source-name").text(R).attr("title",R);v("#processor-source-type").text(S).attr("title",S);v("#connection-source-id").val(P.id);v("#connection-source-component-id").val(P.id);v("#connection-source-group-id").val(J.getGroupId());v("#connection-source-group-name").text(J.getGroupName());v("#relationship-names-container").show();Q.resolve(P.component)})};var G=function(O){return v.Deferred(function(P){var Q=O.datum();v.ajax({type:"GET",url:A.urls.api+"/flow/process-groups/"+encodeURIComponent(Q.id),dataType:"json"}).done(function(R){var V=R.processGroupFlow;var U=R.permissions.canRead?V.breadcrumb.breadcrumb.name:V.id;var W=V.flow;var S=[];v.each(W.outputPorts,function(Y,Z){if(Z.permissions.canRead&&Z.permissions.canWrite){var X=Z.component;S.push({text:X.name,value:X.id,description:E.escapeHtml(X.comments)})}});if(!E.isEmpty(S)){v("#output-port-source").show();S.sort(function(Y,X){return Y.text.localeCompare(X.text)});v("#output-port-options").combo({options:S,maxHeight:300,select:function(X){v("#connection-source-id").val(X.value)}});v("#connection-source-component-id").val(V.id);v("#connection-source-group-id").val(V.id);v("#connection-source-group-name").text(U);P.resolve()}else{var T="'"+E.escapeHtml(U)+"' does not have any output ports.";if(E.isEmpty(W.outputPorts)===false){T="Not authorized for any output ports in '"+E.escapeHtml(U)+"'."}i.showOkDialog({headerText:"Connection Configuration",dialogContent:T});k();P.reject()}}).fail(function(T,R,S){c.handleAjaxError(T,R,S);P.reject()})}).promise()};var e=function(O){return v.Deferred(function(P){var Q=O.datum();v.ajax({type:"GET",url:Q.uri,dataType:"json"}).done(function(R){var T=R.component;var U=T.contents;if(!E.isEmpty(U.outputPorts)){v("#output-port-source").show();var S=[];v.each(U.outputPorts,function(V,W){S.push({text:W.name,value:W.id,disabled:W.exists===false,description:E.escapeHtml(W.comments)})});S.sort(function(W,V){return W.text.localeCompare(V.text)});v("#output-port-options").combo({options:S,maxHeight:300,select:function(V){v("#connection-source-id").val(V.value)}});v("#connection-source-component-id").val(T.id);v("#connection-source-group-id").val(T.id);v("#connection-source-group-name").text(T.name);P.resolve()}else{i.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+E.escapeHtml(T.name)+"' does not have any output ports."});k();P.reject()}}).fail(function(T,R,S){c.handleAjaxError(T,R,S);P.reject()})}).promise()};var a=function(O){if(J.isOutputPort(O)){return o(O)}else{if(J.isProcessor(O)){return z(O)}else{if(J.isRemoteProcessGroup(O)){return K(O)}else{if(J.isFunnel(O)){return s(O)}else{return M(O)}}}}};var o=function(O){return v.Deferred(function(P){var R=O.datum();var Q=R.permissions.canRead?R.component.name:R.id;v("#output-port-destination").show();v("#output-port-destination-name").text(Q).attr("title",Q);v("#connection-destination-id").val(R.id);v("#connection-destination-component-id").val(R.id);v("#connection-destination-group-id").val(J.getGroupId());v("#connection-destination-group-name").text(J.getGroupName());P.resolve()}).promise()};var s=function(O){return v.Deferred(function(Q){var P=O.datum();v("#funnel-destination").show();v("#connection-destination-id").val(P.id);v("#connection-destination-component-id").val(P.id);v("#connection-destination-group-id").val(J.getGroupId());v("#connection-destination-group-name").text(J.getGroupName());Q.resolve()}).promise()};var z=function(O){return v.Deferred(function(Q){var P=O.datum();var R=P.permissions.canRead?P.component.name:P.id;var S=P.permissions.canRead?E.substringAfterLast(P.component.type,"."):"Processor";v("#processor-destination").show();v("#processor-destination-name").text(R).attr("title",R);v("#processor-destination-type").text(S).attr("title",S);v("#connection-destination-id").val(P.id);v("#connection-destination-component-id").val(P.id);v("#connection-destination-group-id").val(J.getGroupId());v("#connection-destination-group-name").text(J.getGroupName());Q.resolve()}).promise()};var M=function(O){return v.Deferred(function(P){var Q=O.datum();v.ajax({type:"GET",url:A.urls.api+"/flow/process-groups/"+encodeURIComponent(Q.id),dataType:"json"}).done(function(R){var U=R.processGroupFlow;var T=R.permissions.canRead?U.breadcrumb.breadcrumb.name:U.id;var V=U.flow;var S=[];v.each(V.inputPorts,function(X,W){S.push({text:W.permissions.canRead?W.component.name:W.id,value:W.id,description:W.permissions.canRead?E.escapeHtml(W.component.comments):null})});if(!E.isEmpty(S)){v("#input-port-destination").show();S.sort(function(X,W){return X.text.localeCompare(W.text)});v("#input-port-options").combo({options:S,maxHeight:300,select:function(W){v("#connection-destination-id").val(W.value)}});v("#connection-destination-component-id").val(U.id);v("#connection-destination-group-id").val(U.id);v("#connection-destination-group-name").text(T);P.resolve()}else{i.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+E.escapeHtml(T)+"' does not have any input ports."});k();P.reject()}}).fail(function(T,R,S){c.handleAjaxError(T,R,S);P.reject()})}).promise()};var K=function(O,P){return v.Deferred(function(Q){var R=O.datum();v.ajax({type:"GET",url:R.uri,dataType:"json"}).done(function(S){var U=S.component;var V=U.contents;if(!E.isEmpty(V.inputPorts)){v("#input-port-destination").show();var T=[];v.each(V.inputPorts,function(X,W){T.push({text:W.name,value:W.id,disabled:W.exists===false,description:E.escapeHtml(W.comments)})});T.sort(function(X,W){return X.text.localeCompare(W.text)});v("#input-port-options").combo({options:T,maxHeight:300,select:function(W){v("#connection-destination-id").val(W.value)}});v("#connection-destination-component-id").val(U.id);v("#connection-destination-group-id").val(U.id);v("#connection-destination-group-name").text(U.name);Q.resolve()}else{i.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+E.escapeHtml(U.name)+"' does not have any input ports."});k();Q.reject()}}).fail(function(U,S,T){c.handleAjaxError(U,S,T);Q.reject()})}).promise()};var L=function(O){return v.Deferred(function(Q){var R=O.datum();var P=R.permissions.canRead?R.component.name:R.id;v("#read-only-output-port-source").show();v("#connection-source-component-id").val(R.id);v("#connection-source-group-id").val(R.id);v("#connection-source-group-name").text(P);Q.resolve()}).promise()};var j=function(O){if(J.isProcessor(O)){return D(O)}else{if(J.isInputPort(O)){return C(O)}else{if(J.isFunnel(O)){return l(O)}else{return L(O)}}}};var x=function(O,P){if(J.isProcessor(O)){return z(O)}else{if(J.isOutputPort(O)){return o(O)}else{if(J.isRemoteProcessGroup(O)){return K(O,P)}else{if(J.isFunnel(O)){return s(O)}else{return M(O)}}}}};var w=function(P){var O=v('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text(P);var Q=v('<span class="relationship-name-value hidden"></span>').text(P);return v('<div class="available-relationship-container"><div class="available-relationship nf-checkbox checkbox-unchecked"></div></div>').append(O).append(Q).appendTo("#relationship-names")};var B=function(Q){var an=v("#connection-source-id").val();var ak=v("#connection-destination-id").val();var ar=v("#connection-source-component-id").val();var ah=F.select("#id-"+ar);var al=v("#connection-destination-component-id").val();var Z=F.select("#id-"+al);var aA=ah.datum();var aa=Z.datum();var R=[];if(ar===al){var ag={x:aA.position.x+(aA.dimensions.width),y:aA.position.y+(aA.dimensions.height/2)};var am=N.config.selfLoopXOffset;var ao=N.config.selfLoopYOffset;R.push({x:(ag.x+am),y:(ag.y-ao)});R.push({x:(ag.x+am),y:(ag.y+ao)})}else{var ay=[];var aq=N.getComponentConnections(ar);v.each(aq,function(aD,aG){var aE=J.getConnectionSourceComponentId(aG);var aF=J.getConnectionDestinationComponentId(aG);if((aE===ar&&aF===al)||(aF===ar&&aE===al)){ay.push(aG)}});if(ay.length>0){var S=false;v.each(ay,function(aD,aE){if(E.isEmpty(aE.bends)){S=true;return false}});if(S===true){var ai=[aA.position.x+(aA.dimensions.width/2),aA.position.y+(aA.dimensions.height/2)];var P=[aa.position.x+(aa.dimensions.width/2),aa.position.y+(aa.dimensions.height/2)];var af=((ai[1]-P[1])/(ai[0]-P[0]));var aw=af<=1&&af>=-1;var ap=function(aD,aF){var aE=false;v.each(ay,function(aG,aH){if(!E.isEmpty(aH.bends)){if(aw){if(aH.bends[0].y===aF){aE=true;return false}}else{if(aH.bends[0].x===aD){aE=true;return false}}}});return aE};var W=(ai[0]+P[0])/2;var ac=(ai[1]+P[1])/2;var av=aw?0:I;var ae=aw?m:0;var ax=false;while(ax===false){if(ap(W-av,ac-ae)===false){R.push({x:(W-av),y:(ac-ae)});ax=true}else{if(ap(W+av,ac+ae)===false){R.push({x:(W+av),y:(ac+ae)});ax=true}}if(aw){ae+=m}else{av+=I}}}}}var U=v("#connection-source-group-id").val();var O=v("#connection-destination-group-id").val();var aB=J.getConnectableTypeForSource(ah);var ad=J.getConnectableTypeForDestination(Z);var X=v("#connection-name").val();var T=v("#flow-file-expiration").val();var az=v("#back-pressure-object-threshold").val();var aC=v("#back-pressure-data-size-threshold").val();var aj=v("#prioritizer-selected").sortable("toArray");var ab=v("#load-balance-strategy-combo").combo("getSelectedOption").value;var Y="DO_NOT_LOAD_BALANCE"!==ab;var V=Y&&"PARTITION_BY_ATTRIBUTE"===ab?v("#load-balance-partition-attribute").val():"";var au=Y?v("#load-balance-compression-combo").combo("getSelectedOption").value:"DO_NOT_COMPRESS";if(H()){var at={revision:f.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:r.isDisconnectionAcknowledged(),component:{name:X,source:{id:an,groupId:U,type:aB},destination:{id:ak,groupId:O,type:ad},selectedRelationships:Q,flowFileExpiration:T,backPressureDataSizeThreshold:aC,backPressureObjectThreshold:az,bends:R,prioritizers:aj,loadBalanceStrategy:ab,loadBalancePartitionAttribute:V,loadBalanceCompression:au}};v.ajax({type:"POST",url:A.urls.api+"/process-groups/"+encodeURIComponent(J.getGroupId())+"/connections",data:JSON.stringify(at),dataType:"json",contentType:"application/json"}).done(function(aD){q.add({connections:[aD]},{selectAll:true});J.reloadConnectionSourceAndDestination(ar,al);q.updateVisibility();d.refresh()}).fail(function(aF,aD,aE){c.handleAjaxError(aF,aD,aE)})}};var y=function(ad){var V=v("#connection-id").text();var P=v("#connection-uri").val();var ab=v("#connection-source-component-id").val();var O=v("#connection-destination-component-id").val();var Z=F.select("#id-"+O);var S=J.getConnectableTypeForDestination(Z);var ae=v("#connection-destination-id").val();var ac=v("#connection-destination-group-id").val();var Y=v("#connection-name").val();var X=v("#flow-file-expiration").val();var Q=v("#back-pressure-object-threshold").val();var af=v("#back-pressure-data-size-threshold").val();var ah=v("#prioritizer-selected").sortable("toArray");var ag=v("#load-balance-strategy-combo").combo("getSelectedOption").value;var T="DO_NOT_LOAD_BALANCE"!==ag;var W=T&&"PARTITION_BY_ATTRIBUTE"===ag?v("#load-balance-partition-attribute").val():"";var U=T?v("#load-balance-compression-combo").combo("getSelectedOption").value:"DO_NOT_COMPRESS";if(H()){var aa=N.get(V);var R={revision:f.getRevision(aa),disconnectedNodeAcknowledged:r.isDisconnectionAcknowledged(),component:{id:V,name:Y,destination:{id:ae,groupId:ac,type:S},selectedRelationships:ad,flowFileExpiration:X,backPressureDataSizeThreshold:af,backPressureObjectThreshold:Q,prioritizers:ah,loadBalanceStrategy:ag,loadBalancePartitionAttribute:W,loadBalanceCompression:U}};return v.ajax({type:"PUT",url:P,data:JSON.stringify(R),dataType:"json",contentType:"application/json"}).done(function(ai){N.set(ai);J.reloadConnectionSourceAndDestination(ab,O)}).fail(function(ak,ai,aj){if(ak.status===400||ak.status===404||ak.status===409){i.showOkDialog({headerText:"Connection Configuration",dialogContent:E.escapeHtml(ak.responseText),})}else{c.handleAjaxError(ak,ai,aj)}})}else{return v.Deferred(function(ai){ai.reject()}).promise()}};var t=function(){var P=v("#relationship-names");var O=[];v.each(P.children(),function(Q,T){var S=v(T);var R=S.children("div.available-relationship");if(R.hasClass("checkbox-checked")){O.push(S.children("span.relationship-name-value").text())}});return O};var H=function(){var O=[];if(E.isBlank(v("#flow-file-expiration").val())){O.push("File expiration must be specified")}if(!v.isNumeric(v("#back-pressure-object-threshold").val())){O.push("Back pressure object threshold must be an integer value")}if(E.isBlank(v("#back-pressure-data-size-threshold").val())){O.push("Back pressure data size threshold must be specified")}if(v("#load-balance-strategy-combo").combo("getSelectedOption").value==="PARTITION_BY_ATTRIBUTE"&&E.isBlank(v("#load-balance-partition-attribute").val())){O.push('Cannot set Load Balance Strategy to "Partition by attribute" without providing a partitioning "Attribute Name"')}if(O.length>0){i.showOkDialog({headerText:"Connection Configuration",dialogContent:E.formatUnorderedList(O)});return false}else{return true}};var k=function(){var Q=v("#prioritizer-selected");var O=v("#prioritizer-available");Q.children().detach().appendTo(O);var P=O.children("li").get();P.sort(function(S,R){var U=v(S).text().toUpperCase();var T=v(R).text().toUpperCase();return(U<T)?-1:(U>T)?1:0});v.each(P,function(){v(this).detach()});v.each(P,function(){v(this).appendTo(O)});v("#connection-name").val("");v("#relationship-names").css("border-width","0").empty();v("#relationship-names-container").hide();E.clearField("connection-id");v("#processor-source").hide();v("#input-port-source").hide();v("#output-port-source").hide();v("#read-only-output-port-source").hide();v("#funnel-source").hide();v("#processor-destination").hide();v("#input-port-destination").hide();v("#output-port-destination").hide();v("#funnel-destination").hide();v("#connection-source-id").val("");v("#connection-source-component-id").val("");v("#connection-source-group-id").val("");v("#connection-destination-id").val("");v("#connection-destination-component-id").val("");v("#connection-destination-group-id").val("");v("#output-port-options").empty();v("#input-port-options").empty();v("#load-balance-strategy-combo").combo("setSelectedOption",E.loadBalanceStrategyOptions[0]);v("#load-balance-partition-attribute").val("");v("#load-balance-compression-combo").combo("setSelectedOption",E.loadBalanceCompressionOptions[0]);g()};var p={init:function(R,O,Q,P){d=R;q=O;n=Q;h=P;v("#relationship-names-container").hide();v("#connection-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Connection",handler:{close:function(){k()},open:function(){E.toggleScrollable(v("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});v("#connection-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"connection-details-tab-content"},{name:"Settings",tabContentId:"connection-settings-tab-content"}]});v("#load-balance-strategy-combo").combo({options:E.loadBalanceStrategyOptions,select:function(S){if(S.value==="PARTITION_BY_ATTRIBUTE"){v("#load-balance-partition-attribute-setting-separator").show();v("#load-balance-partition-attribute-setting").show()}else{v("#load-balance-partition-attribute-setting-separator").hide();v("#load-balance-partition-attribute-setting").hide()}if(S.value==="DO_NOT_LOAD_BALANCE"){v("#load-balance-compression-setting").hide()}else{v("#load-balance-compression-setting").show()}}});v("#load-balance-compression-combo").combo({options:E.loadBalanceCompressionOptions});v.ajax({type:"GET",url:A.urls.prioritizers,dataType:"json"}).done(function(S){v.each(S.prioritizerTypes,function(T,U){p.addAvailablePrioritizer("#prioritizer-available",U)});v("#prioritizer-available, #prioritizer-selected").sortable({containment:v("#connection-settings-tab-content").find(".settings-right"),connectWith:"ul",placeholder:"ui-state-highlight",scroll:true,opacity:0.6});v("#prioritizer-available, #prioritizer-selected").disableSelection()}).fail(c.handleAjaxError)},addAvailablePrioritizer:function(T,R){var Q=R.type;var P=E.substringAfterLast(Q,".");var S=v(T);var O=v("<li></li>").append(v('<span style="float: left;"></span>').text(P)).attr("id",Q).addClass("ui-state-default").appendTo(S);if(E.isDefinedAndNotNull(R.description)){v('<div class="fa fa-question-circle"></div>').appendTo(O).qtip(v.extend({content:E.escapeHtml(R.description)},E.config.tooltipConfig))}},createConnection:function(Q,R){var P=F.select("#id-"+Q);var O=F.select("#id-"+R);if(P.empty()||O.empty()){return}v.when(b(P),a(O)).done(function(){v("#flow-file-expiration").val("0 sec");v("#back-pressure-object-threshold").val(n);v("#back-pressure-data-size-threshold").val(h);v("#connection-configuration-tabs").find("li:first").click();v("#connection-configuration").modal("setHeaderText","Create Connection").modal("show");v("#connection-configuration div.relationship-name").ellipsis();E.populateField("connection-id",null);var S=v("#relationship-names");if(S.is(":visible")&&S.get(0).scrollHeight>Math.round(S.innerHeight())){S.css("border-width","1px")}}).fail(function(){g()})},showConfiguration:function(P,O){return v.Deferred(function(R){var S=P.datum();var Q=S.component;var V=J.getConnectionSourceComponentId(S);var T=F.select("#id-"+V);if(E.isUndefinedOrNull(O)){var U=J.getConnectionDestinationComponentId(S);O=F.select("#id-"+U)}v.when(j(T),x(O,Q.destination)).done(function(){var Y=Q.availableRelationships;var X=Q.selectedRelationships;if(E.isDefinedAndNotNull(Y)||E.isDefinedAndNotNull(X)){v.each(Y,function(ab,aa){w(aa)});u();v.each(X,function(ac,aa){if(v.inArray(aa,Y)===-1){var ad=w(aa);v(ad).children("div.relationship-name").addClass("undefined")}var ab=v("#relationship-names").children("div");v.each(ab,function(ae,ag){var af=v(ag).children("span.relationship-name-value");if(af.text()===aa){v(ag).children("div.available-relationship").removeClass("checkbox-unchecked").addClass("checkbox-checked")}})})}if(J.isProcessGroup(T)||J.isRemoteProcessGroup(T)){v("#connection-source-id").val(Q.source.id);v("#read-only-output-port-name").text(Q.source.name).attr("title",Q.source.name)}if(J.isProcessGroup(O)||J.isRemoteProcessGroup(O)){var W=O.datum();if(Q.destination.groupId===W.id){v("#input-port-options").combo("setSelectedOption",{value:Q.destination.id})}}v("#connection-name").val(Q.name);v("#flow-file-expiration").val(Q.flowFileExpiration);v("#back-pressure-object-threshold").val(Q.backPressureObjectThreshold);v("#back-pressure-data-size-threshold").val(Q.backPressureDataSizeThreshold);v("#load-balance-strategy-combo").combo("setSelectedOption",{value:Q.loadBalanceStrategy});v("#load-balance-compression-combo").combo("setSelectedOption",{value:Q.loadBalanceCompression});v("#load-balance-partition-attribute").val(Q.loadBalancePartitionAttribute);E.populateField("connection-id",Q.id);v.each(Q.prioritizers,function(aa,ab){v("#prioritizer-available").children('li[id="'+ab+'"]').detach().appendTo("#prioritizer-selected")});v("#connection-uri").val(S.uri);v("#connection-configuration").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(J.isProcessor(T)){return t().length===0}return false},handler:{click:function(){if(J.isProcessor(T)){y(t()).done(function(){R.resolve()}).fail(function(){R.reject()})}else{y(undefined).done(function(){R.resolve()}).fail(function(){R.reject()})}v("#connection-configuration").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){v("#connection-configuration").modal("hide");R.reject()}}}]);v("#connection-configuration").modal("setHeaderText","Configure Connection").modal("show");v("#connection-configuration div.relationship-name").ellipsis();var Z=v("#relationship-names");if(Z.is(":visible")&&Z.get(0).scrollHeight>Math.round(Z.innerHeight())){Z.css("border-width","1px")}}).fail(function(){R.reject()})}).promise()}};return p}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.ErrorHandler"],function(c,d,e){return(nf.ConnectionDetails=b(c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ConnectionDetails=b(require("jquery"),require("nf.Common"),require("nf.ErrorHandler")))}else{nf.ConnectionDetails=b(a.$,a.nf.Common,a.nf.ErrorHandler)}}}(this,function(d,b,g){var j=function(o,q,p){if(p.type==="PROCESSOR"){return k(o,q,p)}else{if(p.type==="FUNNEL"){return l(o,q,p)}else{if(p.type==="REMOTE_OUTPUT_PORT"){return f(o,q,p)}else{return n(o,q,p)}}}};var k=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(p.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(p.name).addClass("ellipsis").attr("title",p.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var l=function(o,q,p){return d.Deferred(function(r){d("#read-only-connection-source-label").text("From funnel");d("#read-only-connection-source").text("funnel").attr("title","funnel");d("#read-only-connection-source-group-name").text(q);r.resolve()}).promise()};var f=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);r.resolve()}else{r.reject(u,s,t)}})}).promise()};var n=function(o,q,p){return d.Deferred(function(r){if(o===p.groupId){d("#read-only-connection-source-label").text("From input");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var e=function(p,q,o){if(o.type==="PROCESSOR"){return a(p,q,o)}else{if(o.type==="FUNNEL"){return m(p,q,o)}else{if(o.type==="REMOTE_INPUT_PORT"){return i(p,q,o)}else{return c(p,q,o)}}}};var a=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(o.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(o.name).addClass("ellipsis").attr("title",o.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var m=function(p,q,o){return d.Deferred(function(r){d("#read-only-connection-target-label").text("To funnel");d("#read-only-connection-target").text("funnel").attr("title","funnel");d("#read-only-connection-target-group-name").text(q);r.resolve()}).promise()};var i=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);r.resolve()}else{r.reject(u,s,t)}})}).promise()};var c=function(p,q,o){return d.Deferred(function(r){if(p===o.groupId){d("#read-only-connection-target-label").text("To output");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var h=function(o){d('<div class="available-relationship-container"></div>').append(d('<div class="relationship-name"></div>').text(o)).appendTo("#read-only-relationship-names")};return{init:function(){d("#connection-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"read-only-connection-details-tab-content"},{name:"Settings",tabContentId:"read-only-connection-settings-tab-content"}]});d("#connection-details").modal({headerText:"Connection Details",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){d("#connection-details").modal("hide")}}}],handler:{close:function(){d("#read-only-relationship-names").empty();b.clearField("read-only-connection-name");b.clearField("read-only-connection-id");d("#read-only-connection-source-label").text("");d("#read-only-connection-source").empty();d("#read-only-connection-source-group-name").text("");d("#read-only-connection-target-label").text("");d("#read-only-connection-target").empty();d("#read-only-connection-target-group-name").text("");d("#read-only-relationship-names").css("border-width","0").empty();b.clearField("read-only-flow-file-expiration");b.clearField("read-only-back-pressure-object-threshold");b.clearField("read-only-back-pressure-data-size-threshold");b.clearField("read-only-load-balance-strategy");b.clearField("read-only-load-balance-partition-attribute");b.clearField("read-only-load-balance-compression");d("#read-only-prioritizers").empty()},open:function(){b.toggleScrollable(d("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}})},showDetails:function(p,r){var q=d.ajax({type:"GET",url:"../nifi-api/flow/process-groups/"+encodeURIComponent(p),dataType:"json"});var o=d.ajax({type:"GET",url:"../nifi-api/connections/"+encodeURIComponent(r),dataType:"json"});d.when(q,o).done(function(w,u){var v=w[0];var x=u[0];if(x.permissions.canRead){var t=x.component;var z=v.permissions.canRead?v.processGroupFlow.breadcrumb.breadcrumb.name:v.processGroupFlow.id;var y=j(v.id,z,t.source);var s=e(v.id,z,t.destination);d.when(y,s).done(function(){var B=t.availableRelationships;var A=t.selectedRelationships;if(b.isDefinedAndNotNull(B)||b.isDefinedAndNotNull(A)){d.each(B,function(G,F){h(F)});d.each(A,function(H,F){if(d.inArray(F,B)===-1){var I=h(F);d(I).children("div.relationship-name").addClass("undefined")}var G=d("#read-only-relationship-names").children("div");d.each(G.children("div.relationship-name"),function(K,J){var L=d(J);if(L.text()===F){L.css("font-weight","bold")}})});d("#selected-relationship-text").show();d("#read-only-relationship-names-container").show()}else{d("#selected-relationship-text").hide();d("#read-only-relationship-names-container").hide()}b.populateField("read-only-connection-name",t.name);b.populateField("read-only-connection-id",t.id);b.populateField("read-only-flow-file-expiration",t.flowFileExpiration);b.populateField("read-only-back-pressure-object-threshold",t.backPressureObjectThreshold);b.populateField("read-only-back-pressure-data-size-threshold",t.backPressureDataSizeThreshold);b.populateField("read-only-load-balance-strategy",b.getComboOptionText(b.loadBalanceStrategyOptions,t.loadBalanceStrategy));b.populateField("read-only-load-balance-partition-attribute",t.loadBalancePartitionAttribute);b.populateField("read-only-load-balance-compression",b.getComboOptionText(b.loadBalanceCompressionOptions,t.loadBalanceCompression));if(t.loadBalanceStrategy==="PARTITION_BY_ATTRIBUTE"){d("#read-only-load-balance-partition-attribute-setting").show()}else{d("#read-only-load-balance-partition-attribute-setting").hide()}if(t.loadBalanceStrategy==="DO_NOT_LOAD_BALANCE"){d("#read-only-load-balance-compression-setting").hide()}else{d("#read-only-load-balance-compression-setting").show()}if(b.isDefinedAndNotNull(t.prioritizers)&&t.prioritizers.length>0){var E=d("<ol></ol>").css("list-style","decimal inside none");d.each(t.prioritizers,function(F,G){E.append(d("<li></li>").text(b.substringAfterLast(G,".")))});d("#read-only-prioritizers").append(E)}else{var C=d('<span class="unset">No value set</span>');d("#read-only-prioritizers").append(C)}d("#connection-details-tabs").find("li:first").click();d("#connection-details").modal("show");var D=d("#read-only-relationship-names");if(D.is(":visible")&&D.get(0).scrollHeight>Math.round(D.innerHeight())){D.css("border-width","1px")}}).fail(g.handleAjaxError)}}).fail(g.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.CanvasUtils","nf.ng.Bridge"],function(f,e,g,d,c){return(nf.ContextMenu=b(f,e,g,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ContextMenu=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ng.Bridge")))}else{nf.ContextMenu=b(a.$,a.d3,a.nf.Common,a.nf.CanvasUtils,a.nf.ng.Bridge)}}}(this,function(G,T,P,Y,p){var z;var J=function(ac){return Y.getParentGroupId()!==null&&ac.empty()};var W=function(ac){return Y.isConfigurable(ac)};var aa=function(ac){return ac.empty()||Y.isProcessGroup(ac)};var H=function(ac){return Y.hasDetails(ac)};var u=function(ac){return Y.areDeletable(ac)};var Q=function(ac){return Y.canWriteCurrentGroup()&&(ac.empty()||Y.canRead(ac))};var d=function(ac){return Y.canWriteCurrentGroup()&&ac.empty()};var X=function(ac){return Y.getComponentByType("Connection").isDisconnected(ac)&&Y.canModify(ac)};var I=function(ac){return Y.canEnable(ac)};var C=function(ac){return Y.canDisable(ac)};var E=function(ac){return Y.isManagedAuthorizer()&&Y.canManagePolicies(ac)};var q=function(ac){return Y.areRunnable(ac)};var M=function(ac){return Y.areStoppable(ac)};var b=function(ae){if(ae.size()!==1){return false}if(Y.canOperate(ae)===false){return false}var ac=false;if(Y.isProcessor(ae)){var af=ae.datum();var ad=af.status.aggregateSnapshot;ac=ad.runStatus!=="Running"&&ad.activeThreadCount>0}return ac};var m=function(ac){if(ac.size()!==1){return false}return Y.isProcessor(ac)||Y.isProcessGroup(ac)||Y.isRemoteProcessGroup(ac)||Y.isConnection(ac)};var N=function(ac){if(ac.size()!==1){return false}if(Y.canRead(ac)===false){return false}return Y.isProcessor(ac)};var v=function(ac){return ac.size()===1&&!Y.isConnection(ac)};var i=function(ac){return Y.isCopyable(ac)};var e=function(ac){return Y.isPastable()};var U=function(ac){return ac.empty()};var y=function(ac){if(ac.size()!==1){return false}if(Y.canModify(ac)===false){return false}return Y.isConnection(ac)};var r=function(ac){return Y.canAlign(ac)};var x=function(ac){return Y.isColorable(ac)};var Z=function(ac){if(ac.size()!==1){return false}return Y.isConnection(ac)};var o=function(ac){if(ac.size()!==1){return false}return Y.isFunnel(ac)||Y.isProcessor(ac)||Y.isProcessGroup(ac)||Y.isRemoteProcessGroup(ac)||Y.isInputPort(ac)||(Y.isOutputPort(ac)&&Y.getParentGroupId()!==null)};var t=function(ac){if(ac.size()!==1){return false}return Y.isFunnel(ac)||Y.isProcessor(ac)||Y.isProcessGroup(ac)||Y.isRemoteProcessGroup(ac)||Y.isOutputPort(ac)||(Y.isInputPort(ac)&&Y.getParentGroupId()!==null)};var n=function(ad){if(ad.size()!==1){return false}if(Y.canRead(ad)===false||Y.canModify(ad)===false){return false}if(Y.isProcessor(ad)){var ac=ad.datum();return ac.component.persistsState===true}else{return false}};var K=function(ad){if(ad.size()!==1){return false}if(Y.canRead(ad)===false||Y.canModify(ad)===false){return false}if(Y.isProcessor(ad)){var ac=ad.datum();return ac.component.multipleVersionsAvailable===true}else{return false}};var a=function(ac){if(ac.size()!==1){return false}return Y.isProcessGroup(ac)};var L=function(ac){if(P.canVersionFlows()===false){return false}if(ac.empty()){if(Y.getParentGroupId()===null){return false}return Y.canReadCurrentGroup()&&Y.canWriteCurrentGroup()}if(a(ac)===true){return Y.canRead(ac)&&Y.canModify(ac)}return false};var R=function(ad){if(L(ad)===false){return false}if(ad.empty()){var ac=p.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ac.length>0){var ae=ac[ac.length-1];if(ae.permissions.canRead){return P.isUndefinedOrNull(ae.breadcrumb.versionControlInformation)}else{return false}}else{return false}}var af=ad.datum();return P.isUndefinedOrNull(af.component.versionControlInformation)};var O=function(ad){if(L(ad)===false){return false}var af;if(ad.empty()){var ac=p.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ac.length>0){var ae=ac[ac.length-1];if(ae.permissions.canRead){af=ae.breadcrumb.versionControlInformation}else{return false}}else{return false}}else{var ag=ad.datum();af=ag.component.versionControlInformation}if(P.isUndefinedOrNull(af)){return false}return af.state==="LOCALLY_MODIFIED"};var f=function(ad){if(L(ad)===false){return false}var af;if(ad.empty()){var ac=p.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ac.length>0){var ae=ac[ac.length-1];if(ae.permissions.canRead){af=ae.breadcrumb.versionControlInformation}else{return false}}else{return false}}else{var ag=ad.datum();af=ag.component.versionControlInformation}if(P.isUndefinedOrNull(af)){return false}return af.state==="LOCALLY_MODIFIED"||af.state==="LOCALLY_MODIFIED_AND_STALE"};var ab=function(ad){if(L(ad)===false){return false}var af;if(ad.empty()){var ac=p.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ac.length>0){var ae=ac[ac.length-1];if(ae.permissions.canRead){af=ae.breadcrumb.versionControlInformation}else{return false}}else{return false}}else{var ag=ad.datum();af=ag.component.versionControlInformation}if(P.isUndefinedOrNull(af)){return false}return af.state!=="LOCALLY_MODIFIED"&&af.state!=="LOCALLY_MODIFIED_AND_STALE"&&af.state!=="SYNC_FAILURE"};var F=function(ad){if(L(ad)===false){return false}if(ad.empty()){var ac=p.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ac.length>0){var ae=ac[ac.length-1];if(ae.permissions.canRead){return P.isDefinedAndNotNull(ae.breadcrumb.versionControlInformation)}else{return false}}else{return false}}var af=ad.datum();return P.isDefinedAndNotNull(af.component.versionControlInformation)};var s=function(ac){if(ac.size()!==1){return false}return !Y.isLabel(ac)&&!Y.isConnection(ac)&&!Y.isProcessGroup(ac)&&!Y.isRemoteProcessGroup(ac)&&P.canAccessProvenance()};var c=function(ac){if(ac.size()!==1){return false}if(Y.canRead(ac)===false){return false}return Y.isRemoteProcessGroup(ac)};var B=function(ac){if(Y.canOperate(ac)===false){return false}return Y.canAllStartTransmitting(ac)};var k=function(ac){if(Y.canOperate(ac)===false){return false}return Y.canAllStopTransmitting(ac)};var V=function(ac){return Z(ac)};var l=function(ac){return Z(ac)};var w=function(ac){if(Y.canModify(ac)===false){return false}return !ac.empty()&&Y.getComponentByType("Connection").isDisconnected(ac)&&Y.getParentGroupId()!==null};var D=function(ac){ac.remove().find(".group-menu-item").each(function(){var ad=G(this).attr("id");D(G("#"+ad+"-sub-menu"))})};var j=function(ad,af){var ae=G('<div class="context-menu-item"></div>').attr("id",af.id).on("mouseenter",function(){G(this).addClass("hover");ad.find(".group-menu-item").not("#"+af.id).each(function(){var ag=G(this).attr("id");D(G("#"+ag+"-sub-menu"))})}).on("mouseleave",function(){G(this).removeClass("hover")}).appendTo(ad);var ac=G('<div class="context-menu-item-img"></div>').addClass(af.clazz).appendTo(ae);if(P.isDefinedAndNotNull(af.imgStyle)){ac.addClass(af.imgStyle)}G('<div class="context-menu-item-text"></div>').text(af.text).appendTo(ae);if(af.isGroup){G('<div class="fa fa-caret-right context-menu-group-item-img"></div>').appendTo(ae)}G('<div class="clear"></div>').appendTo(ae);return ae};var g=function(ad,ac){ad.css({left:ac.x+"px",top:ac.y+"px"}).show()};var S=function(ae,ad,ac){z[ae](ad,ac);A.hide()};var h=[{id:"reload-menu-item",condition:U,menuItem:{clazz:"fa fa-refresh",text:"Refresh",action:"reload"}},{id:"leave-group-menu-item",condition:J,menuItem:{clazz:"fa fa-level-up",text:"Leave group",action:"leaveGroup"}},{separator:true},{id:"show-configuration-menu-item",condition:W,menuItem:{clazz:"fa fa-gear",text:"Configure",action:"showConfiguration"}},{id:"show-details-menu-item",condition:H,menuItem:{clazz:"fa fa-gear",text:"View configuration",action:"showDetails"}},{id:"variable-registry-menu-item",condition:aa,menuItem:{clazz:"fa",text:"Variables",action:"openVariableRegistry"}},{separator:true},{id:"version-menu-item",groupMenuItem:{clazz:"fa",text:"Version"},menuItems:[{id:"start-version-control-menu-item",condition:R,menuItem:{clazz:"fa fa-upload",text:"Start version control",action:"saveFlowVersion"}},{separator:true},{id:"commit-menu-item",condition:O,menuItem:{clazz:"fa fa-upload",text:"Commit local changes",action:"saveFlowVersion"}},{id:"local-changes-menu-item",condition:f,menuItem:{clazz:"fa",text:"Show local changes",action:"showLocalChanges"}},{id:"revert-menu-item",condition:f,menuItem:{clazz:"fa fa-undo",text:"Revert local changes",action:"revertLocalChanges"}},{id:"change-version-menu-item",condition:ab,menuItem:{clazz:"fa",text:"Change version",action:"changeFlowVersion"}},{separator:true},{id:"stop-version-control-menu-item",condition:F,menuItem:{clazz:"fa",text:"Stop version control",action:"stopVersionControl"}}]},{separator:true},{id:"enter-group-menu-item",condition:a,menuItem:{clazz:"fa fa-sign-in",text:"Enter group",action:"enterGroup"}},{separator:true},{id:"start-menu-item",condition:q,menuItem:{clazz:"fa fa-play",text:"Start",action:"start"}},{id:"stop-menu-item",condition:M,menuItem:{clazz:"fa fa-stop",text:"Stop",action:"stop"}},{id:"terminate-menu-item",condition:b,menuItem:{clazz:"fa fa-hourglass-end",text:"Terminate",action:"terminate"}},{id:"enable-menu-item",condition:I,menuItem:{clazz:"fa fa-flash",text:"Enable",action:"enable"}},{id:"disable-menu-item",condition:C,menuItem:{clazz:"icon icon-enable-false",text:"Disable",action:"disable"}},{id:"enable-transmission-menu-item",condition:B,menuItem:{clazz:"fa fa-bullseye",text:"Enable transmission",action:"enableTransmission"}},{id:"disable-transmission-menu-item",condition:k,menuItem:{clazz:"icon icon-transmit-false",text:"Disable transmission",action:"disableTransmission"}},{separator:true},{id:"data-provenance-menu-item",condition:s,menuItem:{clazz:"icon icon-provenance",imgStyle:"context-menu-provenance",text:"View data provenance",action:"openProvenance"}},{id:"show-stats-menu-item",condition:m,menuItem:{clazz:"fa fa-area-chart",text:"View status history",action:"showStats"}},{id:"view-state-menu-item",condition:n,menuItem:{clazz:"fa fa-tasks",text:"View state",action:"viewState"}},{id:"list-queue-menu-item",condition:l,menuItem:{clazz:"fa fa-list",text:"List queue",action:"listQueue"}},{id:"show-usage-menu-item",condition:N,menuItem:{clazz:"fa fa-book",text:"View usage",action:"showUsage"}},{id:"view-menu-item",groupMenuItem:{clazz:"icon icon-connect",text:"View connections"},menuItems:[{id:"show-upstream-menu-item",condition:t,menuItem:{clazz:"icon",text:"Upstream",action:"showUpstream"}},{id:"show-downstream-menu-item",condition:o,menuItem:{clazz:"icon",text:"Downstream",action:"showDownstream"}}]},{separator:true},{id:"refresh-remote-flow-menu-item",condition:c,menuItem:{clazz:"fa fa-refresh",text:"Refresh remote",action:"refreshRemoteFlow"}},{separator:true},{id:"remote-ports-menu-item",condition:c,menuItem:{clazz:"fa fa-cloud",text:"Manage remote ports",action:"remotePorts"}},{id:"manage-policies-menu-item",condition:E,menuItem:{clazz:"fa fa-key",text:"Manage access policies",action:"managePolicies"}},{id:"change-version-menu-item",condition:K,menuItem:{clazz:"fa fa-exchange",text:"Change version",action:"changeVersion"}},{separator:true},{id:"show-source-menu-item",condition:Z,menuItem:{clazz:"fa fa-long-arrow-left",text:"Go to source",action:"showSource"}},{id:"show-destination-menu-item",condition:Z,menuItem:{clazz:"fa fa-long-arrow-right",text:"Go to destination",action:"showDestination"}},{separator:true},{id:"align-menu-item",groupMenuItem:{clazz:"fa",text:"Align"},menuItems:[{id:"align-horizontal-menu-item",condition:r,menuItem:{clazz:"fa fa-align-center fa-rotate-90",text:"Horizontally",action:"alignHorizontal"}},{id:"align-vertical-menu-item",condition:r,menuItem:{clazz:"fa fa-align-center",text:"Vertically",action:"alignVertical"}}]},{id:"to-front-menu-item",condition:y,menuItem:{clazz:"fa fa-clone",text:"Bring to front",action:"toFront"}},{id:"center-menu-item",condition:v,menuItem:{clazz:"fa fa-crosshairs",text:"Center in view",action:"center"}},{id:"fill-color-menu-item",condition:x,menuItem:{clazz:"fa fa-paint-brush",text:"Change color",action:"fillColor"}},{id:"open-uri-menu-item",condition:c,menuItem:{clazz:"fa fa-external-link",text:"Go to",action:"openUri"}},{separator:true},{id:"move-into-parent-menu-item",condition:w,menuItem:{clazz:"fa fa-arrows",text:"Move to parent group",action:"moveIntoParent"}},{id:"group-menu-item",condition:X,menuItem:{clazz:"icon icon-group",text:"Group",action:"group"}},{separator:true},{id:"upload-template-menu-item",condition:d,menuItem:{clazz:"icon icon-template-import",text:"Upload template",action:"uploadTemplate"}},{id:"template-menu-item",condition:Q,menuItem:{clazz:"icon icon-template-save",text:"Create template",action:"template"}},{separator:true},{id:"copy-menu-item",condition:i,menuItem:{clazz:"fa fa-copy",text:"Copy",action:"copy"}},{id:"paste-menu-item",condition:e,menuItem:{clazz:"fa fa-paste",text:"Paste",action:"paste"}},{separator:true},{id:"empty-queue-menu-item",condition:V,menuItem:{clazz:"fa fa-minus-circle",text:"Empty queue",action:"emptyQueue"}},{id:"delete-menu-item",condition:u,menuItem:{clazz:"fa fa-trash",text:"Delete",action:"delete"}}];var A={init:function(ac){z=ac;G("#context-menu").on("contextmenu",function(ad){ad.preventDefault();ad.stopPropagation()})},show:function(){nf.ContextMenu.hide();var ag=G("#context-menu").empty();var aj=G("#canvas-body").get(0);var ao=G("#banner-footer").get(0);var ah=G("#breadcrumbs").get(0);var am=Y.getSelection();var ak=T.mouse(aj);var ad=function(ap,aq){return ap+aq.width()>aj.clientWidth};var ae=function(aq,ap){return aq+ap.height()>(aj.clientHeight-ah.clientHeight-ao.clientHeight)};var an=function(aq,ar,ap){j(aq,{id:ar,clazz:ap.clazz,imgStyle:ap.imgStyle,text:ap.text,isGroup:false}).on("click",function(at){S(ap.action,am,at)}).on("contextmenu",function(at){S(ap.action,am,at);at.preventDefault();at.stopPropagation()})};var al=function(ar,aq,ap,at){j(ar,{id:aq,clazz:ap.clazz,imgStyle:ap.imgStyle,text:ap.text,isGroup:true}).addClass("group-menu-item").on("mouseenter",function(){if(G("#"+aq+"-sub-menu").length==0){var ay=G(this);var av=ar.position();var ax=ay.position();var au=av.left+ax.left+ay.width();var az=av.top+ax.top;var aw=G('<div class="context-menu unselectable sub-menu"></div>').attr("id",aq+"-sub-menu").appendTo("body");ac(aw,at);if(ad(au,aw)){au-=(aw.width()+ay.width()-4)}if(ae(az,aw)){az-=(aw.height()-ay.height())}aw.css({top:az+"px",left:au+"px"}).show()}})};var ai=function(aq){if(aq.separator){return true}else{if(aq.menuItem){return aq.condition(am)}else{var ap=[];G.each(aq.menuItems,function(ar,at){if(ai(at)){ap.push(at)}});return ap.length>0}}};var ac=function(at,ap){var aq=false;G.each(ap,function(au,av){if(av.separator&&aq){G('<div class="context-menu-item-separator"></div>').appendTo(at);aq=false}else{if(af(at,av)){aq=true}}});var ar=at.children().last();if(ar.hasClass("context-menu-item-separator")){ar.remove()}};var af=function(ar,ap){var aq=false;if(ap.menuItem){aq=ap.condition(am);if(aq){an(ar,ap.id,ap.menuItem)}}else{if(ap.groupMenuItem){var au=[];G.each(ap.menuItems,function(aw,av){if(ai(av)){au.push(av)}});var at=G.grep(au,function(av){return P.isUndefinedOrNull(av.separator)});aq=at.length>0;if(aq){al(ar,ap.id,ap.groupMenuItem,au)}}}return aq};ac(ag,h);if(ad(ak[0],ag)){ak[0]=aj.clientWidth-ag.width()-2}if(ae(ak[1],ag)){ak[1]=aj.clientHeight-ah.clientHeight-ao.clientHeight-ag.height()-9}g(ag,{x:ak[0],y:ak[1]});p.digest()},hide:function(){G("#context-menu").hide();G("div.context-menu.sub-menu").remove()},activate:function(ac){ac.on("contextmenu.selection",function(){A.show();T.event.preventDefault();T.event.stopPropagation()})}};return A}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","nf.CanvasUtils"],function(d,c){return(nf.QuickSelect=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.QuickSelect=b(require("d3"),require("nf.CanvasUtils")))}else{nf.QuickSelect=b(a.d3,a.nf.CanvasUtils)}}}(this,function(d,c){var b;var a={init:function(e){b=e},quickSelect:function(){var e=c.getSelection();if(c.isConfigurable(e)){b.showConfiguration(e)}else{if(c.hasDetails(e)){b.showDetails(e)}}d.event.preventDefault();d.event.stopPropagation()},activate:function(e){e.on("dblclick",function(){a.quickSelect()})}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","nf.ng.Bridge","nf.ContextMenu","nf.CanvasUtils"],function(f,d,c,e){return(nf.Selectable=b(f,d,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Selectable=b(require("d3"),require("nf.ng.Bridge"),require("nf.ContextMenu"),require("nf.CanvasUtils")))}else{nf.Selectable=b(a.d3,a.nf.ng.Bridge,a.nf.ContextMenu,a.nf.CanvasUtils)}}}(this,function(d,b,a,c){var e={select:function(f){a.hide();if(!f.classed("selected")){if(!d.event.shiftKey){d.selectAll("g.selected").classed("selected",false)}f.classed("selected",true)}else{if(d.event.shiftKey){f.classed("selected",false)}}b.digest();d.event.stopPropagation()},activate:function(f){f.on("mousedown.selection",function(){e.select(d.select(this));c.setURLParameters()})}};return e}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.CanvasUtils","nf.ContextMenu","nf.Label"],function(f,e,g,d,c,h){return(nf.Birdseye=b(f,e,g,d,c,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Birdseye=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ContextMenu"),require("nf.Label")))}else{nf.Birdseye=b(a.$,a.d3,a.nf.Common,a.nf.CanvasUtils,a.nf.ContextMenu,a.nf.Label)}}}(this,function(g,l,d,e,k,f){var h;var c;var j;var i=function(F){var D=e.getCanvasTranslate();var U=e.getCanvasScale();D=[D[0]/U,D[1]/U];var x=l.select("#canvas").node().getBoundingClientRect();var m=(x.left/U)-D[0];var z=((x.top-e.getCanvasOffset())/U)-D[1];var E=(x.right/U)-D[0];var s=(x.bottom/U)-D[1];var H=g("#canvas-container");var I=H.width()/U;var S=H.height()/U;var y=-D[0];var M=-D[1];var T=y+I;var v=M+S;var K=Math.min(m,y);var N=Math.min(z,M);var p=Math.max(E,T);var Q=Math.max(s,v);var R=p-K;var n=Q-N;var C=g("#birdseye");var B=C.width();var u=C.height();var L=B/R;var t=u/n;var J=Math.min(L,t);var r=[0,0];var o=[0,0];if(D[0]<0&&D[1]<0){r=[0,0];o=[-D[0],-D[1]]}else{if(D[0]>=0&&D[1]<0){r=[D[0],0];o=[0,-D[1]]}else{if(D[0]<0&&D[1]>=0){r=[0,D[1]];o=[-D[0],0]}else{r=[D[0],D[1]];o=[0,0]}}}var P=0;var w=-m;if(D[0]<0){if(D[0]<w){P=w}else{P=w-(w-D[0])}}else{if(D[0]<w){P=w-D[0]}}var O=0;var G=-z;if(D[1]<0){if(D[1]<G){O=G}else{O=G-(G-D[1])}}else{if(D[1]<G){O=G-D[1]}}r=[r[0]+P,r[1]+O];o=[o[0]+P,o[1]+O];c.attr("transform","scale("+J+")");j.attr("transform","translate("+r+")");l.select("rect.birdseye-brush").attrs({width:I,height:S,"stroke-width":(2/J),transform:function(V){V.x=o[0];V.y=o[1];return"translate("+o+")"}});var A=l.select("#birdseye-canvas").node();var q=A.getContext("2d");q.save();q.setTransform(1,0,0,1,0,0);q.clearRect(0,0,A.width,A.height);q.restore();q.save();q.translate(r[0]*J,r[1]*J);q.scale(J,J);g.each(F.labels,function(W,X){var V=f.defaultColor();if(X.permissions.canRead){if(d.isDefinedAndNotNull(X.component.style["background-color"])){V=X.component.style["background-color"]}}q.fillStyle=V;q.fillRect(X.position.x,X.position.y,X.dimensions.width,X.dimensions.height)});q.fillStyle="#ad9897";g.each(F.funnels,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});q.fillStyle="#bbdcde";g.each(F.ports,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});q.fillStyle="#728e9b";g.each(F.remoteProcessGroups,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});g.each(F.processGroups,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});g.each(F.processors,function(W,X){var V="#dde4eb";if(X.permissions.canRead){if(d.isDefinedAndNotNull(X.component.style["background-color"])){V=X.component.style["background-color"];if(V==="#ffffff"){V="#dde4eb"}}}q.fillStyle=V;q.fillRect(X.position.x,X.position.y,X.dimensions.width,X.dimensions.height)});q.restore()};var b=true;var a={init:function(m){h=m;var p=g("#birdseye");l.select("#birdseye").append("canvas").attr("id","birdseye-canvas").attr("width",p.width()).attr("height",p.height());var o=l.select("#birdseye").append("svg").attr("width",p.width()).attr("height",p.height());c=o.append("g").attr("class","birdseye");j=c.append("g").attr("pointer-events","none");var n=l.drag().subject(function(q){return{x:q.x,y:q.y,source:"birdseye"}}).on("drag",function(q){q.x+=l.event.dx;q.y+=l.event.dy;l.select(this).attr("transform",function(){return"translate("+q.x+", "+q.y+")"});e.translateCanvas([-l.event.dx,-l.event.dy])}).on("end",function(){h.updateVisibility();e.persistUserView();a.refresh()});c.append("g").attrs({"pointer-events":"all","class":"birdseye-brush-container"}).append("rect").attr("class","birdseye-brush moveable").datum({x:0,y:0}).call(n)},refresh:function(){if(b){i(h.get())}},updateBirdseyeVisibility:function(m){var n=g("#birdseye");if(m){n.show();b=true;i(h.get())}else{n.hide();b=false}}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage","nf.Connection","nf.Birdseye","nf.CanvasUtils","nf.Common","nf.Dialog","nf.Client","nf.ErrorHandler"],function(g,l,h,j,c,e,d,f,k,i){return(nf.Draggable=b(g,l,h,j,c,e,d,f,k,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Draggable=b(require("jquery"),require("d3"),require("nf.Storage"),require("nf.Connection"),require("nf.Birdseye"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.ErrorHandler")))}else{nf.Draggable=b(a.$,a.d3,a.nf.Storage,a.nf.Connection,a.nf.Birdseye,a.nf.CanvasUtils,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.ErrorHandler)}}}(this,function(g,o,i,l,a,d,c,f,n,k){var m;var h;var j=function(q){var t=o.map();var s=q.datum();var u={x:s.x-s.original.x,y:s.y-s.original.y};if(u.x===0&&u.y===0){return}var p=o.selectAll("g.connection.selected");var r=o.selectAll("g.component.selected");if(d.canModify(p)===false||d.canModify(r)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}p.each(function(w){var v=e.updateConnectionPosition(w,u);if(v!==null){t.set(w.id,v)}});r.each(function(w){var v=l.getComponentConnections(w.id);g.each(v,function(z,y){if(!t.has(y.id)&&d.getConnectionSourceComponentId(y)===d.getConnectionDestinationComponentId(y)){var x=e.updateConnectionPosition(l.get(y.id),u);if(x!==null){t.set(y.id,x)}}});t.set(w.id,e.updateComponentPosition(w,u))});e.refreshConnections(t)};var b=function(q){var p=o.selectAll("g.component.selected, g.connection.selected").classed("selected",false);if(d.canModify(p)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}if(d.canModify(q)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Not authorized to modify the destination group."});return}d.moveComponents(p,q)};var e={init:function(p){m=p;h=o.drag().on("start",function(){o.event.sourceEvent.stopPropagation()}).on("drag",function(){var r=o.select("rect.drag-selection");if(r.empty()){var s=o.selectAll("g.component.selected");var q=null,u=null,v=null,t=null;s.each(function(y){if(q===null||y.position.x<q){q=y.position.x}if(v===null||y.position.y<v){v=y.position.y}var x=y.position.x+y.dimensions.width;var w=y.position.y+y.dimensions.height;if(u===null||x>u){u=x}if(t===null||w>t){t=w}});o.select("#canvas").append("rect").attr("rx",6).attr("ry",6).attr("x",q).attr("y",v).attr("class","drag-selection").attr("pointer-events","none").attr("width",u-q).attr("height",t-v).attr("stroke-width",function(){return 1/d.getCanvasScale()}).attr("stroke-dasharray",function(){return 4/d.getCanvasScale()}).datum({original:{x:q,y:v},x:q,y:v})}else{r.attr("x",function(w){w.x+=o.event.dx;return w.x}).attr("y",function(w){w.y+=o.event.dy;return w.y})}}).on("end",function(){o.event.sourceEvent.stopPropagation();var q=o.select("rect.drag-selection");if(q.empty()){return}var r=o.select("g.drop").classed("drop",false);if(r.empty()){j(q)}else{b(r)}q.remove()})},updateComponentPosition:function(r,s){var q={x:r.position.x+s.x,y:r.position.y+s.y};var p={revision:n.getRevision(r),disconnectedNodeAcknowledged:i.isDisconnectionAcknowledged(),component:{id:r.id,position:q}};return g.Deferred(function(t){g.ajax({type:"PUT",url:r.uri,data:JSON.stringify(p),dataType:"json",contentType:"application/json"}).done(function(u){d.getComponentByType(r.type).set(u);t.resolve({type:r.type,id:r.id})}).fail(function(w,u,v){if(w.status===400||w.status===404||w.status===409){f.showOkDialog({headerText:"Component Position",dialogContent:c.escapeHtml(w.responseText)})}else{k.handleAjaxError(w,u,v)}t.reject()})}).promise()},updateConnectionPosition:function(r,s){if(r.bends.length===0){return null}var q=g.map(r.bends,function(t){return{x:t.x+s.x,y:t.y+s.y}});var p={revision:n.getRevision(r),disconnectedNodeAcknowledged:i.isDisconnectionAcknowledged(),component:{id:r.id,bends:q}};return g.Deferred(function(t){g.ajax({type:"PUT",url:r.uri,data:JSON.stringify(p),dataType:"json",contentType:"application/json"}).done(function(u){l.set(u);t.resolve({type:r.type,id:r.id})}).fail(function(w,u,v){if(w.status===400||w.status===404||w.status===409){f.showOkDialog({headerText:"Component Position",dialogContent:c.escapeHtml(w.responseText)})}else{k.handleAjaxError(w,u,v)}t.reject()})}).promise()},refreshConnections:function(p){if(p.size()>0){g.when.apply(window,p.values()).done(function(){var q=g.makeArray(arguments);var r=o.set();g.each(q,function(u,t){if(t.type==="Connection"){r.add(t.id)}else{var s=l.getComponentConnections(t.id);g.each(s,function(w,v){r.add(v.id)})}});r.each(function(s){l.refresh(s)})}).always(function(){a.refresh()})}},activate:function(p){p.classed("moveable",true).call(h)},deactivate:function(p){p.classed("moveable",false).on(".drag",null)}};return e}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","nf.Connection","nf.ConnectionConfiguration","nf.CanvasUtils"],function(d,f,e,c){return(nf.Connectable=b(d,f,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Connectable=b(require("d3"),require("nf.Connection"),require("nf.ConnectionConfiguration"),require("nf.CanvasUtils")))}else{nf.Connectable=b(a.d3,a.nf.Connection,a.nf.ConnectionConfiguration,a.nf.CanvasUtils)}}}(this,function(f,h,g,e){var c;var d;var b;var a=function(){return !f.event.shiftKey&&f.select("rect.drag-selection").empty()&&f.select("rect.component-selection").empty()};return{init:function(){d=f.select("#canvas");c=f.drag().subject(function(i){b=f.mouse(d.node());return{x:b[0],y:b[1]}}).on("start",function(l){f.event.sourceEvent.stopPropagation();e.getSelection().classed("selected",false);var k=f.select(this.parentNode).classed("selected",true);f.select(this).classed("dragging",true);var j=k.datum();var i=f.mouse(d.node());d.insert("path",":first-child").datum({sourceId:j.id,sourceWidth:j.dimensions.width,x:i[0],y:i[1]}).attrs({"class":"connector",d:function(m){return"M"+m.x+" "+m.y+"L"+m.x+" "+m.y}});f.select(this).attr("transform",function(){return"translate("+i[0]+", "+(i[1]+20)+")"});d.node().appendChild(this)}).on("drag",function(j){f.select(this).attr("transform",function(){return"translate("+f.event.x+", "+(f.event.y+50)+")"});var i=f.select("g.hover").classed("connectable-destination",function(){return(Math.abs(b[0]-f.event.x)>10||Math.abs(b[1]-f.event.y)>10)&&e.isValidConnectionDestination(f.select(this))});f.select("path.connector").classed("connectable",function(){if(i.empty()){return false}return i.classed("connectable-destination")}).attr("d",function(r){if(!i.empty()&&i.classed("connectable-destination")){var m=i.datum();if(r.sourceId===m.id){var k=r.x;var q=r.y;var o=r.sourceWidth/2;var n=h.config.selfLoopXOffset;var p=h.config.selfLoopYOffset;return"M"+k+" "+q+"L"+(k+o+n)+" "+(q-p)+"L"+(k+o+n)+" "+(q+p)+"Z"}else{var l=e.getPerimeterPoint(r,{x:m.position.x,y:m.position.y,width:m.dimensions.width,height:m.dimensions.height});return"M"+r.x+" "+r.y+"L"+l.x+" "+l.y}}else{return"M"+r.x+" "+r.y+"L"+f.event.x+" "+f.event.y}})}).on("end",function(o){f.event.sourceEvent.stopPropagation();var q=f.select(this);var l=f.select("path.connector");var j=l.datum();var p=f.select("g.connectable-destination");if(p.empty()){var i=f.select("#id-"+j.sourceId);var m=i.datum();var n=f.mouse(i.node());if(n[0]<0||n[0]>m.dimensions.width||n[1]<0||n[1]>m.dimensions.height){q.remove()}else{q.classed("dragging",false).attr("transform",function(){return"translate("+o.origX+", "+o.origY+")"});i.node().appendChild(this)}l.remove()}else{q.remove();var k=p.datum();g.createConnection(j.sourceId,k.id)}})},activate:function(i){i.classed("connectable",true).on("mouseenter.connectable",function(m){if(a()){var k=f.select(this);if(e.isValidConnectionSource(k)){var l=f.select("text.add-connect");if(l.empty()){var j=(m.dimensions.width/2)-14;var n=(m.dimensions.height/2)+14;k.append("text").datum({origX:j,origY:n}).call(c).attrs({"class":"add-connect",transform:"translate("+j+", "+n+")"}).text("\ue834")}}}}).on("mouseleave.connectable",function(){var j=f.select(this).select("text.add-connect");if(!j.empty()&&!j.classed("dragging")){j.remove()}}).on("mouseover.connectable",function(){f.select(this).classed("hover",function(){return a()})}).on("mouseout.connection",function(){f.select(this).classed("hover connectable-destination",false)})},deactivate:function(i){i.classed("connectable",false).on("mouseenter.connectable",null).on("mouseleave.connectable",null).on("mouseover.connectable",null).on("mouseout.connectable",null)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.ng.Bridge","nf.Label","nf.Funnel","nf.Port","nf.RemoteProcessGroup","nf.ProcessGroup","nf.Processor","nf.Connection","nf.ConnectionConfiguration","nf.CanvasUtils","nf.Connectable","nf.Draggable","nf.Selectable","nf.ContextMenu","nf.QuickSelect"],function(d,s,f,t,k,p,c,m,e,l,h,q,r,j,n,i,o,g){return(nf.Graph=b(d,s,f,t,k,p,c,m,e,l,h,q,r,j,n,i,o,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Graph=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.ng.Bridge"),require("nf.Label"),require("nf.Funnel"),require("nf.Port"),require("nf.RemoteProcessGroup"),require("nf.ProcessGroup"),require("nf.Processor"),require("nf.Connection"),require("nf.ConnectionConfiguration"),require("nf.CanvasUtils"),require("nf.Connectable"),require("nf.Draggable"),require("nf.Selectable"),require("nf.ContextMenu"),require("nf.QuickSelect")))}else{nf.Graph=b(a.$,a.d3,a.nf.Common,a.nf.ng.Bridge,a.nf.Label,a.nf.Funnel,a.nf.Port,a.nf.RemoteProcessGroup,a.nf.ProcessGroup,a.nf.Processor,a.nf.Connection,a.nf.ConnectionConfiguration,a.nf.CanvasUtils,a.nf.Connectable,a.nf.Draggable,a.nf.Selectable,a.nf.ContextMenu,a.nf.QuickSelect)}}}(this,function(b,u,e,v,j,q,a,l,d,k,g,r,s,i,n,h,o,f){var p=function(w){if(e.isDefinedAndNotNull(w.inputPorts)&&e.isDefinedAndNotNull(w.outputPorts)){return w.inputPorts.concat(w.outputPorts)}else{if(e.isDefinedAndNotNull(w.inputPorts)){return w.inputPorts}else{if(e.isDefinedAndNotNull(w.outputPorts)){return w.outputPorts}else{return[]}}}};var m=function(w){if(e.isDefinedAndNotNull(w.inputPortStatusSnapshots)&&e.isDefinedAndNotNull(w.outputPortStatusSnapshots)){return w.inputPortStatusSnapshots.concat(w.outputPortStatusSnapshots)}else{if(e.isDefinedAndNotNull(w.inputPortStatusSnapshots)){return w.inputPortStatusSnapshots}else{if(e.isDefinedAndNotNull(w.outputPortStatusSnapshots)){return w.outputPortStatusSnapshots}else{return[]}}}};var t=function(){var E=b("#canvas-container");var z=s.getCanvasTranslate();var A=s.getCanvasScale();z=[z[0]/A,z[1]/A];var w=E.width()/A;var x=E.height()/A;var B=-z[0]-w;var y=-z[1]-x;var G=B+(w*3);var I=y+(x*3);var D=function(N){if(!s.shouldRenderPerScale()){return false}var M=N.position.x;var L=N.position.y;var K=M+N.dimensions.width;var J=L+N.dimensions.height;return B<K&&G>M&&y<J&&I>L};var F=function(L){if(!s.shouldRenderPerScale()){return false}var J,M;if(L.bends.length>0){var K=Math.min(Math.max(0,L.labelIndex),L.bends.length-1);J=L.bends[K].x;M=L.bends[K].y}else{J=(L.start.x+L.end.x)/2;M=(L.start.y+L.end.y)/2}return B<J&&G>J&&y<M&&I>M};var C=function(N,J){var L=u.select("#id-"+N.id);var M=J(N);var K=L.classed("visible");L.classed("visible",M).classed("entering",function(){return M&&!K}).classed("leaving",function(){return !M&&K})};var H=c.get();b.each(H.processors,function(J,K){C(K,D)});b.each(H.ports,function(J,K){C(K,D)});b.each(H.processGroups,function(J,K){C(K,D)});b.each(H.remoteProcessGroups,function(J,K){C(K,D)});b.each(H.connections,function(J,K){C(K,F)})};var c={init:function(){j.init(i,n,h,o,f);q.init(i,n,h,o);a.init(i,n,h,o,f);l.init(i,n,h,o,f);d.init(i,n,h,o);k.init(i,n,h,o,f);g.init(h,o,f,r);return s.showDeepLink(true)},add:function(y,w){var x=false;if(e.isDefinedAndNotNull(w)){x=e.isDefinedAndNotNull(w.selectAll)?w.selectAll:x}if(x){s.getSelection().classed("selected",false)}var z=p(y);j.add(y.labels,w);q.add(y.funnels,w);l.add(y.remoteProcessGroups,w);a.add(z,w);d.add(y.processGroups,w);k.add(y.processors,w);g.add(y.connections,w);if(x){v.digest()}},set:function(y,w){var x=false;if(e.isDefinedAndNotNull(w)){x=e.isDefinedAndNotNull(w.selectAll)?w.selectAll:x}if(x){s.getSelection().classed("selected",false)}var z=p(y);j.set(y.labels,w);q.set(y.funnels,w);l.set(y.remoteProcessGroups,w);a.set(z,w);d.set(y.processGroups,w);k.set(y.processors,w);g.set(y.connections,w);if(x){v.digest()}},expireCaches:function(w){j.expireCaches(w);q.expireCaches(w);l.expireCaches(w);a.expireCaches(w);d.expireCaches(w);k.expireCaches(w);g.expireCaches(w)},get:function(){return{labels:j.get(),funnels:q.get(),ports:a.get(),remoteProcessGroups:l.get(),processGroups:d.get(),processors:k.get(),connections:g.get()}},getComponentByType:function(w){switch(w){case"Label":return j;break;case"Funnel":return q;break;case"Port":return a;break;case"RemoteProcessGroup":return l;break;case"ProcessGroup":return d;break;case"Processor":return k;break;case"Connection":return g;break;default:throw new Error("Unknown component type.");break}},removeAll:function(){j.removeAll();q.removeAll();a.removeAll();l.removeAll();d.removeAll();k.removeAll();g.removeAll()},pan:function(){a.pan();l.pan();d.pan();k.pan();g.pan()},updateVisibility:function(){t();c.pan();s.setURLParameters()},getSelection:function(){return u.selectAll("g.component.selected, g.connection.selected")},reload:function(w){var x=w.datum();if(x.permissions.canRead){if(s.isProcessor(w)){k.reload(x.id)}else{if(s.isInputPort(w)){a.reload(x.id)}else{if(s.isRemoteProcessGroup(w)){l.reload(x.id)}}}}}};return c}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ng.Bridge","nf.ErrorHandler","nf.Dialog","nf.Storage","nf.Common","nf.Client","nf.CanvasUtils","nf.ProcessGroup","nf.ProcessGroupConfiguration","nf.Graph","nf.Birdseye"],function(i,k,m,h,j,f,n,g,d,e,l,c){return(nf.FlowVersion=b(i,k,m,h,j,f,n,g,d,e,l,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.FlowVerison=b(require("jquery"),require("nf.ng.Bridge"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Storage"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ProcessGroup"),require("nf.ProcessGroupConfiguration"),require("nf.Graph"),require("nf.Birdseye")))}else{nf.FlowVersion=b(a.$,a.nf.ng.Bridge,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Storage,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ProcessGroup,a.nf.ProcessGroupConfiguration,a.nf.Graph,a.nf.Birdseye)}}}(this,function(u,j,b,h,n,D,f,J,q,y,m,d){var o=null;var t={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var K=function(){u("#save-flow-version-registry-combo").combo("destroy").hide();u("#save-flow-version-bucket-combo").combo("destroy").hide();u("#save-flow-version-label").text("");u("#save-flow-version-registry").text("").hide();u("#save-flow-version-bucket").text("").hide();u("#save-flow-version-name").text("").hide();u("#save-flow-version-description").removeClass("unset blank").text("").hide();u("#save-flow-version-name-field").val("").hide();u("#save-flow-version-description-field").val("").hide();u("#save-flow-version-change-comments").val("");u("#save-flow-version-process-group-id").removeData("versionControlInformation").removeData("revision").text("")};var C=function(){u("#revert-local-changes-process-group-id").text("");z(u("#revert-local-changes-table"),u("#revert-local-changes-filter"),u("#displayed-revert-local-changes-entries"),u("#total-revert-local-changes-entries"))};var a=function(){z(u("#show-local-changes-table"),u("#show-local-changes-filter"),u("#displayed-show-local-changes-entries"),u("#total-show-local-changes-entries"))};var z=function(V,R,T,U){var Q=V.data("gridInstance");if(D.isDefinedAndNotNull(Q)){Q.setSelectedRows([]);Q.resetActiveCell();var S=Q.getData();S.setItems([]);S.setFilterArgs({searchString:""})}R.val("");T.text("0");U.text("0")};var l=function(){var Q=u("#import-flow-version-table").data("gridInstance");if(D.isDefinedAndNotNull(Q)){Q.setSelectedRows([]);Q.resetActiveCell();var R=Q.getData();R.setItems([])}};var P=function(){u("#import-flow-version-dialog").removeData("pt");u("#import-flow-version-registry-combo").combo("destroy").hide();u("#import-flow-version-bucket-combo").combo("destroy").hide();u("#import-flow-version-name-combo").combo("destroy").hide();u("#import-flow-version-registry").text("").hide();u("#import-flow-version-bucket").text("").hide();u("#import-flow-version-name").text("").hide();l();u("#import-flow-version-process-group-id").removeData("versionControlInformation").removeData("revision").text("");u("#import-flow-version-container").hide();u("#import-flow-version-label").text("")};var N=function(S,Q,U,R,T,V){return u.ajax({type:"GET",url:"../nifi-api/flow/registries",dataType:"json"}).done(function(W){var X=[];if(D.isDefinedAndNotNull(W.registries)&&W.registries.length>0){W.registries.sort(function(Z,Y){return Z.registry.name>Y.registry.name});u.each(W.registries,function(Z,aa){var Y=aa.registry;X.push({text:Y.name,value:Y.id,description:D.escapeHtml(Y.description)})})}else{X.push({text:"No available registries",value:null,optionClass:"unset",disabled:true})}Q.combo({options:X,select:function(Y){k(S,Y,U,R,T,V)}})}).fail(b.handleAjaxError)};var O=function(Q,T,R,S,U){return u.ajax({type:"GET",url:"../nifi-api/flow/registries/"+encodeURIComponent(Q)+"/buckets",dataType:"json"}).done(function(V){var W=[];if(D.isDefinedAndNotNull(V.buckets)&&V.buckets.length>0){V.buckets.sort(function(Y,X){if(Y.permissions.canRead===false&&X.permissions.canRead===false){return 0}else{if(Y.permissions.canRead===false){return -1}else{if(X.permissions.canRead===false){return 1}}}return Y.bucket.name>X.bucket.name});u.each(V.buckets,function(Y,X){if(X.permissions.canRead===true){var Z=X.bucket;if(U(X)){W.push({text:Z.name,value:Z.id,description:D.escapeHtml(Z.description)})}}})}if(W.length===0){W.push({text:"No available buckets",value:null,optionClass:"unset",disabled:true});if(D.isDefinedAndNotNull(R)){R.combo("destroy").combo({options:[{text:"No available flows",value:null,optionClass:"unset",disabled:true}]})}}T.combo("destroy").combo({options:W,select:S})}).fail(b.handleAjaxError)};var k=function(R,U,T,Q,S,W){var V=function(){T.combo("destroy").combo({options:[{text:"No available buckets",value:null,optionClass:"unset",disabled:true}]});if(D.isDefinedAndNotNull(Q)){Q.combo("destroy").combo({options:[{text:"No available flows",value:null,optionClass:"unset",disabled:true}]})}R.modal("refreshButtons")};if(U.disabled===true){V()}else{T.combo("destroy").combo({options:[{text:"Loading buckets...",value:null,optionClass:"unset",disabled:true}]});if(D.isDefinedAndNotNull(Q)){Q.combo("destroy").combo({options:[{text:"Loading flows...",value:null,optionClass:"unset",disabled:true}]});l()}O(U.value,T,Q,S,W).fail(function(){V()})}};var c=function(Q){u("#save-flow-version-dialog").modal("refreshButtons")};var w=function(){var Q=u("#save-flow-version-process-group-id").text();var S=u("#save-flow-version-process-group-id").data("revision");var V={processGroupRevision:f.getRevision({revision:{version:S.version}}),disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged()};var T=u("#save-flow-version-process-group-id").data("versionControlInformation");if(D.isDefinedAndNotNull(T)){V.versionedFlow={registryId:T.registryId,bucketId:T.bucketId,flowId:T.flowId,comments:u("#save-flow-version-change-comments").val()}}else{var R=u("#save-flow-version-registry-combo").combo("getSelectedOption");var U=u("#save-flow-version-bucket-combo").combo("getSelectedOption");V.versionedFlow={registryId:R.value,bucketId:U.value,flowName:u("#save-flow-version-name-field").val(),description:u("#save-flow-version-description-field").val(),comments:u("#save-flow-version-change-comments").val()}}return u.ajax({type:"POST",data:JSON.stringify(V),url:"../nifi-api/versions/process-groups/"+encodeURIComponent(Q),dataType:"json",contentType:"application/json"}).fail(b.handleAjaxError)};var L=function(Q,S){var R=function(U,T){var W=D.isBlank(U[Q.columnId]);var V=D.isBlank(T[Q.columnId]);if(W&&V){return 0}else{if(W){return 1}else{if(V){return -1}}}return U[Q.columnId]===T[Q.columnId]?0:U[Q.columnId]>T[Q.columnId]?1:-1};S.sort(R,Q.sortAsc)};var s=function(){var V=u("#import-flow-version-table");var S=function(aa,X,Z,Y,W){return D.escapeHtml(Z)};var R=function(ad,X,ac,Z,W){var ab=new Date();var Y=ab.getTimezoneOffset()*60*1000;var aa=new Date(W.timestamp+Y+o);return D.formatDateTime(aa)};var Q=[{id:"version",name:"Version",field:"version",formatter:S,sortable:true,resizable:true,width:75,maxWidth:75},{id:"timestamp",name:"Created",field:"timestamp",formatter:R,sortable:true,resizable:true,width:175,maxWidth:175},{id:"changeComments",name:"Comments",field:"comments",sortable:true,resizable:true,formatter:S}];var U=new Slick.Data.DataView({inlineFilters:false});L({columnId:"version",sortAsc:false},U);var T=new Slick.Grid(V,U,Q,t);T.setSelectionModel(new Slick.RowSelectionModel());T.registerPlugin(new Slick.AutoTooltips());T.setSortColumn("version",false);T.onSort.subscribe(function(X,W){L({columnId:W.sortCol.id,sortAsc:W.sortAsc},U)});T.onSelectedRowsChanged.subscribe(function(X,W){u("#import-flow-version-dialog").modal("refreshButtons")});T.onDblClick.subscribe(function(X,W){if(u("#import-flow-version-label").is(":visible")){r()}else{A().always(function(){u("#import-flow-version-dialog").modal("hide")})}});U.onRowCountChanged.subscribe(function(X,W){T.updateRowCount();T.render()});U.onRowsChanged.subscribe(function(X,W){T.invalidateRows(W.rows);T.render()});U.syncGridSelection(T,true);V.data("gridInstance",T)};var I=function(X,U,Z,R){var Y=function(){return U.val()};var T=function(){var ac=X.data("gridInstance");if(D.isDefinedAndNotNull(ac)){var ad=ac.getData();ad.setFilterArgs({searchString:Y()});ad.refresh()}};var S=function(af,ac){if(ac.searchString===""){return true}try{var aj=new RegExp(ac.searchString,"i")}catch(ah){return false}var ad=af.componentId.search(aj)>=0;var ai=af.differenceType.search(aj)>=0;var ae=af.difference.search(aj)>=0;var ag=false;if(D.isDefinedAndNotNull(af.componentName)){ag=af.componentName.search(aj)>=0}return ad||ag||ai||ae};U.on("keyup",function(){T()});var W=function(ag,ad,af,ae,ac){return D.escapeHtml(af)};var ab=function(ah,ad,ag,af,ac){var ae="";if(ac.differenceType!=="Component Removed"&&D.isDefinedAndNotNull(ac.processGroupId)){ae+='<div class="pointer go-to-component fa fa-long-arrow-right" title="Go To"></div>'}return ae};var aa=[{id:"componentName",name:"Component Name",field:"componentName",formatter:W,sortable:true,resizable:true},{id:"differenceType",name:"Change Type",field:"differenceType",formatter:W,sortable:true,resizable:true},{id:"difference",name:"Difference",field:"difference",formatter:W,sortable:true,resizable:true},{id:"actions",name:"&nbsp;",formatter:ab,sortable:false,resizable:false,width:25}];var Q=new Slick.Data.DataView({inlineFilters:false});Q.setFilterArgs({searchString:Y()});Q.setFilter(S);L({columnId:"componentName",sortAsc:true},Q);var V=new Slick.Grid(X,Q,aa,t);V.setSelectionModel(new Slick.RowSelectionModel());V.registerPlugin(new Slick.AutoTooltips());V.setSortColumn("componentName",true);V.onSort.subscribe(function(ad,ac){L({columnId:ac.sortCol.id,sortAsc:ac.sortAsc},Q)});V.onClick.subscribe(function(af,ad){var ae=u(af.target);var ac=Q.getItem(ad.row);if(V.getColumns()[ad.cell].id==="actions"){if(ae.hasClass("go-to-component")){if(ac.componentType==="Controller Service"){y.showConfiguration(ac.processGroupId).done(function(){y.selectControllerService(ac.componentId);X.closest(".large-dialog").modal("hide")})}else{J.showComponent(ac.processGroupId,ac.componentId).done(function(){X.closest(".large-dialog").modal("hide")})}}}});Q.onRowCountChanged.subscribe(function(ad,ac){V.updateRowCount();V.render();Z.text(D.formatInteger(ac.current))});Q.onRowsChanged.subscribe(function(ad,ac){V.invalidateRows(ac.rows);V.render()});Q.syncGridSelection(V,true);X.data("gridInstance",V);Z.text("0");R.text("0")};var G=function(){var T=u("#new-process-group-dialog").data("pt");u("#import-flow-version-dialog").data("pt",T);var Q=u("#import-flow-version-registry-combo").combo("destroy").combo({options:[{text:"Loading registries...",value:null,optionClass:"unset",disabled:true}]}).show();var S=u("#import-flow-version-bucket-combo").combo("destroy").combo({options:[{text:"Loading buckets...",value:null,optionClass:"unset",disabled:true}]}).show();var R=u("#import-flow-version-name-combo").combo("destroy").combo({options:[{text:"Loading flows...",value:null,optionClass:"unset",disabled:true}]}).show();N(u("#import-flow-version-dialog"),Q,S,R,E,function(U){return true}).done(function(){u("#import-flow-version-dialog").modal("setHeaderText","Import Version").modal("setButtonModel",[{buttonText:"Import",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:M,handler:{click:function(){A().always(function(){u("#import-flow-version-dialog").modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){u(this).modal("hide")}}}]).modal("show");u("#new-process-group-dialog").modal("hide")})};var x=function(R,U,Q){var S=u("#import-flow-version-table").data("gridInstance");var T=S.getData();T.beginUpdate();S.setSelectedRows([]);S.resetActiveCell();T.setItems([]);return u.ajax({type:"GET",url:"../nifi-api/flow/registries/"+encodeURIComponent(R)+"/buckets/"+encodeURIComponent(U)+"/flows/"+encodeURIComponent(Q)+"/versions",dataType:"json"}).done(function(V){if(D.isDefinedAndNotNull(V.versionedFlowSnapshotMetadataSet)&&V.versionedFlowSnapshotMetadataSet.length>0){u.each(V.versionedFlowSnapshotMetadataSet,function(X,W){T.addItem(u.extend({id:W.versionedFlowSnapshotMetadata.version},W.versionedFlowSnapshotMetadata))})}else{h.showOkDialog({headerText:"Flow Versions",dialogContent:"This flow does not have any versions available."})}}).fail(b.handleAjaxError).always(function(){T.endUpdate();T.reSort();S.invalidate()})};var F=function(Q,R,S){return u.ajax({type:"GET",url:"../nifi-api/flow/registries/"+encodeURIComponent(Q)+"/buckets/"+encodeURIComponent(R)+"/flows",dataType:"json"}).done(function(T){var U=[];if(D.isDefinedAndNotNull(T.versionedFlows)&&T.versionedFlows.length>0){T.versionedFlows.sort(function(W,V){return W.versionedFlow.flowName>V.versionedFlow.flowName});u.each(T.versionedFlows,function(W,V){var X=V.versionedFlow;U.push({text:X.flowName,value:X.flowId,description:D.escapeHtml(X.description)})})}else{U.push({text:"No available flows",value:null,optionClass:"unset",disabled:true})}u("#import-flow-version-name-combo").combo("destroy").combo({options:U,select:function(V){if(D.isDefinedAndNotNull(V.value)){S(Q,R,V.value)}else{var W=u("#import-flow-version-table").data("gridInstance");var X=W.getData();X.beginUpdate();X.setItems([]);X.endUpdate()}}})}).fail(b.handleAjaxError)};var p=function(R,S,Q){x(R,S,Q).done(function(){u("#import-flow-version-dialog").modal("refreshButtons")})};var E=function(R){l();if(D.isDefinedAndNotNull(R.value)){u("#import-flow-version-name-combo").combo("destroy").combo({options:[{text:"Loading flows...",value:null,optionClass:"unset",disabled:true}]});var Q=u("#import-flow-version-registry-combo").combo("getSelectedOption");F(Q.value,R.value,p)}else{u("#import-flow-version-name-combo").combo("destroy").combo({options:[{text:"No available flows",value:null,optionClass:"unset",disabled:true}]})}};var A=function(){var W=u("#import-flow-version-dialog").data("pt");var T=u("#import-flow-version-registry-combo").combo("getSelectedOption");var X=u("#import-flow-version-bucket-combo").combo("getSelectedOption");var Q=u("#import-flow-version-name-combo").combo("getSelectedOption");var S=u("#import-flow-version-table").data("gridInstance");var R=S.getSelectedRows();var V=S.getDataItem(R[0]);var U={revision:f.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged(),component:{position:{x:W.x,y:W.y},versionControlInformation:{registryId:T.value,bucketId:X.value,flowId:Q.value,version:V.version}}};return u.ajax({type:"POST",data:JSON.stringify(U),url:"../nifi-api/process-groups/"+encodeURIComponent(J.getGroupId())+"/process-groups",dataType:"json",contentType:"application/json"}).done(function(Y){m.add({processGroups:[Y]},{selectAll:true});m.updateVisibility();d.refresh()}).fail(b.handleAjaxError)};var M=function(){var S=u("#import-flow-version-table").data("gridInstance");if(D.isDefinedAndNotNull(S)){var T=S.getSelectedRows();if(u("#import-flow-version-label").is(":visible")){if(T.length===1){var R=S.getDataItem(T[0]);var Q=parseInt(u("#import-flow-version-label").text(),10);return Q===R.version}else{return true}}else{return T.length!==1}}else{return true}};var r=function(){var ab=null;var S=null;var V=false;var R=u("#import-flow-version-process-group-id").text();var ac=u("#import-flow-version-process-group-id").data("revision");var ad=u("#import-flow-version-process-group-id").data("versionControlInformation");var Q=u("#import-flow-version-table").data("gridInstance");var Z=Q.getSelectedRows();var W=Q.getDataItem(Z[0]);u("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){V=true;u("#change-version-status-dialog").modal("setButtonModel",[]);if(ab!==null){clearTimeout(ab);aa()}}}}]);u("#import-flow-version-dialog").modal("hide");var T=function(){var ae={processGroupRevision:f.getRevision({revision:{version:ac.version}}),disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged(),versionControlInformation:{groupId:R,registryId:ad.registryId,bucketId:ad.bucketId,flowId:ad.flowId,version:W.version}};return u.ajax({type:"POST",data:JSON.stringify(ae),url:"../nifi-api/versions/update-requests/process-groups/"+encodeURIComponent(R),dataType:"json",contentType:"application/json"}).done(function(){g(0);u("#change-version-status-dialog").modal("show")}).fail(b.handleAjaxError)};var X=function(){Y().done(U)};var Y=function(){return u.ajax({type:"GET",url:S.uri,dataType:"json"}).fail(aa).fail(b.handleAjaxError)};var aa=function(){if(V===true){u("#change-version-status-message").text("The change version request has been cancelled.");u("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){u(this).modal("hide")}}}])}if(D.isDefinedAndNotNull(S)){u.ajax({type:"DELETE",url:S.uri+"?"+u.param({disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(ae){S=ae.request;e(R);if(D.isDefinedAndNotNull(S.failureReason)){u("#change-version-status-dialog").modal("hide");h.showOkDialog({headerText:"Change Version",dialogContent:D.escapeHtml(S.failureReason)})}else{g(S.percentCompleted);u("#change-version-status-message").text("This Process Group version has changed.");u("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){u(this).modal("hide")}}}])}})}};var U=function(ae){S=ae.request;if(S.complete===true||V===true){aa()}else{g(S.percentCompleted);u("#change-version-status-message").text(S.state);ab=setTimeout(function(){ab=null;X()},2000)}};T().done(U)};var B=function(Q){return u.Deferred(function(R){if(Q===J.getGroupId()){u.ajax({type:"GET",url:"../nifi-api/versions/process-groups/"+encodeURIComponent(Q),dataType:"json"}).done(function(T){R.resolve(T)}).fail(function(){R.reject()})}else{var S=q.get(Q);if(S.permissions.canRead===true&&S.permissions.canWrite===true){R.resolve({processGroupRevision:S.revision,versionControlInformation:S.component.versionControlInformation})}else{R.reject()}}}).promise()};var H=function(Q,R){if(J.getGroupId()===Q){j.injector.get("breadcrumbsCtrl").updateVersionControlInformation(Q,R);j.digest()}else{q.reload(Q)}};var e=function(Q){if(J.getGroupId()===Q){u.ajax({type:"GET",url:"../nifi-api/flow/process-groups/"+encodeURIComponent(Q),dataType:"json"}).done(function(S){m.set(S.processGroupFlow.flow);m.updateVisibility();var R=j.injector.get("breadcrumbsCtrl");R.resetBreadcrumbs();R.generateBreadcrumbs(S.processGroupFlow.breadcrumb);j.digest()}).fail(b.handleAjaxError)}else{q.reload(Q)}};var g=function(R){var S=u("#change-version-percent-complete");S.find("div.progress-label").remove();S.find("md-progress-linear").remove();var Q=u('<div class="progress-label"></div>').text(R+"%");(j.injector.get("$compile")(u('<md-progress-linear ng-cloak ng-value="'+R+'" class="md-hue-2" md-mode="determinate" aria-label="Searching Queue"></md-progress-linear>'))(j.rootScope)).appendTo(S);S.append(Q)};var v=function(Q,R,X,W){var S=X.data("gridInstance");var T=S.getData();T.beginUpdate();S.setSelectedRows([]);S.resetActiveCell();T.setItems([]);var V=B(Q).done(function(Y){if(D.isDefinedAndNotNull(Y.versionControlInformation)){var Z=Y.versionControlInformation;R.text("The following changes have been made to "+Z.flowName+" (Version "+Z.version+").")}else{h.showOkDialog({headerText:"Change Version",dialogContent:"This Process Group is not currently under version control."})}});var U=u.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(Q)+"/local-modifications",dataType:"json"}).done(function(Y){if(D.isDefinedAndNotNull(Y.componentDifferences)&&Y.componentDifferences.length>0){var Z=0;u.each(Y.componentDifferences,function(ab,aa){u.each(aa.differences,function(ac,ad){T.addItem({id:Z++,componentId:aa.componentId,componentName:aa.componentName,componentType:aa.componentType,processGroupId:aa.processGroupId,differenceType:ad.differenceType,difference:ad.difference})})});T.endUpdate();T.reSort();S.invalidate();W.text(D.formatInteger(Z))}else{h.showOkDialog({headerText:"Local Changes",dialogContent:"This Process Group does not have any local changes."})}}).fail(b.handleAjaxError);return u.when(V,U)};var i=function(Q){B(Q).done(function(U){if(D.isDefinedAndNotNull(U.versionControlInformation)){var Z=null;var Y=null;var V=false;u("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){V=true;u("#change-version-status-dialog").modal("setButtonModel",[]);if(Z!==null){clearTimeout(Z);X()}}}}]);u("#import-flow-version-dialog").modal("hide");var S=function(){var aa={processGroupRevision:f.getRevision({revision:{version:U.processGroupRevision.version}}),disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged(),versionControlInformation:U.versionControlInformation};return u.ajax({type:"POST",data:JSON.stringify(aa),url:"../nifi-api/versions/revert-requests/process-groups/"+encodeURIComponent(Q),dataType:"json",contentType:"application/json"}).done(function(){g(0);u("#change-version-status-dialog").modal("show")}).fail(b.handleAjaxError)};var T=function(){W().done(R)};var W=function(){return u.ajax({type:"GET",url:Y.uri,dataType:"json"}).fail(X).fail(b.handleAjaxError)};var X=function(){if(V===true){u("#change-version-status-message").text("The revert request has been cancelled.");u("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){u(this).modal("hide")}}}])}if(D.isDefinedAndNotNull(Y)){u.ajax({type:"DELETE",url:Y.uri+"?"+u.param({disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(aa){Y=aa.request;e(Q);if(D.isDefinedAndNotNull(Y.failureReason)){u("#change-version-status-dialog").modal("hide");h.showOkDialog({headerText:"Revert Local Changes",dialogContent:D.escapeHtml(Y.failureReason)})}else{g(Y.percentCompleted);u("#change-version-status-message").text("This Process Group version has changed.");u("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){u(this).modal("hide")}}}])}})}};var R=function(aa){Y=aa.request;if(Y.complete===true||V===true){X()}else{g(Y.percentCompleted);u("#change-version-status-message").text(Y.state);Z=setTimeout(function(){Z=null;T()},2000)}};S().done(R)}else{h.showOkDialog({headerText:"Revert Changes",dialogContent:"This Process Group is not currently under version control."})}}).fail(b.handleAjaxError)};return{init:function(Q){o=Q;u("#save-flow-version-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Save Flow Version",buttons:[{buttonText:"Save",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(u("#save-flow-version-registry-combo").is(":visible")){var R=u("#save-flow-version-registry-combo").combo("getSelectedOption");var S=u("#save-flow-version-bucket-combo").combo("getSelectedOption");if(D.isDefinedAndNotNull(R)&&D.isDefinedAndNotNull(S)){return R.disabled===true||S.disabled===true}else{return true}}else{return false}},handler:{click:function(){var R=u("#save-flow-version-process-group-id").text();w().done(function(S){H(R,S.versionControlInformation)});u(this).modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){u(this).modal("hide")}}}],handler:{close:function(){K()}}});u("#import-flow-version-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){P()}}});u("#change-version-status-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Change Flow Version",handler:{close:function(){u("#change-version-status-dialog").modal("setButtonModel",[])}}});u("#revert-local-changes-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Revert Local Changes",buttons:[{buttonText:"Revert",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var R=u("#revert-local-changes-process-group-id").text();i(R);u(this).modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){u(this).modal("hide")}}}],handler:{close:function(){C()}}});u("#show-local-changes-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Show Local Changes",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){u(this).modal("hide")}}}],handler:{close:function(){a()}}});u("#import-process-group-link").on("click",function(){G()});s();I(u("#revert-local-changes-table"),u("#revert-local-changes-filter"),u("#displayed-revert-local-changes-entries"),u("#total-revert-local-changes-entries"));I(u("#show-local-changes-table"),u("#show-local-changes-filter"),u("#displayed-show-local-changes-entries"),u("#total-show-local-changes-entries"))},showFlowVersionDialog:function(Q){var R=true;return u.Deferred(function(S){B(Q).done(function(T){if(D.isDefinedAndNotNull(T.versionControlInformation)){var W=T.versionControlInformation;u("#save-flow-version-registry").text(W.registryName).show();u("#save-flow-version-bucket").text(W.bucketName).show();u("#save-flow-version-label").text(W.version+1);u("#save-flow-version-name").text(W.flowName).show();D.populateField("save-flow-version-description",W.flowDescription);u("#save-flow-version-description").show();u("#save-flow-version-process-group-id").data("versionControlInformation",W);u("#save-flow-version-label").css("margin-top","-15px");R=false;S.resolve()}else{var U=u("#save-flow-version-registry-combo").combo("destroy").combo({options:[{text:"Loading registries...",value:null,optionClass:"unset",disabled:true}]}).show();var V=u("#save-flow-version-bucket-combo").combo("destroy").combo({options:[{text:"Loading buckets...",value:null,optionClass:"unset",disabled:true}]}).show();u("#save-flow-version-label").text(1);u("#save-flow-version-name-field").show();u("#save-flow-version-description-field").show();u("#save-flow-version-label").css("margin-top","0");N(u("#save-flow-version-dialog"),U,V,null,c,function(X){return X.permissions.canWrite===true}).done(function(){S.resolve()}).fail(function(){S.reject()})}u("#save-flow-version-process-group-id").data("revision",T.processGroupRevision).text(Q)}).fail(b.handleAjaxError)}).done(function(){u("#save-flow-version-dialog").modal("show");if(R){u("#save-flow-version-name-field").focus()}else{u("#save-flow-version-change-comments").focus()}}).fail(function(){u("#save-flow-version-dialog").modal("refreshButtons")}).promise()},revertLocalChanges:function(Q){v(Q,u("#revert-local-changes-message"),u("#revert-local-changes-table"),u("#total-revert-local-changes-entries")).done(function(){u("#revert-local-changes-process-group-id").text(Q);u("#revert-local-changes-dialog").modal("show")})},showLocalChanges:function(Q){v(Q,u("#show-local-changes-message"),u("#show-local-changes-table"),u("#total-show-local-changes-entries")).done(function(){u("#show-local-changes-dialog").modal("show")})},showChangeFlowVersionDialog:function(Q){return u.Deferred(function(R){B(Q).done(function(S){if(D.isDefinedAndNotNull(S.versionControlInformation)){var T=S.versionControlInformation;u("#import-flow-version-registry").text(T.registryName).show();u("#import-flow-version-bucket").text(T.bucketName).show();u("#import-flow-version-name").text(T.flowName).show();u("#import-flow-version-container").show();u("#import-flow-version-label").text(T.version);u("#import-flow-version-process-group-id").data("versionControlInformation",T).data("revision",S.processGroupRevision).text(Q);x(T.registryId,T.bucketId,T.flowId).done(function(){R.resolve()}).fail(function(){h.showOkDialog({headerText:"Change Version",dialogContent:"Unable to load available versions for this Process Group."});R.reject()})}else{h.showOkDialog({headerText:"Change Version",dialogContent:"This Process Group is not currently under version control."});R.reject()}}).fail(b.handleAjaxError)}).done(function(){u("#import-flow-version-dialog").modal("setHeaderText","Change Version").modal("setButtonModel",[{buttonText:"Change",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:M,handler:{click:function(){r()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){u(this).modal("hide")}}}]).modal("show")}).promise()},stopVersionControl:function(Q){h.showYesNoDialog({headerText:"Stop Version Control",dialogContent:"Are you sure you want to stop version control?",noText:"Cancel",yesText:"Disconnect",yesHandler:function(){u.ajax({type:"GET",url:"../nifi-api/versions/process-groups/"+encodeURIComponent(Q),dataType:"json"}).done(function(R){if(D.isDefinedAndNotNull(R.versionControlInformation)){var S=f.getRevision({revision:{version:R.processGroupRevision.version}});u.ajax({type:"DELETE",url:"../nifi-api/versions/process-groups/"+encodeURIComponent(Q)+"?"+u.param(u.extend({disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged()},S)),dataType:"json",contentType:"application/json"}).done(function(T){H(Q,undefined);h.showOkDialog({headerText:"Disconnect",dialogContent:"This Process Group is no longer under version control."})}).fail(b.handleAjaxError)}else{h.showOkDialog({headerText:"Disconnect",dialogContent:"This Process Group is not currently under version control."})}}).fail(b.handleAjaxError)}})}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.FilteredDialogCommon=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.FilteredDialogCommon=b(require("jquery")))}else{nf.FilteredDialogCommon=b(a.$)}}}(this,function(a){var b={addKeydownListener:function(e,d,c){var f=[a.ui.keyCode.UP,a.ui.keyCode.PAGE_UP,a.ui.keyCode.DOWN,a.ui.keyCode.PAGE_DOWN];a(e).off("keydown").on("keydown",function(j){var i=j.keyCode?j.keyCode:j.which;if(a.inArray(i,f)===-1||j.shiftKey||j.altKey||j.ctrlKey){return}var h=d.getSelectedRows();if(h.length>0){if(i===a.ui.keyCode.PAGE_UP){d.navigatePageUp();return}if(i===a.ui.keyCode.PAGE_DOWN){d.navigatePageDown();return}var g=h[0];if(i===a.ui.keyCode.UP){g=Math.max(g-1,0)}else{g=Math.min(g+1,c.getLength()-1)}b.choseRow(d,g);d.scrollRowIntoView(g,false)}})},choseFirstRow:function(c){b.choseRow(c,0)},choseRow:function(d,c){d.setSelectedRows([c]);d.setActiveCell(c,0)}};return b}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.ErrorHandler"],function(e,c,f,d,g){return(nf.StatusHistory=b(e,c,f,d,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.StatusHistory=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.ErrorHandler")))}else{nf.StatusHistory=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.ErrorHandler)}}}(this,function(e,x,h,s,g){var w={nifiInstanceId:"nifi-instance-id",nifiInstanceLabel:"NiFi",type:{processor:"Processor",inputPort:"Input Port",outputPort:"Output Port",processGroup:"Process Group",remoteProcessGroup:"Remote Process Group",connection:"Connection",funnel:"Funnel",template:"Template",label:"Label"},urls:{api:"../nifi-api"}};var v={DURATION:function(z){return h.formatDuration(z)},COUNT:function(z){if(z%1===0){return h.formatInteger(z)}else{return h.formatFloat(z)}},DATA_SIZE:function(z){return h.formatDataSize(z)}};var n=null;var c=null;var q=null;var d=null;var k=function(B,F,D,A,E){e("#status-history-last-refreshed").text(D.generated);var z={groupId:B,id:F,type:A,instances:[]};var C=D.fieldDescriptors;z.details=D.componentDetails;z.selectedDescriptor=h.isUndefined(E)?C[0]:E;if(h.isDefinedAndNotNull(D.aggregateSnapshots)&&D.aggregateSnapshots.length>1){z.instances.push({id:w.nifiInstanceId,label:w.nifiInstanceLabel,snapshots:D.aggregateSnapshots})}else{j();return}e.each(D.nodeSnapshots,function(H,G){if(h.isDefinedAndNotNull(G.statusSnapshots)&&G.statusSnapshots.length>1){z.instances.push({id:G.nodeId,label:G.address+":"+G.apiPort,snapshots:G.statusSnapshots})}});if(z.instances.length>0){e("#status-history-dialog").data("status-history",z);r(z,C)}else{j()}};var j=function(){s.showOkDialog({headerText:"Status History",dialogContent:"Insufficient history, please try again later."})};var r=function(z,A){if(d===null){d={}}e.each(z.instances,function(C,B){B.snapshots.forEach(function(F){var E=new Date();var D=E.getTimezoneOffset()*60*1000;F.timestamp=new Date(F.timestamp+D+n)})});m(A,z.selectedDescriptor)};var m=function(B,A){var z=[];e.each(B,function(C,D){z.push({text:D.label,value:D.field,description:h.escapeHtml(D.description)})});e("#status-history-metric-combo").combo({selectedOption:{value:A.field},options:z,select:function(D){var E=null;e.each(B,function(F,G){if(D.value===G.field){E=G;return false}});if(E!==null){if(q===null||q.field!==E.field){c=null}q=E;var C=e("#status-history-dialog").data("status-history");C.selectedDescriptor=E;e("#status-history-dialog").data("status-history",C);l()}}});e("#status-history-dialog").modal("show")};var a=function(){return e("#status-history-chart-container").parent().outerHeight()-e("#status-history-chart-control-container").outerHeight()-parseInt(e("#status-history-chart-control-container").css("margin-top"),10)};var y=function(){return e("body").height()-e("#status-history-chart-control-container").outerHeight()-e("#status-history-refresh-container").outerHeight()-parseInt(e("#status-history-chart-control-container").css("margin-top"),10)-parseInt(e(".dialog-content").css("top"))-parseInt(e(".dialog-content").css("bottom"))};var u=function(){return e("body").width()-e("#status-history-details").innerWidth()-parseInt(e("#status-history-dialog").css("left"),10)-parseInt(e(".dialog-content").css("left"))-parseInt(e(".dialog-content").css("right"))};var l=function(){var ah=e("#status-history-dialog");if(ah.is(":visible")){var aa=ah.data("status-history");var ag=aa.selectedDescriptor;e("#status-history-details").empty();var C=o("Status History");x.map(aa.details).each(function(aw,av){i(C,av,aw)});var E={top:15,right:20,bottom:25,left:75};var X=x.scaleOrdinal(x.schemeCategory10);var B=[];e.each(aa.instances,function(aw,av){B.push(av.label)});X.domain(B);var ar=[];e.each(aa.instances,function(aw,av){if(h.isUndefinedOrNull(d[av.id])){d[av.id]=true}ar.push({id:av.id,label:av.label,values:e.map(av.snapshots,function(ax){return{timestamp:ax.timestamp,value:ax.statusMetrics[ag.field]}}),visible:d[av.id]===true})});var O=function(av){if(av.getMilliseconds()){return x.timeFormat(":%S.%L")(av)}else{if(av.getSeconds()){return x.timeFormat(":%S")(av)}else{if(av.getMinutes()||av.getHours()){return x.timeFormat("%H:%M")(av)}else{if(av.getDay()&&av.getDate()!==1){return x.timeFormat("%a %d")(av)}else{if(av.getDate()!==1){return x.timeFormat("%b %d")(av)}else{if(av.getMonth()){return x.timeFormat("%B")(av)}else{return x.timeFormat("%Y")(av)}}}}}}};var N=e("#status-history-chart-container").empty();if(N.hasClass("ui-resizable")){N.resizable("destroy");N.removeAttr("style")}N.height(a());var z=N.outerWidth()-E.left-E.right;var A=N.outerHeight()-E.top-E.bottom;V=e("#status-history-container").width();if(z>V){z=V}am=y();if(A>am){A=am}var ae=x.scaleTime().range([0,z]);var U=x.axisBottom(ae).ticks(5).tickFormat(O);var ad=x.scaleLinear().range([A,0]);var F=x.axisLeft(ad).tickFormat(v[ag.formatter]);var G=x.line().curve(x.curveMonotoneX).x(function(av){return ae(av.timestamp)}).y(function(av){return ad(av.value)});var M=x.select("#status-history-chart-container").append("svg").attr("style","pointer-events: none;").attr("width",N.parent().width()).attr("height",N.innerHeight());var H=M.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",z).attr("height",A);var au=M.append("g").attr("transform","translate("+E.left+", "+E.top+")");var D=x.min(ar,function(av){return x.min(av.values,function(aw){return aw.timestamp})});var K=x.max(ar,function(av){return x.max(av.values,function(aw){return aw.timestamp})});i(C,"Start",h.formatDateTime(D));i(C,"End",h.formatDateTime(K));ae.domain([D,K]);ad.domain([p(ar),t(ar)]);au.append("g").attr("class","x axis").attr("transform","translate(0, "+A+")").call(U);au.append("g").attr("class","y axis").call(F).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").attr("text-anchor","end").text(ag.label);var ab=au.selectAll(".status").data(ar).enter().append("g").attr("clip-path","url(#clip)").attr("class","status");ab.append("path").attr("class",function(av){return"chart-line chart-line-"+av.id}).attr("d",function(av){return G(av.values)}).attr("stroke",function(av){return X(av.label)}).classed("hidden",function(av){return av.visible===false}).append("title").text(function(av){return av.label});ab.each(function(av){var aw=x.select(this).append("g").attr("class",function(){return"mark-group mark-group-"+av.id}).classed("hidden",function(ax){return ax.visible===false});aw.selectAll("circle.mark").data(av.values).enter().append("circle").attr("style","pointer-events: all;").attr("class","mark").attr("cx",function(ax){return ae(ax.timestamp)}).attr("cy",function(ax){return ad(ax.value)}).attr("fill",function(){return X(av.label)}).attr("r",1.5).append("title").text(function(ax){return av.label+" -- "+v[ag.formatter](ax.value)})});M.attr("width",N.parent().width()).attr("height",N.innerHeight());H.attr("width",z).attr("height",A);au.select(".x.axis").attr("transform","translate(0, "+A+")");var T=e("#status-history-chart-control-container").empty();var R=T.innerHeight()-E.top-E.bottom;var ak=x.scaleTime().range([0,z]);var J=x.axisBottom(ak).ticks(5).tickFormat(O);var ao=x.scaleLinear().range([R,0]);var ai=x.axisLeft(ao).tickValues(ad.domain()).tickFormat(v[ag.formatter]);var Q=x.line().curve(x.curveMonotoneX).x(function(av){return ak(av.timestamp)}).y(function(av){return ao(av.value)});var af=x.select("#status-history-chart-control-container").append("svg").attr("width",N.parent().width()).attr("height",R+E.top+E.bottom);var W=af.append("g").attr("transform","translate("+E.left+", "+E.top+")");ak.domain(ae.domain());ao.domain(ad.domain());W.append("g").attr("class","x axis").attr("transform","translate(0, "+R+")").call(J);W.append("g").attr("class","y axis").call(ai);var at=W.selectAll(".status").data(ar).enter().append("g").attr("class","status");at.append("path").attr("class",function(av){return"chart-line chart-line-"+av.id}).attr("d",function(av){return Q(av.values)}).attr("stroke",function(av){return X(av.label)}).classed("hidden",function(av){return d[av.id]===false}).append("title").text(function(av){return av.label});var L=function(){var aA=e.map(ar,function(aG){var aE=ae.domain();var aF=ad.domain();var aH=e.extend({},aG);return e.extend(aH,{values:e.grep(aG.values,function(aI){return aI.timestamp.getTime()>=aE[0].getTime()&&aI.timestamp.getTime()<=aE[1].getTime()&&aI.value>=aF[0]&&aI.value<=aF[1]})})});var av=e.grep(aA,function(aE){return aE.id!==w.nifiInstanceId&&aE.visible&&aE.values.length>0});var az=av.length===0?"NA":v[ag.formatter](p(av));var ay=av.length===0?"NA":v[ag.formatter](f(av));var aw=av.length===0?"NA":v[ag.formatter](t(av));e("#node-aggregate-statistics").text(az+" / "+aw+" / "+ay);var aC=e.grep(aA,function(aE){return aE.id===w.nifiInstanceId&&aE.visible&&aE.values.length>0});var aD=aC.length===0?"NA":v[ag.formatter](p(aC));var aB=aC.length===0?"NA":v[ag.formatter](f(aC));var ax=aC.length===0?"NA":v[ag.formatter](t(aC));e("#cluster-aggregate-statistics").text(aD+" / "+ax+" / "+aB)};var aq=function(av,aw){ae.domain(av);ad.domain(aw);ab.selectAll(".chart-line").attr("d",function(ax){return G(ax.values)});ab.selectAll("circle.mark").attr("cx",function(ax){return ae(ax.timestamp)}).attr("cy",function(ax){return ad(ax.value)}).attr("r",function(){return x.brushSelection(P.node())===null?1.5:4});au.select(".x.axis").call(U);au.select(".y.axis").call(F)};var I=function(){c=x.brushSelection(P.node());var aw,av;if(c===null){var ax=e.grep(ar,function(ay){return ay.visible});if(ax.length===0){av=ao.domain()}else{av=[x.min(ax,function(ay){return x.min(ay.values,function(az){return az.value})}),x.max(ax,function(ay){return x.max(ay.values,function(az){return az.value})})]}aw=ak.domain()}else{aw=[c[0][0],c[1][0]].map(ak.invert,ak);av=[c[1][1],c[0][1]].map(ao.invert,ao)}aq(aw,av);L()};var al=x.brush().extent([[ak.range()[0],ao.range()[1]],[ak.range()[1],ao.range()[0]]]).on("brush",I);var P=W.append("g").attr("class","brush").on("click",I).call(al);if(h.isDefinedAndNotNull(c)){al=al.move(P,c)}W.select("rect.selection").attr("style","pointer-events: all;").on("dblclick",function(){if(c!==null){var av=ao.range();al.move(P,[[c[0][0],av[1]],[c[1][0],av[0]]])}});var ac=e.grep(ar,function(av){return av.id!==w.nifiInstanceId}).sort(function(aw,av){return aw.label<av.label?-1:aw.label>av.label?1:0});var ap=function(aw,av){var ay=e("<div></div>").addClass("legend-label nf-checkbox-label").css("color",X(av.label)).text(av.label).ellipsis();var ax=e('<div class="nf-checkbox"></div>').on("click",function(){var az=x.selectAll("path.chart-line-"+av.id);var aB=x.select("g.mark-group-"+av.id);var aA=aB.classed("hidden");az.classed("hidden",function(){return !aA});aB.classed("hidden",function(){return !aA});av.visible=aA;d[av.id]=av.visible;I()}).addClass(av.visible?"checkbox-checked":"checkbox-unchecked");e('<div class="legend-entry"></div>').append(ax).append(ay).on("mouseenter",function(){x.selectAll("path.chart-line-"+av.id).classed("over",true)}).on("mouseleave",function(){x.selectAll("path.chart-line-"+av.id).classed("over",false)}).appendTo(aw)};var Z=e.grep(ar,function(av){return av.id===w.nifiInstanceId});var aj=o("NiFi");i(aj,"Min / Max / Mean","","cluster-aggregate-statistics");ap(aj,Z[0]);if(ac.length>0){var Y=o("Nodes");i(Y,"Min / Max / Mean","","node-aggregate-statistics");e.each(ac,function(aw,av){ap(Y,av)})}I();var V,am,S,an;N.append('<div class="ui-resizable-handle ui-resizable-se"></div>').resizable({minWidth:425,minHeight:150,handles:{se:".ui-resizable-se"},resize:function(ax,aw){an=e("#status-history-dialog");var av={};if(h.isDefinedAndNotNull(an.data("nf-dialog"))){av=an.data("nf-dialog")}av["min-width"]=(an.width()/e(window).width())*100+"%";av["min-height"]=(an.height()/e(window).height())*100+"%";av.responsive["fullscreen-width"]=an.outerWidth()+"px";av.responsive["fullscreen-height"]=an.outerHeight()+"px";V=u();if(aw.helper.width()>V){aw.helper.width(V);av.responsive["fullscreen-width"]=e(window).width()+"px";av["min-width"]="100%"}am=y();if(aw.helper.height()>am){aw.helper.height(am);av.responsive["fullscreen-height"]=e(window).height()+"px";av["min-height"]="100%"}S=a();if(aw.helper.height()<S){aw.helper.height(S)}av["min-width"]=(parseInt(av["min-width"],10)>=100)?"100%":av["min-width"];av["min-height"]=(parseInt(av["min-height"],10)>=100)?"100%":av["min-height"];an.data("nfDialog",av);an.css("min-width",(N.outerWidth()+e("#status-history-details").outerWidth()+40));an.css("min-height",(N.outerHeight()+e("#status-history-refresh-container").outerHeight()+e("#status-history-chart-control-container").outerHeight()+e(".dialog-buttons").outerHeight()+e(".dialog-header").outerHeight()+40+5));an.center()},stop:l})}};var p=function(z){return x.min(z,function(A){return x.min(A.values,function(B){return B.value})})};var t=function(z){return x.max(z,function(A){return x.max(A.values,function(B){return B.value})})};var f=function(A){var B=0;var z=x.sum(A,function(C){B+=C.values.length;return x.sum(C.values,function(D){return D.value})});return z/B};var o=function(A){var z=e('<div class="status-history-detail"></div>').appendTo("#status-history-details");e('<div class="detail-container-label"></div>').text(A).appendTo(z);return e("<div></div>").appendTo(z)};var i=function(A,C,D,E){var B=e('<div class="detail-item"></div>').appendTo(A);e('<div class="setting-name"></div>').text(C).appendTo(B);var z=e('<div class="setting-field"></div>').text(D).appendTo(B);if(h.isDefinedAndNotNull(E)){z.attr("id",E)}};var b={init:function(z){n=z;e("#status-history-refresh-button").click(function(){var A=e("#status-history-dialog").data("status-history");if(A!==null){if(A.type===w.type.processor){b.showProcessorChart(A.groupId,A.id,A.selectedDescriptor)}else{if(A.type===w.type.processGroup){b.showProcessGroupChart(A.groupId,A.id,A.selectedDescriptor)}else{if(A.type===w.type.remoteProcessGroup){b.showRemoteProcessGroupChart(A.groupId,A.id,A.selectedDescriptor)}else{b.showConnectionChart(A.groupId,A.id,A.selectedDescriptor)}}}}});e("#status-history-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Status History",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){e("#status-history-dialog").removeData("status-history");e("#status-history-chart-container").empty();e("#status-history-chart-control-container").empty();e("#status-history-details").empty();c=null;q=null;d=null},open:l}});e(window).on("resize",function(A){if(A.target===window){l()}h.toggleScrollable(e("#status-history-details").get(0))})},showConnectionChart:function(z,A,B){e.ajax({type:"GET",url:w.urls.api+"/flow/connections/"+encodeURIComponent(A)+"/status/history",dataType:"json"}).done(function(C){k(z,A,C.statusHistory,w.type.connection,B)}).fail(g.handleAjaxError)},showProcessorChart:function(z,B,A){e.ajax({type:"GET",url:w.urls.api+"/flow/processors/"+encodeURIComponent(B)+"/status/history",dataType:"json"}).done(function(C){k(z,B,C.statusHistory,w.type.processor,A)}).fail(g.handleAjaxError)},showProcessGroupChart:function(A,z,B){e.ajax({type:"GET",url:w.urls.api+"/flow/process-groups/"+encodeURIComponent(z)+"/status/history",dataType:"json"}).done(function(C){k(A,z,C.statusHistory,w.type.processGroup,B)}).fail(g.handleAjaxError)},showRemoteProcessGroupChart:function(A,z,B){e.ajax({type:"GET",url:w.urls.api+"/flow/remote-process-groups/"+encodeURIComponent(z)+"/status/history",dataType:"json"}).done(function(C){k(A,z,C.statusHistory,w.type.remoteProcessGroup,B)}).fail(g.handleAjaxError)}};return b}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Common","nf.Dialog","nf.Shell","nf.ng.Bridge","nf.ClusterSummary","nf.ErrorHandler","nf.Storage","nf.CanvasUtils"],function(h,e,f,g,c,j,l,k,i,d){return(nf.QueueListing=b(h,e,f,g,c,j,l,k,i,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.QueueListing=b(require("jquery"),require("Slick"),require("nf.Common"),require("nf.Dialog"),require("nf.Shell"),require("nf.ng.Bridge"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Storage"),require("nf.CanvasUtils")))}else{nf.QueueListing=b(a.$,a.Slick,a.nf.Common,a.nf.Dialog,a.nf.Shell,a.nf.ng.Bridge,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Storage,a.nf.CanvasUtils)}}}(this,function(c,n,h,i,o,r,g,e,d,m){var p={urls:{uiExtensionToken:"../nifi-api/access/ui-extension-token",downloadToken:"../nifi-api/access/download-token"}};var l=function(){c("#listing-request-status-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Queue Listing",handler:{close:function(){c("#listing-request-status-dialog").modal("setButtonModel",[])}}})};var q=function(){var s=function(C,z,B,A,y){return'<div class="pointer show-flowfile-details fa fa-info-circle" title="View Details" style="float: left;"></div>'};var x=function(C,z,B,A,y){return h.formatDataSize(B)};var u=function(C,z,B,A,y){return h.formatDuration(B)};var t=function(C,z,B,A,y){if(B==0){return"No"}return h.formatDuration(B)};var w=[{id:"moreDetails",field:"moreDetails",name:"&nbsp;",sortable:false,resizable:false,formatter:s,width:50,maxWidth:50},{id:"position",name:"Position",field:"position",sortable:false,resizable:false,width:75,maxWidth:75,formatter:h.genericValueFormatter},{id:"uuid",name:"UUID",field:"uuid",sortable:false,resizable:true,formatter:h.genericValueFormatter},{id:"filename",name:"Filename",field:"filename",sortable:false,resizable:true,formatter:h.genericValueFormatter},{id:"size",name:"File Size",field:"size",sortable:false,resizable:true,defaultSortAsc:false,formatter:x},{id:"queuedDuration",name:"Queued Duration",field:"queuedDuration",sortable:false,resizable:true,formatter:u},{id:"lineageDuration",name:"Lineage Duration",field:"lineageDuration",sortable:false,resizable:true,formatter:u},{id:"penalized",name:"Penalized",field:"penaltyExpiresIn",sortable:false,resizable:false,width:100,maxWidth:100,formatter:t}];if(g.isConnectedToCluster()){w.push({id:"clusterNodeAddress",name:"Node",field:"clusterNodeAddress",sortable:false,resizable:true,formatter:h.genericValueFormatter})}if(h.canAccessProvenance()){var v=function(){return'<div title="Provenance" class="pointer icon icon-provenance view-provenance"></div>'};w.push({id:"actions",name:"&nbsp;",resizable:false,formatter:v,sortable:false,width:50,maxWidth:50})}return w};var b=function(){var s=c("#flowfile-uri").text()+"/content";h.getAccessToken(p.urls.downloadToken).done(function(u){var v={};if(!h.isBlank(u)){v.access_token=u}var t=c("#flowfile-cluster-node-id").text();if(!h.isBlank(t)){v.clusterNodeId=t}if(c.isEmptyObject(v)){window.open(s)}else{window.open(s+"?"+c.param(v))}}).fail(function(){i.showOkDialog({headerText:"Queue Listing",dialogContent:"Unable to generate access token for downloading content."})})};var f=function(){var s=c("#flowfile-uri").text()+"/content";var t=c.Deferred(function(u){if(d.hasItem("jwt")){var w=c.ajax({type:"POST",url:p.urls.uiExtensionToken});var v=c.ajax({type:"POST",url:p.urls.downloadToken});c.when(w,v).done(function(A,z){var y=A[0];var x=z[0];u.resolve(y,x)}).fail(function(){i.showOkDialog({headerText:"Queue Listing",dialogContent:"Unable to generate access token for viewing content."});u.reject()})}else{u.resolve("","")}}).promise();t.done(function(w,v){var y={};var u=c("#flowfile-cluster-node-id").text();if(!h.isBlank(u)){y.clusterNodeId=u}if(!h.isBlank(v)){y.access_token=v}if(c.isEmptyObject(y)===false){s=s+"?"+c.param(y)}var x=c("#nifi-content-viewer-url").text();if(x.indexOf("?")===-1){x+="?"}else{x+="&"}var z={ref:s};if(!h.isBlank(w)){z.access_token=w}window.open(x+c.param(z))})};var a=function(t){var u=4;var w=false;var v=null;var s=null;return c.Deferred(function(y){var B=function(D){var E=c("#listing-request-percent-complete");E.find("div.progress-label").remove();E.find("md-progress-linear").remove();var C=c('<div class="progress-label"></div>').text(D+"%");(r.injector.get("$compile")(c('<md-progress-linear ng-cloak ng-value="'+D+'" class="md-hue-2" md-mode="determinate" aria-label="Searching Queue"></md-progress-linear>'))(r.rootScope)).appendTo(E);E.append(C)};c("#listing-request-status-dialog").modal("setButtonModel",[{headerText:"Queue Listing",buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){w=true;if(s!==null){clearTimeout(s);x()}}}}]);var x=function(){c("#listing-request-status-dialog").modal("hide");var E=w;if(h.isDefinedAndNotNull(v)){c.ajax({type:"DELETE",url:v.uri,dataType:"json"});if(h.isEmpty(v.flowFileSummaries)){if(w===false){E=true;i.showOkDialog({headerText:"Queue Listing",dialogContent:"The queue has no FlowFiles."})}}else{c("#total-flowfiles-count").text(h.formatInteger(v.queueSize.objectCount));c("#total-flowfiles-size").text(h.formatDataSize(v.queueSize.byteCount));c("#queue-listing-last-refreshed").text(v.lastUpdated);var D=c("#queue-listing-table");var G=c("#queue-listing-message");if(v.sourceRunning===true||v.destinationRunning===true){if(v.souceRunning===true&&v.destinationRunning===true){G.text("The source and destination of this queue are currently running. This listing may no longer be accurate.").show()}else{if(v.sourceRunning===true){G.text("The source of this queue is currently running. This listing may no longer be accurate.").show()}else{if(v.destinationRunning===true){G.text("The destination of this queue is currently running. This listing may no longer be accurate.").show()}}}}else{G.text("").hide()}var F=c("#queue-listing-table").data("gridInstance");F.setColumns(q());var C=F.getData();C.beginUpdate();C.setItems(v.flowFileSummaries,"uuid");C.endUpdate()}}else{E=true}if(E){y.reject()}else{y.resolve()}};var A=function(C){B(v.percentCompleted);c("#listing-request-status-message").text(v.state);if(v.finished===true||w===true){x()}else{s=setTimeout(function(){s=null;z(Math.min(u,C*2))},C*1000)}};var z=function(C){c.ajax({type:"GET",url:v.uri,dataType:"json"}).done(function(D){v=D.listingRequest;A(C)}).fail(x).fail(e.handleAjaxError)};c.ajax({type:"POST",url:"../nifi-api/flowfile-queues/"+t.id+"/listing-requests",dataType:"json",contentType:"application/json"}).done(function(C){B(0);c("#listing-request-status-dialog").modal("show");v=C.listingRequest;A(1)}).fail(x).fail(e.handleAjaxError)}).promise()};var j=function(s){var t=function(w,x){c('<div class="flowfile-detail"></div>').append(c('<div class="detail-name"></div>').text(w)).append(c('<div class="detail-value">'+h.formatValue(x)+"</div>").ellipsis()).append(c('<div class="clear"></div>')).appendTo("#additional-flowfile-details")};var u=function(w,x){if(h.isDefinedAndNotNull(x)){w.removeClass("unset").text(x)}else{w.addClass("unset").text("No value set")}};var v={};if(h.isDefinedAndNotNull(s.clusterNodeId)){v.clusterNodeId=s.clusterNodeId}c.ajax({type:"GET",url:s.uri,data:v,dataType:"json"}).done(function(x){var z=x.flowFile;var w=h.isDefinedAndNotNull(z.contentClaimFileSize)?z.contentClaimFileSize:h.formatDataSize(0);c("#flowfile-uri").text(z.uri);c("#flowfile-uuid").html(h.formatValue(z.uuid));c("#flowfile-filename").html(h.formatValue(z.filename));c("#flowfile-queue-position").html(h.formatValue(z.position));c("#flowfile-file-size").html(h.formatValue(w));c("#flowfile-queued-duration").text(h.formatDuration(z.queuedDuration));c("#flowfile-lineage-duration").text(h.formatDuration(z.lineageDuration));c("#flowfile-penalized").text(z.penaltyExpiresIn==0?"No":h.formatDuration(z.penaltyExpiresIn));if(h.isDefinedAndNotNull(s.clusterNodeId)){c("#flowfile-cluster-node-id").text(s.clusterNodeId);t("Node Address",s.clusterNodeAddress)}if(h.isDefinedAndNotNull(z.contentClaimContainer)){u(c("#content-container"),z.contentClaimContainer);u(c("#content-section"),z.contentClaimSection);u(c("#content-identifier"),z.contentClaimIdentifier);u(c("#content-offset"),z.contentClaimOffset);u(c("#content-bytes"),z.contentClaimFileSizeBytes);var B=c("#content-size");u(B,z.contentClaimFileSize);if(h.isDefinedAndNotNull(z.contentClaimFileSize)){B.attr("title",h.formatInteger(z.contentClaimFileSizeBytes)+" bytes")}c("#flowfile-content-details").show();c("#flowfile-with-no-content").hide()}else{c("#flowfile-content-details").hide();c("#flowfile-with-no-content").show()}var y=c("#flowfile-attributes-container");var A=Object.keys(z.attributes).sort();A.forEach(function(C){var D=z.attributes[C];var E=c('<div class="attribute-detail"></div>').append(c('<div class="attribute-name">'+h.formatValue(C)+"</div>").ellipsis()).appendTo(y);E.append(c('<div class="attribute-value">'+h.formatValue(D)+"</div>").ellipsis()).append('<div class="clear"></div>')});c("#flowfile-details-dialog").modal("show")}).fail(e.handleAjaxError)};var k={init:function(){l();c("#queue-listing-refresh-button").click(function(){var v=c("#queue-listing-table").data("connection");a(v)});var t={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var s=new n.Data.DataView({inlineFilters:false});s.setItems([]);var u=new n.Grid("#queue-listing-table",s,q(),t);u.setSelectionModel(new n.RowSelectionModel());u.registerPlugin(new n.AutoTooltips());u.onClick.subscribe(function(y,v){var x=c(y.target);var w=s.getItem(v.row);if(u.getColumns()[v.cell].id==="moreDetails"){if(x.hasClass("show-flowfile-details")){j(w)}}else{if(u.getColumns()[v.cell].id==="actions"){if(x.hasClass("view-provenance")){c("#shell-close-button").click();o.showPage("provenance?"+c.param({flowFileUuid:w.uuid}))}}}});s.onRowCountChanged.subscribe(function(w,v){u.updateRowCount();u.render();c("#displayed-flowfiles").text(v.current)});s.onRowsChanged.subscribe(function(w,v){u.invalidateRows(v.rows);u.render()});c("#queue-listing-table").data("gridInstance",u);c("#displayed-flowfiles").text("0")},initFlowFileDetailsDialog:function(){c("#content-download").on("click",b);if(h.isContentViewConfigured()){c("#content-view").show();c("#content-view").on("click",f)}c("#flowfile-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"flowfile-details-tab-content"},{name:"Attributes",tabContentId:"flowfile-attributes-tab-content"}]});c("#flowfile-details-dialog").modal({scrollableContentStyle:"scrollable",headerText:"FlowFile",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){c("#flowfile-details-dialog").modal("hide")}}}],handler:{close:function(){c("#flowfile-attributes-container").empty();c("#flowfile-cluster-node-id").text("");c("#additional-flowfile-details").empty()},open:function(){h.toggleScrollable(c("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}})},resetTableSize:function(){var s=c("#queue-listing-table").data("gridInstance");if(h.isDefinedAndNotNull(s)){s.resizeCanvas()}},listQueue:function(s){a(s).done(function(){var t="";if(s.permissions.canRead){t=m.formatConnectionName(s.component)}if(t===""){t="Connection"}c("#queue-listing-header-text").text(t);o.showContent("#queue-listing-container").done(function(){c("#queue-listing-table").removeData("connection");var v=c("#queue-listing-table").data("gridInstance");var u=v.getData();u.beginUpdate();u.setItems([],"uuid");u.endUpdate();c("#displayed-flowfiles, #total-flowfiles-count").text("0");c("#total-flowfiles-size").text(h.formatDataSize(0))});k.resetTableSize();c("#queue-listing-table").data("connection",s)})}};return k}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.ErrorHandler","nf.Common","nf.Client","nf.Storage","nf.CanvasUtils","nf.ng.Bridge","nf.Dialog","nf.Shell"],function(h,d,k,e,l,i,f,j,g,c){return(nf.PolicyManagement=b(h,d,k,e,l,i,f,j,g,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PolicyManagement=b(require("jquery"),require("Slick"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Client"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Dialog"),require("nf.Shell")))}else{nf.PolicyManagement=b(a.$,a.Slick,a.nf.ErrorHandler,a.nf.Common,a.nf.Client,a.nf.Storage,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Dialog,a.nf.Shell)}}}(this,function(y,a,e,H,g,t,K,p,h,G){var C={urls:{api:"../nifi-api",searchTenants:"../nifi-api/tenants/search-results"}};var i=false;var j=false;var u=function(){y("#new-policy-user-button").on("click",function(){y("#search-users-dialog").modal("show");y("#search-users-field").focus()});y("#delete-policy-button").on("click",function(){x()});y("#search-users-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Users/Groups",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var N=y("#policy-table").data("gridInstance");var M=N.getData();M.beginUpdate();y.each(f(y("#allowed-users")),function(P,O){M.addItem(O)});y.each(f(y("#allowed-groups")),function(O,P){M.addItem(P)});M.endUpdate();I();y("#search-users-dialog").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){y("#search-users-dialog").modal("hide")}}}],handler:{close:function(){y("#search-users-field").userSearchAutocomplete("reset").val("");y("#allowed-users, #allowed-groups").empty()}}});y(document).on("click","div.remove-allowed-entity",function(){y(this).closest("li").remove()});y.widget("nf.userSearchAutocomplete",y.ui.autocomplete,{reset:function(){this.term=null},_create:function(){this._super();this.widget().menu("option","items","> :not(.search-no-matches)")},_normalize:function(N){var M=[];M.push(N);return M},_renderMenu:function(P,N){var R=N[0];var O=J();var Q=o();var M=this;y.each(R.userGroups,function(S,T){if(y.inArray(T.id,O)===-1){M._renderGroup(P,y.extend({type:"group"},T))}});y.each(R.users,function(S,T){if(y.inArray(T.id,Q)===-1){M._renderUser(P,y.extend({type:"user"},T))}});if(P.children().length===0){P.append('<li class="unset search-no-matches">No users matched the search terms</li>')}},_resizeMenu:function(){var M=this.menu.element;M.width(y("#search-users-field").outerWidth()-2)},_renderUser:function(O,N){var M=y("<a></a>").text(N.component.identity);return y("<li></li>").data("ui-autocomplete-item",N).append(M).appendTo(O)},_renderGroup:function(N,M){var P=y("<span></span>").text(M.component.identity);var O=y("<a></a>").append('<div class="fa fa-users"></div>').append(P);return y("<li></li>").data("ui-autocomplete-item",M).append(O).appendTo(N)}});y("#search-users-field").userSearchAutocomplete({minLength:0,appendTo:"#search-users-results",position:{my:"left top",at:"left bottom",offset:"0 1"},source:function(N,M){y.ajax({type:"GET",data:{q:N.term},dataType:"json",url:C.urls.searchTenants}).done(function(O){M(O)})},select:function(M,N){z(N.item);y(this).val("");return false}})};var J=function(){var P=y("#policy-table").data("gridInstance");var O=P.getData();var N=[];var M=O.getItems();y.each(M,function(Q,R){if(R.type==="group"){N.push(R.id)}});y.each(f(y("#allowed-groups")),function(Q,R){N.push(R.id)});return N};var f=function(M){var N=[];M.children("li").each(function(P,O){var Q=y(O).data("tenant");if(H.isDefinedAndNotNull(Q)){N.push(Q)}});return N};var o=function(){var P=y("#policy-table").data("gridInstance");var N=P.getData();var O=[];var M=N.getItems();y.each(M,function(Q,R){if(R.type==="user"){O.push(R.id)}});y.each(f(y("#allowed-users")),function(R,Q){O.push(Q.id)});return O};var z=function(M){var O=M.type==="user"?y("#allowed-users"):y("#allowed-groups");var P=y("<span></span>").addClass("allowed-entity ellipsis").text(M.component.identity).ellipsis();var N=y("<div></div>").addClass("remove-allowed-entity fa fa-trash");y("<li></li>").data("tenant",M).append(P).append(N).appendTo(O)};var c=function(M){return M==="controller"||M==="counters"||M==="policies"||M==="tenants"};var m=function(M){return M==="proxy"||M==="restricted-components"};var A=function(){y("#override-policy-dialog").modal({headerText:"Override Policy",buttons:[{buttonText:"Override",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){k(y("#copy-policy-radio-button").is(":checked"));y(this).modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){y(this).modal("hide")}}}],handler:{close:function(){y("#copy-policy-radio-button").prop("checked",true)}}});y("#create-policy-link, #add-local-admin-link").on("click",function(){k(false)});y("#override-policy-link").on("click",function(){y("#override-policy-dialog").modal("show")});y("#policy-type-list").combo({options:[H.getPolicyTypeListing("flow"),H.getPolicyTypeListing("controller"),H.getPolicyTypeListing("provenance"),H.getPolicyTypeListing("restricted-components"),H.getPolicyTypeListing("policies"),H.getPolicyTypeListing("tenants"),H.getPolicyTypeListing("site-to-site"),H.getPolicyTypeListing("system"),H.getPolicyTypeListing("proxy"),H.getPolicyTypeListing("counters")],select:function(W){if(i){y("#selected-policy-type").text(W.value);if(c(W.value)){y("#restricted-component-required-permissions").hide();y("#restriction-message").hide();y("#controller-policy-target").combo("setSelectedOption",{value:"read"}).show()}else{y("#controller-policy-target").hide();if(m(W.value)){y("#selected-policy-action").text("write")}else{y("#selected-policy-action").text("read")}if(W.value==="restricted-components"){if(!j){var V="regardless of restrictions";var S=K.getComponentRestrictions();var U=S.requiredPermissions;var T=[{text:V,value:"",description:"Allows users to create/modify all restricted components regardless of restrictions."}];U.each(function(X,Y){if(Y!==W.value){T.push({text:"requiring '"+X+"'",value:Y,description:"Allows users to create/modify restricted components requiring '"+H.escapeHtml(X)+"'"})}});T.sort(function(Y,X){if(Y.text===V){return -1}else{if(X.text===V){return 1}}return Y.text<X.text?-1:Y.text>X.text?1:0});y("#restricted-component-required-permissions").combo({options:T,select:function(X){if(X.text===V){y("#restriction-message").hide()}else{y("#restriction-message").show()}b()}})}y("#restricted-component-required-permissions").show()}else{y("#restriction-message").hide();y("#restricted-component-required-permissions").hide()}b()}}}});y("#controller-policy-target").combo({options:[{text:"view",value:"read"},{text:"modify",value:"write"}],select:function(S){if(i){y("#selected-policy-action").text(S.value);b()}}});y("#component-policy-target").combo({options:[{text:"view the component",value:"read-component",description:"Allows users to view component configuration details"},{text:"modify the component",value:"write-component",description:"Allows users to modify component configuration details"},{text:"operate the component",value:"operate-component",description:"Allows users to operate components by changing component run status (start/stop/enable/disable), remote port transmission status, or terminating processor threads"},{text:"view provenance",value:"read-provenance",description:"Allows users to view provenance events generated by this component"},{text:"view the data",value:"read-data",description:"Allows users to view metadata and content for this component in flowfile queues in outbound connections and through provenance events"},{text:"modify the data",value:"write-data",description:"Allows users to empty flowfile queues in outbound connections and submit replays through provenance events"},{text:"receive data via site-to-site",value:"write-receive-data",description:"Allows this port to receive data from these NiFi instances",disabled:true},{text:"send data via site-to-site",value:"write-send-data",description:"Allows this port to send data to these NiFi instances",disabled:true},{text:"view the policies",value:"read-policies",description:"Allows users to view the list of users who can view/modify this component"},{text:"modify the policies",value:"write-policies",description:"Allows users to modify the list of users who can view/modify this component"}],select:function(S){if(i){var T=y("#selected-policy-component-type").text();if(S.value==="read-component"){y("#selected-policy-action").text("read")}else{if(S.value==="write-component"){y("#selected-policy-action").text("write")}else{if(S.value==="operate-component"){y("#selected-policy-action").text("write");T=("operation/"+T)}else{if(S.value==="read-data"){y("#selected-policy-action").text("read");T=("data/"+T)}else{if(S.value==="write-data"){y("#selected-policy-action").text("write");T=("data/"+T)}else{if(S.value==="read-provenance"){y("#selected-policy-action").text("read");T=("provenance-data/"+T)}else{if(S.value==="read-policies"){y("#selected-policy-action").text("read");T=("policies/"+T)}else{if(S.value==="write-policies"){y("#selected-policy-action").text("write");T=("policies/"+T)}else{if(S.value==="write-receive-data"){y("#selected-policy-action").text("write");T="data-transfer/input-ports"}else{if(S.value==="write-send-data"){y("#selected-policy-action").text("write");T="data-transfer/output-ports"}}}}}}}}}}y("#selected-policy-type").text(T);b()}}});var M=function(X,T,W,V,S){var U="";if(S.type==="group"){U+='<div class="fa fa-users"></div>'}U+=H.escapeHtml(S.component.identity);return U};var Q=function(Z,U,Y,W,T){var V="";var S=y("#policy-table").data("policy");var X=y("#delete-policy-button").is(":disabled")===false;if(S.permissions.canWrite===true&&X){V+='<div title="Remove" class="pointer delete-user fa fa-trash"></div>'}return V};var P=[{id:"identity",name:"User",sortable:true,resizable:true,formatter:M}];if(K.isConfigurableAuthorizer()){P.push({id:"actions",name:"&nbsp;",sortable:false,resizable:false,formatter:Q,width:100,maxWidth:100})}var O={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false};var N=new a.Data.DataView({inlineFilters:false});N.setItems([]);L({columnId:"identity",sortAsc:true},N);var R=new a.Grid("#policy-table",N,P,O);R.setSelectionModel(new a.RowSelectionModel());R.registerPlugin(new a.AutoTooltips());R.setSortColumn("identity",true);R.onSort.subscribe(function(T,S){L({columnId:S.sortCol.id,sortAsc:S.sortAsc},N)});R.onClick.subscribe(function(V,S){var U=y(V.target);var T=N.getItem(S.row);if(R.getColumns()[S.cell].id==="actions"){if(U.hasClass("delete-user")){F(T)}}});N.onRowCountChanged.subscribe(function(T,S){R.updateRowCount();R.render();y("#displayed-policy-users").text(S.current)});N.onRowsChanged.subscribe(function(T,S){R.invalidateRows(S.rows);R.render()});y("#policy-table").data("gridInstance",R);y("#displayed-policy-users").text("0")};var L=function(M,O){var N=function(R,P){if(R.permissions.canRead&&P.permissions.canRead){var Q=H.isDefinedAndNotNull(R.component[M.columnId])?R.component[M.columnId]:"";var S=H.isDefinedAndNotNull(P.component[M.columnId])?P.component[M.columnId]:"";return Q===S?0:Q>S?1:-1}else{if(!R.permissions.canRead&&!P.permissions.canRead){return 0}if(R.permissions.canRead){return 1}else{return -1}}};O.sort(N,M.sortAsc)};var F=function(M){h.showYesNoDialog({headerText:"Update Policy",dialogContent:"Remove '"+H.escapeHtml(M.component.identity)+"' from this policy?",yesHandler:function(){q(M)}})};var q=function(N){var O=y("#policy-table").data("gridInstance");var M=O.getData();M.beginUpdate();M.deleteItem(N.id);M.endUpdate();I()};var x=function(){h.showYesNoDialog({headerText:"Delete Policy",dialogContent:"By deleting this policy, the permissions for this component will revert to the inherited policy if applicable.",yesText:"Delete",noText:"Cancel",yesHandler:function(){l()}})};var l=function(){var M=y("#policy-table").data("policy");var N=g.getRevision(M);if(H.isDefinedAndNotNull(M)){y.ajax({type:"DELETE",url:M.uri+"?"+y.param(y.extend({disconnectedNodeAcknowledged:t.isDisconnectionAcknowledged()},N)),dataType:"json"}).done(function(){b()}).fail(function(Q,O,P){e.handleAjaxError(Q,O,P);s();b()})}else{h.showOkDialog({headerText:"Delete Policy",dialogContent:"No policy selected"})}};var n=function(){var M=y("#selected-policy-component-id").text();var O=y("#selected-policy-type").text();if(M!==""){O+=("/"+M)}if(O==="restricted-components"){var N=y("#restricted-component-required-permissions").combo("getSelectedOption").value;if(!H.isBlank(N)){O+=("/"+N)}}return{action:y("#selected-policy-action").text(),resource:"/"+O}};var D=function(Q,O){var P=y("#policy-table").data("gridInstance");var N=P.getData();N.beginUpdate();var M=[];y.each(Q,function(S,R){M.push(y.extend({type:"user"},R))});y.each(O,function(R,S){M.push(y.extend({type:"group"},S))});N.setItems(M);N.endUpdate();N.reSort();P.invalidate();P.getSelectionModel().setSelectedRows([])};var r=function(P){if(P==="/policies"){return y("<span>Showing effective policy inherited from all policies.</span>")}else{if(P==="/controller"){return y("<span>Showing effective policy inherited from the controller.</span>")}else{var M=H.substringAfterLast(P,"/");var O=M;var N=p.injector.get("breadcrumbsCtrl").getBreadcrumbs();y.each(N,function(Q,R){if(R.id===M){O=R.label;return false}});return y("<span>Showing effective policy inherited from Process Group </span>").append(y('<span class="link ellipsis" style="max-width: 200px; vertical-align: top;"></span>').text(O).attr("title",O).on("click",function(){y("#shell-close-button").click();K.getComponentByType("ProcessGroup").enterGroup(M).done(function(){K.getSelection().classed("selected",false);p.digest()})})).append("<span>.</span>")}}};var v=function(N){var O=N.component;var M=n();d();y("#policy-table").data("policy",N);if(M.resource===O.resource){if(K.isConfigurableAuthorizer()){y("#delete-policy-button").prop("disabled",O.configurable===false||N.permissions.canWrite===false);y("#new-policy-user-button").prop("disabled",O.configurable===false||N.permissions.canWrite===false)}}else{y("#policy-message").append(r(O.resource));if(K.isConfigurableAuthorizer()){y("#override-policy-message").show();y("#delete-policy-button").prop("disabled",true);y("#new-policy-user-button").prop("disabled",true)}}D(O.users,O.userGroups)};var b=function(){var M=n();var N;if(M.resource.startsWith("/policies")){if(M.resource.endsWith("/policies")){y("#admin-policy-message").show()}N=y.Deferred(function(O){y.ajax({type:"GET",url:"../nifi-api/policies/"+M.action+M.resource,dataType:"json"}).done(function(P){y("#policy-last-refreshed").text(P.generated);if(P.permissions.canRead===true){var Q=P.component;if(M.resource===Q.resource){v(P)}else{s();y("#policy-message").text("No component specific administrators.");if(K.isConfigurableAuthorizer()){y("#add-local-admin-message").show()}}}else{s();y("#policy-message").text("No component specific administrators.");if(K.isConfigurableAuthorizer()){y("#add-local-admin-message").show()}}O.resolve()}).fail(function(R,P,Q){if(R.status===404){s();y("#policy-message").text("No component specific administrators.");if(K.isConfigurableAuthorizer()){y("#add-local-admin-message").show()}O.resolve()}else{if(R.status===403){s();y("#policy-message").text("Not authorized to access the policy for the specified resource.");O.resolve()}else{s();O.reject();e.handleAjaxError(R,P,Q)}}})}).promise()}else{if(M.resource.startsWith("/restricted-components")){y("#admin-policy-message").hide();N=y.Deferred(function(O){y.ajax({type:"GET",url:"../nifi-api/policies/"+M.action+M.resource,dataType:"json"}).done(function(P){y("#policy-last-refreshed").text(P.generated);if(P.permissions.canRead===true){var Q=P.component;if(M.resource===Q.resource){v(P)}else{s();y("#policy-message").text("No restriction specific users.");if(K.isConfigurableAuthorizer()){y("#new-policy-message").show()}}}else{s();y("#policy-message").text("Not authorized to view the policy.");if(K.isConfigurableAuthorizer()){y("#new-policy-message").show()}}O.resolve()}).fail(function(R,P,Q){if(R.status===404){s();if(M.resource==="/restricted-components"){y("#policy-message").text('No users with permission "regardless of restrictions."')}else{y("#policy-message").text("No users with permission to specific restriction.")}if(K.isConfigurableAuthorizer()){y("#new-policy-message").show()}O.resolve()}else{if(R.status===403){s();y("#policy-message").text("Not authorized to access the policy for the specified resource.");O.resolve()}else{s();O.reject();e.handleAjaxError(R,P,Q)}}})}).promise()}else{y("#admin-policy-message").hide();N=y.Deferred(function(O){y.ajax({type:"GET",url:"../nifi-api/policies/"+M.action+M.resource,dataType:"json"}).done(function(P){y("#policy-last-refreshed").text(P.generated);if(P.permissions.canRead===true){v(P)}else{s();y("#policy-message").text("Not authorized to view the policy.");if(K.isConfigurableAuthorizer()){y("#override-policy-message").show()}}O.resolve()}).fail(function(R,P,Q){if(R.status===404){s();y("#policy-message").text("No policy for the specified resource.");if(K.isConfigurableAuthorizer()){y("#new-policy-message").show()}O.resolve()}else{if(R.status===403){s();y("#policy-message").text("Not authorized to access the policy for the specified resource.");O.resolve()}else{s();O.reject();e.handleAjaxError(R,P,Q)}}})}).promise()}}return N};var k=function(R){var Q=n();var T=[];var P=[];if(R===true){var S=y("#policy-table").data("gridInstance");var O=S.getData();var N=O.getItems();y.each(N,function(V,W){var U=y.extend({},W);if(U.type==="user"){T.push(U)}else{P.push(U)}delete U.type})}var M={revision:g.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:t.isDisconnectionAcknowledged(),component:{action:Q.action,resource:Q.resource,users:T,userGroups:P}};y.ajax({type:"POST",url:"../nifi-api/policies",data:JSON.stringify(M),dataType:"json",contentType:"application/json"}).done(function(U){if(U.permissions.canRead===true){v(U)}else{s();b()}}).fail(e.handleAjaxError)};var I=function(){var S=y("#policy-table").data("gridInstance");var Q=S.getData();var R=[];var P=[];var O=Q.getItems();y.each(O,function(U,V){var T=y.extend({},V);if(T.type==="user"){R.push(T)}else{P.push(T)}delete T.type});var M=y("#policy-table").data("policy");if(H.isDefinedAndNotNull(M)){var N={revision:g.getRevision(M),disconnectedNodeAcknowledged:t.isDisconnectionAcknowledged(),component:{id:M.id,users:R,userGroups:P}};y.ajax({type:"PUT",url:M.uri,data:JSON.stringify(N),dataType:"json",contentType:"application/json"}).done(function(T){if(T.permissions.canRead===true){v(T)}else{s();b()}}).fail(function(V,T,U){e.handleAjaxError(V,T,U);s();b()}).always(function(){K.reload({transition:true})})}else{h.showOkDialog({headerText:"Update Policy",dialogContent:"No policy selected"})}};var B=function(){G.showContent("#policy-management").always(function(){E()});w.resetTableSize()};var d=function(){y("#policy-message").text("").empty();if(K.isConfigurableAuthorizer()){y("#new-policy-message").hide();y("#override-policy-message").hide();y("#add-local-admin-message").hide()}};var s=function(){d();if(K.isConfigurableAuthorizer()){y("#delete-policy-button").prop("disabled",true);y("#new-policy-user-button").prop("disabled",true)}y("#policy-table").removeData("policy");D([],[])};var E=function(){s();y("#selected-policy-type").text("");y("#selected-policy-action").text("");y("#selected-policy-component-id").text("");y("#selected-policy-component-type").text("");y("div.policy-selected-component-container").hide()};var w={init:function(){u();A();if(K.isConfigurableAuthorizer()){y("#delete-policy-button").show();y("#new-policy-user-button").show()}y("#policy-refresh-button").on("click",function(){b()});s();i=true},resetTableSize:function(){var M=y("#policy-table");if(M.is(":visible")){var N=M.data("gridInstance");if(H.isDefinedAndNotNull(N)){N.resizeCanvas()}}},showControllerServicePolicy:function(M){d();y("#component-policy-controls").show();y("#global-policy-controls").hide();if(M.permissions.canRead===true){y("#policy-selected-controller-service-container div.policy-selected-component-name").text(M.component.name)}else{y("#policy-selected-controller-service-container div.policy-selected-component-name").text(M.id)}y("#policy-selected-controller-service-container").show();y("#selected-policy-component-id").text(M.id);y("#selected-policy-component-type").text("controller-services");y("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"read-provenance"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});return b().always(B)},showReportingTaskPolicy:function(M){d();y("#component-policy-controls").show();y("#global-policy-controls").hide();if(M.permissions.canRead===true){y("#policy-selected-reporting-task-container div.policy-selected-component-name").text(M.component.name)}else{y("#policy-selected-reporting-task-container div.policy-selected-component-name").text(M.id)}y("#policy-selected-reporting-task-container").show();y("#selected-policy-component-id").text(M.id);y("#selected-policy-component-type").text("reporting-tasks");y("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"read-provenance"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});return b().always(B)},showTemplatePolicy:function(M){d();y("#component-policy-controls").show();y("#global-policy-controls").hide();if(M.permissions.canRead===true){y("#policy-selected-template-container div.policy-selected-component-name").text(M.template.name)}else{y("#policy-selected-template-container div.policy-selected-component-name").text(M.id)}y("#policy-selected-template-container").show();y("#selected-policy-component-id").text(M.id);y("#selected-policy-component-type").text("templates");y("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"read-provenance"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});return b().always(B)},showComponentPolicy:function(M){d();y("#component-policy-controls").show();y("#global-policy-controls").hide();y("#policy-selected-component-container").show();var N;if(M.empty()){y("#selected-policy-component-id").text(K.getGroupId());N="process-groups";y("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},true).combo("setOptionEnabled",{value:"read-provenance"},true).combo("setOptionEnabled",{value:"write-data"},true)}else{var O=M.datum();y("#selected-policy-component-id").text(O.id);if(K.isProcessor(M)){N="processors"}else{if(K.isProcessGroup(M)){N="process-groups"}else{if(K.isInputPort(M)){N="input-ports"}else{if(K.isOutputPort(M)){N="output-ports"}else{if(K.isRemoteProcessGroup(M)){N="remote-process-groups"}else{if(K.isLabel(M)){N="labels"}else{if(K.isFunnel(M)){N="funnels"}}}}}}}y("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},K.isInputPort(M)&&K.getParentGroupId()===null).combo("setOptionEnabled",{value:"write-send-data"},K.isOutputPort(M)&&K.getParentGroupId()===null).combo("setOptionEnabled",{value:"read-data"},!K.isLabel(M)).combo("setOptionEnabled",{value:"write-data"},!K.isLabel(M))}y("#selected-policy-component-type").text(N);y("#component-policy-target").combo("setSelectedOption",{value:"read-component"});return b().always(B)},showGlobalPolicies:function(){d();y("#component-policy-controls").hide();y("#global-policy-controls").show();var M=y("#policy-type-list").combo("getSelectedOption").value;y("#selected-policy-type").text(M);if(c(M)){y("#selected-policy-action").text(y("#controller-policy-target").combo("getSelectedOption").value)}else{if(m(M)){y("#selected-policy-action").text("write")}else{y("#selected-policy-action").text("read")}}return b().always(B)}};return w}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.CanvasUtils","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.ErrorHandler","nf.Clipboard","nf.Snippet","nf.GoTo","nf.ng.Bridge","nf.Shell","nf.VariableRegistry","nf.ComponentState","nf.FlowVersion","nf.Draggable","nf.Birdseye","nf.Connection","nf.Graph","nf.ProcessGroupConfiguration","nf.ProcessorConfiguration","nf.ProcessorDetails","nf.LabelConfiguration","nf.RemoteProcessGroupConfiguration","nf.RemoteProcessGroupDetails","nf.PortConfiguration","nf.PortDetails","nf.ConnectionConfiguration","nf.ConnectionDetails","nf.PolicyManagement","nf.RemoteProcessGroup","nf.Label","nf.Processor","nf.RemoteProcessGroupPorts","nf.ComponentVersion","nf.QueueListing","nf.StatusHistory"],function(C,H,L,G,l,t,j,f,y,M,h,m,F,k,g,u,w,i,N,p,E,K,e,z,B,J,D,q,n,o,x,c,v,r,d,s,A,I){return(nf.Actions=b(C,H,L,G,l,t,j,f,y,M,h,m,F,k,g,u,w,i,N,p,E,K,e,z,B,J,D,q,n,o,x,c,v,r,d,s,A,I))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Actions=b(require("jquery"),require("d3"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ErrorHandler"),require("nf.Clipboard"),require("nf.Snippet"),require("nf.GoTo"),require("nf.ng.Bridge"),require("nf.Shell"),require("nf.VariableRegistry"),require("nf.ComponentState"),require("nf.FlowVersion"),require("nf.Draggable"),require("nf.Birdseye"),require("nf.Connection"),require("nf.Graph"),require("nf.ProcessGroupConfiguration"),require("nf.ProcessorConfiguration"),require("nf.ProcessorDetails"),require("nf.LabelConfiguration"),require("nf.RemoteProcessGroupConfiguration"),require("nf.RemoteProcessGroupDetails"),require("nf.PortConfiguration"),require("nf.PortDetails"),require("nf.ConnectionConfiguration"),require("nf.ConnectionDetails"),require("nf.PolicyManagement"),require("nf.RemoteProcessGroup"),require("nf.Label"),require("nf.Processor"),require("nf.RemoteProcessGroupPorts"),require("nf.ComponentVersion"),require("nf.QueueListing"),require("nf.StatusHistory")))}else{nf.Actions=b(a.$,a.d3,a.nf.CanvasUtils,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ErrorHandler,a.nf.Clipboard,a.nf.Snippet,a.nf.GoTo,a.nf.ng.Bridge,a.nf.Shell,a.nf.VariableRegistry,a.nf.ComponentState,a.nf.FlowVersion,a.nf.Draggable,a.nf.Birdseye,a.nf.Connection,a.nf.Graph,a.nf.ProcessGroupConfiguration,a.nf.ProcessorConfiguration,a.nf.ProcessorDetails,a.nf.LabelConfiguration,a.nf.RemoteProcessGroupConfiguration,a.nf.RemoteProcessGroupDetails,a.nf.PortConfiguration,a.nf.PortDetails,a.nf.ConnectionConfiguration,a.nf.ConnectionDetails,a.nf.PolicyManagement,a.nf.RemoteProcessGroup,a.nf.Label,a.nf.Processor,a.nf.RemoteProcessGroupPorts,a.nf.ComponentVersion,a.nf.QueueListing,a.nf.StatusHistory)}}}(this,function(F,L,P,K,m,v,k,f,B,Q,h,o,J,l,g,w,y,i,R,r,H,O,c,C,E,N,G,s,p,q,A,a,x,t,b,u,D,M){var I={urls:{api:"../nifi-api",controller:"../nifi-api/controller"}};var e=function(){F("#drop-request-status-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){F("#drop-request-status-dialog").modal("setButtonModel",[])}}})};var n=function(T,S){S.disconnectedNodeAcknowledged=v.isDisconnectionAcknowledged();return F.ajax({type:"PUT",url:T,data:JSON.stringify(S),dataType:"json",contentType:"application/json"}).fail(function(W,U,V){m.showOkDialog({headerText:"Update Resource",dialogContent:K.escapeHtml(W.responseText)})})};var j=function(S){F.ajax({type:"GET",url:I.urls.api+"/flow/process-groups/"+encodeURIComponent(S.id),dataType:"json"}).done(function(T){r.set(T.processGroupFlow.flow)})};var d=function(S,T){return T.filter(function(U){return P.getConnectionSourceComponentId(S)===U.id}).size()>0};var z={init:function(){e()},enterGroup:function(S){if(S.size()===1&&P.isProcessGroup(S)){var T=S.datum();P.getComponentByType("ProcessGroup").enterGroup(T.id)}},leaveGroup:function(){P.getComponentByType("ProcessGroup").enterGroup(P.getParentGroupId())},refreshRemoteFlow:function(T){if(T.size()===1&&P.isRemoteProcessGroup(T)){var W=T.datum();var X=W.component.flowRefreshed;var S=function(Y){W.component.flowRefreshed=Y;if(T.classed("visible")){T.select("text.remote-process-group-last-refresh").text(function(){return Y})}};var V=function(Y){F.ajax({type:"GET",url:W.uri,dataType:"json"}).done(function(Z){var ab=Z.component;if(X===ab.flowRefreshed){U(Y)}else{a.set(Z);var aa=R.getComponentConnections(ab.id);F.each(aa,function(ad,ac){if(ac.permissions.canRead){R.reload(ac.id)}})}})};var U=function(Y){if(Y<=32){setTimeout(function(){V(Y*2)},Y*1000)}else{S(X)}};S("Refreshing...");V(1)}},openUri:function(S){if(S.size()===1&&P.isRemoteProcessGroup(S)){var U=S.datum();var T=U.component.targetUri;if(!K.isBlank(T)){window.open(encodeURI(T))}else{m.showOkDialog({headerText:"Remote Process Group",dialogContent:"No target URI defined."})}}},showSource:function(S){if(S.size()===1&&P.isConnection(S)){var U=S.datum();if(U.sourceGroupId===P.getGroupId()){var T=L.select("#id-"+U.sourceId);z.show(T)}else{if(U.sourceType==="REMOTE_OUTPUT_PORT"){var V=L.select("#id-"+U.sourceGroupId);z.show(V)}else{P.showComponent(U.sourceGroupId,U.sourceId)}}}},showDestination:function(U){if(U.size()===1&&P.isConnection(U)){var V=U.datum();if(V.destinationGroupId===P.getGroupId()){var S=L.select("#id-"+V.destinationId);z.show(S)}else{if(V.destinationType==="REMOTE_INPUT_PORT"){var T=L.select("#id-"+V.destinationGroupId);z.show(T)}else{P.showComponent(V.destinationGroupId,V.destinationId)}}}},showDownstream:function(S){if(S.size()===1&&!P.isConnection(S)){if(P.isProcessor(S)){h.showDownstreamFromProcessor(S)}else{if(P.isFunnel(S)){h.showDownstreamFromFunnel(S)}else{if(P.isInputPort(S)){h.showDownstreamFromInputPort(S)}else{if(P.isOutputPort(S)){h.showDownstreamFromOutputPort(S)}else{if(P.isProcessGroup(S)||P.isRemoteProcessGroup(S)){h.showDownstreamFromGroup(S)}}}}}}},showUpstream:function(S){if(S.size()===1&&!P.isConnection(S)){if(P.isProcessor(S)){h.showUpstreamFromProcessor(S)}else{if(P.isFunnel(S)){h.showUpstreamFromFunnel(S)}else{if(P.isInputPort(S)){h.showUpstreamFromInputPort(S)}else{if(P.isOutputPort(S)){h.showUpstreamFromOutputPort(S)}else{if(P.isProcessGroup(S)||P.isRemoteProcessGroup(S)){h.showUpstreamFromGroup(S)}}}}}}},show:function(S){var T=P.getSelection();T.classed("selected",false);S.classed("selected",true);if(S.size()===1){z.center(S)}else{o.injector.get("navigateCtrl").zoomFit()}P.setURLParameters(P.getGroupId(),S);o.digest()},select:function(S){S.classed("selected",true)},selectAll:function(){z.select(L.selectAll("g.component, g.connection"))},center:function(U){if(U.size()===1){var V;if(P.isConnection(U)){var S,Z;var Y=U.datum();if(Y.bends.length>0){var T=Math.min(Math.max(0,Y.labelIndex),Y.bends.length-1);S=Y.bends[T].x;Z=Y.bends[T].y}else{S=(Y.start.x+Y.end.x)/2;Z=(Y.start.y+Y.end.y)/2}V={x:S,y:Z,width:1,height:1}}else{var W=U.datum();var X=W.position;V={x:X.x,y:X.y,width:W.dimensions.width,height:W.dimensions.height}}P.centerBoundingBox(V)}},enable:function(T){if(T.empty()){var S={id:P.getGroupId(),state:"ENABLED"};n(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),S).done(j)}else{var V=P.filterEnable(T);if(!V.empty()){var U=[];V.each(function(Z){var X=L.select(this);var Y,W;if(P.isProcessGroup(X)){Y=I.urls.api+"/flow/process-groups/"+encodeURIComponent(Z.id);W={id:Z.id,state:"ENABLED"}}else{Y=Z.uri+"/run-status";W={revision:k.getRevision(Z),state:"STOPPED"}}U.push(n(Y,W).done(function(aa){if(P.isProcessGroup(X)){P.getComponentByType("ProcessGroup").reload(Z.id)}else{P.getComponentByType(Z.type).set(aa)}}))});if(U.length>0){F.when.apply(window,U).always(function(){o.digest()})}}}},disable:function(U){if(U.empty()){var T={id:P.getGroupId(),state:"DISABLED"};n(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),T).done(j)}else{var S=P.filterDisable(U);if(!S.empty()){var V=[];S.each(function(Z){var X=L.select(this);var Y,W;if(P.isProcessGroup(X)){Y=I.urls.api+"/flow/process-groups/"+encodeURIComponent(Z.id);W={id:Z.id,state:"DISABLED"}}else{Y=Z.uri+"/run-status";W={revision:k.getRevision(Z),state:"DISABLED"}}V.push(n(Y,W).done(function(aa){if(P.isProcessGroup(X)){P.getComponentByType("ProcessGroup").reload(Z.id)}else{P.getComponentByType(Z.type).set(aa)}}))});if(V.length>0){F.when.apply(window,V).always(function(){o.digest()})}}}},openProvenance:function(S){if(S.size()===1){var T=S.datum();J.showPage("provenance?"+F.param({componentId:T.id}))}},start:function(U){if(U.empty()){var S={id:P.getGroupId(),state:"RUNNING"};n(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),S).done(j)}else{var V=U.filter(function(W){return P.isRunnable(L.select(this))});if(!V.empty()){var T=[];V.each(function(Z){var X=L.select(this);var Y,W;if(P.isProcessGroup(X)){Y=I.urls.api+"/flow/process-groups/"+encodeURIComponent(Z.id);W={id:Z.id,state:"RUNNING"}}else{Y=Z.uri+"/run-status";W={revision:k.getRevision(Z),state:"RUNNING"}}T.push(n(Y,W).done(function(aa){if(P.isProcessGroup(X)){P.getComponentByType("ProcessGroup").reload(Z.id)}else{P.getComponentByType(Z.type).set(aa)}}))});if(T.length>0){F.when.apply(window,T).always(function(){o.digest()})}}}},stop:function(T){if(T.empty()){var S={id:P.getGroupId(),state:"STOPPED"};n(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),S).done(j)}else{var V=T.filter(function(W){return P.isStoppable(L.select(this))});if(!V.empty()){var U=[];V.each(function(Z){var X=L.select(this);var Y,W;if(P.isProcessGroup(X)){Y=I.urls.api+"/flow/process-groups/"+encodeURIComponent(Z.id);W={id:Z.id,state:"STOPPED"}}else{Y=Z.uri+"/run-status";W={revision:k.getRevision(Z),state:"STOPPED"}}U.push(n(Y,W).done(function(aa){if(P.isProcessGroup(X)){P.getComponentByType("ProcessGroup").reload(Z.id)}else{P.getComponentByType(Z.type).set(aa)}}))});if(U.length>0){F.when.apply(window,U).always(function(){o.digest()})}}}},terminate:function(S){if(S.size()===1&&P.isProcessor(S)){var T=S.datum();F.ajax({type:"DELETE",url:T.uri+"/threads",dataType:"json"}).done(function(U){t.set(U)}).fail(f.handleAjaxError)}},enableTransmission:function(S){var T=S.filter(function(U){return P.canStartTransmitting(L.select(this))});T.each(function(V){var U={revision:k.getRevision(V),state:"TRANSMITTING"};n(V.uri+"/run-status",U).done(function(W){a.set(W)})})},disableTransmission:function(T){var S=T.filter(function(U){return P.canStopTransmitting(L.select(this))});S.each(function(V){var U={revision:k.getRevision(V),state:"STOPPED"};n(V.uri+"/run-status",U).done(function(W){a.set(W)})})},showConfiguration:function(S){if(S.empty()){H.showConfiguration(P.getGroupId())}else{if(S.size()===1){var T=S.datum();if(P.isProcessor(S)){O.showConfiguration(S)}else{if(P.isLabel(S)){C.showConfiguration(S)}else{if(P.isProcessGroup(S)){H.showConfiguration(T.id)}else{if(P.isRemoteProcessGroup(S)){E.showConfiguration(S)}else{if(P.isInputPort(S)||P.isOutputPort(S)){G.showConfiguration(S)}else{if(P.isConnection(S)){p.showConfiguration(S)}}}}}}}}},managePolicies:function(S){if(S.size()<=1){A.showComponentPolicy(S)}},showDetails:function(S){if(S.empty()){H.showConfiguration(P.getGroupId())}else{if(S.size()===1){var T=S.datum();if(P.isProcessor(S)){c.showDetails(P.getGroupId(),T.id)}else{if(P.isProcessGroup(S)){H.showConfiguration(T.id)}else{if(P.isRemoteProcessGroup(S)){N.showDetails(S)}else{if(P.isInputPort(S)||P.isOutputPort(S)){s.showDetails(S)}else{if(P.isConnection(S)){q.showDetails(P.getGroupId(),T.id)}}}}}}}},showUsage:function(S){if(S.size()===1&&P.isProcessor(S)){var T=S.datum();J.showPage("../nifi-docs/documentation?"+F.param({select:T.component.type,group:T.component.bundle.group,artifact:T.component.bundle.artifact,version:T.component.bundle.version}))}},showStats:function(S){if(S.size()===1){var T=S.datum();if(P.isProcessor(S)){M.showProcessorChart(P.getGroupId(),T.id)}else{if(P.isProcessGroup(S)){M.showProcessGroupChart(P.getGroupId(),T.id)}else{if(P.isRemoteProcessGroup(S)){M.showRemoteProcessGroupChart(P.getGroupId(),T.id)}else{if(P.isConnection(S)){M.showConnectionChart(P.getGroupId(),T.id)}}}}}},remotePorts:function(S){if(S.size()===1&&P.isRemoteProcessGroup(S)){b.showPorts(S)}},reload:function(){P.reload({transition:true})},"delete":function(U){if(K.isUndefined(U)||U.empty()){m.showOkDialog({headerText:"Delete Components",dialogContent:"No eligible components are selected. Please select the components to be deleted."})}else{if(U.size()===1){var W=U.datum();var T=k.getRevision(W);F.ajax({type:"DELETE",url:W.uri+"?"+F.param({version:T.version,clientId:T.clientId,disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(X){P.getComponentByType(W.type).remove(W.id);if(P.isConnection(U)===false){var Y=R.getComponentConnections(W.id);if(Y.length>0){var Z=[];F.each(Y,function(ab,aa){Z.push(aa.id)});R.remove(Z)}}P.setURLParameters();i.refresh();o.digest()}).fail(f.handleAjaxError)}else{var S=P.getGroupId();var V=Q.marshal(U,S);Q.create(V).done(function(X){Q.remove(X.snippet.id).done(function(){var Z=L.map();var Y=function(aa,ab){if(!Z.has(aa)){Z.set(aa,[])}Z.get(aa).push(ab)};U.each(function(ab){Y(ab.type,ab.id);if(ab.type!=="Connection"){var aa=R.getComponentConnections(ab.id);if(aa.length>0){F.each(aa,function(ad,ac){Y("Connection",ac.id)})}}});Z.each(function(ab,aa){if(aa!=="Connection"){P.getComponentByType(aa).remove(ab)}});if(Z.has("Connection")){R.remove(Z.get("Connection"))}P.setURLParameters();i.refresh();o.digest()}).fail(f.handleAjaxError)}).fail(f.handleAjaxError)}}},emptyQueue:function(S){if(S.size()!==1||!P.isConnection(S)){return}m.showYesNoDialog({headerText:"Empty Queue",dialogContent:"Are you sure you want to empty this queue? All FlowFiles waiting at the time of the request will be removed.",noText:"Cancel",yesText:"Empty",yesHandler:function(){var W=S.datum();var aa=4;var Y=false;var Z=null;var V=null;var U=function(ad){var ae=F("#drop-request-percent-complete");ae.find("div.progress-label").remove();ae.find("md-progress-linear").remove();var ac=F('<div class="progress-label"></div>').text(ad+"%");(o.injector.get("$compile")(F('<md-progress-linear ng-cloak ng-value="'+ad+'" class="md-hue-2" md-mode="determinate" aria-label="Drop request percent complete"></md-progress-linear>'))(o.rootScope)).appendTo(ae);ae.append(ac)};F("#drop-request-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){Y=true;if(V!==null){clearTimeout(V);T()}}}}]);var T=function(){R.reloadStatus(W.id);if(K.isDefinedAndNotNull(Z)){F.ajax({type:"DELETE",url:Z.uri,dataType:"json"}).done(function(ac){Z=ac.dropRequest;var af=Z.dropped.split(/ \/ /);var ae=F("<div></div>");F('<span class="label"></span>').text(af[0]).appendTo(ae);F("<span></span>").text(" FlowFiles ("+af[1]+")").appendTo(ae);if(Z.percentCompleted<100){var ad=Z.original.split(/ \/ /);F('<span class="label"></span>').text(" out of "+ad[0]).appendTo(ae);F("<span></span>").text(" ("+ad[1]+")").appendTo(ae)}F("<span></span>").text(" were removed from the queue.").appendTo(ae);if(K.isDefinedAndNotNull(Z.failureReason)){F("<br/><br/><span></span>").text(Z.failureReason).appendTo(ae)}m.showOkDialog({headerText:"Empty Queue",dialogContent:ae})}).always(function(){F("#drop-request-status-dialog").modal("hide")})}else{m.showOkDialog({headerText:"Empty Queue",dialogContent:"No FlowFiles were removed."});F("#drop-request-status-dialog").modal("hide")}};var ab=function(ac){U(Z.percentCompleted);F("#drop-request-status-message").text(Z.state);if(Z.finished===true||Y===true){T()}else{V=setTimeout(function(){V=null;X(Math.min(aa,ac*2))},ac*1000)}};var X=function(ac){F.ajax({type:"GET",url:Z.uri,dataType:"json"}).done(function(ad){Z=ad.dropRequest;ab(ac)}).fail(function(af,ad,ae){if(af.status===403){f.handleAjaxError(af,ad,ae)}else{T()}})};F.ajax({type:"POST",url:"../nifi-api/flowfile-queues/"+encodeURIComponent(W.id)+"/drop-requests",dataType:"json",contentType:"application/json"}).done(function(ac){U(0);F("#drop-request-status-dialog").modal("show");Z=ac.dropRequest;ab(1)}).fail(function(ae,ac,ad){if(ae.status===403){f.handleAjaxError(ae,ac,ad)}else{T()}})}})},listQueue:function(T){if(T.size()!==1||!P.isConnection(T)){return}var S=T.datum();D.listQueue(S)},viewState:function(T){if(T.size()!==1||!P.isProcessor(T)){return}var S=T.datum();g.showState(S,P.isConfigurable(T))},saveFlowVersion:function(S){if(S.empty()){w.showFlowVersionDialog(P.getGroupId())}else{if(S.size()===1){var T=S.datum();if(P.isProcessGroup(S)){w.showFlowVersionDialog(T.id)}}}},revertLocalChanges:function(S){if(S.empty()){w.revertLocalChanges(P.getGroupId())}else{if(S.size()===1){var T=S.datum();w.revertLocalChanges(T.id)}}},showLocalChanges:function(S){if(S.empty()){w.showLocalChanges(P.getGroupId())}else{if(S.size()===1){var T=S.datum();w.showLocalChanges(T.id)}}},changeFlowVersion:function(S){if(S.empty()){w.showChangeFlowVersionDialog(P.getGroupId())}else{if(S.size()===1){var T=S.datum();if(P.isProcessGroup(S)){w.showChangeFlowVersionDialog(T.id)}}}},stopVersionControl:function(S){if(S.empty()){w.stopVersionControl(P.getGroupId())}else{if(S.size()===1){var T=S.datum();w.stopVersionControl(T.id)}}},openVariableRegistry:function(S){if(S.empty()){l.showVariables(P.getGroupId())}else{if(S.size()===1){var T=S.datum();if(P.isProcessGroup(S)){l.showVariables(T.id)}}}},changeVersion:function(T){if(T.size()!==1||!P.isProcessor(T)){return}var S=T.datum();u.promptForVersionChange(S)},alignVertical:function(U){var W=L.map();if(P.canModify(U)===false){m.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}var T=null,V=null;U.each(function(Y){if(Y.type!=="Connection"){if(T===null||Y.position.x<T){T=Y.position.x}var X=Y.position.x+Y.dimensions.width;if(V===null||X>V){V=X}}});var S=(T+V)/2;U.each(function(Y){if(Y.type!=="Connection"){var Z={x:S-(Y.position.x+Y.dimensions.width/2),y:0};if(Z.x!==0){var X=R.getComponentConnections(Y.id);F.each(X,function(ac,ab){var ad=L.select("#id-"+ab.id);if(!W.has(ab.id)&&P.getConnectionSourceComponentId(ab)===P.getConnectionDestinationComponentId(ab)){var aa=y.updateConnectionPosition(R.get(ab.id),Z);if(aa!==null){W.set(ab.id,aa)}}else{if(!W.has(ab.id)&&ad.classed("selected")&&P.canModify(ad)){if(P.getConnectionSourceComponentId(ab)===Y.id||!d(ab,U)){var aa=y.updateConnectionPosition(R.get(ab.id),Z);if(aa!==null){W.set(ab.id,aa)}}}}});W.set(Y.id,y.updateComponentPosition(Y,Z))}}});y.refreshConnections(W)},alignHorizontal:function(T){var V=L.map();if(P.canModify(T)===false){m.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}var W=null,U=null;T.each(function(Y){if(Y.type!=="Connection"){if(W===null||Y.position.y<W){W=Y.position.y}var X=Y.position.y+Y.dimensions.height;if(U===null||X>U){U=X}}});var S=(W+U)/2;T.each(function(Y){if(Y.type!=="Connection"){var Z={x:0,y:S-(Y.position.y+Y.dimensions.height/2)};if(Z.y!==0){var X=R.getComponentConnections(Y.id);F.each(X,function(ac,ab){var ad=L.select("#id-"+ab.id);if(!V.has(ab.id)&&P.getConnectionSourceComponentId(ab)===P.getConnectionDestinationComponentId(ab)){var aa=y.updateConnectionPosition(R.get(ab.id),Z);if(aa!==null){V.set(ab.id,aa)}}else{if(!V.has(ab.id)&&ad.classed("selected")&&P.canModify(ad)){if(P.getConnectionSourceComponentId(ab)===Y.id||!d(ab,T)){var aa=y.updateConnectionPosition(R.get(ab.id),Z);if(aa!==null){V.set(ab.id,aa)}}}}});V.set(Y.id,y.updateComponentPosition(Y,Z))}}});y.refreshConnections(V)},fillColor:function(U){if(P.isColorable(U)){var S=P.isProcessor(U);var T;if(S){T=t.defaultFillColor()}else{T=x.defaultColor()}if(U.size()===1){var V=U.datum();if(K.isDefinedAndNotNull(V.component.style["background-color"])){T=V.component.style["background-color"]}}F("#fill-color").minicolors("value",T);if(S){F("#fill-color-processor-preview").show();F("#fill-color-label-preview").hide()}else{F("#fill-color-processor-preview").hide();F("#fill-color-label-preview").show()}F("#fill-color-dialog").modal("show")}},group:function(){var T=P.getSelection();if(T.empty()){return}var S=P.getOrigin(T);var U={x:S.x,y:S.y};F.when(o.injector.get("groupComponent").promptForGroupName(U,false)).done(function(V){var W=L.select("#id-"+V.id);P.moveComponents(T,W)})},moveIntoParent:function(){var S=P.getSelection();if(S.empty()){return}P.moveComponentsToParent(S)},uploadTemplate:function(){F("#upload-template-dialog").modal("show")},template:function(){var S=P.getSelection();if(S.empty()){S=L.selectAll("g.component, g.connection")}if(S.empty()){m.showOkDialog({headerText:"Create Template",dialogContent:"The current selection is not valid to create a template."});return}S=P.trimDanglingEdges(S);if(S.empty()){m.showOkDialog({headerText:"Create Template",dialogContent:"The current selection is not valid to create a template."});return}F("#new-template-dialog").modal("setButtonModel",[{buttonText:"Create",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var U=F("#new-template-name").val();if(K.isBlank(U)){m.showOkDialog({headerText:"Create Template",dialogContent:"The template name cannot be blank."});return}F("#new-template-dialog").modal("hide");var W=F("#new-template-description").val();var T=P.getGroupId();var V=Q.marshal(S,T);Q.create(V).done(function(X){var Y={name:U,description:W,snippetId:X.snippet.id,disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged()};F.ajax({type:"POST",url:I.urls.api+"/process-groups/"+encodeURIComponent(P.getGroupId())+"/templates",data:JSON.stringify(Y),dataType:"json",contentType:"application/json"}).done(function(){m.showOkDialog({headerText:"Create Template",dialogContent:"Template '"+K.escapeHtml(U)+"' was successfully created."})}).always(function(){F("#new-template-name").val("");F("#new-template-description").val("")}).fail(f.handleAjaxError)}).fail(f.handleAjaxError)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){F("#new-template-name").val("");F("#new-template-description").val("");F("#new-template-dialog").modal("hide")}}}]).modal("show");F("#new-template-name").focus()},copy:function(U){if(U.empty()){return}var T=P.getOrigin(U);var S=P.getGroupId();B.copy({snippet:Q.marshal(U,S),origin:T})},paste:function(Z,aa){if(K.isDefinedAndNotNull(aa)){var U=P.getCanvasScale();var S=P.getCanvasTranslate();var V=aa.pageX;var T=aa.pageY-P.getCanvasOffset();var Y=(V/U)-(S[0]/U);var X=(T/U)-(S[1]/U);var W={x:Y,y:X}}B.paste().done(function(ac){var ab=F.Deferred(function(ad){var ae=function(ai,ag,ah){ad.reject(ai.responseText)};var af=P.getGroupId();Q.create(ac.snippet).done(function(ai){var ah=W;var ag=ac.origin;if(!K.isDefinedAndNotNull(ah)){ag.x+=25;ag.y+=25;ah=ag}Q.copy(ai.snippet.id,ah,af).done(function(ak){var aj=ak.flow;r.add(aj,{selectAll:true});r.updateVisibility();i.refresh()}).fail(function(){P.reload().done(function(){r.updateVisibility();i.refresh()})}).fail(ae)}).fail(ae)}).promise();ab.fail(function(ae){var ad="An error occurred while attempting to copy and paste.";if(F.trim(ae)!==""){ad=ae}m.showOkDialog({headerText:"Paste Error",dialogContent:K.escapeHtml(ad)})})})},toFront:function(V){if(V.size()!==1||!P.isConnection(V)){return}var S=V.datum();var U=-1;F.each(R.get(),function(X,Y){if(S.id!==Y.id&&Y.zIndex>U){U=Y.zIndex}});if(U>=0){var W=U+1;var T={revision:k.getRevision(S),disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged(),component:{id:S.id,zIndex:W}};F.ajax({type:"PUT",url:S.uri,data:JSON.stringify(T),dataType:"json",contentType:"application/json"}).done(function(X){R.set(X)}).fail(f.handleAjaxError)}}};return z}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.Graph","nf.Shell","nf.ng.Bridge","nf.ClusterSummary","nf.ErrorHandler","nf.Storage","nf.CanvasUtils","nf.Birdseye","nf.ContextMenu","nf.Actions","nf.ProcessGroup"],function(j,q,h,i,m,e,l,o,n,k,g,d,p,f,c){return(nf.Canvas=b(j,q,h,i,m,e,l,o,n,k,g,d,p,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Canvas=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.Graph"),require("nf.Shell"),require("nf.ng.Bridge"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.Birdseye"),require("nf.ContextMenu"),require("nf.Actions"),require("nf.ProcessGroup")))}else{nf.Canvas=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.Graph,a.nf.Shell,a.nf.ng.Bridge,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Storage,a.nf.CanvasUtils,a.nf.Birdseye,a.nf.ContextMenu,a.nf.Actions,a.nf.ProcessGroup)}}}(this,function(v,F,D,h,l,C,k,B,d,o,I,e,s,q,t){var z=1;var n=[0,0];var b=1.2;var G=8;var p=0.2;var u=0.6;var M="";var g=false;var y=false;var J="root";var L=null;var i=null;var j=null;var a=false;var E=false;var m=false;var c=null;var f=null;var K=false;var x={urls:{api:"../nifi-api",currentUser:"../nifi-api/flow/current-user",controllerBulletins:"../nifi-api/flow/controller/bulletins",kerberos:"../nifi-api/access/kerberos",oidc:"../nifi-api/access/oidc/exchange",revision:"../nifi-api/flow/revision",banners:"../nifi-api/flow/banners"}};var A=function(N){if(g){r.reload({transition:true}).done(function(){setTimeout(function(){A(N)},N*1000)})}};var H=function(N,P){var O=new Date().getTime();return v.ajax({type:"GET",url:x.urls.api+"/flow/process-groups/"+encodeURIComponent(N),dataType:"json"}).done(function(Q){var S=Q.processGroupFlow;r.setGroupId(S.id);var T=S.breadcrumb;if(T.permissions.canRead){r.setGroupName(T.breadcrumb.name)}else{r.setGroupName(T.id)}i=Q.permissions;k.injector.get("breadcrumbsCtrl").resetBreadcrumbs();k.digest();k.injector.get("breadcrumbsCtrl").generateBreadcrumbs(T);k.injector.get("breadcrumbsCtrl").resetScrollPosition();var R=T;while(R.parentBreadcrumb!=null){R=R.parentBreadcrumb}if(M==""){M=document.title}if(R.permissions.canRead){document.title=R.breadcrumb.name}else{document.title=M}v("#stats-last-refreshed").text(S.lastRefreshed);if(D.isDefinedAndNotNull(S.parentGroupId)){r.setParentGroupId(S.parentGroupId)}else{r.setParentGroupId(null)}l.expireCaches(O);l.set(S.flow,v.extend({selectAll:false,overrideRevisionCheck:B.didConnectedStateChange()},P));l.updateVisibility();e.refresh()}).fail(d.handleAjaxError)};var w=function(){return v.ajax({type:"GET",url:x.urls.currentUser,dataType:"json"}).done(function(N){D.setCurrentUser(N)})};var r={CANVAS_OFFSET:0,SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,hideSplash:function(){v("#splash").fadeOut()},stopPolling:function(){g=false},disableRefreshHotKey:function(){y=true},reload:function(N){return v.Deferred(function(Q){var P=H(r.getGroupId(),N);var S=k.injector.get("flowStatusCtrl").reloadFlowStatus();var R=w();var O=v.ajax({type:"GET",url:x.urls.controllerBulletins,dataType:"json"}).done(function(U){k.injector.get("flowStatusCtrl").updateBulletins(U)});var T=B.loadClusterSummary().done(function(U){var V=U.clusterSummary;if(B.didConnectedStateChange()){if(V.connectedToCluster){h.showConnectedToClusterMessage(function(){o.resetDisconnectionAcknowledgement()})}else{h.showDisconnectedFromClusterMessage(function(){o.acknowledgeDisconnection()})}}k.injector.get("flowStatusCtrl").updateClusterSummary(V)});v.when(P,S,R,O,T).done(function(U){k.digest();Q.resolve(U)}).fail(function(W,U,V){Q.reject(W,U,V)})}).promise()},initCanvas:function(){var T=v("#canvas-container");c=F.select("#canvas-container").append("svg").on("contextmenu",function(){K=false;I.getSelection().classed("selected",false);I.setURLParameters();s.show();F.event.preventDefault()});var N=c.append("defs");N.selectAll("marker").data(["normal","ghost","unauthorized","full"]).enter().append("marker").attrs({id:function(U){return U},viewBox:"0 0 6 6",refX:5,refY:3,markerWidth:6,markerHeight:6,orient:"auto",fill:function(U){if(U==="ghost"){return"#aaaaaa"}else{if(U==="unauthorized"){return"#ba554a"}else{if(U==="full"){return"#ba554a"}else{return"#000000"}}}}}).append("path").attr("d","M2,3 L0,6 L6,3 L0,0 z");var P=N.append("filter").attrs({id:"component-drop-shadow",height:"140%",y:"-20%"});P.append("feGaussianBlur").attrs({"in":"SourceAlpha",stdDeviation:3,result:"blur"});P.append("feOffset").attrs({"in":"blur",dx:0,dy:1,result:"offsetBlur"});P.append("feFlood").attrs({"flood-color":"#000000","flood-opacity":0.4,result:"offsetColor"});P.append("feComposite").attrs({"in":"offsetColor",in2:"offsetBlur",operator:"in",result:"offsetColorBlur"});var R=P.append("feMerge");R.append("feMergeNode").attr("in","offsetColorBlur");R.append("feMergeNode").attr("in","SourceGraphic");var O=N.append("filter").attrs({id:"connection-full-drop-shadow",height:"140%",y:"-20%"});O.append("feGaussianBlur").attrs({"in":"SourceAlpha",stdDeviation:3,result:"blur"});O.append("feOffset").attrs({"in":"blur",dx:0,dy:1,result:"offsetBlur"});O.append("feFlood").attrs({"flood-color":"#ba554a","flood-opacity":1,result:"offsetColor"});O.append("feComposite").attrs({"in":"offsetColor",in2:"offsetBlur",operator:"in",result:"offsetColorBlur"});var S=O.append("feMerge");S.append("feMergeNode").attr("in","offsetColorBlur");S.append("feMergeNode").attr("in","SourceGraphic");f=c.append("g").attrs({transform:"translate("+n+") scale("+z+")","pointer-events":"all",id:"canvas"});c.on("mousedown.selection",function(){K=true;if(F.event.button!==0){F.event.stopImmediatePropagation();return}if(F.event.shiftKey){var U=F.mouse(f.node());f.append("rect").attr("rx",6).attr("ry",6).attr("x",U[0]).attr("y",U[1]).attr("class","component-selection").attr("width",0).attr("height",0).attr("stroke-width",function(){return 1/r.View.getScale()}).attr("stroke-dasharray",function(){return 4/r.View.getScale()}).datum(U);F.event.stopImmediatePropagation();F.event.preventDefault()}}).on("mousemove.selection",function(){if(F.event.shiftKey){var V=F.select("rect.component-selection");if(!V.empty()){var W=V.datum();var U=F.mouse(f.node());var X={};if(W[0]<U[0]){X.x=W[0];X.width=U[0]-W[0]}else{X.x=U[0];X.width=W[0]-U[0]}if(W[1]<U[1]){X.y=W[1];X.height=U[1]-W[1]}else{X.y=U[1];X.height=W[1]-U[1]}V.attrs(X);F.event.stopPropagation()}}}).on("mouseup.selection",function(){if(K===false){return}K=false;var U=F.select("rect.component-selection");if(!U.empty()){var V={x:parseInt(U.attr("x"),10),y:parseInt(U.attr("y"),10),width:parseInt(U.attr("width"),10),height:parseInt(U.attr("height"),10)};F.selectAll("g.component").classed("selected",function(W){return F.select(this).classed("selected")||W.position.x>=V.x&&(W.position.x+W.dimensions.width)<=(V.x+V.width)&&W.position.y>=V.y&&(W.position.y+W.dimensions.height)<=(V.y+V.height)});F.selectAll("g.connection").classed("selected",function(Y){var X=[Y.start].concat(Y.bends,[Y.end]);var W=F.extent(X,function(aa){return aa.x});var Z=F.extent(X,function(aa){return aa.y});return F.select(this).classed("selected")||W[0]>=V.x&&W[1]<=(V.x+V.width)&&Z[0]>=V.y&&Z[1]<=(V.y+V.height)});U.remove();I.setURLParameters()}k.digest()});var Q=function(){var Y=v("#banner-footer");var U=0;if(Y.is(":visible")){U=Y.height()}var W=parseInt(T.css("top"),10);var X=v(window).height();var V=(X-(U+W));T.css({height:V+"px",bottom:U+"px"});c.attrs({height:T.height(),width:v(window).width()});k.injector.get("breadcrumbsCtrl").updateBreadcrumbsCss({bottom:U+"px"});v("#canvas-body").css({height:X+"px",width:v(window).width()+"px"})};v("body").on("GoTo:Component",function(V,U){I.showComponent(U.parentGroupId,U.id)});v("body").on("GoTo:ProcessGroup",function(V,U){t.enterGroup(U.id).done(function(){I.getSelection().classed("selected",false);k.digest()})});v(window).on("resize",function(ac){if(ac.target===window){if(v(".md-menu-backdrop").is(":visible")===true){v(".md-menu-backdrop").click()}Q();var aa=v("#shell-dialog");if(aa.is(":visible")){setTimeout(function(ae){C.resizeContent(ae);if(ae.find("#shell-iframe").is(":visible")){C.resizeIframe(ae)}},50,aa)}var U=v(".dialog");for(var Z=0,ab=U.length;Z<ab;Z++){if(v(U[Z]).is(":visible")){setTimeout(function(ae){ae.modal("resize")},50,v(U[Z]))}}var ad=v('*[class*="slickgrid_"]');for(var Y=0,ab=ad.length;Y<ab;Y++){if(v(ad[Y]).is(":visible")){setTimeout(function(af){var ae=af.data("gridInstance");var ag=ae.getEditorLock();if(!ag.isActive()){ae.resizeCanvas()}},50,v(ad[Y]))}}var W=v(".tab-container");var V=[];for(var X=0,ab=W.length;X<ab;X++){if(v(W[X]).is(":visible")){V.push(v("#"+v(W[X]).attr("id")+"-content"))}}v.each(V,function(ae,af){D.toggleScrollable(af.get(0))})}}).on("keydown",function(U){if(v(".dialog").is(":visible")||v("#search-field").is(":focus")){return}var V=I.getSelection();var W=U.ctrlKey||U.metaKey;if(W){if(U.keyCode===82){if(y===true){location.reload();return}q.reload()}else{if(U.keyCode===65){q.selectAll();I.setURLParameters();k.digest();U.preventDefault()}else{if(U.keyCode===67){if(r.canWrite()&&I.isCopyable(V)){q.copy(V)}}else{if(U.keyCode===86){if(r.canWrite()&&I.isPastable()){q.paste(V);U.preventDefault()}}}}}}else{if(U.keyCode===8||U.keyCode===46){if(r.canWrite()&&I.areDeletable(V)){q["delete"](V)}}}});v.ajax({type:"GET",url:x.urls.banners,dataType:"json"}).done(function(W){if(D.isDefinedAndNotNull(W.banners)){if(D.isDefinedAndNotNull(W.banners.headerText)&&W.banners.headerText!==""){v("#banner-header").addClass("banner-header-background").text(W.banners.headerText).show();v("#canvas-container").css("top","98px")}if(D.isDefinedAndNotNull(W.banners.footerText)&&W.banners.footerText!==""){var U=v("#banner-footer").text(W.banners.footerText).show();var V=function(X){var Y=v("#"+X);Y.css("bottom",parseInt(U.css("height"),10)+"px")};V("graph")}}Q()}).fail(d.handleAjaxError)},init:function(){var N=v.Deferred(function(O){var P=function(S){var R=D.getJwtPayload(S);var Q=parseInt(R.exp,10)*D.MILLIS_PER_SECOND;o.setItem("jwt",S,Q);O.resolve()};if(o.hasItem("jwt")){O.resolve()}else{v.ajax({type:"POST",url:x.urls.kerberos,dataType:"text"}).done(function(Q){P(Q)}).fail(function(){v.ajax({type:"POST",url:x.urls.oidc,dataType:"text"}).done(function(Q){P(Q)}).fail(function(){O.reject()})})}}).promise();return v.Deferred(function(O){N.always(function(){w().done(function(P){if(P.anonymous===false){v("#current-user").text(P.identity).show();if(o.getItem("jwt")!==null){v("#logout-link-container").show()}}else{D.setAnonymousUserLabel()}O.resolve()}).fail(function(R,P,Q){if(R.status===401){window.location="../nifi/login"}else{O.reject(R,P,Q)}})})}).promise()},setGroupId:function(N){J=N},getGroupId:function(){return J},setGroupName:function(N){L=N},getGroupName:function(){return L},setParentGroupId:function(N){j=N},getParentGroupId:function(){return j},setManagedAuthorizer:function(N){a=N},isManagedAuthorizer:function(){return a},setConfigurableAuthorizer:function(N){E=N},isConfigurableAuthorizer:function(){return E},setConfigurableUsersAndGroups:function(N){m=N},isConfigurableUsersAndGroups:function(){return m},canRead:function(){if(i===null){return false}else{return i.canRead===true}},canWrite:function(){if(i===null){return false}else{return i.canWrite===true}},startPolling:function(N){g=true;A(N)},View:(function(){var P;var N=0,Q=0,O=z;return{init:function(){var T;var S=false;var U=function(V){if(D.isDefinedAndNotNull(V)){if(D.isDefinedAndNotNull(V.subject)){return V.subject.source==="birdseye"}else{return false}}else{return false}};var R=function(V){if(D.isDefinedAndNotNull(V)){if(U(V)){return false}return V.type==="wheel"||V.type==="mousewheel"}else{return true}};P=F.zoom().scaleExtent([p,G]).on("start",function(){s.hide()}).on("zoom",function(){if(!isNaN(F.event.transform.x)){N=F.event.transform.x}if(!isNaN(F.event.transform.y)){Q=F.event.transform.y}if(!isNaN(F.event.transform.k)){O=F.event.transform.k}S=true;T=r.View.refresh({persist:false,transition:R(F.event.sourceEvent),refreshComponents:false,refreshBirdseye:false})}).on("end",function(){if(!U(F.event.sourceEvent)){if(D.isDefinedAndNotNull(T)){l.updateVisibility();T.done(function(){e.refresh()});I.persistUserView();T=null}if(S===false){I.getSelection().classed("selected",false);I.setURLParameters();k.digest()}}S=false});c.call(P).on("dblclick.zoom",null)},shouldRenderPerScale:function(){return r.View.getScale()>=u},translate:function(R){P.translateBy(c,R[0],R[1])},scale:function(R){P.scaleBy(c,R)},transform:function(S,R){P.transform(c,F.zoomIdentity.translate(S[0],S[1]).scale(R))},getTranslate:function(){return[N,Q]},getScale:function(){return O},zoomIn:function(){r.View.scale(b)},zoomOut:function(){r.View.scale(1/b)},fit:function(){var T=r.View.getTranslate();var V=r.View.getScale();var Y;var X=v("#canvas-container");var U=X.width();var W=X.height();var aa=F.select("#canvas").node().getBoundingClientRect();var ab=aa.width/V;var S=aa.height/V;var Z=aa.left/V;var R=(aa.top-r.CANVAS_OFFSET)/V;if(ab>U||S>W){Y=Math.min(U/ab,W/S);Y=Math.min(Math.max(Y,p),G)}else{Y=1;Z-=100;R-=50}I.centerBoundingBox({x:Z-(T[0]/V),y:R-(T[1]/V),width:U/Y,height:W/Y,scale:Y})},actualSize:function(){var W=r.View.getTranslate();var V=r.View.getScale();var S=I.getSelection();var T;if(!S.empty()){var R=S.node().getBoundingClientRect();T={x:(R.left/V)-(W[0]/V),y:((R.top-r.CANVAS_OFFSET)/V)-(W[1]/V),width:R.width/V,height:R.height/V,scale:1}}else{var Y=v("#canvas-container");var U=Y.width()/V;var X=Y.height()/V;T={x:(U/2)-(W[0]/V),y:(X/2)-(W[1]/V),width:1,height:1,scale:1}}I.centerBoundingBox(T)},refresh:function(R){return v.Deferred(function(S){var V=true;var X=false;var W=true;var Y=true;if(D.isDefinedAndNotNull(R)){V=D.isDefinedAndNotNull(R.persist)?R.persist:V;X=D.isDefinedAndNotNull(R.transition)?R.transition:X;W=D.isDefinedAndNotNull(R.refreshComponents)?R.refreshComponents:W;Y=D.isDefinedAndNotNull(R.refreshBirdseye)?R.refreshBirdseye:Y}if(W){l.updateVisibility()}if(V===true){I.persistUserView()}var T=r.View.getTranslate();var U=r.View.getScale();if(X===true){f.transition().duration(500).attr("transform",function(){return"translate("+T+") scale("+U+")"}).on("end",function(){if(Y===true){e.refresh()}S.resolve()})}else{f.attr("transform",function(){return"translate("+T+") scale("+U+")"});if(Y===true){e.refresh()}S.resolve()}}).promise()}}}())};return r}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.ErrorHandler","nf.Common","nf.Canvas","nf.ContextMenu"],function(f,e,d,c){return(nf.ErrorHandler=b(f,e,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("nf.ErrorHandler"),require("nf.Common"),require("nf.Canvas"),require("nf.ContextMenu")))}else{nf.ErrorHandler=b(a.nf.ErrorHandler,a.nf.Common,a.nf.Canvas,a.nf.ContextMenu)}}}(this,function(d,c,b,a){return{handleAjaxError:function(g,e,f){d.handleAjaxError(g,e,f);c.showLogoutLink();if($("#splash").is(":visible")){b.hideSplash()}a.hide();b.stopPolling();b.disableRefreshHotKey()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.Settings","nf.UniversalCapture","nf.CustomUi","nf.CanvasUtils","nf.Processor"],function(g,m,l,d,f,h,n,e,i,k,c,j){return(nf.ControllerService=b(g,m,l,d,f,h,n,e,i,k,c,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ControllerService=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.Settings"),require("nf.UniversalCapture"),require("nf.CustomUi"),require("nf.CanvasUtils"),require("nf.Processor")))}else{nf.ControllerService=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.Settings,a.nf.UniversalCapture,a.nf.CustomUi,a.nf.CanvasUtils,a.nf.Processor)}}}(this,function(D,U,d,S,j,t,g,I,c,A,X,s){var O,E;var N={edit:"edit",readOnly:"read-only",serviceOnly:"SERVICE_ONLY",serviceAndReferencingComponents:"SERVICE_AND_REFERENCING_COMPONENTS",urls:{api:"../nifi-api"}};var x=function(ad,aa,ab){if(ad.status===400){var ae=ad.responseText.split("\n");var ac;if(ae.length===1){ac=D("<span></span>").text(ae[0])}else{ac=S.formatUnorderedList(ae)}j.showOkDialog({dialogContent:ac,headerText:"Controller Service"})}else{d.handleAjaxError(ad,aa,ab)}};var H=function(){var aa=D("#controller-service-configuration").data("controllerServiceDetails");if(D("#controller-service-name").val()!==aa.component.name){return true}if(D("#controller-service-comments").val()!==aa.component.comments){return true}return D("#controller-service-properties").propertytable("isSaveRequired")};var n=function(){var ab=D("#controller-service-properties").propertytable("marshalProperties");var ac={};ac.id=D("#controller-service-id").text();ac.name=D("#controller-service-name").val();ac.comments=D("#controller-service-comments").val();if(D.isEmptyObject(ab)===false){ac.properties=ab}var aa={};aa.disconnectedNodeAcknowledged=t.isDisconnectionAcknowledged();aa.component=ac;return aa};var b=function(aa){return true};var Y=function(ad,ae){var ab=ad.data("gridInstance");var ac=ab.getData();var aa=ac.getItemById(ae);if(S.isUndefined(aa)||aa.permissions.canRead===false){return D.Deferred(function(af){af.reject()}).promise()}return D.ajax({type:"GET",url:aa.uri,dataType:"json"}).done(function(af){P(ad,af)}).fail(d.handleAjaxError)};var P=function(ae,aa){var ab=ae.data("gridInstance");var ad=ab.getData();var ac=ad.getItemById(aa.id);ad.updateItem(aa.id,D.extend({type:"ControllerService",bulletins:ac.bulletins},aa))};var h=function(ab,aa){Y(ab,aa.id).done(function(ac){f(ab,ac.component)})};var f=function(ab,aa){D.each(aa.referencingComponents,function(ad,af){if(af.permissions.canRead===false){return}var ac=af.component;if(ac.referenceType==="Processor"){if(X.getGroupId()===ac.groupId){s.reload(ac.id)}D("div."+ac.id+"-active-threads").text(ac.activeThreadCount);var ae=D("div."+ac.id+"-state");if(ae.length){l(ae,ac)}}else{if(ac.referenceType==="ReportingTask"){E.reload(ac.id);D("div."+ac.id+"-active-threads").text(ac.activeThreadCount);var ae=D("div."+ac.id+"-state");if(ae.length){l(ae,ac)}}else{Y(ab,ac.id);var ae=D("div."+ac.id+"-state");if(ae.length){J(ae,ac)}if(ac.referenceCycle===false){f(ab,ac)}}}});T.reloadReferencedServices(ab,aa)};var V=function(aa){var ab=aa.get(0).scrollHeight>Math.round(aa.innerHeight())||aa.get(0).scrollWidth>Math.round(aa.innerWidth());if(aa.is(":visible")&&ab){aa.css("border-width","1px")}else{aa.css("border-width","0px")}};var k=function(ad,ab){var ae=ab.data("bulletins");if(S.doBulletinsDiffer(ae,ad)){ab.data("bulletins",ad);var aa=S.getFormattedBulletins(ad);if(ad.length>0){var ac=S.formatUnorderedList(aa);if(ab.data("qtip")){ab.qtip("option","content.text",ac)}else{ab.addClass("has-bulletins").show().qtip(D.extend({},X.config.systemTooltipConfig,{content:ac}))}}else{if(ab.data("qtip")){ab.removeClass("has-bulletins").removeData("bulletins").hide().qtip("api").destroy(true)}}}};var l=function(aa,ab){aa.removeClass("disabled stopped running invalid").addClass(function(){var ac=D(this);var ae=ab.state.toLowerCase();if(ae==="stopped"&&!S.isEmpty(ab.validationErrors)){ae="invalid";var ad=S.formatUnorderedList(ab.validationErrors);if(ac.data("qtip")){ac.qtip("option","content.text",ad)}else{ac.qtip(D.extend({},X.config.systemTooltipConfig,{content:ad}))}}else{if(ac.data("qtip")){ac.qtip("api").destroy(true)}}return ae})};var J=function(ab,aa){ab.removeClass("disabled enabled invalid").addClass(function(){var ac=D(this);var ae=aa.state==="ENABLED"?"enabled":"disabled";if(ae==="disabled"&&!S.isEmpty(aa.validationErrors)){ae="invalid";var ad=S.formatUnorderedList(aa.validationErrors);if(ac.data("qtip")){ac.qtip("option","content.text",ad)}else{ac.qtip(D.extend({},X.config.systemTooltipConfig,{content:ad}))}}else{if(ac.data("qtip")){ac.qtip("api").destroy(true)}}return ae})};var m=function(ab){var aa=U.nest().key(function(ac){return ac.sourceId}).map(ab,U.map);aa.each(function(ac,ad){D("div."+ad+"-bulletins").each(function(){k(ac,D(this))})})};var M=function(aj,ak,ab){if(ab.permissions.canRead===false){ak.append('<div class="unset">Unauthorized</div>');return}var ae=ab.component.referencingComponents;if(S.isEmpty(ae)){ak.append('<div class="unset">No referencing components.</div>');return}var ac=function(am,al){if(am.hasClass("expanded")){am.removeClass("expanded").addClass("collapsed");al.hide()}else{am.removeClass("collapsed").addClass("expanded");al.show()}};var ad=[];var af=D('<ul class="referencing-component-listing clear"></ul>');var ai=D('<ul class="referencing-component-listing clear"></ul>');var aa=D('<ul class="referencing-component-listing clear"></ul>');var ag=D('<ul class="referencing-component-listing clear"></ul>');D.each(ae,function(aI,ar){if(ar.permissions.canRead===false){var ao=D('<div class="unset"></div>').text(ar.id);ag.append(ao)}else{var aB=ar.component;ad.push(aB.id);if(aB.referenceType==="Processor"){var aH=D('<span class="referencing-component-name link"></span>').text(aB.name).on("click",function(){X.showComponent(aB.groupId,aB.id);ak.closest(".dialog").modal("hide");D("#shell-close-button").click()});var ax=D('<div class="referencing-component-state"></div>').addClass(aB.id+"-state");l(ax,aB);var az=D('<div class="referencing-component-bulletins"></div>').addClass(aB.id+"-bulletins");var aC=D('<span class="referencing-component-type"></span>').text(aB.type);var an=D('<span class="referencing-component-active-thread-count"></span>').addClass(aB.id+"-active-threads");if(S.isDefinedAndNotNull(aB.activeThreadCount)&&aB.activeThreadCount>0){an.text("("+aB.activeThreadCount+")")}var au=D("<li></li>").append(ax).append(az).append(aH).append(aC).append(an);af.append(au)}else{if(aB.referenceType==="ControllerService"){var aE=D('<span class="referencing-component-name link"></span>').text(aB.name).on("click",function(){var aJ=aj.data("gridInstance");var aK=aJ.getData();var aL=aK.getRowById(aB.id);aJ.setSelectedRows([aL]);aJ.scrollRowIntoView(aL);ak.closest(".dialog").modal("hide")});var aF=D('<div class="referencing-component-references hidden"></div>');var aq=D('<div class="service expansion-button collapsed pointer"></div>').on("click",function(){if(aq.hasClass("collapsed")){if(aB.referenceCycle===true){aF.append('<div class="unset">Reference cycle detected.</div>')}else{var aJ=aj.data("gridInstance");var aK=aJ.getData();o(aB.id,aK).done(function(aL){M(aj,aF,aL)})}}else{aF.empty()}ac(aq,aF);V(ak)});var av=D('<div class="referencing-component-state"></div>').addClass(aB.id+"-state");J(av,aB);var aG=D('<div class="referencing-component-bulletins"></div>').addClass(aB.id+"-bulletins");var aA=D('<span class="referencing-component-type"></span>').text(aB.type);var at=D("<li></li>").append(aq).append(av).append(aG).append(aE).append(aA).append(aF);ai.append(at)}else{if(aB.referenceType==="ReportingTask"){var ap=D('<span class="referencing-component-name link"></span>').text(aB.name).on("click",function(){var aL=D("#reporting-tasks-table").data("gridInstance");var aJ=aL.getData();var aK=aJ.getRowById(aB.id);aL.setSelectedRows([aK]);aL.scrollRowIntoView(aK);D("#settings-tabs").find("li:last").click();ak.closest(".dialog").modal("hide")});var ay=D('<div class="referencing-component-state"></div>').addClass(aB.id+"-state");l(ay,aB);var al=D('<div class="referencing-component-bulletins"></div>').addClass(aB.id+"-bulletins");var am=D('<span class="referencing-component-type"></span>').text(S.substringAfterLast(aB.type,"."));var aw=D('<span class="referencing-component-active-thread-count"></span>').addClass(aB.id+"-active-threads");if(S.isDefinedAndNotNull(aB.activeThreadCount)&&aB.activeThreadCount>0){aw.text("("+aB.activeThreadCount+")")}var aD=D("<li></li>").append(ay).append(al).append(ap).append(am).append(aw);aa.append(aD)}}}}});X.queryBulletins(ad).done(function(al){var am=al.bulletinBoard.bulletins;m(am)});var ah=function(al,an){if(an.is(":empty")){an.remove();return}var ap=D('<div class="expansion-button expanded"></div>');var ao=D('<span class="referencing-component-title"></span>').text(al);var am=D('<span class="referencing-component-count"></span>').text("("+an.children().length+")");D('<div class="referencing-component-block pointer unselectable"></div>').on("click",function(){ac(ap,an);V(ak)}).append(ap).append(ao).append(am).appendTo(ak);an.appendTo(ak)};ah("Processors",af);ah("Reporting Tasks",aa);ah("Controller Services",ai);ah("Unauthorized",ag)};var e=function(af,ab,ad,ae){var aa={revision:g.getRevision(ab),disconnectedNodeAcknowledged:t.isDisconnectionAcknowledged(),state:ad?"ENABLED":"DISABLED"};var ac=D.ajax({type:"PUT",url:ab.uri+"/run-status",data:JSON.stringify(aa),dataType:"json",contentType:"application/json"}).done(function(ag){P(af,ag)}).fail(d.handleAjaxError);return D.Deferred(function(ag){ac.done(function(){if(ab.permissions.canRead===false){ag.resolve();return}var ah=u(ab,function(ak,aj){if(D.isArray(aj)){if(ad){k(aj,D("#enable-controller-service-bulletins"))}else{k(aj,D("#disable-controller-service-bulletins"))}}var ai=ak.status.runStatus;if(ad){return ai==="ENABLING"||ai==="ENABLED"}else{return ai==="DISABLED"}},function(ai){return X.queryBulletins([ab.id])},ae);ah.done(function(){ag.resolve()}).fail(function(){ag.reject()})}).fail(function(){ag.reject()})}).promise()};var q=function(aa){var ab=U.set();ab.add(aa.id);var ac=function(ad){D.each(ad,function(ae,ag){var af=ag.component;if(af.referenceType==="ControllerService"){ab.add(af.id);if(af.referenceCycle===false){ac(af.referencingComponents)}}})};ac(aa.referencingComponents);return ab};var a=function(ab,aa,ac){D.each(ab,function(ad,af){var ae=af.component;if(ac){if(ae.referenceType==="ControllerService"){aa[af.id]=g.getRevision(af)}}else{if(ae.referenceType!=="ControllerService"){aa[af.id]=g.getRevision(af)}}a(ae.referencingComponents,aa,ac)})};var F=function(af,aa,ac,ae){var ag={};a(aa.component.referencingComponents,ag,false);var ad={id:aa.id,state:ac?"RUNNING":"STOPPED",referencingComponentRevisions:ag,disconnectedNodeAcknowledged:t.isDisconnectionAcknowledged()};var ab=D.ajax({type:"PUT",url:aa.uri+"/references",data:JSON.stringify(ad),dataType:"json",contentType:"application/json"}).fail(d.handleAjaxError);return D.Deferred(function(ah){ab.done(function(ai){aa.component.referencingComponents=ai.controllerServiceReferencingComponents;if(ac){ah.resolve()}else{var aj=q(aa.component);var ak=af.data("gridInstance");var am=ak.getData();var al=[];aj.each(function(an){o(an,am).done(function(ao){al.push(w(ao,ae))})});D.when.apply(window,al).done(function(){ah.resolve()}).fail(function(){ah.reject()})}}).fail(function(){ah.reject()})}).promise()};var o=function(ab,ac){var aa=ac.getItemById(ab);if(S.isDefinedAndNotNull(aa)){return D.Deferred(function(ad){ad.resolve(aa)})}else{return D.ajax({type:"GET",url:"../nifi-api/controller-services/"+encodeURIComponent(ab),dataType:"json"}).fail(d.handleAjaxError)}};var u=function(aa,ad,ac,ae){var ab=aa.component;return D.Deferred(function(af){var ai=2;var ah=function(){var ak=ai;ai=Math.min(ai*2,4);return ak*1000};var aj=function(){var al=ac(ab);var ak=D.ajax({type:"GET",url:aa.uri,dataType:"json"});D.when(al,ak).done(function(am,an){var ao=an[0];ag(ao,am.bulletinBoard.bulletins)}).fail(function(ao,am,an){af.reject();d.handleAjaxError(ao,am,an)})};var ag=function(al,ak){if(ad(al,ak)){af.resolve()}else{if(typeof ae==="function"&&ae()){setTimeout(aj,ah())}else{af.reject()}}};ac(ab).done(function(ak){ag(aa,ak.bulletinBoard.bulletins)}).fail(function(am,ak,al){af.reject();d.handleAjaxError(am,ak,al)})}).promise()};var w=function(aa,ab){return u(aa,function(af,ae){var ac=af.component.referencingComponents;var ad=false;D.each(ac,function(ag,aj){var ai=aj.component;if(ai.referenceType==="Processor"||ai.referenceType==="ReportingTask"){if(ai.state==="RUNNING"||ai.activeThreadCount>0){ad=true}D("div."+ai.id+"-active-threads").text(ai.activeThreadCount);var ah=D("div."+ai.id+"-state");l(ah,ai)}});m(ae);return ad===false},function(ac){var ae=[];var ad=ac.referencingComponents;D.each(ad,function(af,ah){var ag=ah.component;if(ag.referenceType==="Processor"||ag.referenceType==="ReportingTask"){ae.push(ag.id)}});return X.queryBulletins(ae)},ab)};var Z=function(aa,ab){return u(aa,function(af,ae){var ac=af.component.referencingComponents;var ad=false;D.each(ac,function(ag,aj){var ah=aj.component;if(ah.referenceType==="ControllerService"){if(ah.state!=="ENABLING"&&ah.state!=="ENABLED"){ad=true}var ai=D("div."+ah.id+"-state");J(ai,ah)}});m(ae);return ad===false},function(ac){var ae=[];var ad=ac.referencingComponents;D.each(ad,function(af,ah){var ag=ah.component;if(ag.referenceType==="ControllerService"){ae.push(ag.id)}});return X.queryBulletins(ae)},ab)};var L=function(aa,ab){return u(aa,function(ae,ad){var ac=ae.component.referencingComponents;var af=false;D.each(ac,function(ag,aj){var ah=aj.component;if(ah.referenceType==="ControllerService"){if(ah.state!=="DISABLED"){af=true}var ai=D("div."+ah.id+"-state");J(ai,ah)}});m(ad);return af===false},function(ac){var ae=[];var ad=ac.referencingComponents;D.each(ad,function(af,ah){var ag=ah.component;if(ag.referenceType==="ControllerService"){ae.push(ag.id)}});return X.queryBulletins(ae)},ab)};var r=function(af,aa,ac,ae){var ag={};a(aa.component.referencingComponents,ag,true);var ad={id:aa.id,state:ac?"ENABLED":"DISABLED",referencingComponentRevisions:ag,disconnectedNodeAcknowledged:t.isDisconnectionAcknowledged()};var ab=D.ajax({type:"PUT",url:aa.uri+"/references",data:JSON.stringify(ad),dataType:"json",contentType:"application/json"}).fail(d.handleAjaxError);return D.Deferred(function(ah){ab.done(function(ai){aa.component.referencingComponents=ai.controllerServiceReferencingComponents;var aj=q(aa.component);var ak=af.data("gridInstance");var am=ak.getData();var al=[];aj.each(function(an){o(an,am).done(function(ao){if(ac){al.push(Z(ao,ae))}else{al.push(L(ao,ae))}})});D.when.apply(window,al).done(function(){ah.resolve()}).fail(function(){ah.reject()})}).fail(function(){ah.reject()})}).promise()};var z=function(ad,ab){D("#disable-controller-service-id").text(ab.id);D("#disable-controller-service-name").text(S.getComponentName(ab));var aa=D("#disable-controller-service-referencing-components");M(ad,aa,ab);var ac=[{buttonText:"Disable",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){G(ad)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:R}}];D("#disable-controller-service-dialog").modal("setButtonModel",ac).modal("show");X.queryBulletins([ab.id]).done(function(ae){k(ae.bulletinBoard.bulletins,D("#disable-controller-service-bulletins"))});V(aa)};var C=function(ad,ab){D("#enable-controller-service-id").text(ab.id);D("#enable-controller-service-name").text(S.getComponentName(ab));var aa=D("#enable-controller-service-referencing-components");M(ad,aa,ab);var ac=[{buttonText:"Enable",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){i(ad)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:R}}];D("#enable-controller-service-dialog").modal("setButtonModel",ac).modal("show");X.queryBulletins([ab.id]).done(function(ae){k(ae.bulletinBoard.bulletins,D("#enable-controller-service-bulletins"))});V(aa)};var R=function(){D(this).modal("hide")};var G=function(aj){var ad=D("#disable-controller-service-dialog");var ac=false;ad.modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ac=true;ad.modal("setButtonModel",[]);D("#disable-controller-service-dialog div.controller-service-canceling").show()}}}]);D("#disable-controller-service-scope-container").hide();D("#disable-controller-service-progress-container").show();var ai=D("#disable-controller-service-id").text();var aa=aj.data("gridInstance");var ae=aa.getData();var ab=ae.getItemById(ai);var af=ab.component;var ak=function(){return ac===false};var ah=function(){D("#disable-controller-service-dialog div.controller-service-canceling").hide();ad.modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:R}}])};if(B(ab)){ah();j.showOkDialog({headerText:"Controller Service",dialogContent:ab.permissions.canRead===false?"Unable to disable due to a lack of read permission to see referencing components.":"Unable to disable due to unauthorized referencing components."});return}D("#disable-progress-label").text("Steps to disable "+S.getComponentName(ab));var ag=D("#disable-referencing-schedulable").addClass("ajax-loading");D.Deferred(function(al){var am=F(aj,ab,false,ak);am.done(function(){ag.removeClass("ajax-loading").addClass("ajax-complete");var an=D("#disable-referencing-services").addClass("ajax-loading");var ao=r(aj,ab,false,ak);ao.done(function(){an.removeClass("ajax-loading").addClass("ajax-complete");var ap=D("#disable-controller-service").addClass("ajax-loading");e(aj,ab,false,ak).done(function(){al.resolve();ap.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){al.reject();ap.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){al.reject();an.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){al.reject();ag.removeClass("ajax-loading").addClass("ajax-error")})}).always(function(){if(ab.permissions.canRead===true){h(aj,af)}ah();if(ac===true&&D("#nf-ok-dialog").not(":visible")){j.showOkDialog({headerText:"Controller Service",dialogContent:"The request to disable has been canceled. Parts of this request may have already completed. Please verify the state of this service and all referencing components."})}})};var B=function(aa){if(aa.permissions.canRead===false||(aa.permissions.canWrite===false&&aa.operatePermissions.canWrite===false)){return true}var ac=false;var ab=aa.component.referencingComponents;D.each(ab,function(ad,ae){if(B(ae)){ac=true;return false}});return ac};var i=function(aj){var aa=D("#enable-controller-service-dialog");var ad=false;var ai=D("#enable-controller-service-id").text();var ab=aj.data("gridInstance");var ae=ab.getData();var ac=ae.getItemById(ai);var af=ac.component;var al=D("#enable-controller-service-scope").combo("getSelectedOption").value;if(al===N.serviceOnly){D("#enable-controller-service-progress li.referencing-component").hide()}aa.modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ad=true;aa.modal("setButtonModel",[]);D("#enable-controller-service-dialog div.controller-service-canceling").show()}}}]);D("#enable-controller-service-scope-container").hide();D("#enable-controller-service-progress-container").show();var ak=function(){return ad===false};var ah=function(){D("#enable-controller-service-dialog div.controller-service-canceling").hide();aa.modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:R}}])};if(al===N.serviceAndReferencingComponents&&B(ac)){ah();j.showOkDialog({headerText:"Controller Service",dialogContent:ac.permissions.canRead===false?"Unable to enable due to a lack of read permission to see referencing components.":"Unable to enable due to unauthorized referencing components."});return}D("#enable-progress-label").text("Steps to enable "+S.getComponentName(ac));var ag=D("#enable-controller-service").addClass("ajax-loading");D.Deferred(function(am){var an=e(aj,ac,true,ak);if(al===N.serviceAndReferencingComponents){an.done(function(){ag.removeClass("ajax-loading").addClass("ajax-complete");var ao=D("#enable-referencing-services").addClass("ajax-loading");var ap=r(aj,ac,true,ak);ap.done(function(){ao.removeClass("ajax-loading").addClass("ajax-complete");var aq=D("#enable-referencing-schedulable").addClass("ajax-loading");F(aj,ac,true,ak).done(function(){am.resolve();aq.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){am.reject();aq.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){am.reject();ao.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){am.reject();ag.removeClass("ajax-loading").addClass("ajax-error")})}else{an.done(function(){am.resolve();ag.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){am.reject();ag.removeClass("ajax-loading").addClass("ajax-error")})}}).always(function(){if(ac.permissions.canRead===true){h(aj,af)}ah();if(ad===true&&D("#nf-ok-dialog").not(":visible")){j.showOkDialog({headerText:"Controller Service",dialogContent:"The request to enable has been canceled. Parts of this request may have already completed. Please verify the state of this service and all referencing components."})}})};var K=function(ab){var aa=D("#controller-service-configuration").data("controllerServiceDetails");return D.ajax({type:"GET",url:aa.uri+"/descriptors",data:{propertyName:ab},dataType:"json"}).fail(d.handleAjaxError)};var Q=function(aa){return D.Deferred(function(ab){D("#controller-service-properties").propertytable("saveRow");if(H()){j.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){ab.resolve()},yesHandler:function(){var ac=D("#controller-service-configuration").data("controllerServiceDetails");y(aa,ac).done(function(){ab.resolve()}).fail(function(){ab.reject()})}})}else{ab.resolve()}}).promise()};var y=function(ac,aa){var ad=n();if(b(ad)){ad.revision=g.getRevision(aa);var ab=[];D.each(p(aa.component),function(af,ah){var ae=!S.isUndefined(ad.component.properties)&&!S.isUndefined(ad.component.properties[ah.name]);var ag=S.isDefinedAndNotNull(aa.component.properties[ah.name]);if(ae&&ag){ab.push(aa.component.properties[ah.name])}});return D.ajax({type:"PUT",data:JSON.stringify(ad),url:aa.uri,dataType:"json",contentType:"application/json"}).done(function(ae){P(ac,ae);D.each(ab,function(af,ag){Y(ac,ag)})}).fail(x)}else{return D.Deferred(function(ae){ae.reject()}).promise()}};var p=function(ab){var aa=[];D.each(ab.descriptors,function(ac,ad){if(S.isDefinedAndNotNull(ad.identifiesControllerService)){aa.push(ad)}});return aa};var v=function(ab){var aa=[];D.each(p(ab),function(ac,ad){var ae=ab.properties[ad.name];if(S.isDefinedAndNotNull(ae)&&D.trim(ae).length>0){aa.push(ae)}});return aa};var W;var T={init:function(ab,aa){O=ab;E=aa;D("#controller-service-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"controller-service-standard-settings-tab-content"},{name:"Properties",tabContentId:"controller-service-properties-tab-content"},{name:"Comments",tabContentId:"controller-service-comments-tab-content"}],select:function(){c.removeAllPropertyDetailDialogs();if(D(this).text()==="Properties"){D("#controller-service-properties").propertytable("resetTableSize")}D("#controller-service-properties").propertytable("saveRow");var ac=D("#controller-service-referencing-components");V(ac)}});D("#controller-service-configuration").modal({headerText:"Configure Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var ac=D("#controller-service-referencing-components");S.cleanUpTooltips(ac,"div.referencing-component-state");S.cleanUpTooltips(ac,"div.referencing-component-bulletins");ac.css("border-width","0").empty();D("#controller-service-properties").propertytable("cancelEdit");D("#controller-service-properties").propertytable("clear");S.clearField("read-only-controller-service-comments");D("#controller-service-compatible-apis").empty();D("#controller-service-configuration").removeData("controllerServiceDetails")},open:function(){S.toggleScrollable(D("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});D("#disable-controller-service-dialog").modal({headerText:"Disable Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var ad=D(this);D("#disable-controller-service-scope-container").show();D("#disable-controller-service-progress-container").hide();D("#disable-controller-service-id").text("");D("#disable-controller-service-name").text("");D("#disable-controller-service-bulletins").removeClass("has-bulletins").removeData("bulletins").hide();S.cleanUpTooltips(D("#disable-controller-service-service-container"),"#disable-controller-service-bulletins");D("div.disable-referencing-components").removeClass("ajax-loading ajax-complete ajax-error");var ac=D("#disable-controller-service-referencing-components");S.cleanUpTooltips(ac,"div.referencing-component-state");S.cleanUpTooltips(ac,"div.referencing-component-bulletins");ac.css("border-width","0").empty()}}});D("#enable-controller-service-scope").combo({options:[{text:"Service only",value:N.serviceOnly,description:"Enable only this controller service"},{text:"Service and referencing components",value:N.serviceAndReferencingComponents,description:"Enable this controller service and enable/start all referencing components"}]});D("#enable-controller-service-dialog").modal({headerText:"Enable Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var ad=D(this);D("#enable-controller-service-scope-container").show();D("#enable-controller-service-progress-container").hide();D("#enable-controller-service-progress li.referencing-component").show();D("#enable-controller-service-id").text("");D("#enable-controller-service-name").text("");D("#enable-controller-service-bulletins").removeClass("has-bulletins").removeData("bulletins").hide();S.cleanUpTooltips(D("#enable-controller-service-service-container"),"#enable-controller-service-bulletins");D("div.enable-referencing-components").removeClass("ajax-loading ajax-complete ajax-error");var ac=D("#enable-controller-service-referencing-components");S.cleanUpTooltips(ac,"div.referencing-component-state");S.cleanUpTooltips(ac,"div.referencing-component-bulletins");ac.css("border-width","0").empty()}}})},showConfiguration:function(ad,ab){if(S.isUndefined(W)){W=ad}var ac=D("#controller-service-configuration");ac.find(".dialog-header .dialog-header-text").text("Configure Controller Service");if(ac.data("mode")!==N.edit||W!==ad){D("#controller-service-configuration .controller-service-read-only").hide();D("#controller-service-configuration .controller-service-editable").show();D("#controller-service-properties").propertytable("destroy").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-controller-service-property-container",descriptorDeferred:K,controllerServiceCreatedDeferred:function(ag){var af;var ah=ag.component;if(S.isDefinedAndNotNull(ah.parentGroupId)){af=N.urls.api+"/flow/process-groups/"+encodeURIComponent(ah.parentGroupId)+"/controller-services"}else{af=N.urls.api+"/flow/controller/controller-services"}return O.loadControllerServices(af,ad)},goToServiceDeferred:function(){return Q(ad)}});ac.data("mode",N.edit)}W=ad;var ae=D.ajax({type:"GET",url:ab.uri,dataType:"json"});var aa=D.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(ab.id),dataType:"json"});D.when(ae,aa).done(function(ak,aj){ab=ak[0];var ag=ab.component;var al=aj[0].componentHistory;ac.data("controllerServiceDetails",ab);S.populateField("controller-service-id",ag.id);S.populateField("controller-service-type",S.formatType(ag));S.populateField("controller-service-bundle",S.formatBundle(ag.bundle));D("#controller-service-name").val(ag.name);D("#controller-service-comments").val(ag.comments);if(!S.isEmpty(ag.controllerServiceApis)){var af=S.getFormattedServiceApis(ag.controllerServiceApis);var ai=S.formatUnorderedList(af);D("#controller-service-compatible-apis").append(ai)}else{D("#controller-service-compatible-apis").append('<span class="unset">None</span>')}var ah=D("#controller-service-referencing-components");M(ad,ah,ab);var am=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){D("#controller-service-properties").propertytable("saveRow");y(ad,ab).done(function(an){f(ad,an.component);ac.modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ac.modal("hide")}}}];if(S.isDefinedAndNotNull(ag.customUiUrl)&&ag.customUiUrl!==""){am.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var an=function(){ac.modal("hide");D("#shell-close-button").click();A.showCustomUi(ab,ag.customUiUrl,true).done(function(){h(ad,ag);I.showSettings()})};D("#controller-service-properties").propertytable("saveRow");if(H()){j.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:an,yesHandler:function(){y(ad,ab).done(function(){an()})}})}else{an()}}}})}ac.modal("setButtonModel",am);D("#controller-service-properties").propertytable("setGroupId",ag.parentGroupId).propertytable("loadProperties",ag.properties,ag.descriptors,al.propertyHistory);ac.modal("show");V(ah);D("#controller-service-properties").propertytable("resetTableSize")}).fail(d.handleAjaxError)},showDetails:function(ad,ab){var ac=D("#controller-service-configuration");ac.find(".dialog-header .dialog-header-text").text("Controller Service Details");if(ac.data("mode")!==N.readOnly){D("#controller-service-configuration .controller-service-read-only").show();D("#controller-service-configuration .controller-service-editable").hide();D("#controller-service-properties").propertytable("destroy").propertytable({supportsGoTo:true,readOnly:true});ac.data("mode",N.readOnly)}var ae=D.ajax({type:"GET",url:ab.uri,dataType:"json"});var aa=D.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(ab.id),dataType:"json"});D.when(ae,aa).done(function(ak,aj){ab=ak[0];var ag=ab.component;var al=aj[0].componentHistory;ac.data("controllerServiceDetails",ab);S.populateField("controller-service-id",ag.id);S.populateField("controller-service-type",S.formatType(ag));S.populateField("controller-service-bundle",S.formatBundle(ag.bundle));S.populateField("read-only-controller-service-name",ag.name);S.populateField("read-only-controller-service-comments",ag.comments);if(!S.isEmpty(ag.controllerServiceApis)){var af=S.getFormattedServiceApis(ag.controllerServiceApis);var ai=S.formatUnorderedList(af);D("#controller-service-compatible-apis").append(ai)}else{D("#controller-service-compatible-apis").append('<span class="unset">None</span>')}var ah=D("#controller-service-referencing-components");M(ad,ah,ab);var am=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){ac.modal("hide")}}}];if(S.isDefinedAndNotNull(A)&&S.isDefinedAndNotNull(ag.customUiUrl)&&ag.customUiUrl!==""){am.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ac.modal("hide");D("#shell-close-button").click();A.showCustomUi(ab,ag.customUiUrl,false).done(function(){I.showSettings()})}}})}ac.modal("setButtonModel",am);D("#controller-service-properties").propertytable("loadProperties",ag.properties,ag.descriptors,al.propertyHistory);ac.modal("show");V(ah);D("#controller-service-properties").propertytable("resetTableSize")})},enable:function(ab,aa){C(ab,aa)},disable:function(ab,aa){z(ab,aa)},reloadReferencedServices:function(ab,aa){D.each(v(aa),function(ac,ad){Y(ab,ad)})},promptToDeleteController:function(ab,aa){j.showYesNoDialog({headerText:"Delete Controller Service",dialogContent:"Delete controller service '"+S.escapeHtml(aa.component.name)+"'?",yesHandler:function(){T.remove(ab,aa)}})},remove:function(ac,aa){var ab=g.getRevision(aa);D.ajax({type:"DELETE",url:aa.uri+"?"+D.param({version:ab.version,clientId:ab.clientId,disconnectedNodeAcknowledged:t.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(ad){var ae=ac.data("gridInstance");var af=ae.getData();af.deleteItem(aa.id);if(aa.permissions.canRead){f(ac,aa.component)}}).fail(d.handleAjaxError)}};return T}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","Slick","nf.Client","nf.Shell","nf.ProcessGroupConfiguration","nf.CanvasUtils","nf.ErrorHandler","nf.FilteredDialogCommon","nf.Dialog","nf.Storage","nf.Common","nf.ControllerService","nf.ProcessGroup","nf.PolicyManagement","nf.ComponentState","nf.ComponentVersion","nf.ng.Bridge"],function(g,r,o,t,q,l,n,i,f,m,h,k,d,j,p,c,e,s){return(nf.ControllerServices=b(g,r,o,t,q,l,n,i,f,m,h,k,d,j,p,c,e,s))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ControllerServices=b(require("jquery"),require("d3"),require("Slick"),require("nf.Client"),require("nf.Shell"),require("nf.ProcessGroupConfiguration"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.Dialog"),require("nf.Storage"),require("nf.Common"),require("nf.ControllerService"),require("nf.ProcessGroup"),require("nf.PolicyManagement"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.ng.Bridge")))}else{nf.ControllerServices=b(a.$,a.d3,a.Slick,a.nf.Client,a.nf.Shell,a.nf.ProcessGroupConfiguration,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.Dialog,a.nf.Storage,a.nf.Common,a.nf.ControllerService,a.nf.ProcessGroup,a.nf.PolicyManagement,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.ng.Bridge)}}}(this,function(x,H,a,f,F,A,K,b,J,i,p,G,I,u,s,c,q,m){var h=null;var j=false;var B={urls:{api:"../nifi-api",controllerServiceTypes:"../nifi-api/flow/controller-service-types"}};var w={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var k=function(N){return N.restricted===false||G.canAccessComponentRestrictions(N.explicitRestrictions)};var e=function(){return x("#controller-service-type-filter").val()};var y=function(){var N=x("#controller-service-types-table").data("gridInstance");if(G.isDefinedAndNotNull(N)){var O=N.getData();O.setFilterArgs({searchString:e()});O.refresh();x("#new-controller-service-dialog").modal("refreshButtons");if(O.getLength()>0){J.choseFirstRow(N);N.scrollRowToTop(0)}}};var z=function(){x("#controller-service-type-description").attr("title","").text("");x("#controller-service-type-name").attr("title","").text("");x("#controller-service-type-bundle").attr("title","").text("");x("#selected-controller-service-name").text("");x("#selected-controller-service-type").text("").removeData("bundle");x("#controller-service-description-container").hide()};var t=function(){z();var N=x("#controller-service-types-table").data("gridInstance");N.resetActiveCell()};var E=function(V,Q){var T=M(V,Q);var P=true;if(T){var U=x("#controller-service-tag-cloud").tagcloud("getSelectedTags");var S=U.length>0;if(S){P=n(U,V.tags)}}var R=true;if(T&&P){var N=x("#controller-service-bundle-group-combo").combo("getSelectedOption");if(G.isDefinedAndNotNull(N)&&N.value!==""){R=(V.bundle.group===N.value)}}var O=T&&P&&R;if(O===false&&x("#selected-controller-service-type").text()===V.type){t()}return O};var M=function(P,O){if(O.searchString===""){return true}try{var S=new RegExp(O.searchString,"i")}catch(R){return false}var Q=P.label.search(S)>=0;var N=P.tags.search(S)>=0;return Q||N};var n=function(P,N){var O=[];x.each(P,function(S,T){O.push(T)});var Q=N.toLowerCase();var R=true;x.each(O,function(S,T){if(Q.indexOf(T)===-1){R=false;return false}});return R};var D=function(N,Q){var P=x("#selected-controller-service-type").text();var O=x("#selected-controller-service-type").data("bundle");if(P===""){i.showOkDialog({headerText:"Controller Service",dialogContent:"The type of controller service to create must be selected."})}else{o(N,Q,P,O)}};var o=function(O,R,Q,S){var N={revision:f.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:p.isDisconnectionAcknowledged(),component:{type:Q,bundle:S}};var P=x.ajax({type:"POST",url:O,data:JSON.stringify(N),dataType:"json",contentType:"application/json"}).done(function(T){var U=R.data("gridInstance");var W=U.getData();W.addItem(x.extend({type:"ControllerService",bulletins:[]},T));W.reSort();U.invalidate();var V=W.getRowById(T.id);J.choseRow(U,V);U.scrollRowIntoView(V)}).fail(b.handleAjaxError);x("#new-controller-service-dialog").modal("hide");return P};var l=function(){var P=[{id:"type",name:"Type",field:"label",formatter:G.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:G.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:G.genericValueFormatter}];var O=new a.Data.DataView({inlineFilters:false});O.setItems([]);O.setFilterArgs({searchString:e()});O.setFilter(E);G.sortType({columnId:"type",sortAsc:true},O);var N=new a.Grid("#controller-service-types-table",O,P,w);N.setSelectionModel(new a.RowSelectionModel());N.registerPlugin(new a.AutoTooltips());N.setSortColumn("type",true);N.onSort.subscribe(function(S,R){G.sortType({columnId:R.sortCol.field,sortAsc:R.sortAsc},O)});N.onSelectedRowsChanged.subscribe(function(W,T){if(x.isArray(T.rows)&&T.rows.length===1){var R=T.rows[0];var V=N.getDataItem(R);if(G.isDefinedAndNotNull(V)){x("#controller-service-description-container").show();if(G.isBlank(V.description)){x("#controller-service-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{x("#controller-service-type-description").width(x("#controller-service-description-container").innerWidth()-1).html(V.description).ellipsis()}var S=G.formatBundle(V.bundle);var U=G.formatType(V);x("#controller-service-type-name").text(U).attr("title",U);x("#controller-service-type-bundle").text(S).attr("title",S);x("#selected-controller-service-name").text(V.label);x("#selected-controller-service-type").text(V.type).data("bundle",V.bundle);x("#new-controller-service-dialog").modal("refreshButtons")}}});N.onViewportChanged.subscribe(function(S,R){G.cleanUpTooltips(x("#controller-service-types-table"),"div.view-usage-restriction");G.cleanUpTooltips(x("#controller-service-types-table"),"div.controller-service-apis")});O.onRowCountChanged.subscribe(function(S,R){N.updateRowCount();N.render();x("#displayed-controller-service-types").text(R.current)});O.onRowsChanged.subscribe(function(S,R){N.invalidateRows(R.rows);N.render()});O.syncGridSelection(N,true);x("#controller-service-types-table").data("gridInstance",N).on("mouseenter","div.slick-cell",function(Y){var Z=x(this).find("div.view-usage-restriction");if(Z.length&&!Z.data("qtip")){var V=x(this).find("span.row-id").text();var aa=O.getItemById(V);if(aa.restricted===true){var X=x("<div></div>");if(G.isBlank(aa.usageRestriction)){X.append(x('<p style="margin-bottom: 3px;"></p>').text("Requires the following permissions:"))}else{X.append(x('<p style="margin-bottom: 3px;"></p>').text(aa.usageRestriction+" Requires the following permissions:"))}var T=[];if(G.isDefinedAndNotNull(aa.explicitRestrictions)){x.each(aa.explicitRestrictions,function(ab,ad){var ac=ad.requiredPermission;T.push("'"+ac.label+"' - "+G.escapeHtml(ad.explanation))})}else{T.push("Access to restricted components regardless of restrictions.")}X.append(G.formatUnorderedList(T));Z.qtip(x.extend({},G.config.tooltipConfig,{content:X,position:{container:x("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}var R=x(this).find("div.controller-service-apis");if(R.length&&!R.data("qtip")){var V=x(this).find("span.row-id").text();var aa=O.getItemById(V);if(!G.isEmpty(aa.controllerServiceApis)){var U=G.getFormattedServiceApis(aa.controllerServiceApis);var S=G.formatUnorderedList(U);var W=x('<div style="padding: 4px;"><p>Supports Controller Services</p><br/></div>').append(S);R.qtip(x.extend({},G.config.tooltipConfig,{content:W,position:{container:x("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});var Q=G.getPolicyTypeListing("restricted-components");x.ajax({type:"GET",url:B.urls.controllerServiceTypes,dataType:"json"}).done(function(S){var X=0;var U=[];var R=H.set();var W=H.map();var V=H.map();O.beginUpdate();x.each(S.controllerServiceTypes,function(Y,Z){if(Z.restricted===true){if(G.isDefinedAndNotNull(Z.explicitRestrictions)){x.each(Z.explicitRestrictions,function(aa,ac){var ab=ac.requiredPermission;if(!V.has(ab.id)){V.set(ab.id,ab.label)}if(!W.has(ab.id)){W.set(ab.id,[])}W.get(ab.id).push({type:G.formatType(Z),bundle:G.formatBundle(Z.bundle),explanation:ac.explanation})})}else{if(!V.has(Q.value)){V.set(Q.value,Q.text)}if(!W.has(Q.value)){W.set(Q.value,[])}W.get(Q.value).push({type:G.formatType(Z),bundle:G.formatBundle(Z.bundle),explanation:Z.usageRestriction})}}R.add(Z.bundle.group);O.addItem({id:X++,label:G.substringAfterLast(Z.type,"."),type:Z.type,bundle:Z.bundle,controllerServiceApis:Z.controllerServiceApis,description:G.escapeHtml(Z.description),restricted:Z.restricted,usageRestriction:G.escapeHtml(Z.usageRestriction),explicitRestrictions:Z.explicitRestrictions,tags:Z.tags.join(", ")});x.each(Z.tags,function(ab,aa){U.push(aa.toLowerCase())})});O.endUpdate();O.reSort();N.invalidate();K.addComponentRestrictions(W,V);x("#total-controller-service-types, #displayed-controller-service-types").text(S.controllerServiceTypes.length);x("#controller-service-tag-cloud").tagcloud({tags:U,select:y,remove:y});var T=[{text:"all groups",value:""}];R.each(function(Y){T.push({text:Y,value:Y})});x("#controller-service-bundle-group-combo").combo({options:T,select:y})}).fail(b.handleAjaxError);x("#new-controller-service-dialog").modal({headerText:"Add Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){z();x("#controller-service-type-filter").val("");x("#controller-service-tag-cloud").tagcloud("clearSelectedTags");x("#controller-service-bundle-group-combo").combo("setSelectedOption",{value:""});y();var R=x("#controller-service-types-table").data("gridInstance");R.setSelectedRows([]);R.resetActiveCell()},resize:function(){x("#controller-service-type-description").width(x("#controller-service-description-container").innerWidth()-1).text(x("#controller-service-type-description").attr("title")).ellipsis()}}})};var r=function(R,O,Q,P,N){if(!N.permissions.canRead){return'<span class="blank">'+G.escapeHtml(N.id)+"</span>"}return G.escapeHtml(N.component.name)};var g=function(V,U,S,P,O){if(G.isDefinedAndNotNull(O.parentGroupId)){var T=K.getSelection();if(T.empty()===false){var R=T.datum();if(R.id===O.parentGroupId){if(R.permissions.canRead){return G.escapeHtml(R.component.name)}else{return G.escapeHtml(R.id)}}}var N=m.injector.get("breadcrumbsCtrl").getBreadcrumbs();var Q=O.parentGroupId;x.each(N,function(W,X){if(X.id===O.parentGroupId){Q=X.label;return false}});return G.escapeHtml(Q)}else{return"Controller"}};var v=function(N){var O=function(P){var S=K.getSelection();if(S.empty()===false){var R=S.datum();if(R.id===P){return R.permissions.canWrite}}var Q=m.injector.get("breadcrumbsCtrl").getBreadcrumbs();var T=false;x.each(Q,function(U,V){if(V.id===P){T=V.permissions.canWrite;return false}});return T};if(G.isDefinedAndNotNull(N.parentGroupId)){return O(N.parentGroupId)}else{return G.canModifyController()}};var L=function(N,P){var O=function(X,W){if(X.permissions.canRead&&W.permissions.canRead){if(N.columnId==="moreDetails"){var T=0;if(!G.isEmpty(X.bulletins)){T=X.bulletins.length}var Q=0;if(!G.isEmpty(W.bulletins)){Q=W.bulletins.length}return T-Q}else{if(N.columnId==="type"){var U=G.isDefinedAndNotNull(X.component[N.columnId])?G.substringAfterLast(X.component[N.columnId],"."):"";var S=G.isDefinedAndNotNull(W.component[N.columnId])?G.substringAfterLast(W.component[N.columnId],"."):"";return U===S?0:U>S?1:-1}else{if(N.columnId==="state"){var V;if(X.status.validationStatus==="VALIDATING"){V="Validating"}else{if(X.status.validationStatus==="INVALID"){V="Invalid"}else{V=G.isDefinedAndNotNull(X.component[N.columnId])?X.component[N.columnId]:""}}var Z;if(W.status.validationStatus==="VALIDATING"){Z="Validating"}else{if(W.status.validationStatus==="INVALID"){Z="Invalid"}else{Z=G.isDefinedAndNotNull(W.component[N.columnId])?W.component[N.columnId]:""}}return V===Z?0:V>Z?1:-1}else{var R=G.isDefinedAndNotNull(X.component[N.columnId])?X.component[N.columnId]:"";var Y=G.isDefinedAndNotNull(W.component[N.columnId])?W.component[N.columnId]:"";return R===Y?0:R>Y?1:-1}}}}else{if(!X.permissions.canRead&&!W.permissions.canRead){return 0}if(X.permissions.canRead){return 1}else{return -1}}};P.sort(O,N.sortAsc)};var C=function(T,N){var S=function(ac,W,ab,Y,V){if(!V.permissions.canRead){return""}var X='<div title="Usage" class="pointer controller-service-usage fa fa-book"></div>';var Z=!G.isEmpty(V.component.validationErrors);var aa=!G.isEmpty(V.bulletins);if(Z){X+='<div class="pointer has-errors fa fa-warning"></div>'}if(aa){X+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(Z||aa){X+='<span class="hidden row-id">'+G.escapeHtml(V.id)+"</span>"}return X};var O=function(ac,W,ab,X,V){var aa="",Y="";if(V.status.validationStatus==="VALIDATING"){aa="validating fa fa-spin fa-circle-notch";Y="Validating"}else{if(V.status.validationStatus==="INVALID"){aa="invalid fa fa-warning";Y="Invalid"}else{if(V.status.runStatus==="DISABLED"){aa='disabled icon icon-enable-false"';Y="Disabled"}else{if(V.status.runStatus==="DISABLING"){aa='disabled icon icon-enable-false"';Y="Disabling"}else{if(V.status.runStatus==="ENABLED"){aa="enabled fa fa-flash";Y="Enabled"}else{if(V.status.runStatus==="ENABLING"){aa="enabled fa fa-flash";Y="Enabling"}}}}}}var Z='<div layout="row"><div class="'+aa+'"></div>';return Z+'<div class="status-text">'+Y+"</div></div>"};var R=function(af,ac,Z,Y,V){var ad="";var X=V.permissions.canRead;var W=V.permissions.canWrite;var ab=W||(V.operatePermissions&&V.operatePermissions.canWrite);var ae=false;if(G.isDefinedAndNotNull(V.parentGroupId)){if(V.parentGroupId===x("#process-group-id").text()){ae=true}}else{ae=true}if(ae===true){var aa=V.status.runStatus==="DISABLED";if(X){if(W&&aa){ad+='<div class="pointer edit-controller-service fa fa-gear" title="Configure"></div>'}else{ad+='<div class="pointer view-controller-service fa fa-gear" title="View Configuration"></div>'}}if(ab){if(V.status.runStatus==="ENABLED"||V.status.runStatus==="ENABLING"){ad+='<div class="pointer disable-controller-service icon icon-enable-false" title="Disable"></div>'}else{if(aa&&V.status.validationStatus==="VALID"){ad+='<div class="pointer enable-controller-service fa fa-flash" title="Enable"></div>'}}}if(aa&&X&&W&&V.component.multipleVersionsAvailable===true){ad+='<div title="Change Version" class="pointer change-version-controller-service fa fa-exchange"></div>'}if(aa&&X&&W&&v(V)){ad+='<div class="pointer delete-controller-service fa fa-trash" title="Remove"></div>'}if(X&&W&&V.component.persistsState===true){ad+='<div title="View State" class="pointer view-state-controller-service fa fa-tasks"></div>'}}else{ad+='<div class="pointer go-to-controller-service fa fa-long-arrow-right" title="Go To"></div>'}if(K.isManagedAuthorizer()&&G.canAccessTenants()){ad+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key"></div>'}return ad};var Q=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:S,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",formatter:r,sortable:true,resizable:true},{id:"type",name:"Type",formatter:G.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:G.instanceBundleFormatter,sortable:true,resizable:true},{id:"state",name:"State",formatter:O,sortable:true,resizeable:true},{id:"parentGroupId",name:"Scope",formatter:g,sortable:true,resizeable:true}];Q.push({id:"actions",name:"&nbsp;",resizable:false,formatter:R,sortable:false,width:90,maxWidth:90});var U=new a.Data.DataView({inlineFilters:false});U.setItems([]);L({columnId:"name",sortAsc:true},U);var P=new a.Grid(T,U,Q,w);P.setSelectionModel(new a.RowSelectionModel());P.registerPlugin(new a.AutoTooltips());P.setSortColumn("name",true);P.onSort.subscribe(function(W,V){L({columnId:V.sortCol.id,sortAsc:V.sortAsc},U)});P.onClick.subscribe(function(Y,W){var X=x(Y.target);var V=U.getItem(W.row);if(P.getColumns()[W.cell].id==="actions"){if(X.hasClass("edit-controller-service")){I.showConfiguration(T,V)}else{if(X.hasClass("view-controller-service")){I.showDetails(T,V)}else{if(X.hasClass("enable-controller-service")){I.enable(T,V)}else{if(X.hasClass("disable-controller-service")){I.disable(T,V)}else{if(X.hasClass("delete-controller-service")){I.promptToDeleteController(T,V)}else{if(X.hasClass("view-state-controller-service")){c.showState(V,V.state==="DISABLED")}else{if(X.hasClass("change-version-controller-service")){q.promptForVersionChange(V)}else{if(X.hasClass("edit-access-policies")){s.showControllerServicePolicy(V);x("#shell-close-button").click()}else{if(X.hasClass("go-to-controller-service")){u.enterGroup(V.parentGroupId);x.Deferred(function(Z){if(x("#process-group-configuration").is(":visible")){A.loadConfiguration(V.parentGroupId).done(function(){Z.resolve()})}else{A.showConfiguration(V.parentGroupId).done(function(){Z.resolve()})}}).done(function(){A.selectControllerService(V.id)})}}}}}}}}}}else{if(P.getColumns()[W.cell].id==="moreDetails"){if(X.hasClass("controller-service-usage")){x("#shell-close-button").click();F.showPage("../nifi-docs/documentation?"+x.param({select:V.component.type,group:V.component.bundle.group,artifact:V.component.bundle.artifact,version:V.component.bundle.version})).done(function(){if(G.isDefinedAndNotNull(V.parentGroupId)){var Z;var aa=u.get(V.parentGroupId);if(G.isDefinedAndNotNull(aa)){Z=aa.id}else{Z=K.getGroupId()}A.showConfiguration(Z)}else{N()}})}}}});U.onRowCountChanged.subscribe(function(W,V){P.updateRowCount();P.render()});U.onRowsChanged.subscribe(function(W,V){P.invalidateRows(V.rows);P.render()});U.syncGridSelection(P,true);T.data("gridInstance",P).on("mouseenter","div.slick-cell",function(ac){var Z=x(this).find("div.has-errors");if(Z.length&&!Z.data("qtip")){var ab=x(this).find("span.row-id").text();var V=U.getItemById(ab);var Y=G.formatUnorderedList(V.component.validationErrors);if(G.isDefinedAndNotNull(Y)){Z.qtip(x.extend({},G.config.tooltipConfig,{content:Y,position:{target:"mouse",viewport:x("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var X=x(this).find("div.has-bulletins");if(X.length&&!X.data("qtip")){var W=x(this).find("span.row-id").text();var V=U.getItemById(W);var aa=G.getFormattedBulletins(V.bulletins);var Y=G.formatUnorderedList(aa);if(G.isDefinedAndNotNull(Y)){X.qtip(x.extend({},G.config.tooltipConfig,{content:Y,position:{target:"mouse",viewport:x("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var d=function(N,O){return x.ajax({type:"GET",url:N,dataType:"json"}).done(function(P){var Q=[];x.each(P.controllerServices,function(U,T){Q.push(x.extend({type:"ControllerService",bulletins:[]},T))});G.cleanUpTooltips(O,"div.has-errors");G.cleanUpTooltips(O,"div.has-bulletins");var R=O.data("gridInstance");var S=R.getData();S.setItems(Q);S.reSort();R.invalidate();R.render()})};return{init:function(O,N){if(!j){l();j=true}C(O,N)},promptNewControllerService:function(O,R){var P=x("#controller-service-types-table").data("gridInstance");var N=P.getData();var Q=[x.ui.keyCode.UP,x.ui.keyCode.PAGE_UP,x.ui.keyCode.DOWN,x.ui.keyCode.PAGE_DOWN];x("#controller-service-type-filter").off("keyup").on("keyup",function(V){var U=V.keyCode?V.keyCode:V.which;if(x.inArray(U,Q)!==-1){return}if(U===x.ui.keyCode.ENTER){var S=P.getSelectedRows();if(S.length>0){var T=P.getDataItem(S[0]);if(k(T)){D(O,R)}}}else{y()}});J.addKeydownListener("#controller-service-type-filter",P,N);x("#new-controller-service-dialog").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var S=P.getSelectedRows();if(S.length>0){var T=P.getDataItem(S[0]);return k(T)===false}else{return N.getLength()===0}},handler:{click:function(){D(O,R)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){x(this).modal("hide")}}}]).modal("show");if(h!==null){P.onDblClick.unsubscribe(h)}h=function(U,S){var T=P.getDataItem(S.row);if(k(T)){o(O,R,T.type,T.bundle)}};P.onDblClick.subscribe(h);P.resizeCanvas();if(N.getLength()>0){J.choseFirstRow(P)}x("#controller-service-type-filter").focus()},resetTableSize:function(O){var N=O.data("gridInstance");if(G.isDefinedAndNotNull(N)){N.resizeCanvas()}},loadControllerServices:function(N,O){return d(N,O)},setBulletins:function(R,O){var Q=R.data("gridInstance");var S=Q.getData();S.beginUpdate();if(!G.isEmpty(O)){var P=H.nest().key(function(T){return T.sourceId}).map(O,H.map);P.each(function(T,V){var U=S.getItemById(V);if(G.isDefinedAndNotNull(U)){S.updateItem(V,x.extend(U,{bulletins:T}))}})}else{var N=S.getItems();x.each(N,function(U,T){S.updateItem(T.id,x.extend(T,{bulletins:[]}))})}S.endUpdate()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.ControllerService","nf.ControllerServices","nf.UniversalCapture","nf.CustomUi"],function(f,j,d,e,g,l,k,c,h,i){return(nf.ReportingTask=b(f,j,d,e,g,l,k,c,h,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ReportingTask=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ControllerService"),require("nf.ControllerServices"),require("nf.UniversalCapture"),require("nf.CustomUi")))}else{nf.ReportingTask=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ControllerService,a.nf.ControllerServices,a.nf.UniversalCapture,a.nf.CustomUi)}}}(this,function(f,h,j,m,g,w,a,c,p,d){var t;var u={edit:"edit",readOnly:"read-only",urls:{api:"../nifi-api"}};var i=u.urls.api+"/flow/controller/controller-services";var b=function(){return f("#controller-services-table")};var o=function(B,y,z){if(B.status===400){var C=B.responseText.split("\n");var A;if(C.length===1){A=f("<span></span>").text(C[0])}else{A=j.formatUnorderedList(C)}m.showOkDialog({dialogContent:A,headerText:"Reporting Task"})}else{h.handleAjaxError(B,y,z)}};var x=function(){var z=f("#reporting-task-configuration").data("reportingTaskDetails");if(f("#reporting-task-name").val()!==z.component.name){return true}if(f("#reporting-task-comments").val()!==z.component.comments){return true}if(f("#reporting-task-enabled").hasClass("checkbox-checked")&&z.component.state==="DISABLED"){return true}else{if(f("#reporting-task-enabled").hasClass("checkbox-unchecked")&&(z.component.state==="RUNNING"||z.component.state==="STOPPED")){return true}}var A=f("#reporting-task-scheduling-strategy-combo").combo("getSelectedOption").value;if(A!==(z.component.schedulingStrategy+"")){return true}var y;if(A==="CRON_DRIVEN"){y=f("#reporting-task-cron-driven-scheduling-period")}else{y=f("#reporting-task-timer-driven-scheduling-period")}if(j.isDefinedAndNotNull(y)&&y.val()!==(z.component.schedulingPeriod+"")){return true}return f("#reporting-task-properties").propertytable("isSaveRequired")};var k=function(){var z=f("#reporting-task-properties").propertytable("marshalProperties");var C=f("#reporting-task-scheduling-strategy-combo").combo("getSelectedOption").value;var y;if(C==="CRON_DRIVEN"){y=f("#reporting-task-cron-driven-scheduling-period")}else{y=f("#reporting-task-timer-driven-scheduling-period")}var B={};B.id=f("#reporting-task-id").text();B.name=f("#reporting-task-name").val();B.schedulingStrategy=C;B.schedulingPeriod=y.val();B.comments=f("#reporting-task-comments").val();if(f("#reporting-task-enabled").hasClass("checkbox-unchecked")){B.state="DISABLED"}else{if(f("#reporting-task-enabled").hasClass("checkbox-checked")){B.state="STOPPED"}}if(f.isEmptyObject(z)===false){B.properties=z}var A={};A.component=B;return A};var s=function(y){var A=[];var z=y.component;if(j.isBlank(z.schedulingPeriod)){A.push("Run schedule must be specified")}if(A.length>0){m.showOkDialog({dialogContent:j.formatUnorderedList(A),headerText:"Reporting Task"});return false}else{return true}};var r=function(z){var B=f("#reporting-tasks-table").data("gridInstance");var y=B.getData();var A=y.getItemById(z.id);y.updateItem(z.id,f.extend({type:"ReportingTask",bulletins:A.bulletins},z))};var e=function(A,z){var y={revision:w.getRevision(A),disconnectedNodeAcknowledged:g.isDisconnectionAcknowledged(),state:z===true?"RUNNING":"STOPPED"};return f.ajax({type:"PUT",url:A.uri+"/run-status",data:JSON.stringify(y),dataType:"json",contentType:"application/json"}).done(function(B){r(B);if(j.isDefinedAndNotNull(B.component)){a.reloadReferencedServices(b(),B.component)}}).fail(h.handleAjaxError)};var n=function(){return f.Deferred(function(y){f("#reporting-task-properties").propertytable("saveRow");if(x()){m.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){y.resolve()},yesHandler:function(){var z=f("#reporting-task-configuration").data("reportingTaskDetails");l(z).done(function(){y.resolve()}).fail(function(){y.reject()})}})}else{y.resolve()}}).promise()};var l=function(z){var y=k();if(s(y)){y.revision=w.getRevision(z);y.disconnectedNodeAcknowledged=g.isDisconnectionAcknowledged();return f.ajax({type:"PUT",data:JSON.stringify(y),url:z.uri,dataType:"json",contentType:"application/json"}).done(function(A){r(A)}).fail(o)}else{return f.Deferred(function(A){A.reject()}).promise()}};var q=function(y){var z=f("#reporting-task-configuration").data("reportingTaskDetails");return f.ajax({type:"GET",url:z.uri+"/descriptors",data:{propertyName:y},dataType:"json"}).fail(h.handleAjaxError)};var v={init:function(y){t=y;f("#reporting-task-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"reporting-task-standard-settings-tab-content"},{name:"Properties",tabContentId:"reporting-task-properties-tab-content"},{name:"Comments",tabContentId:"reporting-task-comments-tab-content"}],select:function(){p.removeAllPropertyDetailDialogs();if(f(this).text()==="Properties"){f("#reporting-task-properties").propertytable("resetTableSize")}f("#reporting-task-properties").propertytable("saveRow")}});f("#reporting-task-configuration").data("mode",u.edit).modal({scrollableContentStyle:"scrollable",headerText:"Configure Reporting Task",handler:{close:function(){f("#reporting-task-properties").propertytable("cancelEdit");f("#reporting-task-properties").propertytable("clear");j.clearField("read-only-reporting-task-comments");f("#reporting-task-configuration").removeData("reportingTaskDetails")},open:function(){j.toggleScrollable(f("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});f("#reporting-task-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-reporting-task-property-container",descriptorDeferred:q,controllerServiceCreatedDeferred:function(z){return c.loadControllerServices(i,f("#controller-services-table"))},goToServiceDeferred:n})},showConfiguration:function(z){var A=f("#reporting-task-configuration");if(A.data("mode")===u.readOnly){f("#reporting-task-configuration .reporting-task-read-only").hide();f("#reporting-task-configuration .reporting-task-editable").show();f("#reporting-task-properties").propertytable("destroy").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-reporting-task-property-container",descriptorDeferred:q,controllerServiceCreatedDeferred:function(C){return c.loadControllerServices(i,f("#controller-services-table"))},goToServiceDeferred:n});A.data("mode",u.edit)}var B=f.ajax({type:"GET",url:z.uri,dataType:"json"});var y=f.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(z.id),dataType:"json"});f.when(B,y).done(function(E,J){z=E[0];var K=z.component;var D=J[0].componentHistory;f("#reporting-task-configuration").data("reportingTaskDetails",z);var H="checkbox-checked";if(K.state==="DISABLED"){H="checkbox-unchecked"}j.populateField("reporting-task-id",K.id);j.populateField("reporting-task-type",j.formatType(K));j.populateField("reporting-task-bundle",j.formatBundle(K.bundle));f("#reporting-task-name").val(K.name);f("#reporting-task-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(H);f("#reporting-task-comments").val(K.comments);var F=K.defaultSchedulingPeriod;var C=f("#reporting-task-cron-driven-scheduling-period").val(F.CRON_DRIVEN);var G=f("#reporting-task-timer-driven-scheduling-period").val(F.TIMER_DRIVEN);if(K.schedulingStrategy==="CRON_DRIVEN"){C.val(K.schedulingPeriod)}else{G.val(K.schedulingPeriod)}f("#reporting-task-scheduling-strategy-combo").combo({options:[{text:"Timer driven",value:"TIMER_DRIVEN",description:"Reporting task will be scheduled to run on an interval defined by the run schedule."},{text:"CRON driven",value:"CRON_DRIVEN",description:"Reporting task will be scheduled to run on at specific times based on the specified CRON string."}],selectedOption:{value:K.schedulingStrategy},select:function(L){if(L.value==="CRON_DRIVEN"){G.hide();C.show()}else{G.show();C.hide()}}});var I=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f("#reporting-task-properties").propertytable("saveRow");l(z).done(function(L){a.reloadReferencedServices(b(),L.component);f("#reporting-task-configuration").modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#reporting-task-configuration").modal("hide")}}}];if(j.isDefinedAndNotNull(K.customUiUrl)&&K.customUiUrl!==""){I.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var L=function(){f("#reporting-task-configuration").modal("hide");f("#shell-close-button").click();d.showCustomUi(z,K.customUiUrl,true).done(function(){v.reload(z.id).done(function(M){a.reloadReferencedServices(b(),M.reportingTask)});t.showSettings()})};f("#reporting-task-properties").propertytable("saveRow");if(x()){m.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:L,yesHandler:function(){l(z).done(function(){L()})}})}else{L()}}}})}f("#reporting-task-configuration").modal("setButtonModel",I);f("#reporting-task-properties").propertytable("setGroupId",K.parentGroupId).propertytable("loadProperties",K.properties,K.descriptors,D.propertyHistory);f("#reporting-task-configuration").modal("show");f("#reporting-task-properties").propertytable("resetTableSize")}).fail(h.handleAjaxError)},showDetails:function(z){var A=f("#reporting-task-configuration");if(A.data("mode")===u.edit){f("#reporting-task-configuration .reporting-task-read-only").show();f("#reporting-task-configuration .reporting-task-editable").hide();f("#reporting-task-properties").propertytable("destroy").propertytable({supportsGoTo:true,readOnly:true});A.data("mode",u.readOnly)}var B=f.ajax({type:"GET",url:z.uri,dataType:"json"});var y=f.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(z.id),dataType:"json"});f.when(B,y).done(function(C,D){z=C[0];var H=z.component;var E=D[0].componentHistory;j.populateField("reporting-task-id",H.id);j.populateField("reporting-task-type",j.substringAfterLast(H.type,"."));j.populateField("reporting-task-bundle",j.formatBundle(H.bundle));j.populateField("read-only-reporting-task-name",H.name);j.populateField("read-only-reporting-task-comments",H.comments);var G=H.schedulingStrategy;if(G==="CRON_DRIVEN"){G="CRON driven"}else{G="Timer driven"}j.populateField("read-only-reporting-task-scheduling-strategy",G);j.populateField("read-only-reporting-task-scheduling-period",H.schedulingPeriod);var F=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){A.modal("hide")}}}];if(j.isDefinedAndNotNull(d)&&j.isDefinedAndNotNull(H.customUiUrl)&&H.customUiUrl!==""){F.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){A.modal("hide");f("#shell-close-button").click();d.showCustomUi(z,H.customUiUrl,false).done(function(){t.showSettings()})}}})}A.modal("setButtonModel",F).modal("show");f("#reporting-task-properties").propertytable("loadProperties",H.properties,H.descriptors,E.propertyHistory);A.modal("show");f("#reporting-task-properties").propertytable("resetTableSize")})},start:function(y){e(y,true)},stop:function(y){e(y,false)},reload:function(B){var A=f("#reporting-tasks-table").data("gridInstance");var y=A.getData();var z=y.getItemById(B);return f.ajax({type:"GET",url:z.uri,dataType:"json"}).done(function(C){r(C)}).fail(h.handleAjaxError)},promptToDeleteReportingTask:function(y){m.showYesNoDialog({headerText:"Delete Reporting Task",dialogContent:"Delete reporting task '"+j.escapeHtml(y.component.name)+"'?",yesHandler:function(){v.remove(y)}})},remove:function(z){var y=w.getRevision(z);f.ajax({type:"DELETE",url:z.uri+"?"+f.param({version:y.version,clientId:y.clientId,disconnectedNodeAcknowledged:g.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(B){var C=f("#reporting-tasks-table").data("gridInstance");var A=C.getData();A.deleteItem(z.id)}).fail(h.handleAjaxError)}};return v}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","d3","nf.Client","nf.Dialog","nf.Storage","nf.Common","nf.CanvasUtils","nf.ControllerServices","nf.ErrorHandler","nf.FilteredDialogCommon","nf.ReportingTask","nf.Shell","nf.ComponentState","nf.ComponentVersion","nf.PolicyManagement"],function(j,f,q,r,i,k,g,h,d,m,l,n,e,p,c,o){return(nf.Settings=b(j,f,q,r,i,k,g,h,d,m,l,n,e,p,c,o))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Settings=b(require("jquery"),require("Slick"),require("d3"),require("nf.Client"),require("nf.Dialog"),require("nf.Storage"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ControllerServices"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.ReportingTask"),require("nf.Shell"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.PolicyManagement")))}else{nf.Settings=b(a.$,a.Slick,a.d3,a.nf.Client,a.nf.Dialog,a.nf.Storage,a.nf.Common,a.nf.CanvasUtils,a.nf.ControllerServices,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.ReportingTask,a.nf.Shell,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.PolicyManagement)}}}(this,function(A,a,O,i,k,s,M,S,H,d,Q,B,K,e,t,w){var F={urls:{api:"../nifi-api",controllerConfig:"../nifi-api/controller/config",reportingTaskTypes:"../nifi-api/flow/reporting-task-types",createReportingTask:"../nifi-api/controller/reporting-tasks",reportingTasks:"../nifi-api/flow/reporting-tasks",registries:"../nifi-api/controller/registry-clients"}};var z={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var r=function(){return A("#controller-services-table")};var m=function(W){var Y=R();var X={revision:i.getRevision({revision:{version:W}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:Y};A.ajax({type:"PUT",url:F.urls.controllerConfig,data:JSON.stringify(X),dataType:"json",contentType:"application/json"}).done(function(Z){k.showOkDialog({headerText:"Settings",dialogContent:"Settings successfully applied."});A("#settings-save").off("click").on("click",function(){m(Z.revision.version)})}).fail(d.handleAjaxError)};var j=function(){};var R=function(){var W={};W.maxTimerDrivenThreadCount=A("#maximum-timer-driven-thread-count-field").val();W.maxEventDrivenThreadCount=A("#maximum-event-driven-thread-count-field").val();return W};var V=function(Y,X){if(X.searchString===""){return true}try{var ab=new RegExp(X.searchString,"i")}catch(aa){return false}var Z=Y.label.search(ab)>=0;var W=Y.tags.search(ab)>=0;return Z||W};var o=function(Y,W){var X=[];A.each(Y,function(ab,ac){X.push(ac)});var Z=W.toLowerCase();var aa=true;A.each(X,function(ab,ac){if(Z.indexOf(ac)===-1){aa=false;return false}});return aa};var n=function(W){return W.restricted===false||M.canAccessComponentRestrictions(W.explicitRestrictions)};var v=function(aa,X,Z,Y,W){if(!W.permissions.canRead){return'<span class="blank">'+M.escapeHtml(W.id)+"</span>"}return M.escapeHtml(W.component.name)};var T=function(W,Y){var X=function(ag,af){if(ag.permissions.canRead&&af.permissions.canRead){if(W.columnId==="moreDetails"){var ac=0;if(!M.isEmpty(ag.bulletins)){ac=ag.bulletins.length}var Z=0;if(!M.isEmpty(af.bulletins)){Z=af.bulletins.length}return ac-Z}else{if(W.columnId==="type"){var ad=M.isDefinedAndNotNull(ag.component[W.columnId])?M.substringAfterLast(ag.component[W.columnId],"."):"";var ab=M.isDefinedAndNotNull(af.component[W.columnId])?M.substringAfterLast(af.component[W.columnId],"."):"";return ad===ab?0:ad>ab?1:-1}else{if(W.columnId==="state"){var ae;if(ag.component.validationStatus==="VALIDATING"){ae="Validating"}else{if(ag.component.validationStatus==="INVALID"){ae="Invalid"}else{ae=M.isDefinedAndNotNull(ag.component[W.columnId])?ag.component[W.columnId]:""}}var ai;if(af.component.validationStatus==="VALIDATING"){ai="Validating"}else{if(af.component.validationStatus==="INVALID"){ai="Invalid"}else{ai=M.isDefinedAndNotNull(af.component[W.columnId])?af.component[W.columnId]:""}}return ae===ai?0:ae>ai?1:-1}else{var aa=M.isDefinedAndNotNull(ag.component[W.columnId])?ag.component[W.columnId]:"";var ah=M.isDefinedAndNotNull(af.component[W.columnId])?af.component[W.columnId]:"";return aa===ah?0:aa>ah?1:-1}}}}else{if(!ag.permissions.canRead&&!af.permissions.canRead){return 0}if(ag.permissions.canRead){return 1}else{return -1}}};Y.sort(X,W.sortAsc)};var C=function(){return A("#reporting-task-type-filter").val()};var p=function(){var X=A("#reporting-task-types-table").data("gridInstance");if(M.isDefinedAndNotNull(X)){var W=X.getData();W.setFilterArgs({searchString:C()});W.refresh();A("#new-reporting-task-dialog").modal("refreshButtons");if(W.getLength()>0){Q.choseFirstRow(X)}}};var P=function(){A("#reporting-task-type-description").attr("title","").text("");A("#reporting-task-type-name").attr("title","").text("");A("#reporting-task-type-bundle").attr("title","").text("");A("#selected-reporting-task-name").text("");A("#selected-reporting-task-type").text("").removeData("bundle");A("#reporting-task-description-container").hide()};var h=function(){P();var W=A("#reporting-task-types-table").data("gridInstance");W.resetActiveCell()};var I=function(ae,Z){var ac=V(ae,Z);var Y=true;if(ac){var ad=A("#reporting-task-tag-cloud").tagcloud("getSelectedTags");var ab=ad.length>0;if(ab){Y=o(ad,ae.tags)}}var aa=true;if(ac&&Y){var W=A("#reporting-task-bundle-group-combo").combo("getSelectedOption");if(M.isDefinedAndNotNull(W)&&W.value!==""){aa=(ae.bundle.group===W.value)}}var X=ac&&Y&&aa;if(X===false&&A("#selected-reporting-task-type").text()===ae.type){h()}return X};var L=function(){var X=A("#selected-reporting-task-type").text();var W=A("#selected-reporting-task-type").data("bundle");if(X===""){k.showOkDialog({headerText:"Settings",dialogContent:"The type of reporting task to create must be selected."})}else{l(X,W)}};var l=function(W,Y){var Z={revision:i.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{type:W,bundle:Y}};var X=A.ajax({type:"POST",url:F.urls.createReportingTask,data:JSON.stringify(Z),dataType:"json",contentType:"application/json"}).done(function(ab){var ad=A("#reporting-tasks-table").data("gridInstance");var aa=ad.getData();aa.addItem(A.extend({type:"ReportingTask",bulletins:[]},ab));aa.reSort();ad.invalidate();var ac=aa.getRowById(ab.id);Q.choseRow(ad,ac);ad.scrollRowIntoView(ac)}).fail(d.handleAjaxError);A("#new-reporting-task-dialog").modal("hide");return X};var f=function(){var W={revision:i.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{name:A("#registry-name").val(),uri:A("#registry-location").val(),description:A("#registry-description").val()}};var X=A.ajax({type:"POST",url:F.urls.registries,data:JSON.stringify(W),dataType:"json",contentType:"application/json"}).done(function(ab){var Y=A("#registries-table").data("gridInstance");var Z=Y.getData();Z.addItem(A.extend({type:"Registry"},ab));Z.reSort();Y.invalidate();var aa=Z.getRowById(ab.id);Q.choseRow(Y,aa);Y.scrollRowIntoView(aa)}).fail(d.handleAjaxError);A("#registry-configuration-dialog").modal("hide");return X};var y=function(aa){var X=A("#registries-table").data("gridInstance");var Y=X.getData();var ab=Y.getItemById(aa);var Z={revision:i.getRevision(ab),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{id:aa,name:A("#registry-name").val(),uri:A("#registry-location").val(),description:A("#registry-description").val()}};var W=A.ajax({type:"PUT",url:ab.uri,data:JSON.stringify(Z),dataType:"json",contentType:"application/json"}).done(function(ac){Y.updateItem(aa,A.extend({type:"Registry"},ac))}).fail(d.handleAjaxError);A("#registry-configuration-dialog").modal("hide");return W};var g=function(){var X=[{id:"type",name:"Type",field:"label",formatter:M.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:M.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:M.genericValueFormatter}];var W=new a.Data.DataView({inlineFilters:false});W.setItems([]);W.setFilterArgs({searchString:C()});W.setFilter(I);M.sortType({columnId:"type",sortAsc:true},W);var aa=new a.Grid("#reporting-task-types-table",W,X,z);aa.setSelectionModel(new a.RowSelectionModel());aa.registerPlugin(new a.AutoTooltips());aa.setSortColumn("type",true);aa.onSort.subscribe(function(ac,ab){M.sortType({columnId:ab.sortCol.field,sortAsc:ab.sortAsc},W)});aa.onSelectedRowsChanged.subscribe(function(ag,ad){if(A.isArray(ad.rows)&&ad.rows.length===1){var af=ad.rows[0];var ab=aa.getDataItem(af);if(M.isDefinedAndNotNull(ab)){A("#reporting-task-description-container").show();if(M.isBlank(ab.description)){A("#reporting-task-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{A("#reporting-task-type-description").width(A("#reporting-task-description-container").innerWidth()-1).html(ab.description).ellipsis()}var ac=M.formatBundle(ab.bundle);var ae=M.formatType(ab);A("#reporting-task-type-name").text(ae).attr("title",ae);A("#reporting-task-type-bundle").text(ac).attr("title",ac);A("#selected-reporting-task-name").text(ab.label);A("#selected-reporting-task-type").text(ab.type).data("bundle",ab.bundle);A("#new-reporting-task-dialog").modal("refreshButtons")}}});aa.onDblClick.subscribe(function(ad,ac){var ab=aa.getDataItem(ac.row);if(n(ab)){l(ab.type,ab.bundle)}});aa.onViewportChanged.subscribe(function(ac,ab){M.cleanUpTooltips(A("#reporting-task-types-table"),"div.view-usage-restriction")});W.onRowCountChanged.subscribe(function(ac,ab){aa.updateRowCount();aa.render();A("#displayed-reporting-task-types").text(ab.current)});W.onRowsChanged.subscribe(function(ac,ab){aa.invalidateRows(ab.rows);aa.render()});W.syncGridSelection(aa,true);A("#reporting-task-types-table").data("gridInstance",aa).on("mouseenter","div.slick-cell",function(ae){var af=A(this).find("div.view-usage-restriction");if(af.length&&!af.data("qtip")){var ad=A(this).find("span.row-id").text();var ac=W.getItemById(ad);if(ac.restricted===true){var ag=A("<div></div>");if(M.isBlank(ac.usageRestriction)){ag.append(A('<p style="margin-bottom: 3px;"></p>').text("Requires the following permissions:"))}else{ag.append(A('<p style="margin-bottom: 3px;"></p>').text(ac.usageRestriction+" Requires the following permissions:"))}var ab=[];if(M.isDefinedAndNotNull(ac.explicitRestrictions)){A.each(ac.explicitRestrictions,function(ah,aj){var ai=aj.requiredPermission;ab.push("'"+ai.label+"' - "+M.escapeHtml(aj.explanation))})}else{ab.push("Access to restricted components regardless of restrictions.")}ag.append(M.formatUnorderedList(ab));af.qtip(A.extend({},M.config.tooltipConfig,{content:ag,position:{container:A("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});var Z=M.getPolicyTypeListing("restricted-components");A.ajax({type:"GET",url:F.urls.reportingTaskTypes,dataType:"json"}).done(function(ac){var ah=0;var ae=[];var ab=O.set();var ag=O.map();var af=O.map();W.beginUpdate();A.each(ac.reportingTaskTypes,function(ai,aj){if(aj.restricted===true){if(M.isDefinedAndNotNull(aj.explicitRestrictions)){A.each(aj.explicitRestrictions,function(ak,am){var al=am.requiredPermission;if(!af.has(al.id)){af.set(al.id,al.label)}if(!ag.has(al.id)){ag.set(al.id,[])}ag.get(al.id).push({type:M.formatType(aj),bundle:M.formatBundle(aj.bundle),explanation:M.escapeHtml(am.explanation)})})}else{if(!af.has(Z.value)){af.set(Z.value,Z.text)}if(!ag.has(Z.value)){ag.set(Z.value,[])}ag.get(Z.value).push({type:M.formatType(aj),bundle:M.formatBundle(aj.bundle),explanation:M.escapeHtml(aj.usageRestriction)})}}ab.add(aj.bundle.group);W.addItem({id:ah++,label:M.substringAfterLast(aj.type,"."),type:aj.type,bundle:aj.bundle,description:M.escapeHtml(aj.description),restricted:aj.restricted,usageRestriction:M.escapeHtml(aj.usageRestriction),explicitRestrictions:aj.explicitRestrictions,tags:aj.tags.join(", ")});A.each(aj.tags,function(al,ak){ae.push(ak.toLowerCase())})});W.endUpdate();W.reSort();aa.invalidate();S.addComponentRestrictions(ag,af);A("#total-reporting-task-types, #displayed-reporting-task-types").text(ac.reportingTaskTypes.length);A("#reporting-task-tag-cloud").tagcloud({tags:ae,select:p,remove:p});var ad=[{text:"all groups",value:""}];ab.each(function(ai){ad.push({text:ai,value:ai})});A("#reporting-task-bundle-group-combo").combo({options:ad,select:p})}).fail(d.handleAjaxError);var Y=[A.ui.keyCode.UP,A.ui.keyCode.PAGE_UP,A.ui.keyCode.DOWN,A.ui.keyCode.PAGE_DOWN];A("#reporting-task-type-filter").off("keyup").on("keyup",function(ae){var ad=ae.keyCode?ae.keyCode:ae.which;if(A.inArray(ad,Y)!==-1){return}if(ad===A.ui.keyCode.ENTER){var ab=aa.getSelectedRows();if(ab.length>0){var ac=aa.getDataItem(ab[0]);if(n(ac)){L()}}}else{p()}});Q.addKeydownListener("#reporting-task-type-filter",aa,aa.getData());A("#new-reporting-task-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Reporting Task",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var ab=aa.getSelectedRows();if(ab.length>0){var ac=aa.getDataItem(ab[0]);return n(ac)===false}else{return aa.getData().getLength()===0}},handler:{click:function(){L()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){A(this).modal("hide")}}}],handler:{close:function(){P();A("#reporting-task-type-filter").val("");A("#reporting-task-tag-cloud").tagcloud("clearSelectedTags");A("#reporting-task-bundle-group-combo").combo("setSelectedOption",{value:""});p();var ab=A("#reporting-task-types-table").data("gridInstance");ab.setSelectedRows([]);ab.resetActiveCell()},resize:function(){A("#reporting-task-type-description").width(A("#reporting-task-description-container").innerWidth()-1).text(A("#reporting-task-type-description").attr("title")).ellipsis()}}});A("#registry-configuration-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){A("#registry-id").text("");A("#registry-name").val("");A("#registry-location").val("");A("#registry-description").val("")}}})};var c=function(){g();var aa=function(aj,ad,ai,af,ac){if(!ac.permissions.canRead){return""}var ae='<div title="View Details" class="pointer view-reporting-task fa fa-info-circle"></div>';ae+='<div title="Usage" class="pointer reporting-task-usage fa fa-book"></div>';var ag=!M.isEmpty(ac.component.validationErrors);var ah=!M.isEmpty(ac.bulletins);if(ag){ae+='<div class="pointer has-errors fa fa-warning" ></div>'}if(ah){ae+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(ag||ah){ae+='<span class="hidden row-id">'+M.escapeHtml(ac.component.id)+"</span>"}return ae};var ab=function(ak,aj,ai,ae,ac){var ag="",ah="";if(ac.status.validationStatus==="VALIDATING"){ag="validating fa fa-spin fa-circle-notch";ah="Validating"}else{if(ac.status.validationStatus==="INVALID"){ag="invalid fa fa-warning";ah="Invalid"}else{if(ac.status.runStatus==="STOPPED"){ah="Stopped";ag="fa fa-stop stopped"}else{if(ac.status.runStatus==="RUNNING"){ah="Running";ag="fa fa-play running"}else{ah="Disabled";ag="icon icon-enable-false disabled"}}}}var af="";if(M.isDefinedAndNotNull(ac.status.activeThreadCount)&&ac.status.activeThreadCount>0){af="("+ac.status.activeThreadCount+")"}var ad='<div layout="row"><div class="'+ag+'"></div>';return ad+'<div class="status-text">'+M.escapeHtml(ah)+'</div><div style="float: left; margin-left: 4px;">'+M.escapeHtml(af)+"</div></div>"};var Z=function(al,aj,ah,ag,ac){var ak="";var ad=ac.permissions.canWrite;var af=ac.permissions.canRead;var ai=ac.operatePermissions.canWrite||ad;var ae=ac.status.runStatus==="STOPPED";if(ac.status.runStatus==="RUNNING"){if(ai){ak+='<div title="Stop" class="pointer stop-reporting-task fa fa-stop"></div>'}}else{if(ae||ac.status.runStatus==="DISABLED"){if(af&&ad){ak+='<div title="Edit" class="pointer edit-reporting-task fa fa-pencil"></div>'}if(ai&&ac.status.runStatus==="STOPPED"&&ac.status.validationStatus==="VALID"){ak+='<div title="Start" class="pointer start-reporting-task fa fa-play"></div>'}if(af&&ad&&ac.component.multipleVersionsAvailable===true){ak+='<div title="Change Version" class="pointer change-version-reporting-task fa fa-exchange"></div>'}if(af&&ad&&M.canModifyController()){ak+='<div title="Remove" class="pointer delete-reporting-task fa fa-trash"></div>'}}}if(af&&ad&&ac.component.persistsState===true){ak+='<div title="View State" class="pointer view-state-reporting-task fa fa-tasks"></div>'}if(S.isManagedAuthorizer()&&M.canAccessTenants()){ak+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key"></div>'}return ak};var W=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:aa,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",sortable:true,resizable:true,formatter:v},{id:"type",name:"Type",formatter:M.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:M.instanceBundleFormatter,sortable:true,resizable:true},{id:"state",name:"Run Status",sortable:true,resizeable:true,formatter:ab}];W.push({id:"actions",name:"&nbsp;",resizable:false,formatter:Z,sortable:false,width:90,maxWidth:90});var Y=new a.Data.DataView({inlineFilters:false});Y.setItems([]);T({columnId:"name",sortAsc:true},Y);var X=new a.Grid("#reporting-tasks-table",Y,W,z);X.setSelectionModel(new a.RowSelectionModel());X.registerPlugin(new a.AutoTooltips());X.setSortColumn("name",true);X.onSort.subscribe(function(ad,ac){T({columnId:ac.sortCol.id,sortAsc:ac.sortAsc},Y)});X.onClick.subscribe(function(ag,ad){var af=A(ag.target);var ae=Y.getItem(ad.row);if(X.getColumns()[ad.cell].id==="actions"){if(af.hasClass("edit-reporting-task")){B.showConfiguration(ae)}else{if(af.hasClass("start-reporting-task")){B.start(ae)}else{if(af.hasClass("stop-reporting-task")){B.stop(ae)}else{if(af.hasClass("delete-reporting-task")){B.promptToDeleteReportingTask(ae)}else{if(af.hasClass("view-state-reporting-task")){var ac=ae.status.runStatus==="STOPPED"&&ae.status.activeThreadCount===0;e.showState(ae,ac)}else{if(af.hasClass("change-version-reporting-task")){t.promptForVersionChange(ae)}else{if(af.hasClass("edit-access-policies")){w.showReportingTaskPolicy(ae);A("#shell-close-button").click()}}}}}}}}else{if(X.getColumns()[ad.cell].id==="moreDetails"){if(af.hasClass("view-reporting-task")){B.showDetails(ae)}else{if(af.hasClass("reporting-task-usage")){A("#shell-close-button").click();K.showPage("../nifi-docs/documentation?"+A.param({select:ae.component.type,group:ae.component.bundle.group,artifact:ae.component.bundle.artifact,version:ae.component.bundle.version})).done(function(){E.showSettings()})}}}}});Y.onRowCountChanged.subscribe(function(ad,ac){X.updateRowCount();X.render()});Y.onRowsChanged.subscribe(function(ad,ac){X.invalidateRows(ac.rows);X.render()});Y.syncGridSelection(X,true);A("#reporting-tasks-table").data("gridInstance",X).on("mouseenter","div.slick-cell",function(ai){var ag=A(this).find("div.has-errors");if(ag.length&&!ag.data("qtip")){var ac=A(this).find("span.row-id").text();var ae=Y.getItemById(ac);var af=M.formatUnorderedList(ae.component.validationErrors);if(M.isDefinedAndNotNull(af)){ag.qtip(A.extend({},M.config.tooltipConfig,{content:af,position:{target:"mouse",viewport:A("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var ad=A(this).find("div.has-bulletins");if(ad.length&&!ad.data("qtip")){var ac=A(this).find("span.row-id").text();var ae=Y.getItemById(ac);var ah=M.getFormattedBulletins(ae.bulletins);var af=M.formatUnorderedList(ah);if(M.isDefinedAndNotNull(af)){ad.qtip(A.extend({},M.config.tooltipConfig,{content:af,position:{target:"mouse",viewport:A("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var u=function(){var ab=function(ag,ad,af,ae,ac){if(!ac.permissions.canRead){return'<span class="blank">'+M.escapeHtml(ac.id)+"</span>"}return M.escapeHtml(ac.component.uri)};var Z=function(ag,ad,af,ae,ac){if(!ac.permissions.canRead){return'<span class="blank">'+M.escapeHtml(ac.id)+"</span>"}return M.escapeHtml(ac.component.description)};var X=function(ah,ad,ag,af,ac){var ae="";if(M.canModifyController()){ae+='<div title="Edit" class="pointer edit-registry fa fa-pencil"></div>';ae+='<div title="Remove" class="pointer remove-registry fa fa-trash"></div>'}return ae};var aa=[{id:"name",name:"Name",field:"name",formatter:v,sortable:true,resizable:true},{id:"uri",name:"Location",field:"uri",formatter:ab,sortable:true,resizable:true},{id:"description",name:"Description",field:"description",formatter:Z,sortable:true,resizable:true}];aa.push({id:"actions",name:"&nbsp;",resizable:false,formatter:X,sortable:false,width:90,maxWidth:90});var Y=new a.Data.DataView({inlineFilters:false});Y.setItems([]);T({columnId:"name",sortAsc:true},Y);var W=new a.Grid("#registries-table",Y,aa,z);W.setSelectionModel(new a.RowSelectionModel());W.registerPlugin(new a.AutoTooltips());W.setSortColumn("name",true);W.onSort.subscribe(function(ad,ac){T({columnId:ac.sortCol.id,sortAsc:ac.sortAsc},Y)});W.onClick.subscribe(function(ae,ac){var ad=A(ae.target);var af=Y.getItem(ac.row);if(W.getColumns()[ac.cell].id==="actions"){if(ad.hasClass("edit-registry")){D(af)}else{if(ad.hasClass("remove-registry")){q(af)}}}else{if(W.getColumns()[ac.cell].id==="moreDetails"){}}});Y.onRowCountChanged.subscribe(function(ad,ac){W.updateRowCount();W.render()});Y.onRowsChanged.subscribe(function(ad,ac){W.invalidateRows(ac.rows);W.render()});Y.syncGridSelection(W,true);A("#registries-table").data("gridInstance",W)};var D=function(W){A("#registry-id").text(W.id);A("#registry-name").val(W.component.name);A("#registry-location").val(W.component.uri);A("#registry-description").val(W.component.description);A("#registry-configuration-dialog").modal("setHeaderText","Edit Registry Client").modal("setButtonModel",[{buttonText:"Update",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){y(W.id)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){A(this).modal("hide")}}}]).modal("show")};var q=function(W){k.showYesNoDialog({headerText:"Delete Registry",dialogContent:"Delete registry '"+M.escapeHtml(W.component.name)+"'?",yesHandler:function(){b(W)}})};var b=function(X){var W=i.getRevision(X);A.ajax({type:"DELETE",url:X.uri+"?"+A.param({version:W.version,clientId:W.clientId,disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(Z){var Y=A("#registries-table").data("gridInstance");var aa=Y.getData();aa.deleteItem(X.id)}).fail(d.handleAjaxError)};var N=function(){var ac=function(){A("#read-only-maximum-timer-driven-thread-count-field").addClass("unset").text("Unauthorized");A("#read-only-maximum-event-driven-thread-count-field").addClass("unset").text("Unauthorized")};var aa=function(ad){if(ad){A("#general-settings div.editable").show();A("#general-settings div.read-only").hide();A("#settings-save").show()}else{A("#general-settings div.editable").hide();A("#general-settings div.read-only").show();A("#settings-save").hide()}};var Z=A.Deferred(function(ad){A.ajax({type:"GET",url:F.urls.controllerConfig,dataType:"json"}).done(function(ae){if(ae.permissions.canWrite){A("#maximum-timer-driven-thread-count-field").removeClass("unset").val(ae.component.maxTimerDrivenThreadCount);A("#maximum-event-driven-thread-count-field").removeClass("unset").val(ae.component.maxEventDrivenThreadCount);aa(true);A("#settings-save").off("click").on("click",function(){m(ae.revision.version)})}else{if(ae.permissions.canRead){A("#read-only-maximum-timer-driven-thread-count-field").removeClass("unset").text(ae.component.maxTimerDrivenThreadCount);A("#read-only-maximum-event-driven-thread-count-field").removeClass("unset").text(ae.component.maxEventDrivenThreadCount)}else{ac()}aa(false)}ad.resolve()}).fail(function(ag,ae,af){if(ag.status===403){ac();aa(false);ad.resolve()}else{ad.reject(ag,ae,af)}})}).promise();var W=F.urls.api+"/flow/controller/controller-services";var Y=H.loadControllerServices(W,r());var ab=G();var X=U();return A.when(Z,Y,ab).done(function(af,ae){var ad=ae[0];A("#settings-last-refreshed").text(ad.currentTime)}).fail(d.handleAjaxError)};var G=function(){return A.ajax({type:"GET",url:F.urls.reportingTasks,dataType:"json"}).done(function(W){var aa=[];A.each(W.reportingTasks,function(ac,ab){aa.push(A.extend({type:"ReportingTask",bulletins:[]},ab))});var Y=A("#reporting-tasks-table");M.cleanUpTooltips(Y,"div.has-errors");M.cleanUpTooltips(Y,"div.has-bulletins");var X=Y.data("gridInstance");var Z=X.getData();Z.setItems(aa);Z.reSort();X.invalidate()})};var U=function(){return A.ajax({type:"GET",url:F.urls.registries,dataType:"json"}).done(function(W){var X=[];A.each(W.registries,function(aa,ab){X.push(A.extend({type:"Registry"},ab))});var Y=A("#registries-table").data("gridInstance");var Z=Y.getData();Z.setItems(X);Z.reSort();Y.invalidate()})};var x=function(){K.showContent("#settings").done(function(){J()});A("#settings-tabs").find(".selected-tab").click();E.resetTableSize()};var J=function(){A("#settings-save").mouseout()};var E={init:function(){A("#settings-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-settings-tab-content"},{name:"Reporting Task Controller Services",tabContentId:"controller-services-tab-content"},{name:"Reporting Tasks",tabContentId:"reporting-tasks-tab-content"},{name:"Registry Clients",tabContentId:"registries-tab-content"}],select:function(){var W=A(this).text();if(W==="General"){A("#controller-cs-availability").hide();A("#new-service-or-task").hide();A("#settings-save").show()}else{var X=false;if(M.isDefinedAndNotNull(M.currentUser)){X=M.currentUser.controllerPermissions.canWrite===true}if(X){A("#new-service-or-task").show();A("div.controller-settings-table").css("top","32px");A("#new-service-or-task").attr("title",function(){if(W==="Reporting Task Controller Services"){A("#settings-save").hide();return"Create a new reporting task controller service"}else{if(W==="Reporting Tasks"){A("#settings-save").hide();return"Create a new reporting task"}else{if(W==="Registry Clients"){A("#settings-save").hide();return"Register a new registry client"}}}})}else{A("#new-service-or-task").hide();A("div.controller-settings-table").css("top","0")}if(W==="Reporting Task Controller Services"){A("#controller-cs-availability").show()}else{if(W==="Reporting Tasks"||W==="Registry Clients"){A("#controller-cs-availability").hide()}}E.resetTableSize()}}});A("#settings-refresh-button").click(function(){N()});A("#new-service-or-task").on("click",function(){var Y=A("#settings-tabs li.selected-tab").text();if(Y==="Reporting Task Controller Services"){var X=F.urls.api+"/controller/controller-services";H.promptNewControllerService(X,r())}else{if(Y==="Reporting Tasks"){A("#new-reporting-task-dialog").modal("show");var Z=A("#reporting-task-types-table").data("gridInstance");if(M.isDefinedAndNotNull(Z)){var W=Z.getData();Z.resizeCanvas();if(W.getLength()>0){Q.choseFirstRow(Z)}}A("#reporting-task-type-filter").focus()}else{if(Y==="Registry Clients"){A("#registry-configuration-dialog").modal("setHeaderText","Add Registry Client").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){A(this).modal("hide")}}}]).modal("show");A("#registry-name").focus()}}}});j();H.init(r(),E.showSettings);c();u()},resetTableSize:function(){H.resetTableSize(r());var W=A("#reporting-tasks-table").data("gridInstance");if(M.isDefinedAndNotNull(W)){W.resizeCanvas()}},showSettings:function(){return N().done(x)},loadSettings:function(){return N()},selectControllerService:function(W){var X=r().data("gridInstance");var Y=X.getData();var Z=Y.getRowById(W);Q.choseRow(X,Z);X.scrollRowIntoView(Z);A("#settings-tabs").find("li:eq(1)").click()},selectReportingTask:function(W){var Z=A("#reporting-tasks-table").data("gridInstance");var X=Z.getData();var Y=X.getRowById(W);Q.choseRow(Z,Y);Z.scrollRowIntoView(Y);A("#settings-tabs").find("li:eq(2)").click()},setBulletins:function(Y,W){if(A("#controller-services-table").data("gridInstance")){H.setBulletins(r(),Y)}var X=A("#reporting-tasks-table").data("gridInstance");var aa=X.getData();aa.beginUpdate();if(!M.isEmpty(W)){var ab=O.nest().key(function(ac){return ac.sourceId}).map(W,O.map);ab.each(function(ac,ad){var ae=aa.getItemById(ad);if(M.isDefinedAndNotNull(ae)){aa.updateItem(ad,A.extend(ae,{bulletins:ac}))}})}else{var Z=aa.getItems();A.each(Z,function(ac,ad){aa.updateItem(ad.id,A.extend(ad,{bulletins:[]}))})}aa.endUpdate()}};return E}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.ng.BreadcrumbsCtrl=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.BreadcrumbsCtrl=b(require("jquery"),require("nf.Common")))}else{nf.ng.BreadcrumbsCtrl=b(a.$,a.nf.Common)}}}(this,function(a,b){return function(e){function d(){this.breadcrumbs=[]}d.prototype={constructor:d,register:function(){if(e.breadcrumbsCtrl===undefined){e.register("breadcrumbsCtrl",c)}},generateBreadcrumbs:function(g){var f=g.id;if(g.permissions.canRead){f=g.breadcrumb.name}this.breadcrumbs.unshift(a.extend({label:f},g));if(b.isDefinedAndNotNull(g.parentBreadcrumb)){this.generateBreadcrumbs(g.parentBreadcrumb)}},updateVersionControlInformation:function(f,g){a.each(this.breadcrumbs,function(h,i){if(i.id===f){i.breadcrumb.versionControlInformation=g;return false}})},resetBreadcrumbs:function(){this.breadcrumbs=[]},isTracking:function(f){return b.isDefinedAndNotNull(f.versionedFlowState)},getVersionControlClass:function(g){if(b.isDefinedAndNotNull(g.versionedFlowState)){var f=g.versionedFlowState;if(f==="SYNC_FAILURE"){return"breadcrumb-version-control-gray fa fa-question"}else{if(f==="LOCALLY_MODIFIED_AND_STALE"){return"breadcrumb-version-control-red fa fa-exclamation-circle"}else{if(f==="STALE"){return"breadcrumb-version-control-red fa fa-arrow-circle-up"}else{if(f==="LOCALLY_MODIFIED"){return"breadcrumb-version-control-gray fa fa-asterisk"}else{return"breadcrumb-version-control-green fa fa-check"}}}}}else{return""}},getVersionControlTooltip:function(f){if(b.isDefinedAndNotNull(f.versionedFlowState)&&f.permissions.canRead){return b.getVersionControlTooltip(f.breadcrumb.versionControlInformation)}else{return"This Process Group is not under version control."}},getBreadcrumbs:function(){return this.breadcrumbs},updateBreadcrumbsCss:function(f){a("#breadcrumbs").css(f)},resetScrollPosition:function(){var l=a("#data-flow-title-container");var i=l.position();var m=l.outerWidth();var k=i.left+m;var j=a("#breadcrumbs-right-border").width();var g=a("#data-flow-title-viewport");var h=g.width();var f=h-j;if(k>f){l.css("left",(i.left-(k-f))+"px")}else{l.css("left","10px")}},registerMouseWheelEvent:function(f){f.on("DOMMouseScroll mousewheel",function(s,l){if(b.isUndefinedOrNull(s.originalEvent)){return}var m=a("#data-flow-title-container");var g=m.position();var q=m.outerWidth();var j=g.left+q;var n=a("#breadcrumbs-right-border").width();var k=a("#data-flow-title-viewport");var i=k.width();var h=i-n;if(q>i){var p=false;var r=0;if(b.isDefinedAndNotNull(s.originalEvent.wheelDelta)){r=s.originalEvent.wheelDelta}else{if(b.isDefinedAndNotNull(s.originalEvent.detail)){r=-s.originalEvent.detail}}if(r>0&&j>h){var o=-25;p=true}else{if(r<0&&(g.left-n)<0){o=25;if(g.left+o>n){o=n-g.left}p=true}}if(p){m.css("left",(g.left+o)+"px")}}})}};var c=new d();c.register();return c}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Storage","nf.Shell","nf.ErrorHandler"],function(e,f,d,c,g){return(nf.ng.Canvas.HeaderCtrl=b(e,f,d,c,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.HeaderCtrl=b(require("jquery"),require("nf.Common"),require("nf.Storage"),require("nf.Shell"),require("nf.ErrorHandler")))}else{nf.ng.Canvas.HeaderCtrl=b(a.$,a.nf.Common,a.nf.Storage,a.nf.Shell,a.nf.ErrorHandler)}}}(this,function(c,d,b,a,e){return function(k,m,f,i){var j=640;var h={urls:{accessConfig:"../nifi-api/access/config"}};function l(p,n,o){this.toolboxCtrl=p;this.globalMenuCtrl=n;this.flowStatusCtrl=o;this.loginCtrl={init:function(){var q=this;if(c("#current-user").text()!==d.ANONYMOUS_USER_TEXT||location.protocol==="http:"){c("#login-link-container").css("display","none")}if(location.protocol==="http:"){c("#current-user-container").css("display","none")}var r=c.ajax({type:"GET",url:h.urls.accessConfig,dataType:"json"});c.when(r).done(function(s){q.supportsLogin=s.config.supportsLogin}).fail(e.handleAjaxError)},supportsLogin:undefined,shell:{launch:function(){a.showPage("login",false)}}};this.logoutCtrl={logout:function(){b.removeItem("jwt");window.location="../nifi/logout"}}}l.prototype={constructor:l,register:function(){if(k.headerCtrl===undefined){k.register("headerCtrl",g)}},init:function(){this.toolboxCtrl.init();this.globalMenuCtrl.init();this.flowStatusCtrl.init();this.loginCtrl.init()}};var g=new l(m,f,i);g.register();return g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.CanvasUtils","nf.ContextMenu"],function(d,c){return(nf.ng.Canvas.ToolboxCtrl=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.ToolboxCtrl=b(require("nf.CanvasUtils"),require("nf.ContextMenu")))}else{nf.ng.Canvas.ToolboxCtrl=b(a.nf.CanvasUtils,a.nf.ContextMenu)}}}(this,function(b,a){return function(l,e,h,c,j,k,g,i){function f(m,p,r,q,n,t,s,o){this.processorComponent=m;this.inputPortComponent=p;this.outputPortComponent=r;this.groupComponent=q;this.remoteGroupComponent=n;this.funnelComponent=t;this.templateComponent=s;this.labelComponent=o;this.config={type:{processor:"Processor",inputPort:"Input Port",outputPort:"Output Port",processGroup:"Process Group",remoteProcessGroup:"Remote Process Group",connection:"Connection",funnel:"Funnel",template:"Template",label:"Label"},urls:{api:"../nifi-api",controller:"../nifi-api/controller",processorTypes:"../nifi-api/flow/processor-types"}}}f.prototype={constructor:f,init:function(){l.modal.init();e.modal.init();h.modal.init();c.modal.init();j.modal.init();g.modal.init()},draggableComponentConfig:function(m){m.getElement().hover(function(){m.getElement().removeClass(m.icon).addClass(m.hoverIcon)},function(){m.getElement().removeClass(m.hoverIcon).addClass(m.icon)});return{zIndex:1011,revert:true,revertDuration:0,cancel:false,containment:"body",cursor:"-webkit-grabbing",start:function(o,n){a.hide()},stop:function(r,q){var t=b.getCanvasTranslate();var s=b.getCanvasScale();var p=r.originalEvent.pageX;var o=r.originalEvent.pageY-b.getCanvasOffset();if(p>=0&&o>=0){var n=(p/s)-(t[0]/s);var u=(o/s)-(t[1]/s);m.dropHandler.apply(m,[{x:n,y:u}])}},helper:m.dragIcon}}};var d=new f(l,e,h,c,j,k,g,i);return d}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Dialog","nf.CanvasUtils","nf.ContextMenu","nf.ClusterSummary","nf.ErrorHandler","nf.Settings"],function(h,i,g,f,d,c,j,e){return(nf.ng.Canvas.FlowStatusCtrl=b(h,i,g,f,d,c,j,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.FlowStatusCtrl=b(require("jquery"),require("nf.Common"),require("nf.Dialog"),require("nf.CanvasUtils"),require("nf.ContextMenu"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Settings")))}else{nf.ng.Canvas.FlowStatusCtrl=b(a.$,a.nf.Common,a.nf.Dialog,a.nf.CanvasUtils,a.nf.ContextMenu,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Settings)}}}(this,function(f,g,e,d,b,a,h,c){return function(l){var i={search:"Search",urls:{search:"../nifi-api/flow/search-results",status:"../nifi-api/flow/status"}};function k(){this.connectedNodesCount="-";this.clusterConnectionWarning=false;this.activeThreadCount="-";this.terminatedThreadCount="-";this.threadCounts="-";this.totalQueued="-";this.controllerTransmittingCount="-";this.controllerNotTransmittingCount="-";this.controllerRunningCount="-";this.controllerStoppedCount="-";this.controllerInvalidCount="-";this.controllerDisabledCount="-";this.controllerUpToDateCount="-";this.controllerLocallyModifiedCount="-";this.controllerStaleCount="-";this.controllerLocallyModifiedAndStaleCount="-";this.controllerSyncFailureCount="-";this.statsLastRefreshed="-";this.search={getInputElement:function(){return f("#search-field")},getButtonElement:function(){return f("#search-button")},getSearchContainerElement:function(){return f("#search-container")},init:function(){var m=this;f.widget("nf.searchAutocomplete",f.ui.autocomplete,{reset:function(){this.term=null},_create:function(){this._super();this.widget().menu("option","items","> :not(.search-header, .search-no-matches)")},_resizeMenu:function(){var n=this.menu.element;n.width(400)},_normalize:function(o){var n=[];n.push(o);return n},_renderMenu:function(p,o){var n=this;var q=o[0];if(!g.isEmpty(q.processorResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-processor"></div>Processors</li>');f.each(q.processorResults,function(s,r){n._renderItem(p,r)})}if(!g.isEmpty(q.processGroupResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-group"></div>Process Groups</li>');f.each(q.processGroupResults,function(s,r){n._renderItem(p,r)})}if(!g.isEmpty(q.remoteProcessGroupResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-group-remote"></div>Remote Process Groups</li>');f.each(q.remoteProcessGroupResults,function(r,s){n._renderItem(p,s)})}if(!g.isEmpty(q.connectionResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-connect"></div>Connections</li>');f.each(q.connectionResults,function(s,r){n._renderItem(p,r)})}if(!g.isEmpty(q.inputPortResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-port-in"></div>Input Ports</li>');f.each(q.inputPortResults,function(r,s){n._renderItem(p,s)})}if(!g.isEmpty(q.outputPortResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-port-out"></div>Output Ports</li>');f.each(q.outputPortResults,function(r,s){n._renderItem(p,s)})}if(!g.isEmpty(q.funnelResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-funnel"></div>Funnels</li>');f.each(q.funnelResults,function(s,r){n._renderItem(p,r)})}if(p.children().length===0){p.append('<li class="unset search-no-matches">No results matched the search terms</li>')}},_renderItem:function(o,n){var t=f('<div class="search-match-header"></div>').text(n.name);var u=f('<div class="search-match-header"></div>').append(document.createTextNode("Parent: "));var s=n.parentGroup.name?n.parentGroup.name:n.parentGroup.id;u=u.append(f("<span></span>").text(s));var p=f('<div class="search-match-header"></div>').append(document.createTextNode("Versioned: "));var q="-";if(g.isDefinedAndNotNull(n.versionedGroup)){q=n.versionedGroup.name?n.versionedGroup.name:n.versionedGroup.id}p=p.append(f("<span></span>").text(q));var r=f("<a></a>").append(t).append(u).append(p);f.each(n.matches,function(w,v){r.append(f('<div class="search-match"></div>').text(v))});return f("<li></li>").data("ui-autocomplete-item",n).append(r).appendTo(o)}});this.getInputElement().searchAutocomplete({appendTo:"#search-flow-results",position:{my:"right top",at:"right bottom",offset:"1 1"},source:function(o,n){f.ajax({type:"GET",data:{q:o.term},dataType:"json",url:i.urls.search}).done(function(p){n(p.searchResultsDTO)})},select:function(o,p){var n=p.item;var q=n.parentGroup;d.showComponent(q.id,n.id);m.getInputElement().val("").blur();return false},open:function(n,o){var p=f(this);f('<div class="search-glass-pane"></div>').one("click",function(){}).appendTo("body")},close:function(n,o){f(this).searchAutocomplete("reset");m.getInputElement().val("");f("div.search-glass-pane").remove()}});m.toggleSearchField()},toggleSearchField:function(){var p=this;b.hide();var m=p.getInputElement().is(":visible");var q="none";var o="search-container-opened";var n="search-container-closed";if(!m){p.getButtonElement().css("background-color","#FFFFFF");q="inline-block";o="search-container-closed";n="search-container-opened"}else{p.getInputElement().css("display",q)}this.getSearchContainerElement().switchClass(o,n,500,function(){p.getInputElement().css("display",q);if(!m){p.getButtonElement().css("background-color","#FFFFFF");p.getInputElement().focus()}else{p.getButtonElement().css("background-color","#E3E8EB")}})}};this.bulletins={update:function(m){var o=f("#bulletin-button");var q=o.data("bulletins");if(g.doBulletinsDiffer(q,m.bulletins)){o.data("bulletins",m.bulletins);var p=g.getFormattedBulletins(m.bulletins);if(p.length===0){if(o.data("qtip")){o.removeClass("has-bulletins").qtip("api").destroy(true)}}else{var n=g.formatUnorderedList(p);if(o.data("qtip")){o.qtip("option","content.text",n)}else{o.addClass("has-bulletins").qtip(f.extend({},d.config.systemTooltipConfig,{content:n,position:{at:"bottom left",my:"top right",adjust:{x:4}}}))}}}c.setBulletins(m.controllerServiceBulletins,m.reportingTaskBulletins)}}}k.prototype={constructor:k,init:function(){this.search.init()},reloadFlowStatus:function(){var m=this;return f.ajax({type:"GET",url:i.urls.status,dataType:"json"}).done(function(n){if(g.isDefinedAndNotNull(n.controllerStatus)){m.update(n.controllerStatus)}}).fail(h.handleAjaxError)},updateClusterSummary:function(n){if(n.connectedToCluster){var m=n.connectedNodes.split(" / ");if(m.length===2&&m[0]!==m[1]){this.clusterConnectionWarning=true}else{this.clusterConnectionWarning=false}this.connectedNodesCount=n.connectedNodes}else{this.connectedNodesCount="Disconnected"}},hasTerminatedThreads:function(){if(Number.isInteger(this.terminatedThreadCount)){return this.terminatedThreadCount>0}else{return false}},getExtraThreadStyles:function(){if(Number.isInteger(this.terminatedThreadCount)&&this.terminatedThreadCount>0){return"warning"}else{if(this.activeThreadCount===0){return"zero"}}return""},getExtraClusterStyles:function(){if(this.connectedNodesCount==="Disconnected"||this.clusterConnectionWarning===true){return"warning"}return""},update:function(m){this.activeThreadCount=m.activeThreadCount;this.terminatedThreadCount=m.terminatedThreadCount;if(this.hasTerminatedThreads()){this.threadCounts=this.activeThreadCount+" ("+this.terminatedThreadCount+")"}else{this.threadCounts=this.activeThreadCount}this.totalQueued=m.queued;if(this.totalQueued.indexOf("0 / 0")>=0){f("#flow-status-container").find(".fa-list").addClass("zero")}else{f("#flow-status-container").find(".fa-list").removeClass("zero")}this.controllerTransmittingCount=g.isDefinedAndNotNull(m.activeRemotePortCount)?m.activeRemotePortCount:"-";if(this.controllerTransmittingCount>0){f("#flow-status-container").find(".fa-bullseye").removeClass("zero").addClass("transmitting")}else{f("#flow-status-container").find(".fa-bullseye").removeClass("transmitting").addClass("zero")}this.controllerNotTransmittingCount=g.isDefinedAndNotNull(m.inactiveRemotePortCount)?m.inactiveRemotePortCount:"-";if(this.controllerNotTransmittingCount>0){f("#flow-status-container").find(".icon-transmit-false").removeClass("zero").addClass("not-transmitting")}else{f("#flow-status-container").find(".icon-transmit-false").removeClass("not-transmitting").addClass("zero")}this.controllerRunningCount=g.isDefinedAndNotNull(m.runningCount)?m.runningCount:"-";if(this.controllerRunningCount>0){f("#flow-status-container").find(".fa-play").removeClass("zero").addClass("running")}else{f("#flow-status-container").find(".fa-play").removeClass("running").addClass("zero")}this.controllerStoppedCount=g.isDefinedAndNotNull(m.stoppedCount)?m.stoppedCount:"-";if(this.controllerStoppedCount>0){f("#flow-status-container").find(".fa-stop").removeClass("zero").addClass("stopped")}else{f("#flow-status-container").find(".fa-stop").removeClass("stopped").addClass("zero")}this.controllerInvalidCount=g.isDefinedAndNotNull(m.invalidCount)?m.invalidCount:"-";if(this.controllerInvalidCount>0){f("#flow-status-container").find(".fa-warning").removeClass("zero").addClass("invalid")}else{f("#flow-status-container").find(".fa-warning").removeClass("invalid").addClass("zero")}this.controllerDisabledCount=g.isDefinedAndNotNull(m.disabledCount)?m.disabledCount:"-";if(this.controllerDisabledCount>0){f("#flow-status-container").find(".icon-enable-false").removeClass("zero").addClass("disabled")}else{f("#flow-status-container").find(".icon-enable-false").removeClass("disabled").addClass("zero")}this.controllerUpToDateCount=g.isDefinedAndNotNull(m.upToDateCount)?m.upToDateCount:"-";if(this.controllerUpToDateCount>0){f("#flow-status-container").find(".fa-check").removeClass("zero").addClass("up-to-date")}else{f("#flow-status-container").find(".fa-check").removeClass("up-to-date").addClass("zero")}this.controllerLocallyModifiedCount=g.isDefinedAndNotNull(m.locallyModifiedCount)?m.locallyModifiedCount:"-";if(this.controllerLocallyModifiedCount>0){f("#flow-status-container").find(".fa-asterisk").removeClass("zero").addClass("locally-modified")}else{f("#flow-status-container").find(".fa-asterisk").removeClass("locally-modified").addClass("zero")}this.controllerStaleCount=g.isDefinedAndNotNull(m.staleCount)?m.staleCount:"-";if(this.controllerStaleCount>0){f("#flow-status-container").find(".fa-arrow-circle-up").removeClass("zero").addClass("stale")}else{f("#flow-status-container").find(".fa-arrow-circle-up").removeClass("stale").addClass("zero")}this.controllerLocallyModifiedAndStaleCount=g.isDefinedAndNotNull(m.locallyModifiedAndStaleCount)?m.locallyModifiedAndStaleCount:"-";if(this.controllerLocallyModifiedAndStaleCount>0){f("#flow-status-container").find(".fa-exclamation-circle").removeClass("zero").addClass("locally-modified-and-stale")}else{f("#flow-status-container").find(".fa-exclamation-circle").removeClass("locally-modified-and-stale").addClass("zero")}this.controllerSyncFailureCount=g.isDefinedAndNotNull(m.syncFailureCount)?m.syncFailureCount:"-";if(this.controllerSyncFailureCount>0){f("#flow-status-container").find(".fa-question").removeClass("zero").addClass("sync-failure")}else{f("#flow-status-container").find(".fa-question").removeClass("sync-failure").addClass("zero")}},updateBulletins:function(m){this.bulletins.update(m)}};var j=new k();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.QueueListing","nf.Shell","nf.PolicyManagement","nf.ClusterSummary","nf.ErrorHandler","nf.Settings","nf.CanvasUtils"],function(g,e,k,c,j,i,h,f,d){return(nf.ng.Canvas.GlobalMenuCtrl=b(g,e,k,c,j,i,h,f,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.GlobalMenuCtrl=b(require("jquery"),require("nf.Common"),require("nf.QueueListing"),require("nf.Shell"),require("nf.PolicyManagement"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Settings"),require("nf.CanvasUtils")))}else{nf.ng.Canvas.GlobalMenuCtrl=b(a.$,a.nf.Common,a.nf.QueueListing,a.nf.Shell,a.nf.PolicyManagement,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Settings,a.nf.CanvasUtils)}}}(this,function(e,c,i,a,h,g,f,d,b){return function(m){var k={urls:{helpDocument:"../nifi-docs/documentation",controllerAbout:"../nifi-api/flow/about"}};function l(n){this.summary={shell:{launch:function(){a.showPage("summary")}}};this.counters={shell:{launch:function(){if(c.canAccessCounters()){a.showPage("counters")}}}};this.bulletinBoard={shell:{launch:function(){a.showPage("bulletin-board")}}};this.dataProvenance={shell:{launch:function(){if(c.canAccessProvenance()){a.showPage("provenance")}}}};this.controllerSettings={shell:{launch:function(){d.showSettings()}}};this.cluster={visible:function(){return g.isConnectedToCluster()},shell:{launch:function(){if(c.canAccessController()){a.showPage("cluster")}}}};this.flowConfigHistory={shell:{launch:function(){a.showPage("history")}}};this.users={shell:{launch:function(){if(c.canAccessTenants()){a.showPage("users")}}}};this.policies={shell:{launch:function(){if(c.canModifyPolicies()&&c.canAccessTenants()){h.showGlobalPolicies()}}}};this.templates={shell:{launch:function(){a.showPage("templates?"+e.param({groupId:b.getGroupId()}))}}};this.help={shell:{launch:function(){a.showPage(k.urls.helpDocument)}}};this.about={init:function(){e.ajax({type:"GET",url:k.urls.controllerAbout,dataType:"json"}).done(function(q){var o=q.about;document.title=o.title;e("#nf-version").text(o.version);var p=false;if(o.buildTag&&o.buildTag!=="HEAD"){e("#nf-about-build-tag").text(o.buildTag);e("#nf-version-detail-tag").show();p=true}if(o.buildRevision){e("#nf-about-build-revision").text(o.buildRevision);e("#nf-about-build-branch").text(o.buildBranch);e("#nf-version-detail-commit").show();p=true}if(o.buildTimestamp){e("#nf-about-build-timestamp").text(o.buildTimestamp);e("#nf-version-detail-timestamp").show();p=true}if(p){e("#nf-version-detail").show()}if(!c.isBlank(o.contentViewerUrl)){e("#nifi-content-viewer-url").text(o.contentViewerUrl);i.initFlowFileDetailsDialog()}}).fail(f.handleAjaxError);this.modal.init()},modal:{getElement:function(){return e("#nf-about")},init:function(){var o=this;var p=function(){var q=e(this);var r=e("#nf-about-pic-container").height()+e(".dialog-header").height()+10;q.find(".dialog-content").css("top",r)};this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"About Apache NiFi",handler:{resize:p},buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){o.hide()}}}]})},update:function(p,o){this.getElement().modal(p,o)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}}l.prototype={constructor:l,init:function(){this.about.init()}};var j=new l();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Actions","nf.Birdseye","nf.Storage","nf.CanvasUtils","nf.ProcessGroupConfiguration"],function(h,d,g,e,f,c){return(nf.ng.Canvas.GraphControlsCtrl=b(h,d,g,e,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.GraphControlsCtrl=b(require("jquery"),require("nf.Actions"),require("nf.Birdseye"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.ProcessGroupConfiguration")))}else{nf.ng.Canvas.GraphControlsCtrl=b(a.$,a.nf.Actions,a.nf.Birdseye,a.nf.Storage,a.nf.CanvasUtils,a.nf.ProcessGroupConfiguration)}}}(this,function(f,b,e,c,d,a){return function(m,i,l){var k=function(n){if(f("div.graph-control-content").is(":visible")===false){f("#graph-controls div.graph-control-docked").hide();f("#graph-controls div.graph-control-header-container").show();f(".graph-control").removeClass("docked")}n.children("div.graph-control-content").show();n.find("div.graph-control-expansion").removeClass("fa-plus-square-o").addClass("fa-minus-square-o");if(n.attr("id")==="navigation-control"){e.updateBirdseyeVisibility(true)}var o=c.getItem("graph-control-visibility");if(o===null){o={}}var p=n.attr("id");o[p]=true;c.setItem("graph-control-visibility",o)};var j=function(n){n.children("div.graph-control-content").hide();n.find("div.graph-control-expansion").removeClass("fa-minus-square-o").addClass("fa-plus-square-o");if(f("div.graph-control-content").is(":visible")===false){f("#graph-controls div.graph-control-header-container").hide();f("#graph-controls div.graph-control-docked").show();f(".graph-control").addClass("docked")}if(n.attr("id")==="navigation-control"){e.updateBirdseyeVisibility(false)}var o=c.getItem("graph-control-visibility");if(o===null){o={}}var p=n.attr("id");o[p]=false;c.setItem("graph-control-visibility",o)};function h(n,o){this.navigateCtrl=n;this.operateCtrl=o}h.prototype={constructor:h,register:function(){if(m.graphControlsCtrl===undefined){m.register("graphControlsCtrl",g)}},init:function(){this.operateCtrl.init();var n=c.getItem("graph-control-visibility");if(n!==null){f.each(n,function(q,o){var p=f("#"+q);if(p){if(o){k(p)}else{j(p)}}})}else{k(f("#navigation-control"));k(f("#operation-control"))}},undock:function(n){k(f(n.target).parent())},expand:function(n){var o=f(n.target);if(o.find(".fa-plus-square-o").length>0||o.hasClass("fa-plus-square-o")||o.parent().children().find(".fa-plus-square-o").length>0){k(o.closest("div.graph-control"))}else{j(o.closest("div.graph-control"))}},getContextIcon:function(){var n=d.getSelection();if(n.empty()){if(d.getParentGroupId()===null){return"icon-drop"}else{return"icon-group"}}else{if(n.size()===1){if(d.isProcessor(n)){return"icon-processor"}else{if(d.isProcessGroup(n)){return"icon-group"}else{if(d.isInputPort(n)){return"icon-port-in"}else{if(d.isOutputPort(n)){return"icon-port-out"}else{if(d.isRemoteProcessGroup(n)){return"icon-group-remote"}else{if(d.isFunnel(n)){return"icon-funnel"}else{if(d.isLabel(n)){return"icon-label"}else{if(d.isConnection(n)){return"icon-connect"}}}}}}}}}else{return"icon-drop"}}},hide:function(){var n=d.getSelection();if(n.size()>1){return"invisible"}else{return""}},getContextName:function(){var o=d.getSelection();var n=d.canReadCurrentGroup();if(o.empty()){if(n){return d.getGroupName()}else{return d.getGroupId()}}else{if(o.size()===1){var p=o.datum();if(p.permissions.canRead){if(d.isLabel(o)){if(f.trim(p.component.label)!==""){return p.component.label}else{return""}}else{if(d.isConnection(o)){return d.formatConnectionName(p.component)}else{return p.component.name}}}else{return p.id}}else{return"Multiple components selected"}}},getContextType:function(){var n=d.getSelection();if(n.empty()){return"Process Group"}else{if(n.size()===1){if(d.isProcessor(n)){return"Processor"}else{if(d.isProcessGroup(n)){return"Process Group"}else{if(d.isInputPort(n)){return"Input Port"}else{if(d.isOutputPort(n)){return"Output Port"}else{if(d.isRemoteProcessGroup(n)){return"Remote Process Group"}else{if(d.isFunnel(n)){return"Funnel"}else{if(d.isLabel(n)){return"Label"}else{if(d.isConnection(n)){return"Connection"}}}}}}}}}else{return"Multiple selected"}}},getContextId:function(){var n=d.getSelection();if(n.empty()){return d.getGroupId()}else{if(n.size()===1){var o=n.datum();return o.id}else{return"Multiple selected"}}},canConfigureOrOpenDetails:function(){var n=d.getSelection();if(n.empty()){return true}return d.isConfigurable(n)||d.hasDetails(n)},openConfigureOrDetailsView:function(){var n=d.getSelection();if(d.isConfigurable(n)){b.showConfiguration(n)}else{if(d.hasDetails(n)){b.showDetails(n)}}}};var g=new h(i,l);g.register();return g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.CanvasUtils","nf.ContextMenu"],function(d,c){return(nf.ng.Canvas.NavigateCtrl=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.NavigateCtrl=b(require("nf.CanvasUtils"),require("nf.ContextMenu")))}else{nf.ng.Canvas.NavigateCtrl=b(a.nf.CanvasUtils,a.nf.ContextMenu)}}}(this,function(b,a){return function(e){function d(){this.zoomIn=function(){e(function(){b.zoomInCanvas()},0)};this.zoomOut=function(){e(function(){b.zoomOutCanvas()},0)};this.zoomFit=function(){e(function(){b.fitCanvas()},0)};this.zoomActualSize=function(){e(function(){b.actualSizeCanvas()},0)}}d.prototype={constructor:d};var c=new d();return c}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Dialog","nf.Storage","nf.Birdseye","nf.CanvasUtils","nf.Common","nf.Client","nf.Processor"],function(g,j,f,h,c,e,d,k,i){return(nf.ng.Canvas.OperateCtrl=b(g,j,f,h,c,e,d,k,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.OperateCtrl=b(require("jquery"),require("d3"),require("nf.Dialog"),require("nf.Storage"),require("nf.Birdseye"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Client"),require("nf.Processor")))}else{nf.ng.Canvas.OperateCtrl=b(a.$,a.d3,a.nf.Dialog,a.nf.Storage,a.nf.Birdseye,a.nf.CanvasUtils,a.nf.Common,a.nf.Client,a.nf.Processor)}}}(this,function(e,h,d,f,a,c,b,i,g){return function(){var k=function(){var m=e("#fill-color-value").val();if(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(m)){e("#fill-color").minicolors("value",m)}};function j(){this.template={modal:{getElement:function(){return e("#new-template-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Create Template"})},update:function(n,m){this.getElement().modal(n,m)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}};this.templateUpload={modal:{getElement:function(){return e("#upload-template-dialog")},init:function(){var m=e("#template-upload-form").ajaxForm({url:"../nifi-api/process-groups/",dataType:"xml",beforeSubmit:function(p,n,o){p.push({name:"disconnectedNodeAcknowledged",value:f.isDisconnectionAcknowledged()});o.url+=(encodeURIComponent(c.getGroupId())+"/templates/upload")},success:function(n,q,r,p){if(n.documentElement.tagName==="templateEntity"){d.showOkDialog({headerText:"Success",dialogContent:"Template successfully imported."})}else{var q="Unable to import template. Please check the log for errors.";if(n.documentElement.tagName==="errorResponse"){var o=n.documentElement.getAttribute("statusText");if(!b.isBlank(o)){q=o}}d.showOkDialog({headerText:"Unable to Upload",dialogContent:b.escapeHtml(q)})}},error:function(p,o,n){d.showOkDialog({headerText:"Unable to Upload",dialogContent:b.escapeHtml(p.responseText)})}});this.getElement().modal({headerText:"Upload Template",buttons:[{buttonText:"Upload",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var n=e("#selected-template-name").text();if(b.isBlank(n)){e("#upload-template-status").text("No template selected. Please browse to select a template.")}else{m.submit();e("#upload-template-dialog").modal("hide")}}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#upload-template-dialog").modal("hide")}}}],handler:{close:function(){e("#selected-template-name").text("");e("#upload-template-status").text("");m.resetForm()}}});e("#template-file-field-button").on("click",function(n){e("#template-file-field").click()});e("#template-file-field").on("change",function(o){var n=e(this).val();if(!b.isBlank(n)){n=n.replace(/^.*[\\\/]/,"")}e("#selected-template-name").text(n);e("#upload-template-status").text("")})},update:function(n,m){this.getElement().modal(n,m)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}};this.fillcolor={modal:{getElement:function(){return e("#fill-color-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Change Color",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var m=c.getSelection();m.each(function(r){var p=h.select(this);var q=p.datum();var o=e("#fill-color").minicolors("value");if(o!==q.component.style["background-color"]){var n={revision:i.getRevision(q),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{id:q.id,style:{"background-color":o}}};e.ajax({type:"PUT",url:q.uri,data:JSON.stringify(n),dataType:"json",contentType:"application/json"}).done(function(s){c.getComponentByType(q.type).set(s)}).fail(function(u,s,t){if(u.status===400||u.status===404||u.status===409){d.showOkDialog({headerText:"Error",dialogContent:b.escapeHtml(u.responseText)})}}).always(function(){a.refresh()})}});e("#fill-color-dialog").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#fill-color-dialog").modal("hide")}}}],handler:{close:function(){e("#fill-color-value").val("");e("#fill-color").minicolors("value","")}}})},update:function(n,m){this.getElement().modal(n,m)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")},minicolors:{getElement:function(){return e("#fill-color")},init:function(){this.getElement().minicolors({inline:true,change:function(n,m){e("#fill-color-value").val(n);if(n.toLowerCase()==="#ffffff"){e("#fill-color-processor-preview-icon").css({color:g.defaultIconColor(),"background-color":n})}else{e("#fill-color-processor-preview-icon").css({color:b.determineContrastColor(b.substringAfterLast(n,"#")),"background-color":n})}var o=n;if(o.toLowerCase()==="#ffffff"){o="rgba(0,0,0,0.25)"}e("#fill-color-processor-preview").css({"border-color":o});e("#fill-color-label-preview").css({background:n});e("#fill-color-label-preview-value").css("color",b.determineContrastColor(b.substringAfterLast(n,"#")))}});e("#fill-color-value").on("blur",k).on("keyup",function(n){var m=n.keyCode?n.keyCode:n.which;if(m===e.ui.keyCode.ENTER){k()}})}}}}}j.prototype={constructor:j,init:function(){this.template.modal.init();this.templateUpload.modal.init();this.fillcolor.modal.init();this.fillcolor.modal.minicolors.init()}};var l=new j();return l}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.FilteredDialogCommon","nf.Dialog","nf.Common"],function(h,e,m,c,i,j,f,l,k,g,d){return(nf.ng.ProcessorComponent=b(h,e,m,c,i,j,f,l,k,g,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.ProcessorComponent=b(require("jquery"),require("Slick"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.ProcessorComponent=b(a.$,a.Slick,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.Dialog,a.nf.Common)}}}(this,function(f,c,k,a,g,h,d,j,i,e,b){return function(n){var q=function(){var w=f("#processor-types-table").data("gridInstance");if(b.isDefinedAndNotNull(w)){var x=w.getData();x.setFilterArgs({searchString:u()});x.refresh();f("#new-processor-dialog").modal("refreshButtons");if(x.getLength()>0){i.choseFirstRow(w);w.scrollRowToTop(0)}}};var s=function(y,x){if(x.searchString===""){return true}try{var B=new RegExp(x.searchString,"i")}catch(A){return false}var z=y.label.search(B)>=0;var w=y.tags.search(B)>=0;return z||w};var l=function(F,A){var D=s(F,A);var z=true;if(D){var E=f("#processor-tag-cloud").tagcloud("getSelectedTags");var C=E.length>0;if(C){z=m(E,F.tags)}}var B=true;if(D&&z){var w=f("#processor-bundle-group-combo").combo("getSelectedOption");if(b.isDefinedAndNotNull(w)&&w.value!==""){B=(F.bundle.group===w.value)}}var x=D&&z&&B;if(x===false&&f("#selected-processor-type").text()===F.type){f("#processor-type-description").attr("title","").text("");f("#processor-type-name").attr("title","").text("");f("#processor-type-bundle").attr("title","").text("");f("#selected-processor-name").text("");f("#selected-processor-type").text("").removeData("bundle");var y=f("#processor-types-table").data("gridInstance");y.resetActiveCell()}return x};var m=function(y,w){var x=[];f.each(y,function(B,C){x.push(C)});var z=w.toLowerCase();var A=true;f.each(x,function(B,C){if(z.indexOf(C)===-1){A=false;return false}});return A};var u=function(){return f("#processor-type-filter").val()};var o=function(){f("#processor-tag-cloud").tagcloud("clearSelectedTags");f("#processor-bundle-group-combo").combo("setSelectedOption",{value:""});f("#processor-type-filter").val("");q();f("#processor-type-description").attr("title","").text("");f("#processor-type-name").attr("title","").text("");f("#processor-type-bundle").attr("title","").text("");f("#selected-processor-name").text("");f("#selected-processor-type").text("").removeData("bundle");var w=f("#processor-types-table").data("gridInstance");w.setSelectedRows([]);w.resetActiveCell()};var r=function(x,A,w,y){var z={revision:k.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:g.isDisconnectionAcknowledged(),component:{type:A,bundle:w,name:x,position:{x:y.x,y:y.y}}};f.ajax({type:"POST",url:n.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/processors",data:JSON.stringify(z),dataType:"json",contentType:"application/json"}).done(function(B){h.add({processors:[B]},{selectAll:true});h.updateVisibility();a.refresh()}).fail(j.handleAjaxError)};var p=function(w){return w.restricted===false||b.canAccessComponentRestrictions(w.explicitRestrictions)};function v(){this.icon="icon icon-processor";this.hoverIcon="icon icon-processor-add";this.modal={filter:{init:function(){var x=[{id:"type",name:"Type",field:"label",formatter:b.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:b.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:b.genericValueFormatter}];var A={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var y=new c.Data.DataView({inlineFilters:false});y.setItems([]);y.setFilterArgs({searchString:u()});y.setFilter(l);b.sortType({columnId:"type",sortAsc:true},y);var w=new c.Grid("#processor-types-table",y,x,A);w.setSelectionModel(new c.RowSelectionModel());w.registerPlugin(new c.AutoTooltips());w.setSortColumn("type",true);w.onSort.subscribe(function(C,B){b.sortType({columnId:B.sortCol.field,sortAsc:B.sortAsc},y)});w.onSelectedRowsChanged.subscribe(function(F,D){if(f.isArray(D.rows)&&D.rows.length===1){var B=D.rows[0];var G=w.getDataItem(B);if(b.isDefinedAndNotNull(G)){if(b.isBlank(G.description)){f("#processor-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{f("#processor-type-description").width(f("#processor-description-container").innerWidth()-1).html(G.description).ellipsis()}var C=b.formatBundle(G.bundle);var E=b.formatType(G);f("#processor-type-name").text(E).attr("title",E);f("#processor-type-bundle").text(C).attr("title",C);f("#selected-processor-name").text(G.label);f("#selected-processor-type").text(G.type).data("bundle",G.bundle);f("#new-processor-dialog").modal("refreshButtons")}}});w.onViewportChanged.subscribe(function(C,B){b.cleanUpTooltips(f("#processor-types-table"),"div.view-usage-restriction")});y.onRowCountChanged.subscribe(function(C,B){w.updateRowCount();w.render();f("#displayed-processor-types").text(B.current)});y.onRowsChanged.subscribe(function(C,B){w.invalidateRows(B.rows);w.render()});y.syncGridSelection(w,false);f("#processor-types-table").data("gridInstance",w).on("mouseenter","div.slick-cell",function(E){var F=f(this).find("div.view-usage-restriction");if(F.length&&!F.data("qtip")){var D=f(this).find("span.row-id").text();var C=y.getItemById(D);if(C.restricted===true){var G=f("<div></div>");if(b.isBlank(C.usageRestriction)){G.append(f('<p style="margin-bottom: 3px;"></p>').text("Requires the following permissions:"))}else{G.append(f('<p style="margin-bottom: 3px;"></p>').text(C.usageRestriction+" Requires the following permissions:"))}var B=[];if(b.isDefinedAndNotNull(C.explicitRestrictions)){f.each(C.explicitRestrictions,function(H,J){var I=J.requiredPermission;B.push("'"+I.label+"' - "+b.escapeHtml(J.explanation))})}else{B.push("Access to restricted components regardless of restrictions.")}G.append(b.formatUnorderedList(B));F.qtip(f.extend({},b.config.tooltipConfig,{content:G,position:{container:f("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});var z=b.getPolicyTypeListing("restricted-components");f.ajax({type:"GET",url:n.headerCtrl.toolboxCtrl.config.urls.processorTypes,dataType:"json"}).done(function(C){var E=[];var B=d3.set();var G=d3.map();var F=d3.map();y.beginUpdate();f.each(C.processorTypes,function(H,J){var I=J.type;if(J.restricted===true){if(b.isDefinedAndNotNull(J.explicitRestrictions)){f.each(J.explicitRestrictions,function(K,M){var L=M.requiredPermission;if(!F.has(L.id)){F.set(L.id,L.label)}if(!G.has(L.id)){G.set(L.id,[])}G.get(L.id).push({type:b.formatType(J),bundle:b.formatBundle(J.bundle),explanation:b.escapeHtml(M.explanation)})})}else{if(!F.has(z.value)){F.set(z.value,z.text)}if(!G.has(z.value)){G.set(z.value,[])}G.get(z.value).push({type:b.formatType(J),bundle:b.formatBundle(J.bundle),explanation:b.escapeHtml(J.usageRestriction)})}}B.add(J.bundle.group);y.addItem({id:H,label:b.substringAfterLast(I,"."),type:I,bundle:J.bundle,description:b.escapeHtml(J.description),restricted:J.restricted,usageRestriction:b.escapeHtml(J.usageRestriction),explicitRestrictions:J.explicitRestrictions,tags:J.tags.join(", ")});f.each(J.tags,function(L,K){E.push(K.toLowerCase())})});y.endUpdate();y.reSort();w.invalidate();d.addComponentRestrictions(G,F);f("#total-processor-types, #displayed-processor-types").text(C.processorTypes.length);f("#processor-tag-cloud").tagcloud({tags:E,select:q,remove:q});var D=[{text:"all groups",value:""}];B.each(function(H){D.push({text:H,value:H})});f("#processor-bundle-group-combo").combo({options:D,select:q})}).fail(j.handleAjaxError)}},getElement:function(){return f("#new-processor-dialog")},init:function(){this.filter.init();this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Processor",handler:{resize:function(){f("#processor-type-description").width(f("#processor-description-container").innerWidth()-1).text(f("#processor-type-description").attr("title")).ellipsis()}}})},update:function(x,w){this.getElement().modal(x,w)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}v.prototype={constructor:v,getElement:function(){return f("#processor-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(w){this.promptForProcessorType(w)},dragIcon:function(w){return f('<div class="icon icon-processor-add"></div>')},promptForProcessorType:function(C){var w=this;var A=function(){var E=f("#selected-processor-name").text();var F=f("#selected-processor-type").text();var D=f("#selected-processor-type").data("bundle");if(E===""||F===""){e.showOkDialog({headerText:"Add Processor",dialogContent:"The type of processor to create must be selected."})}else{r(E,F,D,C)}w.modal.hide()};var z=f("#processor-types-table").data("gridInstance");var x=z.getData();var y=function(E,D){var F=z.getDataItem(D.row);if(p(F)){f("#selected-processor-name").text(F.label);f("#selected-processor-type").text(F.type).data("bundle",F.bundle);A()}};z.onDblClick.subscribe(y);this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var D=z.getSelectedRows();if(D.length>0){var E=z.getDataItem(D[0]);return p(E)===false}else{return x.getLength()===0}},handler:{click:A}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#new-processor-dialog").modal("hide")}}}]);this.modal.update("setCloseHandler",function(){z.onDblClick.unsubscribe(y);o()});this.modal.show();var B=[f.ui.keyCode.UP,f.ui.keyCode.PAGE_UP,f.ui.keyCode.DOWN,f.ui.keyCode.PAGE_DOWN];f("#processor-type-filter").off("keyup").on("keyup",function(G){var F=G.keyCode?G.keyCode:G.which;if(f.inArray(F,B)!==-1){return}if(F===f.ui.keyCode.ENTER){var D=z.getSelectedRows();if(D.length>0){var E=z.getDataItem(D[0]);if(p(E)){A()}}}else{q()}});i.addKeydownListener("#processor-type-filter",z,x);z.resizeCanvas();if(x.getLength()>0){i.choseFirstRow(z)}f("#processor-type-filter").focus()}};var t=new v();return t}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(h,e,g,d,c,f,i){return(nf.ng.InputPortComponent=b(h,e,g,d,c,f,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.InputPortComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.InputPortComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(f,c,e,b,a,d,g){return function(k){var j=function(n,m){var l={revision:c.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:b.isDisconnectionAcknowledged(),component:{name:n,position:{x:m.x,y:m.y}}};f.ajax({type:"POST",url:k.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/input-ports",data:JSON.stringify(l),dataType:"json",contentType:"application/json"}).done(function(o){a.add({inputPorts:[o]},{selectAll:true});a.updateVisibility();e.refresh()}).fail(g.handleAjaxError)};function h(){this.icon="icon icon-port-in";this.hoverIcon="icon icon-port-in-add";this.modal={getElement:function(){return f("#new-port-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Port",handler:{close:function(){f("#new-port-name").val("")}}})},update:function(m,l){this.getElement().modal(m,l)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}h.prototype={constructor:h,getElement:function(){return f("#port-in-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(l){this.promptForInputPortName(l)},dragIcon:function(l){return f('<div class="icon icon-port-in-add"></div>')},promptForInputPortName:function(n){var m=this;var l=function(){var o=f("#new-port-name").val();m.modal.hide();j(o,n)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:l}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){m.modal.hide()}}}]);f("#new-port-type").text("Input");this.modal.show();f("#new-port-name").focus().off("keyup").on("keyup",function(p){var o=p.keyCode?p.keyCode:p.which;if(o===f.ui.keyCode.ENTER){l()}})}};var i=new h();return i}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(h,e,g,d,c,f,i){return(nf.ng.OutputPortComponent=b(h,e,g,d,c,f,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.OutputPortComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.OutputPortComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(f,c,e,b,a,d,g){return function(k){var i=function(n,m){var l={revision:c.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:b.isDisconnectionAcknowledged(),component:{name:n,position:{x:m.x,y:m.y}}};f.ajax({type:"POST",url:k.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/output-ports",data:JSON.stringify(l),dataType:"json",contentType:"application/json"}).done(function(o){a.add({outputPorts:[o]},{selectAll:true});a.updateVisibility();e.refresh()}).fail(g.handleAjaxError)};function h(){this.icon="icon icon-port-out";this.hoverIcon="icon icon-port-out-add";this.modal={getElement:function(){return f("#new-port-dialog")},init:function(){},update:function(m,l){this.getElement().modal(m,l)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}h.prototype={constructor:h,getElement:function(){return f("#port-out-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(l){this.promptForOutputPortName(l)},dragIcon:function(l){return f('<div class="icon icon-port-out-add"></div>')},promptForOutputPortName:function(m){var n=this;var l=function(){var o=f("#new-port-name").val();n.modal.hide();i(o,m)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:l}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){n.modal.hide()}}}]);f("#new-port-type").text("Output");this.modal.show();f("#new-port-name").focus().off("keyup").on("keyup",function(p){var o=p.keyCode?p.keyCode:p.which;if(o===f.ui.keyCode.ENTER){l()}})}};var j=new h();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Common","nf.Dialog"],function(g,k,c,h,i,e,j,d,f){return(nf.ng.GroupComponent=b(g,k,c,h,i,e,j,d,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.GroupComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog")))}else{nf.ng.GroupComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog)}}}(this,function(e,i,a,f,g,c,h,b,d){return function(m){var l=function(p,o){var n={revision:i.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{name:p,position:{x:o.x,y:o.y}}};return e.ajax({type:"POST",url:m.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/process-groups",data:JSON.stringify(n),dataType:"json",contentType:"application/json"}).done(function(q){g.add({processGroups:[q]},{selectAll:true});g.updateVisibility();a.refresh()}).fail(h.handleAjaxError)};function j(){this.icon="icon icon-group";this.hoverIcon="icon icon-group-add";this.modal={getElement:function(){return e("#new-process-group-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Process Group",handler:{close:function(){e("#new-process-group-name").val("");e("#new-process-group-dialog").removeData("pt")}}})},update:function(o,n){this.getElement().modal(o,n)},show:function(){this.getElement().modal("show")},storePt:function(n){e("#new-process-group-dialog").data("pt",n)},hide:function(){this.getElement().modal("hide")}}}j.prototype={constructor:j,getElement:function(){return e("#group-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(n){this.promptForGroupName(n,true)},dragIcon:function(n){return e('<div class="icon icon-group-add"></div>')},promptForGroupName:function(o,p){var n=this;return e.Deferred(function(q){var r=function(){var s=e("#new-process-group-name").val();n.modal.hide();if(b.isBlank(s)){d.showOkDialog({headerText:"Create Process Group",dialogContent:"The group name is required."});q.reject()}else{l(s,o).done(function(t){q.resolve(t.component)}).fail(function(){q.reject()})}};n.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:r}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){q.reject();n.modal.hide()}}}]);if(p===true&&b.canVersionFlows()){e("#import-process-group-link").show()}else{e("#import-process-group-link").hide()}n.modal.storePt(o);n.modal.show();e("#new-process-group-name").focus().off("keyup").on("keyup",function(t){var s=t.keyCode?t.keyCode:t.which;if(s===e.ui.keyCode.ENTER){r()}})}).promise()}};var k=new j();return k}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Common"],function(g,k,c,h,i,e,j,f,d){return(nf.ng.RemoteProcessGroupComponent=b(g,k,c,h,i,e,j,f,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.RemoteProcessGroupComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.RemoteProcessGroupComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(e,i,a,f,g,c,h,d,b){return function(m){var l=function(o){var n={revision:i.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{targetUris:e("#new-remote-process-group-uris").val(),position:{x:o.x,y:o.y},communicationsTimeout:e("#new-remote-process-group-timeout").val(),yieldDuration:e("#new-remote-process-group-yield-duration").val(),transportProtocol:e("#new-remote-process-group-transport-protocol-combo").combo("getSelectedOption").value,localNetworkInterface:e("#new-remote-process-group-local-network-interface").val(),proxyHost:e("#new-remote-process-group-proxy-host").val(),proxyPort:e("#new-remote-process-group-proxy-port").val(),proxyUser:e("#new-remote-process-group-proxy-user").val(),proxyPassword:e("#new-remote-process-group-proxy-password").val()}};e.ajax({type:"POST",url:m.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/remote-process-groups",data:JSON.stringify(n),dataType:"json",contentType:"application/json"}).done(function(p){g.add({remoteProcessGroups:[p]},{selectAll:true});e("#new-remote-process-group-dialog").modal("hide");g.updateVisibility();a.refresh()}).fail(function(s,p,q){if(s.status===400){var t=s.responseText.split("\n");var r;if(t.length===1){r=e("<span></span>").text(t[0])}else{r=b.formatUnorderedList(t)}d.showOkDialog({dialogContent:r,headerText:"Configuration Error"})}else{h.handleAjaxError(s,p,q)}})};function k(){this.icon="icon icon-group-remote";this.hoverIcon="icon icon-group-remote-add";this.modal={getElement:function(){return e("#new-remote-process-group-dialog")},init:function(){var n="30 sec";var o="10 sec";this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Remote Process Group",handler:{close:function(){e("#new-remote-process-group-uris").val("");e("#new-remote-process-group-timeout").val(n);e("#new-remote-process-group-yield-duration").val(o);e("#new-remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:"RAW"});e("#new-remote-process-group-local-network-interface").val("");e("#new-remote-process-group-proxy-host").val("");e("#new-remote-process-group-proxy-port").val("");e("#new-remote-process-group-proxy-user").val("");e("#new-remote-process-group-proxy-password").val("")}}});e("#new-remote-process-group-timeout").val(n);e("#new-remote-process-group-yield-duration").val(o);e("#new-remote-process-group-transport-protocol-combo").combo({options:[{text:"RAW",value:"RAW"},{text:"HTTP",value:"HTTP"}]})},update:function(o,n){this.getElement().modal(o,n)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}k.prototype={constructor:k,getElement:function(){return e("#group-remote-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(n){this.promptForRemoteProcessGroupUri(n)},dragIcon:function(n){return e('<div class="icon icon-group-remote-add"></div>')},promptForRemoteProcessGroupUri:function(p){var n=this;var o=function(){l(p)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:o}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){n.modal.hide()}}}]);this.modal.show();e("#new-remote-process-group-uris").focus().off("keyup").on("keyup",function(r){var q=r.keyCode?r.keyCode:r.which;if(q===e.ui.keyCode.ENTER){o()}})}};var j=new k();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(h,e,g,d,c,f,i){return(nf.ng.FunnelComponent=b(h,e,g,d,c,f,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.FunnelComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.FunnelComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(f,c,e,b,a,d,g){return function(i){function h(){this.icon="icon icon-funnel";this.hoverIcon="icon icon-funnel-add"}h.prototype={constructor:h,getElement:function(){return f("#funnel-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(k){this.createFunnel(k)},dragIcon:function(k){return f('<div class="icon icon-funnel-add"></div>')},createFunnel:function(l){var k={revision:c.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:b.isDisconnectionAcknowledged(),component:{position:{x:l.x,y:l.y}}};f.ajax({type:"POST",url:i.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/funnels",data:JSON.stringify(k),dataType:"json",contentType:"application/json"}).done(function(m){a.add({funnels:[m]},{selectAll:true});a.updateVisibility();e.refresh()}).fail(g.handleAjaxError)}};var j=new h();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Common"],function(g,k,c,h,i,e,j,f,d){return(nf.ng.TemplateComponent=b(g,k,c,h,i,e,j,f,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.TemplateComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.TemplateComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(e,i,a,f,g,c,h,d,b){return function(l){var k=function(o,p){var n={templateId:o,originX:p.x,originY:p.y,disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged()};e.ajax({type:"POST",url:l.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/template-instance",data:JSON.stringify(n),dataType:"json",contentType:"application/json"}).done(function(q){g.add(q.flow,{selectAll:true});g.updateVisibility();a.refresh()}).fail(h.handleAjaxError)};function j(){this.icon="icon icon-template";this.hoverIcon="icon icon-template-add";this.modal={getElement:function(){return e("#instantiate-template-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Template"})},update:function(o,n){this.getElement().modal(o,n)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}j.prototype={constructor:j,getElement:function(){return e("#template-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(n){this.promptForTemplate(n)},dragIcon:function(n){return e('<div class="icon icon-template-add"></div>')},promptForTemplate:function(n){var o=this;e.ajax({type:"GET",url:l.headerCtrl.toolboxCtrl.config.urls.api+"/flow/templates",dataType:"json"}).done(function(p){var r=p.templates;if(b.isDefinedAndNotNull(r)&&r.length>0){r=r.sort(function(t,s){var v=b.parseDateTime(t.template.timestamp);var u=b.parseDateTime(s.template.timestamp);return u.getTime()-v.getTime()});var q=[];e.each(r,function(s,t){if(t.permissions.canRead===true){q.push({text:t.template.name,value:t.id,description:b.escapeHtml(t.template.description)})}});e("#available-templates").combo({maxHeight:300,options:q});o.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var t=e("#available-templates").combo("getSelectedOption");var s=t.value;o.modal.hide();k(s,n)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){o.modal.hide()}}}]);o.modal.show()}else{d.showOkDialog({headerText:"Instantiate Template",dialogContent:"No templates have been loaded into this NiFi."})}}).fail(h.handleAjaxError)}};var m=new j();return m}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Label"],function(h,e,g,d,c,f,i,j){return(nf.ng.LabelComponent=b(h,e,g,d,c,f,i,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.LabelComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Label")))}else{nf.ng.LabelComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Label)}}}(this,function(f,c,e,b,a,d,g,h){return function(k){function j(){this.icon="icon icon-label";this.hoverIcon="icon icon-label-add"}j.prototype={constructor:j,getElement:function(){return f("#label-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(l){this.createLabel(l)},dragIcon:function(l){return f('<div class="icon icon-label-add"></div>')},createLabel:function(m){var l={revision:c.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:b.isDisconnectionAcknowledged(),component:{width:h.config.width,height:h.config.height,position:{x:m.x,y:m.y}}};f.ajax({type:"POST",url:k.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/labels",data:JSON.stringify(l),dataType:"json",contentType:"application/json"}).done(function(n){a.add({labels:[n]},{selectAll:true});a.updateVisibility();e.refresh()}).fail(g.handleAjaxError)}};var i=new j();return i}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.BreadcrumbsDirective=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.BreadcrumbsDirective=b())}else{nf.ng.BreadcrumbsDirective=b()}}}(this,function(){return function(a){return{restrict:"E",templateUrl:"views/nf-ng-breadcrumbs-directive-view.html",scope:{breadcrumbs:"=",clickFunc:"=",highlightCrumbId:"=",separatorFunc:"=",isTracking:"=",getVersionControlClass:"=",getVersionControlTooltip:"="},link:function(d,c,b){a.registerMouseWheelEvent(c)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.DraggableDirective=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.DraggableDirective=b())}else{nf.ng.DraggableDirective=b()}}}(this,function(){return function(){return{restrict:"AE",link:function(c,b,a){b.draggable(c.$eval(a.nfDraggable))}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.ng.Bridge","nf.Common","nf.CanvasUtils","nf.ClusterSummary","nf.Actions"],function(e,f,g,c,d){return(nf.ng.AppCtrl=b(e,f,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppCtrl=b(require("nf.ng.Bridge"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.ClusterSummary"),require("nf.Actions")))}else{nf.ng.AppCtrl=b(a.nf.ng.Bridge,a.nf.CanvasUtils,a.nf.Common,a.nf.ClusterSummary,a.nf.Actions)}}}(this,function(c,d,e,a,b){return function(g,i){function f(j){this.nf={Common:e,ClusterSummary:a,Actions:b,CanvasUtils:d,};this.serviceProvider=j}f.prototype={constructor:f};var h=new f(i);g.appCtrl=h;c.rootScope=g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.AppConfig=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppConfig=b())}else{nf.ng.AppConfig=b()}}}(this,function(){return function(a,b){b.debugInfoEnabled(false);a.definePalette("basePalette",{"50":"728E9B","100":"728E9B","200":"004849","300":"775351","400":"728E9B","500":"728E9B","600":"728E9B","700":"728E9B","800":"728E9B","900":"rgba(249,250,251,0.97)",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("tintPalette",{"50":"728E9B","100":"728E9B","200":"CCDADB","300":"728E9B","400":"AABBC3","500":"728E9B","600":"C7D2D7","700":"728E9B","800":"E3E8EB","900":"728E9B",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("warnPalette",{"50":"BA554A","100":"BA554A","200":"BA554A","300":"BA554A","400":"BA554A","500":"BA554A","600":"BA554A","700":"BA554A","800":"BA554A","900":"BA554A",A100:"BA554A",A200:"BA554A",A400:"BA554A",A700:"BA554A",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.theme("default").primaryPalette("basePalette",{"default":"500","hue-1":"200","hue-2":"300","hue-3":"900"}).accentPalette("tintPalette",{"default":"200","hue-1":"400","hue-2":"600","hue-3":"800"}).warnPalette("warnPalette",{"default":"500"})}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","angular","nf.Common","nf.CanvasUtils","nf.ErrorHandler","nf.Client","nf.Dialog","nf.Storage","nf.Canvas","nf.Graph","nf.ContextMenu","nf.QuickSelect","nf.Shell","nf.Settings","nf.Snippet","nf.Actions","nf.QueueListing","nf.VariableRegistry","nf.ComponentState","nf.FlowVersion","nf.ComponentVersion","nf.Draggable","nf.Connectable","nf.StatusHistory","nf.Birdseye","nf.ConnectionConfiguration","nf.ControllerService","nf.ReportingTask","nf.PolicyManagement","nf.ProcessorConfiguration","nf.ProcessGroupConfiguration","nf.ControllerServices","nf.RemoteProcessGroupConfiguration","nf.RemoteProcessGroupPorts","nf.PortConfiguration","nf.LabelConfiguration","nf.ProcessorDetails","nf.PortDetails","nf.ConnectionDetails","nf.RemoteProcessGroupDetails","nf.GoTo","nf.ng.Bridge","nf.ng.AppCtrl","nf.ng.AppConfig","nf.ng.ServiceProvider","nf.ng.BreadcrumbsCtrl","nf.ng.Canvas.HeaderCtrl","nf.ng.Canvas.FlowStatusCtrl","nf.ng.Canvas.GlobalMenuCtrl","nf.ng.Canvas.ToolboxCtrl","nf.ng.ProcessorComponent","nf.ng.InputPortComponent","nf.ng.OutputPortComponent","nf.ng.GroupComponent","nf.ng.RemoteProcessGroupComponent","nf.ng.FunnelComponent","nf.ng.TemplateComponent","nf.ng.LabelComponent","nf.ng.Canvas.GraphControlsCtrl","nf.ng.Canvas.NavigateCtrl","nf.ng.Canvas.OperateCtrl","nf.ng.BreadcrumbsDirective","nf.ng.DraggableDirective"],function(P,D,aa,ak,f,m,q,z,G,x,H,X,Z,U,E,al,M,p,h,B,A,C,O,ae,l,v,ab,Q,I,aj,S,V,N,c,R,J,d,y,w,ad,k,t,j,L,ac,o,g,e,s,ag,Y,F,K,am,af,ai,W,u,T,i,ah,n,r){return b(P,D,aa,ak,f,m,q,z,G,x,H,X,Z,U,E,al,M,p,h,B,A,C,O,ae,l,v,ab,Q,I,aj,S,V,N,c,R,J,d,y,w,ad,k,t,j,L,ac,o,g,e,s,ag,Y,F,K,am,af,ai,W,u,T,i,ah,n,r)})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=b(require("jquery"),require("angular"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Client"),require("nf.Dialog"),require("f.Storage"),require("nf.Canvas"),require("nf.Graph"),require("nf.ContextMenu"),require("nf.QuickSelect"),require("nf.Shell"),require("nf.Settings"),require("nf.Actions"),require("nf.Snippet"),require("nf.QueueListing"),require("nf.VariableRegistry"),require("nf.ComponentState"),require("nf.FlowVersion"),require("nf.ComponentVersion"),require("nf.Draggable"),require("nf.Connectable"),require("nf.StatusHistory"),require("nf.Birdseye"),require("nf.ConnectionConfiguration"),require("nf.ControllerService"),require("nf.ReportingTask"),require("nf.PolicyManagement"),require("nf.ProcessorConfiguration"),require("nf.ProcessGroupConfiguration"),require("nf.ControllerServices"),require("nf.RemoteProcessGroupConfiguration"),require("nf.RemoteProcessGroupPorts"),require("nf.PortConfiguration"),require("nf.LabelConfiguration"),require("nf.ProcessorDetails"),require("nf.PortDetails"),require("nf.ConnectionDetails"),require("nf.RemoteProcessGroupDetails"),require("nf.GoTo"),require("nf.ng.Bridge"),require("nf.ng.AppCtrl"),require("nf.ng.AppConfig"),require("nf.ng.ServiceProvider"),require("nf.ng.BreadcrumbsCtrl"),require("nf.ng.Canvas.HeaderCtrl"),require("nf.ng.Canvas.FlowStatusCtrl"),require("nf.ng.Canvas.GlobalMenuCtrl"),require("nf.ng.Canvas.ToolboxCtrl"),require("nf.ng.ProcessorComponent"),require("nf.ng.InputPortComponent"),require("nf.ng.OutputPortComponent"),require("nf.ng.GroupComponent"),require("nf.ng.RemoteProcessGroupComponent"),require("nf.ng.FunnelComponent"),require("nf.ng.TemplateComponent"),require("nf.ng.LabelComponent"),require("nf.ng.Canvas.GraphControlsCtrl"),require("nf.ng.Canvas.NavigateCtrl"),require("nf.ng.Canvas.OperateCtrl"),require("nf.ng.BreadcrumbsDirective"),require("nf.ng.DraggableDirective"))}else{b(a.$,a.angular,a.nf.Common,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Client,a.nf.Dialog,a.nf.Storage,a.nf.Canvas,a.nf.Graph,a.nf.ContextMenu,a.nf.QuickSelect,a.nf.Shell,a.nf.Settings,a.nf.Actions,a.nf.Snippet,a.nf.QueueListing,a.nf.VariableRegistry,a.nf.ComponentState,a.nf.FlowVersion,a.nf.ComponentVersion,a.nf.Draggable,a.nf.Connectable,a.nf.StatusHistory,a.nf.Birdseye,a.nf.ConnectionConfiguration,a.nf.ControllerService,a.nf.ReportingTask,a.nf.PolicyManagement,a.nf.ProcessorConfiguration,a.nf.ProcessGroupConfiguration,a.nf.ControllerServices,a.nf.RemoteProcessGroupConfiguration,a.nf.RemoteProcessGroupPorts,a.nf.PortConfiguration,a.nf.LabelConfiguration,a.nf.ProcessorDetails,a.nf.PortDetails,a.nf.ConnectionDetails,a.nf.RemoteProcessGroupDetails,a.nf.GoTo,a.nf.ng.Bridge,a.nf.ng.AppCtrl,a.nf.ng.AppConfig,a.nf.ng.ServiceProvider,a.nf.ng.BreadcrumbsCtrl,a.nf.ng.Canvas.HeaderCtrl,a.nf.ng.Canvas.FlowStatusCtrl,a.nf.ng.Canvas.GlobalMenuCtrl,a.nf.ng.Canvas.ToolboxCtrl,a.nf.ng.ProcessorComponent,a.nf.ng.InputPortComponent,a.nf.ng.OutputPortComponent,a.nf.ng.GroupComponent,a.nf.ng.RemoteProcessGroupComponent,a.nf.ng.FunnelComponent,a.nf.ng.TemplateComponent,a.nf.ng.LabelComponent,a.nf.ng.Canvas.GraphControlsCtrl,a.nf.ng.Canvas.NavigateCtrl,a.nf.ng.Canvas.OperateCtrl,a.nf.ng.BreadcrumbsDirective,a.nf.ng.DraggableDirective)}}}(this,function(N,B,Z,aj,d,k,o,x,E,v,F,W,Y,S,C,ak,K,n,f,z,y,A,M,ad,j,t,aa,O,G,ai,Q,U,L,a,P,H,b,w,u,ac,i,r,h,J,ab,m,e,c,q,af,X,D,I,al,ae,ah,V,s,R,g,ag,l,p){var T={urls:{flowConfig:"../nifi-api/flow/config"}};N(document).ready(function(){if(E.SUPPORTS_SVG){var an=B.module("ngCanvasApp",["ngResource","ngRoute","ngMaterial","ngMessages"]);J.$inject=["$mdThemingProvider","$compileProvider"];h.$inject=["$scope","serviceProvider","$compile","headerCtrl","graphControlsCtrl"];ab.$inject=[];m.$inject=["serviceProvider"];e.$inject=["serviceProvider","toolboxCtrl","globalMenuCtrl","flowStatusCtrl"];c.$inject=["serviceProvider"];q.$inject=["serviceProvider"];af.$inject=["processorComponent","inputPortComponent","outputPortComponent","groupComponent","remoteGroupComponent","funnelComponent","templateComponent","labelComponent"];X.$inject=["serviceProvider"];D.$inject=["serviceProvider"];I.$inject=["serviceProvider"];al.$inject=["serviceProvider"];ae.$inject=["serviceProvider"];ah.$inject=["serviceProvider"];V.$inject=["serviceProvider"];s.$inject=["serviceProvider"];R.$inject=["serviceProvider","navigateCtrl","operateCtrl"];g.$inject=["$timeout"];ag.$inject=[];l.$inject=["breadcrumbsCtrl"];p.$inject=[];an.config(J);an.controller("ngCanvasAppCtrl",h);an.service("serviceProvider",ab);an.service("breadcrumbsCtrl",m);an.service("headerCtrl",e);an.service("flowStatusCtrl",c);an.service("globalMenuCtrl",q);an.service("toolboxCtrl",af);an.service("processorComponent",X);an.service("inputPortComponent",D);an.service("outputPortComponent",I);an.service("groupComponent",al);an.service("remoteGroupComponent",ae);an.service("funnelComponent",ah);an.service("templateComponent",V);an.service("labelComponent",s);an.service("graphControlsCtrl",R);an.service("navigateCtrl",g);an.service("operateCtrl",ag);an.directive("nfBreadcrumbs",l);an.directive("nfDraggable",p);aj.init(E,C,ak,j,v);r.injector=B.bootstrap(N("body"),["ngCanvasApp"],{strictDi:true});var am=E.init();am.done(function(){var ao=k.init();var ap=N.ajax({type:"GET",url:T.urls.flowConfig,dataType:"json"});N.when(ap,am,ao).done(function(at){var au=at[0];var av=N("#canvas-container");E.CANVAS_OFFSET=av.offset().top;var ar=au.flowConfiguration;var aq=parseInt(ar.autoRefreshIntervalSeconds,10);E.setManagedAuthorizer(ar.supportsManagedAuthorizer);E.setConfigurableAuthorizer(ar.supportsConfigurableAuthorizer);E.setConfigurableUsersAndGroups(ar.supportsConfigurableUsersAndGroups);x.init();E.initCanvas();E.View.init();F.init(C);W.init(C);Y.init(F);r.injector.get("headerCtrl").init();S.init();C.init();K.init();n.init();f.init();z.init(ar.timeOffset);y.init(S);A.init();M.init();ad.init(ar.timeOffset);j.init(v);t.init(j,v,ar.defaultBackPressureObjectThreshold,ar.defaultBackPressureDataSizeThreshold);aa.init(U,O);O.init(S);G.init();ai.init();Q.init(U);L.init();a.init();P.init();H.init();b.init(true);w.init();u.init();ac.init();i.init();v.init().done(function(){r.injector.get("graphControlsCtrl").init();var aw=aq/2;setTimeout(function(){E.startPolling(aq)},aw*1000);E.hideSplash()}).fail(d.handleAjaxError)}).fail(d.handleAjaxError)}).fail(d.handleAjaxError);N(".component-button").qtip(N.extend({},Z.config.tooltipConfig,{position:{at:"bottom center",my:"top center",adjust:{y:5}}}))}else{N("#message-title").text("Unsupported Browser");N("#message-content").text("Flow graphs are shown using SVG. Please use a browser that supports rendering SVG.");N("#message-pane").show();E.hideSplash()}})}));
