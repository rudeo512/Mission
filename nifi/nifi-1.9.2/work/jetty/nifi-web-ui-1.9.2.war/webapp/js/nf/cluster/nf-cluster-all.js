(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.Dialog=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Dialog=b(require("jquery")))}else{nf.Dialog=b(a.$)}}}(this,function(b){b(document).ready(function(){b("#nf-ok-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-ok-dialog-content").empty()}}});b("#nf-yes-no-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-yes-no-dialog-content").empty();b("#nf-yes-no-dialog").modal("setButtonModel",[])}}})});var a={showOkDialog:function(c){c=b.extend({headerText:"",dialogContent:""},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-ok-dialog-content").append(d).append("</br>");b("#nf-ok-dialog").modal("setButtonModel",[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-ok-dialog").modal("hide");if(typeof c.okHandler==="function"){c.okHandler.call(this)}}}}]);b("#nf-ok-dialog").modal("setHeaderText",c.headerText).modal("show")},showYesNoDialog:function(c){c=b.extend({headerText:"",dialogContent:"",yesText:"Yes",noText:"No"},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-yes-no-dialog-content").append(d);b("#nf-yes-no-dialog").modal("setButtonModel",[{buttonText:c.yesText,color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.yesHandler==="function"){c.yesHandler.call(this)}}}},{buttonText:c.noText,color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.noHandler==="function"){c.noHandler.call(this)}}}}]);b("#nf-yes-no-dialog").modal("setHeaderText",c.headerText).modal("show")},showDisconnectedFromClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node is currently not connected to the cluster. Any modifications to the data flow made here will not replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})},showConnectedToClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node just joined the cluster. Any modifications to the data flow made here will replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.Storage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Storage=b())}else{nf.Storage=b()}}}(this,function(){var h=false;var g=86400000;var f=g*2;var b=function(i){return typeof i==="undefined"};var e=function(i){return i===null};var d=function(i){return !b(i)&&!e(i)};var c=function(k){if(d(k.expires)){var i=new Date(k.expires);var j=new Date();return i.valueOf()<j.valueOf()}else{return false}};var a=function(i){try{var j=JSON.parse(localStorage.getItem(i));if(d(j)){return j}else{return null}}catch(k){return null}};return{init:function(){for(var k=0;k<localStorage.length;k++){try{var j=localStorage.key(k);this.getItem(j)}catch(l){}}},acknowledgeDisconnection:function(){h=true},resetDisconnectionAcknowledgement:function(){h=false},isDisconnectionAcknowledged:function(){return h},setItem:function(j,l,i){i=d(i)?i:new Date().valueOf()+f;var k={expires:i,item:l};localStorage.setItem(j,JSON.stringify(k))},hasItem:function(i){return a(i)!==null},getItem:function(i){var j=a(i);if(j===null){return null}if(c(j)){this.removeItem(i);return null}if(d(j.item)){return j.item}else{return null}},getItemExpiration:function(i){var j=a(i);if(j===null){return null}if(d(j.expires)){return j.expires}else{return null}},removeItem:function(i){localStorage.removeItem(i)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage"],function(e,d,c){return(nf.Common=b(e,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Common=b(require("jquery"),require("d3"),require("nf.Storage")))}else{nf.Common=b(a.$,a.d3,a.nf.Storage)}}}(this,function(e,d,b){e(document).ready(function(){var g="images/bg-error.png";e("<img/>").attr("src",g).on("load",function(){e("div.message-pane").css("background-image",g)});e(document).on("mouseenter","span.link",function(){e(this).addClass("link-over")}).on("mouseleave","span.link",function(){e(this).removeClass("link-over")});e(document).on("click","div.nf-checkbox",function(){var h=e(this);if(h.hasClass("checkbox-unchecked")){h.removeClass("checkbox-unchecked").addClass("checkbox-checked")}else{h.removeClass("checkbox-checked").addClass("checkbox-unchecked")}h.trigger("change")});e(document).on("click",".nf-checkbox-label",function(h){e(h.target).parent().find(".nf-checkbox").click()});e(document).ajaxStart(function(){e("div.loading-container").addClass("ajax-loading")}).ajaxStop(function(){e("div.loading-container").removeClass("ajax-loading")});if(b.getItem("jwt")!==null){e("#user-logout-container").css("display","block");f.scheduleTokenRefresh()}e("#user-logout").on("click",function(){b.removeItem("jwt");window.location="../nifi/logout"});e("#user-home").on("click",function(){if(top!==window){parent.window.location="../nifi"}else{window.location="../nifi"}})});var c=null;var a=[{text:"view the user interface",value:"flow",description:"Allows users to view the user interface"},{text:"access the controller",value:"controller",description:"Allows users to view/modify the controller including Reporting Tasks, Controller Services, and Nodes in the Cluster"},{text:"query provenance",value:"provenance",description:"Allows users to submit a Provenance Search and request Event Lineage"},{text:"access restricted components",value:"restricted-components",description:"Allows users to create/modify restricted components assuming other permissions are sufficient"},{text:"access all policies",value:"policies",description:"Allows users to view/modify the policies for all components"},{text:"access users/user groups",value:"tenants",description:"Allows users to view/modify the users and user groups"},{text:"retrieve site-to-site details",value:"site-to-site",description:"Allows other NiFi instances to retrieve Site-To-Site details of this NiFi"},{text:"view system diagnostics",value:"system",description:"Allows users to view System Diagnostics"},{text:"proxy user requests",value:"proxy",description:"Allows proxy machines to send requests on the behalf of others"},{text:"access counters",value:"counters",description:"Allows users to view/modify Counters"}];var f={ANONYMOUS_USER_TEXT:"Anonymous user",config:{sensitiveText:"Sensitive value set",tooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:function(g){e(this).slideDown(100)}},hide:{effect:function(g){e(this).slideUp(100)}},position:{at:"top center",my:"bottom center"}}},SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,currentUser:undefined,sortVersion:function(g,r){if(g===r){return 0}var n=g.split(/-/);var s=r.split(/-/);if(n.length>=1&&s.length>=1){var p=n[0].split(/\./);var m=s[0].split(/\./);if(p.length>=1&&m.length>=1){var k=Math.min(p.length,m.length);for(var l=0;l<k;l++){var q=parseInt(p[l],10);var j=parseInt(m[l],10);if(isNaN(q)&&isNaN(j)){continue}else{if(isNaN(q)){return -1}else{if(isNaN(j)){return 1}}}if(q!==j){return q-j}}if(p.length===m.length){if(n.length===s.length){var o=f.substringAfterFirst(g,n[0]);var h=f.substringAfterFirst(r,s[0]);return o===h?0:o>h?1:-1}else{return s.length-n.length}}else{return p.length-m.length}}else{if(p.length>=1){return 1}else{if(m.length>=1){return -1}else{return 0}}}}else{if(n.length>=1){return 1}else{if(s.length>=1){return -1}else{return 0}}}},sortType:function(g,j){var h=function(m,k){var n=f.formatBundle(m.bundle);var l=f.formatBundle(k.bundle);return n===l?0:n>l?1:-1};var i=function(r,q){if(g.columnId==="version"){var p=f.isDefinedAndNotNull(r.bundle[g.columnId])?r.bundle[g.columnId]:"";var n=f.isDefinedAndNotNull(q.bundle[g.columnId])?q.bundle[g.columnId]:"";var l=f.sortVersion(p,n);return l===0?h(r,q):l}else{if(g.columnId==="type"){var o=f.substringAfterLast(r[g.columnId],".");var m=f.substringAfterLast(q[g.columnId],".");return o===m?0:o>m?1:-1}else{var k=f.isDefinedAndNotNull(r[g.columnId])?r[g.columnId]:"";var s=f.isDefinedAndNotNull(q[g.columnId])?q[g.columnId]:"";return k===s?h(r,q):k>s?1:-1}}};j.sort(i,g.sortAsc)},typeFormatter:function(l,h,k,j,g){var i="";if(g.restricted===true){i+='<div class="view-usage-restriction fa fa-shield"></div><span class="hidden row-id">'+f.escapeHtml(g.id)+"</span>"}else{i+='<div class="fa"></div>'}i+=f.escapeHtml(k);return i},genericValueFormatter:function(k,h,j,i,g){return f.escapeHtml(j)},typeBundleFormatter:function(k,h,j,i,g){return f.escapeHtml(f.formatBundle(g.bundle))},typeVersionFormatter:function(l,h,k,j,g){var i="";if(f.isDefinedAndNotNull(g.bundle)){i+=('<div style="float: left;">'+f.escapeHtml(g.bundle.version)+"</div>")}else{i+='<div style="float: left;">unversioned</div>'}if(!f.isEmpty(g.controllerServiceApis)){i+='<div class="controller-service-apis fa fa-list" title="Compatible Controller Service" style="margin-left: 4px;"></div><span class="hidden row-id">'+f.escapeHtml(g.id)+"</span>"}i+='<div class="clear"></div>';return i},instanceTypeFormatter:function(k,h,j,i,g){if(!g.permissions.canRead){return""}return f.escapeHtml(f.formatType(g.component))},instanceBundleFormatter:function(k,h,j,i,g){if(!g.permissions.canRead){return""}return f.typeBundleFormatter(k,h,j,i,g.component)},getVersionControlTooltip:function(g){return g.stateExplanation},formatClassName:function(g){return f.substringAfterLast(g.type,".")},formatType:function(g){var h=f.formatClassName(g);if(g.bundle.version!=="unversioned"){h+=(" "+g.bundle.version)}return h},formatBundle:function(g){var h="";if(g.group!=="default"){h=g.group+" - "}return h+g.artifact},setCurrentUser:function(g){f.currentUser=g},scheduleTokenRefresh:function(){if(c!==null){clearInterval(c)}var g=f.MILLIS_PER_MINUTE;var h=function(){var j=b.getItemExpiration("jwt");if(j!==null){var l=new Date(j);var k=new Date();var i=l.valueOf()-k.valueOf()-(30*f.MILLIS_PER_SECOND);if(i<g){if(e("#current-user").text()!==f.ANONYMOUS_USER_TEXT&&!e("#anonymous-user-alert").is(":visible")){e("#anonymous-user-alert").show().qtip(e.extend({},f.config.tooltipConfig,{content:"Your session will expire soon. Please log in again to avoid being automatically logged out.",position:{my:"top right",at:"bottom left"}}))}}}};h();c=setInterval(h,g)},setAnonymousUserLabel:function(){var g=e("#anonymous-user-alert");if(g.data("qtip")){g.qtip("api").destroy(true)}g.show().qtip(e.extend({},f.config.tooltipConfig,{content:"You are accessing with limited authority. Log in or request an account to access with additional authority granted to you by an administrator.",position:{my:"top right",at:"bottom left"}}));e("#current-user").text(f.ANONYMOUS_USER_TEXT).show()},getJwtPayload:function(h){if(f.isDefinedAndNotNull(h)){var g=h.split(/\./);if(g.length!==3){return""}var j=e.base64.atob(g[1]);var i=JSON.parse(j);if(f.isDefinedAndNotNull(i)){return i}else{return null}}return null},canVersionFlows:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.canVersionFlows===true}else{return false}},canAccessProvenance:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.provenancePermissions.canRead===true}else{return false}},canAccessRestrictedComponents:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.restrictedComponentsPermissions.canWrite===true}else{return false}},canAccessComponentRestrictions:function(h){if(f.isDefinedAndNotNull(f.currentUser)){if(f.currentUser.restrictedComponentsPermissions.canWrite===true){return true}var g=function(k){if(f.isEmpty(f.currentUser.componentRestrictionPermissions)){return false}var j=false;e.each(f.currentUser.componentRestrictionPermissions,function(l,m){if(m.requiredPermission.id===k.id){if(m.permissions.canWrite===true){j=true;return false}}});return j};var i=true;if(f.isEmpty(h)){i=false}else{e.each(h,function(j,k){if(!g(k.requiredPermission)){i=false;return false}})}return i}else{return false}},canAccessCounters:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.countersPermissions.canRead===true}else{return false}},canModifyCounters:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.countersPermissions.canRead===true&&f.currentUser.countersPermissions.canWrite===true}else{return false}},canAccessTenants:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.tenantsPermissions.canRead===true}else{return false}},canModifyTenants:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.tenantsPermissions.canRead===true&&f.currentUser.tenantsPermissions.canWrite===true}else{return false}},canAccessPolicies:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.policiesPermissions.canRead===true}else{return false}},canModifyPolicies:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.policiesPermissions.canRead===true&&f.currentUser.policiesPermissions.canWrite===true}else{return false}},canAccessController:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.controllerPermissions.canRead===true}else{return false}},canModifyController:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.controllerPermissions.canRead===true&&f.currentUser.controllerPermissions.canWrite===true}else{return false}},canAccessSystem:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.systemPermissions.canRead===true}else{return false}},addHoverEffect:function(g,i,h){e(document).on("mouseenter",g,function(){e(this).removeClass(i).addClass(h)}).on("mouseleave",g,function(){e(this).removeClass(h).addClass(i)});return e(g).addClass(i)},toggleScrollable:function(g){if(e(g).is(":visible")){if(g.offsetHeight<g.scrollHeight||g.offsetWidth<g.scrollWidth){e(g).addClass("scrollable")}else{e(g).removeClass("scrollable")}}},determineContrastColor:function(g){if(parseInt(g,16)>16777215/1.5){return"#000000"}return"#ffffff"},showLogoutLink:function(){if(b.getItem("jwt")===null){e("#user-logout-container").css("display","none")}else{e("#user-logout-container").css("display","block")}},isContentViewConfigured:function(){var g=e("#nifi-content-viewer-url").text();return !f.isBlank(g)},populateField:function(h,g){if(f.isUndefined(g)||f.isNull(g)){return e("#"+h).addClass("unset").text("No value set")}else{if(g===""){return e("#"+h).addClass("blank").text("Empty string set")}else{return e("#"+h).text(g)}}},clearField:function(g){return e("#"+g).removeClass("unset blank").text("")},cleanUpTooltips:function(g,h){g.find(h).each(function(){var j=e(this);if(j.data("qtip")){var i=j.qtip("api");i.destroy(true)}})},formatPropertyTooltip:function(h,j){var k=[];if(f.isDefinedAndNotNull(h)){if(!f.isBlank(h.description)){k.push(f.escapeHtml(h.description))}if(!f.isBlank(h.defaultValue)){k.push("<b>Default value:</b> "+f.escapeHtml(h.defaultValue))}if(!f.isBlank(h.supportsEl)){k.push("<b>Expression language scope:</b> "+f.escapeHtml(h.expressionLanguageScope))}if(!f.isBlank(h.identifiesControllerService)){var g=f.formatType({type:h.identifiesControllerService,bundle:h.identifiesControllerServiceBundle});var i=f.formatBundle(h.identifiesControllerServiceBundle);k.push("<b>Requires Controller Service:</b> "+f.escapeHtml(g+" from "+i))}}if(f.isDefinedAndNotNull(j)){if(!f.isEmpty(j.previousValues)){var l=[];e.each(j.previousValues,function(n,m){l.push("<li>"+f.escapeHtml(m.previousValue)+" - "+f.escapeHtml(m.timestamp)+" ("+f.escapeHtml(m.userIdentity)+")</li>")});k.push('<b>History:</b><ul class="property-info">'+l.join("")+"</ul>")}}if(k.length>0){return k.join("<br/><br/>")}else{return null}},formatProperty:function(g,h){return'<div><span class="label">'+f.formatValue(g)+": </span>"+f.formatValue(h)+"</div>"},formatValue:function(g){if(f.isDefinedAndNotNull(g)){if(g===""){return'<span class="blank" style="font-size: 13px; padding-top: 2px;">Empty string set</span>'}else{return f.escapeHtml(g)}}else{return'<span class="unset" style="font-size: 13px; padding-top: 2px;">No value set</span>'}},escapeHtml:(function(){var g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2f;"};return function(h){if(f.isDefinedAndNotNull(h)){return String(h).replace(/[&<>"'\/]/g,function(i){return g[i]})}else{return""}}}()),isSensitiveProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.sensitive===true}else{return false}},isRequiredProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.required===true}else{return false}},isDynamicProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.dynamic===true}else{return false}},getAllowableValues:function(g){if(f.isDefinedAndNotNull(g)){return g.allowableValues}else{return null}},supportsEl:function(g){if(f.isDefinedAndNotNull(g)){return g.supportsEl===true}else{return false}},formatUnorderedList:function(h){if(e.isArray(h)){var g=e('<ul class="result"></ul>');e.each(h,function(j,k){var i=e("<li></li>").appendTo(g);if(k instanceof jQuery){i.append(k)}else{i.text(k)}});return g}else{return null}},substringAfterLast:function(k,j){var h="";var i=k.lastIndexOf(j);if(i>=0){var g=i+j.length;if(g<k.length){h=k.substr(g)}}return h},substringAfterFirst:function(k,j){var h="";var i=k.indexOf(j);if(i>=0){var g=i+j.length;if(g<k.length){h=k.substr(g)}}return h},substringBeforeLast:function(j,i){var g="";var h=j.lastIndexOf(i);if(h>=0){g=j.substr(0,h)}return g},substringBeforeFirst:function(j,i){var g="";var h=j.indexOf(i);if(h>=0){g=j.substr(0,h)}return g},setCursor:function(h,g){if(g){e("#"+h).addClass("pointer")}else{e("#"+h).removeClass("pointer")}},getAccessToken:function(g){return e.Deferred(function(h){if(b.hasItem("jwt")){e.ajax({type:"POST",url:g}).done(function(i){h.resolve(i)}).fail(function(){h.reject()})}else{h.resolve("")}}).promise()},MILLIS_PER_DAY:86400000,MILLIS_PER_HOUR:3600000,MILLIS_PER_MINUTE:60000,MILLIS_PER_SECOND:1000,loadBalanceStrategyOptions:[{text:"Do not load balance",value:"DO_NOT_LOAD_BALANCE",description:"Do not load balance FlowFiles between nodes in the cluster."},{text:"Partition by attribute",value:"PARTITION_BY_ATTRIBUTE",description:"Determine which node to send a given FlowFile to based on the value of a user-specified FlowFile Attribute. All FlowFiles that have the same value for said Attribute will be sent to the same node in the cluster."},{text:"Round robin",value:"ROUND_ROBIN",description:"FlowFiles will be distributed to nodes in the cluster in a Round-Robin fashion."},{text:"Single node",value:"SINGLE_NODE",description:"All FlowFiles will be sent to the same node. Which node they are sent to is not defined."}],loadBalanceCompressionOptions:[{text:"Do not compress",value:"DO_NOT_COMPRESS",description:"FlowFiles will not be compressed"},{text:"Compress attributes only",value:"COMPRESS_ATTRIBUTES_ONLY",description:"FlowFiles' attributes will be compressed, but the FlowFiles' contents will not be"},{text:"Compress attributes and content",value:"COMPRESS_ATTRIBUTES_AND_CONTENT",description:"FlowFiles' attributes and content will be compressed"}],formatDuration:function(j){j=j<1?0:j;var l=j/f.MILLIS_PER_DAY;l=l>=1?parseInt(l,10):0;j%=f.MILLIS_PER_DAY;var g=j/f.MILLIS_PER_HOUR;g=g>=1?parseInt(g,10):0;j%=f.MILLIS_PER_HOUR;var h=j/f.MILLIS_PER_MINUTE;h=h>=1?parseInt(h,10):0;j%=f.MILLIS_PER_MINUTE;var k=j/f.MILLIS_PER_SECOND;k=k>=1?parseInt(k,10):0;j=Math.floor(j%f.MILLIS_PER_SECOND);var i=f.pad(g,2,"0")+":"+f.pad(h,2,"0")+":"+f.pad(k,2,"0")+"."+f.pad(j,3,"0");if(l>0){return l+" days and "+i}else{return i}},BYTES_IN_KILOBYTE:1024,BYTES_IN_MEGABYTE:1048576,BYTES_IN_GIGABYTE:1073741824,BYTES_IN_TERABYTE:1099511627776,formatDataSize:function(h){var g=parseFloat(h/f.BYTES_IN_TERABYTE);if(g>1){return g.toFixed(2)+" TB"}g=parseFloat(h/f.BYTES_IN_GIGABYTE);if(g>1){return g.toFixed(2)+" GB"}g=parseFloat(h/f.BYTES_IN_MEGABYTE);if(g>1){return g.toFixed(2)+" MB"}g=parseFloat(h/f.BYTES_IN_KILOBYTE);if(g>1){return g.toFixed(2)+" KB"}return parseFloat(h).toFixed(2)+" bytes"},formatInteger:function(h){var g=h+"";var i=/(\d+)(\d{3})/;while(i.test(g)){g=g.replace(i,"$1,$2")}return f.escapeHtml(g)},formatFloat:function(g){if(f.isUndefinedOrNull(g)){return 0+""}return g.toFixed(2)+""},pad:function(j,h,i){var g=j+"";while(g.length<h){g=i+g}return g},formatDateTime:function(g){return f.pad(g.getMonth()+1,2,"0")+"/"+f.pad(g.getDate(),2,"0")+"/"+f.pad(g.getFullYear(),2,"0")+" "+f.pad(g.getHours(),2,"0")+":"+f.pad(g.getMinutes(),2,"0")+":"+f.pad(g.getSeconds(),2,"0")+"."+f.pad(g.getMilliseconds(),3,"0")},parseDateTime:function(k){if(!f.isDefinedAndNotNull(k)){return new Date()}if(k==="No value set"){return new Date()}if(k==="Empty string set"){return new Date()}var r=k.split(/ /);if(r.length!==3){return new Date()}var h=r[0].split(/\//);var g=r[1].split(/:/);if(h.length!==3||g.length!==3){return new Date()}var m=parseInt(h[2],10);var l=parseInt(h[0],10)-1;var n=parseInt(h[1],10);var o=parseInt(g[0],10);var j=parseInt(g[1],10);var q=g[2].split(/\./);var p=parseInt(q[0],10);var i=0;if(q.length===2){i=parseInt(q[1],10)}return new Date(m,l,n,o,j,p,i)},parseDuration:function(g){var h=g.split(/:/);if(h.length!==3){return 0}var i=h[2].split(/\./);if(i.length===2){return new Date(1970,0,1,parseInt(h[0],10),parseInt(h[1],10),parseInt(i[0],10),parseInt(i[1],10)).getTime()}else{return new Date(1970,0,1,parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10),0).getTime()}},parseSize:function(i){var j=i.split(/ /);var h=parseFloat(j[0].replace(/,/g,""));var g=j[1];if(g==="KB"){return h*1024}else{if(g==="MB"){return h*1024*1024}else{if(g==="GB"){return h*1024*1024*1024}else{if(g==="TB"){return h*1024*1024*1024*1024}else{return h}}}}},parseCount:function(i){var h=i.split(/ /,1);if(h.length!==1){return 0}var g=parseInt(h[0].replace(/,/g,""),10);if(isNaN(g)){return 0}return g},isDefinedAndNotNull:function(g){return !f.isUndefined(g)&&!f.isNull(g)},isUndefinedOrNull:function(g){return f.isUndefined(g)||f.isNull(g)},isUndefined:function(g){return typeof g==="undefined"},isBlank:function(g){return f.isUndefined(g)||f.isNull(g)||e.trim(g)===""},isNull:function(g){return g===null},isEmpty:function(g){return e.isArray(g)?g.length===0:true},doBulletinsDiffer:function(h,j){if(e.isArray(h)&&e.isArray(j)){if(h.length===j.length){for(var g=0;g<h.length;g++){if(h[g].id!==j[g].id||h[g].canRead!==j[g].canRead){return true}}}else{return true}}else{if(e.isArray(h)||e.isArray(j)){return true}}return false},getFormattedBulletins:function(h){var g=[];e.each(h,function(k,l){if(l.canRead===true){var i=l.bulletin;var o="";if(f.isDefinedAndNotNull(i.nodeAddress)){o="-&nbsp;"+f.escapeHtml(i.nodeAddress)+"&nbsp;-&nbsp;"}var n=e("<pre></pre>").css({"white-space":"pre-wrap"}).text(i.message);var m=e("<div>"+f.escapeHtml(i.timestamp)+"&nbsp;"+o+"&nbsp;<b>"+f.escapeHtml(i.level)+"</b>&nbsp;</div>").append(n);g.push(m)}});return g},getFormattedServiceApis:function(h){var g=[];e.each(h,function(l,m){var j=f.formatType({type:m.type,bundle:m.bundle});var k=f.formatBundle(m.bundle);g.push(e("<div></div>").text(j+" from "+k))});return g},getFormattedGarbageCollections:function(h){h.sort(function(j,i){return i.collectionCount-j.collectionCount});var g=[];e.each(h,function(k,i){var j=e('<span style="font-weight: bold;"></span>').text(i.name);var l=e("<span></span>").text(" - "+i.collectionCount+" times ("+i.collectionTime+")");var m=e("<div></div>").append(j).append(l);g.push(m)});return g},getPolicyTypeListing:function(h){var g=d.nest().key(function(i){return i.value}).map(a,d.map);return g.get(h)[0]},getComponentName:function(g){return g.permissions.canRead===true?g.component.name:g.id},getComboOptionText:function(g,i){var h=g.find(function(j){return j.value===i});return f.isDefinedAndNotNull(h)?h.text:undefined}};return f}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Dialog","nf.Common"],function(d,c,e){return(nf.ErrorHandler=b(d,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("jquery"),require("nf.Dialog"),require("nf.Common")))}else{nf.ErrorHandler=b(a.$,a.nf.Dialog,a.nf.Common)}}}(this,function(b,a,c){return{handleAjaxError:function(g,d,e){if(d==="canceled"){if(b("#splash").is(":visible")){b("#message-title").text("Session Expired");b("#message-content").text("Your session has expired. Please reload to log in again.");b("#message-pane").show()}else{a.showOkDialog({headerText:"Session Expired",dialogContent:"Your session has expired. Please press Ok to log in again.",okHandler:function(){window.location="/nifi"}})}return}if(b("#splash").is(":visible")){if(g.status===401){b("#message-title").text("Unauthorized")}else{if(g.status===403){b("#message-title").text("Insufficient Permissions")}else{if(g.status===409){b("#message-title").text("Invalid State")}else{b("#message-title").text("An unexpected error has occurred")}}}if(b.trim(g.responseText)===""){b("#message-content").text("Please check the logs.")}else{b("#message-content").text(g.responseText)}b("#message-pane").show();return}if(g.status===400||g.status===404||g.status===409||g.status===503){a.showOkDialog({headerText:"Error",dialogContent:c.escapeHtml(g.responseText)})}else{if(g.status===403){a.showOkDialog({headerText:"Insufficient Permissions",dialogContent:c.escapeHtml(g.responseText)})}else{if(g.status<99||g.status===12007||g.status===12029){var f="Please ensure the application is running and check the logs for any errors.";if(c.isDefinedAndNotNull(d)){if(d==="timeout"){f="Request has timed out. Please ensure the application is running and check the logs for any errors."}else{if(d==="abort"){f="Request has been aborted."}else{if(d==="No Transport"){f="Request transport mechanism failed. Please ensure the host where the application is running is accessible."}}}}b("#message-title").text("Unable to communicate with NiFi");b("#message-content").text(f)}else{if(g.status===401){b("#message-title").text("Unauthorized");if(b.trim(g.responseText)===""){b("#message-content").text("Authentication is required to use this NiFi.")}else{b("#message-content").text(g.responseText)}}else{if(g.status===500){b("#message-title").text("An unexpected error has occurred");if(b.trim(g.responseText)===""){b("#message-content").text("An error occurred communicating with the application core. Please check the logs and fix any configuration issues before restarting.")}else{b("#message-content").text(g.responseText)}}else{if(g.status===200||g.status===201){b("#message-title").text("Parse Error");if(b.trim(g.responseText)===""){b("#message-content").text("Unable to interpret response from NiFi.")}else{b("#message-content").text(g.responseText)}}else{b("#message-title").text(g.status+": Unexpected Response");b("#message-content").text("An unexpected error has occurred. Please check the logs.")}}}}b("#message-pane").show()}}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.UniversalCapture=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.UniversalCapture=b(require("jquery")))}else{nf.UniversalCapture=b(a.$)}}}(this,function(b){b(document).ready(function(c){c(window).on("keydown",function(d){var i=d.ctrlKey||d.metaKey;if(!i&&d.keyCode===27){var g=c("div.value-combo");if(g.is(":visible")&&g.parent().hasClass("combo-editor")){return}if(c("div.property-detail").is(":visible")){a.removeAllPropertyDetailDialogs();d.stopImmediatePropagation();d.preventDefault()}else{var h=c(d.target);if(h.length){var j=c(".cancellable");if(j.length){var e=null;var f=null;c.each(j,function(k,m){var l=c(m);var n=l.css("zIndex");if(l.is(":visible")&&(n!==null&&typeof n!=="undefined")){n=parseInt(n,10);if(e===null||n>e){e=n;f=l}}});if(f!==null){if(f.hasClass("modal")){f.modal("hide")}else{f.hide()}d.stopImmediatePropagation();d.preventDefault();return}}if(top!==window){if(typeof parent.nf!=="undefined"&&typeof parent.nf.Shell!=="undefined"){parent.$("#shell-close-button").click();d.stopImmediatePropagation();d.preventDefault();return}}}}}else{if(i){if(d.keyCode===82){d.preventDefault()}}else{if(!c("input, textarea").is(":focus")&&(d.keyCode==8||d.keyCode===46)){d.preventDefault()}}}})});var a={removeAllPropertyDetailDialogs:function(){var c=b("body").find("div.property-detail");c.find("div.nfel-editor").nfeditor("destroy");c.find("div.value-combo").combo("destroy");c.hide().remove()}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Storage"],function(d,c){return(nf.AjaxSetup=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AjaxSetup=b(require("jquery"),require("nf.Storage")))}else{nf.AjaxSetup=b(a.$,a.nf.Storage)}}}(this,function(b,a){b(document).ready(function(c){c.ajaxSetup({beforeSend:function(f){var d=a.hasItem("jwt");var e=a.getItem("jwt");if(e!==null){f.setRequestHeader("Authorization","Bearer "+e)}else{if(d===true){return false}}}})})}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Common","nf.Dialog","nf.ErrorHandler"],function(d,g,e,c,f){return(nf.ClusterTable=b(d,g,e,c,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ClusterTable=b(require("jquery"),require("Slick"),require("nf.Common"),require("nf.Dialog"),require("nf.ErrorHandler")))}else{nf.ClusterTable=b(a.$,a.Slick,a.nf.Common,a.nf.Dialog,a.nf.ErrorHandler)}}}(this,function(I,c,W,q,g){var Q={primaryNode:"Primary Node",clusterCoordinator:"Cluster Coordinator",urls:{cluster:"../nifi-api/controller/cluster",nodes:"../nifi-api/controller/cluster/nodes",systemDiagnostics:"../nifi-api/system-diagnostics"},data:[{name:"cluster",update:k,isAuthorized:W.canAccessController},{name:"systemDiagnostics",update:F,isAuthorized:W.canAccessSystem}]};var H={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var L={name:"Nodes",data:{dataSet:"cluster",update:o},tabContentId:"cluster-nodes-tab-content",tableId:"cluster-nodes-table",tableColumnModel:a,tableIdColumn:"nodeId",tableOptions:H,tableOnClick:e,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"address"},{text:"by status",value:"status"}]};var S={name:"JVM",data:{dataSet:"systemDiagnostics",update:Z},tabContentId:"cluster-jvm-tab-content",tableId:"cluster-jvm-table",tableColumnModel:z,tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:j,cleanUpTable:t,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"node"}]};var u={name:"System",data:{dataSet:"systemDiagnostics",update:b},tabContentId:"cluster-system-tab-content",tableId:"cluster-system-table",tableColumnModel:[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"processors",field:"processors",name:"Cores",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"processorLoadAverage",field:"processorLoadAverage",name:"Core Load Average",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"totalThreads",field:"totalThreads",name:"Total Threads",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"daemonThreads",field:"daemonThreads",name:"Daemon Threads",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter}],tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"node"}]};var y={name:"FlowFile Storage",data:{dataSet:"systemDiagnostics",update:E},tabContentId:"cluster-flowfile-tab-content",tableId:"cluster-flowfile-table",tableColumnModel:[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"ffRepoTotal",field:"ffRepoTotal",name:"Total Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"ffRepoUsed",field:"ffRepoUsed",name:"Used Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"ffRepoFree",field:"ffRepoFree",name:"Free Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"ffStoreUtil",field:"ffRepoUtil",name:"Utilization",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter}],tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"node"}]};var ab={name:"Content Storage",data:{dataSet:"systemDiagnostics",update:w},tabContentId:"cluster-content-tab-content",tableId:"cluster-content-table",tableColumnModel:[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"contentRepoId",field:"contentRepoId",name:"Content Repository",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"contentRepoTotal",field:"contentRepoTotal",name:"Total Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"contentRepoUsed",field:"contentRepoUsed",name:"Used Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"contentRepoFree",field:"contentRepoFree",name:"Free Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"contentRepoUtil",field:"contentRepoUtil",name:"Utilization",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter}],tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"node"},{text:"by repository",value:"contentRepoId"}]};var C={name:"Provenance Storage",data:{dataSet:"systemDiagnostics",update:p},tabContentId:"cluster-provenance-tab-content",tableId:"cluster-provenance-table",tableColumnModel:[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"provenanceRepoId",field:"provenanceRepoId",name:"Provenance Repository",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"provenanceRepoTotal",field:"provenanceRepoTotal",name:"Total Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"provenanceRepoUsed",field:"provenanceRepoUsed",name:"Used Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"provenanceRepoFree",field:"provenanceRepoFree",name:"Free Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"provenanceRepoUtil",field:"provenanceRepoUtil",name:"Utilization",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter}],tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"node"},{text:"by repository",value:"contentRepoId"}]};var s={name:"Versions",data:{dataSet:"systemDiagnostics",update:f},tabContentId:"cluster-version-tab-content",tableId:"cluster-version-table",tableColumnModel:[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"version",field:"version",name:"NiFi Version",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"javavendor",field:"javaVendor",name:"Java Vendor",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"javaversion",field:"javaVersion",name:"Java Version",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"osname",field:"osName",name:"OS Name",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"osversion",field:"osVersion",name:"OS Version",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"osarch",field:"osArchitecture",name:"OS Architecture",sortable:true,resizable:true,formatter:W.genericValueFormatter}],tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"address"}]};var T=[L,u,S,y,ab,C,s];var A={};var M={};function e(af,ac,ae,ad){if(L.grid.getColumns()[ac.cell].id==="actions"){if(ae.hasClass("prompt-for-connect")){R(ad)}else{if(ae.hasClass("prompt-for-removal")){h(ad)}else{if(ae.hasClass("prompt-for-offload")){l(ad)}else{if(ae.hasClass("prompt-for-disconnect")){V(ad)}}}}}else{if(L.grid.getColumns()[ac.cell].id==="moreDetails"){if(ae.hasClass("show-node-details")){B(ad)}}}}function a(){var ad=function(am,aj,al,ak,ai){return'<div title="View Details" class="pointer show-node-details fa fa-info-circle"></div>'};var ac=function(am,aj,al,ak,ai){return m(ai)};var ae=function(am,aj,al,ak,ai){return W.formatValue(al)};var ah=function(am,aj,al,ak,ai){return d(ai)};var af=[{id:"moreDetails",name:"&nbsp;",sortable:false,resizable:false,formatter:ad,width:50,maxWidth:50},{id:"formattedNodeAddress",field:"formattedNodeAddress",name:"Node Address",formatter:ac,resizable:true,sortable:true},{id:"activeThreadCount",field:"activeThreadCount",name:"Active Thread Count",resizable:true,sortable:true,defaultSortAsc:false,formatter:W.genericValueFormatter},{id:"queued",field:"queued",name:'<span class="queued-title">Queue</span>&nbsp;/&nbsp;<span class="queued-size-title">Size</span>',resizable:true,sortable:true,defaultSortAsc:false,formatter:W.genericValueFormatter},{id:"status",field:"status",name:"Status",formatter:ah,resizable:true,sortable:true},{id:"uptime",field:"nodeStartTime",name:"Started At",formatter:ae,resizable:true,sortable:true,defaultSortAsc:false},{id:"heartbeat",field:"heartbeat",name:"Last Heartbeat",formatter:ae,resizable:true,sortable:true,defaultSortAsc:false}];if(W.canModifyController()){var ag=function(ar,ap,ao,am,aj){var an='<div title="Connect" class="pointer prompt-for-connect fa fa-plug"></div>';var ak='<div title="Delete" class="pointer prompt-for-removal fa fa-trash"></div>';var ai='<div title="Disconnect" class="pointer prompt-for-disconnect fa fa-power-off"></div>';var al='<div title="Offload" class="pointer prompt-for-offload fa fa-rotate-90 fa-upload" style="margin-top: 5px;margin-left: 5px;margin-right: -2px;"></div>';var aq="";if(aj.status==="CONNECTED"||aj.status==="CONNECTING"){aq+=ai}else{if(aj.status==="DISCONNECTED"){aq+=an+al+ak}else{if(aj.status==="OFFLOADED"){aq+=an+ak}else{aq+='<div style="width: 16px; height: 16px;">&nbsp;</div>'}}}return aq};af.push({id:"actions",label:"&nbsp;",formatter:ag,resizable:false,sortable:false,width:80,maxWidth:80})}return af}function j(ac){var ad=ac.getData();return function(ah){var ai=I(this).find("div.show-jvm-gc");if(ai.length&&!ai.data("qtip")){var ag=I(this).find("span.row-id").text();var ae=ad.getItemById(ag);var aj=W.getFormattedGarbageCollections(ae.garbageCollection);var af=W.formatUnorderedList(aj);if(W.isDefinedAndNotNull(af)){ai.qtip(I.extend({},W.config.tooltipConfig,{content:af,position:{container:I("#cluster"),at:"bottom left",my:"top right",adjust:{x:4,y:4}}}))}}}}function t(ac){W.cleanUpTooltips(ac,"div.show-jvm-gc")}function z(){var ac=function(ah,ae,ag,af,ad){return'<div class="pointer show-jvm-gc fa fa-question-circle"></div><span class="hidden row-id">'+W.escapeHtml(ad.id)+"</span>"};return[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"heapMax",field:"maxHeap",name:"Heap Max",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"heapTotal",field:"totalHeap",name:"Heap Total",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"heapUsed",field:"usedHeap",name:"Heap Used",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"heapUtilPct",field:"heapUtilization",name:"Heap Utilization",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"nonHeapTotal",field:"totalNonHeap",name:"Non-Heap Total",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"nonHeapUsed",field:"usedNonHeap",name:"Non-Heap Used",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"gc",name:"GC",sortable:false,resizable:true,formatter:ac,width:50,maxWidth:50},{id:"uptime",field:"uptime",name:"Uptime",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter}]}var r,X;function aa(ac,af,ae){var ad=function(au,at){if(ac.columnId==="heartbeat"||ac.columnId==="uptime"){var ak=W.parseDateTime(au[ac.columnId]);var ah=W.parseDateTime(at[ac.columnId]);return ak.getTime()-ah.getTime()}else{if(ac.columnId==="queued"){var am=au[ac.columnId].split(/ \/ /);var ap=at[ac.columnId].split(/ \/ /);var ar=X%4;if(ar<2){I("#cluster-nodes-table span.queued-title").addClass("sorted");var ai=W.parseCount(am[0]);var ao=W.parseCount(ap[0]);return ai-ao}else{I("#cluster-nodes-table span.queued-size-title").addClass("sorted");var ax=W.parseSize(am[1]);var aw=W.parseSize(ap[1]);return ax-aw}}else{if(ac.columnId==="maxHeap"||ac.columnId==="totalHeap"||ac.columnId==="usedHeap"||ac.columnId==="totalNonHeap"||ac.columnId==="usedNonHeap"||ac.columnId==="ffRepoTotal"||ac.columnId==="ffRepoUsed"||ac.columnId==="ffRepoFree"||ac.columnId==="contentRepoTotal"||ac.columnId==="contentRepoUsed"||ac.columnId==="contentRepoFree"){var ax=W.parseSize(au[ac.columnId]);var aw=W.parseSize(at[ac.columnId]);return ax-aw}else{if(ac.columnId==="totalThreads"||ac.columnId==="daemonThreads"||ac.columnId==="processors"){var ai=W.parseCount(au[ac.columnId]);var ao=W.parseCount(at[ac.columnId]);return ai-ao}else{if(ac.columnId==="status"){var al=d(au);var aq=d(at);return al===aq?0:al>aq?1:-1}else{if(ac.columnId==="formattedNodeAddress"){var aj=m(au);var ag=m(at);return aj===ag?0:aj>ag?1:-1}else{var an=W.isDefinedAndNotNull(au[ac.columnId])?au[ac.columnId]:"";var av=W.isDefinedAndNotNull(at[ac.columnId])?at[ac.columnId]:"";return an===av?0:an>av?1:-1}}}}}}};I("#cluster-nodes-table span.queued-title").removeClass("sorted");I("#cluster-nodes-table span.queued-size-title").removeClass("sorted");if(r!==ac.columnId){X=0}else{X++}af.sort(ad,ac.sortAsc);r=ac.columnId}var m=function(ac){return W.escapeHtml(ac.address)+":"+W.escapeHtml(ac.apiPort)};var d=function(ad){var ac=ad.status;if(ad.roles.includes(Q.primaryNode)){ac+=", PRIMARY"}if(ad.roles.includes(Q.clusterCoordinator)){ac+=", COORDINATOR"}return W.escapeHtml(ac)};var R=function(ac){q.showYesNoDialog({headerText:"Connect Node",dialogContent:"Connect '"+m(ac)+"' to this cluster?",yesHandler:function(){v(ac.nodeId)}})};var v=function(ad){var ac={node:{nodeId:ad,status:"CONNECTING"}};I.ajax({type:"PUT",url:Q.urls.nodes+"/"+encodeURIComponent(ad),data:JSON.stringify(ac),dataType:"json",contentType:"application/json"}).done(function(af){var ag=af.node;var ah=I("#cluster-nodes-table").data("gridInstance");var ae=ah.getData();ae.updateItem(ag.nodeId,ag)}).fail(g.handleAjaxError)};var l=function(ac){q.showYesNoDialog({headerText:"Offload Node",dialogContent:"Offload '"+m(ac)+"'?",yesHandler:function(){U(ac.nodeId)}})};var U=function(ad){var ac={node:{nodeId:ad,status:"OFFLOADING"}};I.ajax({type:"PUT",url:Q.urls.nodes+"/"+encodeURIComponent(ad),data:JSON.stringify(ac),dataType:"json",contentType:"application/json"}).done(function(af){var ag=af.node;var ah=I("#cluster-nodes-table").data("gridInstance");var ae=ah.getData();ae.updateItem(ag.nodeId,ag)}).fail(g.handleAjaxError)};var V=function(ac){q.showYesNoDialog({headerText:"Disconnect Node",dialogContent:"Disconnect '"+m(ac)+"' from the cluster?",yesHandler:function(){Y(ac.nodeId)}})};var Y=function(ad){var ac={node:{nodeId:ad,status:"DISCONNECTING"}};I.ajax({type:"PUT",url:Q.urls.nodes+"/"+encodeURIComponent(ad),data:JSON.stringify(ac),dataType:"json",contentType:"application/json"}).done(function(af){var ag=af.node;var ah=I("#cluster-nodes-table").data("gridInstance");var ae=ah.getData();ae.updateItem(ag.nodeId,ag)}).fail(g.handleAjaxError)};var h=function(ac){q.showYesNoDialog({headerText:"Remove Node",dialogContent:"Remove '"+m(ac)+"' from the cluster?",yesHandler:function(){D(ac.nodeId)}})};var D=function(ac){I.ajax({type:"DELETE",url:Q.urls.nodes+"/"+encodeURIComponent(ac),dataType:"json"}).done(function(){var ae=I("#cluster-nodes-table").data("gridInstance");var ad=ae.getData();ad.deleteItem(ac)}).fail(g.handleAjaxError)};var J=function(){return I("#cluster-filter").val()};var n=function(){var ae=N();if(!ae){return}var ad=ae.grid;if(W.isDefinedAndNotNull(ad)){var ac=ad.getData();ac.setFilterArgs({searchString:J(),property:I("#cluster-filter-type").combo("getSelectedOption").value});ac.refresh()}};var N=function(){var ac=null;T.forEach(function(ad){if(I("#"+ad.tableId).is(":visible")){ac=ad}});return ac};var K=function(ad,ac){if(ac.searchString===""){return true}try{var ag=new RegExp(ac.searchString,"i")}catch(af){return false}var ae=ad[ac.property];if(ac.property==="address"){ae=m(ad)}else{if(ac.property==="status"){ae=d(ad)}}return ae.search(ag)>=0};function O(ac){if(!ac){ac=N()}if(ac.dataView){var ae=ac.dataView.getLength();var ad=ac.rowCount;I("#displayed-rows").text(ae);I("#total-rows").text(ad)}}var P=function(){I("#cluster-filter").val("");n()};var B=function(ac){I.ajax({type:"GET",url:Q.urls.nodes+"/"+encodeURIComponent(ac.nodeId),dataType:"json"}).done(function(ae){var ag=ae.node;I("#node-id").text(ag.nodeId);I("#node-address").text(m(ag));var af=I("#node-events");if(I.isArray(ag.events)&&ag.events.length>0){var ad=[];I.each(ag.events,function(ah,ai){ad.push(ai.timestamp+": "+ai.message)});I("<div></div>").append(W.formatUnorderedList(ad)).appendTo(af)}else{af.append('<div><span class="unset">None</span></div>')}I("#node-details-dialog").modal("show")}).fail(g.handleAjaxError)};function Z(ac){if(W.isDefinedAndNotNull(ac.systemDiagnostics)&&W.isDefinedAndNotNull(ac.systemDiagnostics.nodeSnapshots)){var ad=[];ac.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;ad.push({id:ae.nodeId,node:ae.address+":"+ae.apiPort,address:ae.address,maxHeap:af.maxHeap,totalHeap:af.totalHeap,usedHeap:af.usedHeap,heapUtilization:af.heapUtilization,maxNonHeap:af.maxNonHeap,totalNonHeap:af.totalNonHeap,usedNonHeap:af.usedNonHeap,garbageCollection:af.garbageCollection,uptime:af.uptime})});S.rowCount=ad.length;S.dataView.setItems(ad);S.dataView.reSort();S.grid.invalidate()}else{S.rowCount=0}}function b(ad){if(W.isDefinedAndNotNull(ad.systemDiagnostics)&&W.isDefinedAndNotNull(ad.systemDiagnostics.nodeSnapshots)){var ac=[];ad.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;ac.push({id:ae.nodeId,node:ae.address+":"+ae.apiPort,address:ae.address,processors:af.availableProcessors,processorLoadAverage:af.processorLoadAverage,totalThreads:af.totalThreads,daemonThreads:af.daemonThreads})});u.rowCount=ac.length;u.dataView.setItems(ac);u.dataView.reSort();u.grid.invalidate()}else{u.rowCount=0}}function E(ac){if(W.isDefinedAndNotNull(ac.systemDiagnostics)&&W.isDefinedAndNotNull(ac.systemDiagnostics.nodeSnapshots)){var ad=[];ac.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;ad.push({id:ae.nodeId,node:ae.address+":"+ae.apiPort,address:ae.address,ffRepoTotal:af.flowFileRepositoryStorageUsage.totalSpace,ffRepoUsed:af.flowFileRepositoryStorageUsage.usedSpace,ffRepoFree:af.flowFileRepositoryStorageUsage.freeSpace,ffRepoUtil:af.flowFileRepositoryStorageUsage.utilization})});y.rowCount=ad.length;y.dataView.setItems(ad);y.dataView.reSort();y.grid.invalidate()}else{y.rowCount=0}}function w(ad){if(W.isDefinedAndNotNull(ad.systemDiagnostics)&&W.isDefinedAndNotNull(ad.systemDiagnostics.nodeSnapshots)){var ac=[];ad.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;af.contentRepositoryStorageUsage.forEach(function(ag){ac.push({id:ae.nodeId+":"+ag.identifier,address:ae.address,node:ae.address+":"+ae.apiPort,contentRepoId:ag.identifier,contentRepoTotal:ag.totalSpace,contentRepoUsed:ag.usedSpace,contentRepoFree:ag.freeSpace,contentRepoUtil:ag.utilization})})});ab.rowCount=ac.length;ab.dataView.setItems(ac);ab.dataView.reSort();ab.grid.invalidate()}else{ab.rowCount=0}}function p(ad){if(W.isDefinedAndNotNull(ad.systemDiagnostics)&&W.isDefinedAndNotNull(ad.systemDiagnostics.nodeSnapshots)){var ac=[];ad.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;af.provenanceRepositoryStorageUsage.forEach(function(ag){ac.push({id:ae.nodeId+":"+ag.identifier,address:ae.address,node:ae.address+":"+ae.apiPort,provenanceRepoId:ag.identifier,provenanceRepoTotal:ag.totalSpace,provenanceRepoUsed:ag.usedSpace,provenanceRepoFree:ag.freeSpace,provenanceRepoUtil:ag.utilization})})});C.rowCount=ac.length;C.dataView.setItems(ac);C.dataView.reSort();C.grid.invalidate()}else{C.rowCount=0}}function f(ad){if(W.isDefinedAndNotNull(ad.systemDiagnostics)&&W.isDefinedAndNotNull(ad.systemDiagnostics.nodeSnapshots)){var ac=[];ad.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;ac.push({id:ae.nodeId,address:ae.address,node:ae.address+":"+ae.apiPort,version:af.versionInfo.niFiVersion,javaVendor:af.versionInfo.javaVendor,javaVersion:af.versionInfo.javaVersion,osName:af.versionInfo.osName,osVersion:af.versionInfo.osVersion,osArchitecture:af.versionInfo.osArchitecture})});s.dataView.setItems(ac);s.dataView.reSort();s.grid.invalidate()}}function F(){var ad=Q.urls.systemDiagnostics;var ac=I.ajax({type:"GET",url:ad,data:{nodewise:true},dataType:"json"}).done(function(af){var ae=M.systemDiagnostics;ae.forEach(function(ag){ag(af)})}).fail(g.handleAjaxError);return ac}function x(ae){var ag=new c.Data.DataView({inlineFilters:false});ag.setItems([],ae.tableIdColumn);ag.setFilterArgs({searchString:J(),property:I("#cluster-filter-type").combo("getSelectedOption").value});ag.setFilter(K);ae.onSort({columnId:ae.tableIdColumn,sortAsc:true},ag);var ad=ae.tableColumnModel;if(typeof ad==="function"){ad=ad()}var ac=new c.Grid("#"+ae.tableId,ag,ad,ae.tableOptions);ac.setSelectionModel(new c.RowSelectionModel());ac.setSortColumn(ae.tableIdColumn,true);ac.onSort.subscribe(function(ai,ah){ae.onSort({columnId:ah.sortCol.field,sortAsc:ah.sortAsc},ag,ae)});ag.onRowCountChanged.subscribe(function(ai,ah){ac.updateRowCount();ac.render();O(ae)});ag.onRowsChanged.subscribe(function(ai,ah){ac.invalidateRows(ah.rows);ac.render()});if(ae.tableOnClick){ac.onClick.subscribe(function(ak,ah){var aj=I(ak.target);var ai=ag.getItem(ah.row);ae.tableOnClick(ak,ah,aj,ai)})}var af=I("#"+ae.tableId).data("gridInstance",ac);if(typeof ae.createTableOnEnter==="function"){af.on("mouseenter","div.slick-cell",ae.createTableOnEnter(ac))}if(typeof ae.cleanUpTable==="function"){ac.onViewportChanged.subscribe(function(ai,ah){ae.cleanUpTable(af)})}ae.dataView=ag;ae.grid=ac}function o(ae){var ac=ae.cluster;if(W.isDefinedAndNotNull(ac.nodes)){var af=L.grid;var ad=af.getData();L.rowCount=ac.nodes.length;ad.setItems(ac.nodes);ad.reSort();af.invalidate();I("#cluster-last-refreshed").text(ac.generated)}else{I("#total-nodes").text("0")}}function k(){var ac=I.ajax({type:"GET",url:Q.urls.cluster,dataType:"json"}).done(function(ae){var ad=M.cluster;ad.forEach(function(af){af(ae)})}).fail(g.handleAjaxError);return ac}function i(ac){var ad=ac.grid;if(W.isDefinedAndNotNull(ad)){ad.resizeCanvas()}P();I("#cluster-filter-type").combo({options:ac.filterOptions,select:function(ae){n()}});O(ac)}var G={init:function(){I("#node-details-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Node Details",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){I("#node-details-dialog").modal("hide")}}}],handler:{close:function(){I("#node-address").text("");I("#node-id").text("");I("#node-events").empty()}}});I("#cluster-filter").keyup(function(){n()});var ac={};Q.data=Q.data.filter(function(ad){ad.authorized=ad.isAuthorized();ac[ad.name]=ad.authorized;if(ad.authorized){return true}else{return false}});T=T.filter(function(ae){var ad=ae.data.dataSet;if(ac[ad]){return true}else{return false}});T.forEach(function(ad){A[ad.name]=ad;var ae=M[ad.data.dataSet];if(ae){M[ad.data.dataSet]=ae.concat([ad.data.update])}else{M[ad.data.dataSet]=[ad.data.update]}});I("#cluster-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:T,select:function(){var ae=I(this).text();var ad=A[ae];if(ad){ad.onTabSelected(ad)}else{console.error("Failed to match tab: ",ae,A)}}});I(window).resize(function(){G.resetTableSize()});T.forEach(function(ae){try{ae.init(ae)}catch(ad){console.error("Failed to initialize tab",ae,ad)}})},resetTableSize:function(){T.forEach(function(ac){if(ac&&ac.grid){ac.grid.resizeCanvas()}})},loadClusterTable:function(){var ad=Q.data.map(function(af){var ae=af.update();return ae});var ac=I.when.apply(I,ad);ac=ac.done(function(ae){O(L)});return ac}};return G}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.ClusterTable","nf.ErrorHandler","nf.Storage"],function(d,e,g,f,c){return(nf.Cluster=b(d,e,g,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Cluster=b(require("jquery"),require("nf.Common"),require("nf.ClusterTable"),require("nf.ErrorHandler"),require("nf.Storage")))}else{nf.Cluster=b(a.$,a.nf.Common,a.nf.ClusterTable,a.nf.ErrorHandler,a.nf.Storage)}}}(this,function(c,b,h,e,d){c(document).ready(function(){g.init()});var a={urls:{banners:"../nifi-api/flow/banners",about:"../nifi-api/flow/about",currentUser:"../nifi-api/flow/current-user"}};var f=function(){return c.ajax({type:"GET",url:a.urls.currentUser,dataType:"json"}).done(function(j){b.setCurrentUser(j)}).fail(e.handleAjaxError)};var i=function(){c("#refresh-button").click(function(){h.loadClusterTable()});return c.Deferred(function(j){if(top===window){c.ajax({type:"GET",url:a.urls.banners,dataType:"json"}).done(function(o){if(b.isDefinedAndNotNull(o.banners)){if(b.isDefinedAndNotNull(o.banners.headerText)&&o.banners.headerText!==""){var l=c("#banner-header").text(o.banners.headerText).show();var n=function(p){var q=c("#"+p);q.css("top",(parseInt(l.css("height"),10)+parseInt(q.css("top"),10))+"px")};n("counters")}if(b.isDefinedAndNotNull(o.banners.footerText)&&o.banners.footerText!==""){var k=c("#banner-footer").text(o.banners.footerText).show();var m=function(p){var q=c("#"+p);q.css("bottom",parseInt(k.css("height"),10)+"px")};m("counters")}}j.resolve()}).fail(function(m,k,l){e.handleAjaxError(m,k,l);j.reject()})}else{j.resolve()}}).promise()};var g={init:function(){d.init();f().done(function(){var j=function(){if(top===window){c("body").css({height:c(window).height()+"px",width:c(window).width()+"px"});c("#cluster").css("margin",40);c("#cluster-table").css("bottom",127);c("#cluster-refresh-container").css("margin",40)}};j();h.init();h.resetTableSize();h.loadClusterTable().done(function(){i().done(function(){c.ajax({type:"GET",url:a.urls.about,dataType:"json"}).done(function(l){var k=l.about;var m=k.title+" Cluster";document.title=m;c("#counters-header-text").text(m)}).fail(e.handleAjaxError);c(window).on("resize",function(s){j();var l=c(".dialog");for(var q=0,r=l.length;q<r;q++){if(c(l[q]).is(":visible")){setTimeout(function(k){k.modal("resize")},50,c(l[q]))}}var t=c('*[class*="slickgrid_"]');for(var p=0,r=t.length;p<r;p++){if(c(t[p]).is(":visible")){setTimeout(function(k){k.data("gridInstance").resizeCanvas()},50,c(t[p]))}}var n=c(".tab-container");var m=[];for(var o=0,r=n.length;o<r;o++){if(c(n[o]).is(":visible")){m.push(c("#"+c(n[o]).attr("id")+"-content"))}}c.each(m,function(k,u){b.toggleScrollable(u.get(0))})})})})})}};return g}));
